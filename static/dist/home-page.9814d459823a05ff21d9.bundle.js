/*! For license information please see home-page.9814d459823a05ff21d9.bundle.js.LICENSE.txt */
(()=>{"use strict";const t=(t,e)=>e.some(e=>t instanceof e);let e,n;const r=new WeakMap,a=new WeakMap,o=new WeakMap;let i={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return r.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return l(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function s(t){i=t(i)}function c(t){return(n||(n=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(f(this),e),l(this.request)}:function(...e){return l(t.apply(f(this),e))}}function u(n){return"function"==typeof n?c(n):(n instanceof IDBTransaction&&function(t){if(r.has(t))return;const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{e(),r()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});r.set(t,e)}(n),t(n,e||(e=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(n,i):n)}function l(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{e(l(t.result)),r()},o=()=>{n(t.error),r()};t.addEventListener("success",a),t.addEventListener("error",o)});return o.set(e,t),e}(t);if(a.has(t))return a.get(t);const e=u(t);return e!==t&&(a.set(t,e),o.set(e,t)),e}const f=t=>o.get(t);const p=["get","getKey","getAll","getAllKeys","count"],d=["put","add","delete","clear"],E=new Map;function _(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(E.get(e))return E.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=d.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!p.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,a?"readwrite":"readonly");let i=o.store;return r&&(i=i.index(e.shift())),(await Promise.all([i[n](...e),a&&o.done]))[0]};return E.set(e,o),o}s(t=>({...t,get:(e,n,r)=>_(e,n)||t.get(e,n,r),has:(e,n)=>!!_(e,n)||t.has(e,n)}));const h=["continue","continuePrimaryKey","advance"],S={},m=new WeakMap,T=new WeakMap,y={get(t,e){if(!h.includes(e))return t[e];let n=S[e];return n||(n=S[e]=function(...t){m.set(this,T.get(this)[e](...t))}),n}};async function*g(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const n=new Proxy(e,y);for(T.set(n,e),o.set(n,f(e));e;)yield n,e=await(m.get(n)||e.continue()),m.delete(n)}function A(e,n){return n===Symbol.asyncIterator&&t(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===n&&t(e,[IDBIndex,IDBObjectStore])}function v(t){return t.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())}function w(t){return t.reduce((t,e)=>(t[e]=(t[e]||0)+1,t),{})}s(t=>({...t,get:(e,n,r)=>A(e,n)?g:t.get(e,n,r),has:(e,n)=>A(e,n)||t.has(e,n)}));const b={DE:"de",KO:"ko",PT:"pt",TH:"th",ZH_TW:"zh-TW",JA:"ja",EN:"en",FR:"fr",ZH_CN:"zh-CN",ES:"es"},O=new Set(["world_kor","world_global","world_jpn","world_asia","world_eu"]),R="world_global",P="world_kor",L="world_jpn",N="world_asia",I="world_eu",C={[R]:"Global",[P]:"Korea",[L]:"Japan",[N]:"Asia",[I]:"Europe"},D=Object.fromEntries(Object.values(C).map(t=>[t.toLowerCase(),t])),M={set_speed:"Speed",set_acc:"Hit",set_cri:"Critical",set_res:"Resist",set_def:"Defense",set_att:"Attack",set_max_hp:"Health",set_cri_dmg:"Destruction",set_coop:"Unity",set_immune:"Immunity",set_rage:"Rage",set_vampire:"Lifesteal",set_shield:"Protection",set_revenge:"Revenge",set_penetrate:"Penetration",set_torrent:"Torrent",set_counter:"Counter",set_scar:"Injury"},F=864e5,k={bronze:0,silver:1,gold:2,master:3,challenger:4,champion:5,warlord:6,emperor:7,legend:8},U=Object.fromEntries(Object.keys(k).sort((t,e)=>k[t]-k[e]).map(t=>[t,v(t)])),B={SEASON:"Season",SEASON_CODE:"Season Code",DATE_TIME:"Date/Time",SECONDS:"Seconds",TURNS:"Turns",SEQ_NUM:"Seq Num",P1_ID:"P1 ID",P1_SERVER:"P1 Server",P2_ID:"P2 ID",P2_SERVER:"P2 Server",P1_LEAGUE:"P1 League",P2_LEAGUE:"P2 League",P1_POINTS:"P1 Points",POINT_GAIN:"Point Gain",WIN:"Win",FIRST_PICK:"First Pick",FIRST_TURN:"First Turn",FIRST_TURN_HERO:"First Turn Hero",CR_BAR:"CR Bar",P1_PREBANS:"P1 Prebans",P2_PREBANS:"P2 Prebans",P1_PICKS:"P1 Picks",P2_PICKS:"P2 Picks",P1_POSTBAN:"P1 Postban",P2_POSTBAN:"P2 Postban",P1_EQUIPMENT:"P1 Equipment",P2_EQUIPMENT:"P2 Equipment",P1_ARTIFACTS:"P1 Artifacts",P2_ARTIFACTS:"P2 Artifacts",P1_MVP:"P1 MVP",P2_MVP:"P2 MVP",P1_PICKS_PRIMES:"P1 Picks Primes",P1_PICKS_PRIME_PRODUCT:"P1 Picks Prime Product",P2_PICKS_PRIMES:"P2 Picks Primes",P2_PICKS_PRIME_PRODUCT:"P2 Picks Prime Product",P1_PREBANS_PRIMES:"P1 Prebans Primes",P1_PREBANS_PRIME_PRODUCT:"P1 Prebans Prime Product",P2_PREBANS_PRIMES:"P2 Prebans Primes",P2_PREBANS_PRIME_PRODUCT:"P2 Prebans Prime Product"},j=(Object.values(B).filter(t=>!t.toLowerCase().includes("prime")),Object.values(B).filter(t=>!t.toLowerCase().includes("prime"))),x=[B.P1_EQUIPMENT,B.P2_EQUIPMENT,B.P1_ARTIFACTS,B.P2_ARTIFACTS,B.CR_BAR,B.P1_PREBANS,B.P2_PREBANS,B.P1_PICKS,B.P2_PICKS],G="Hero Name",H="Battles",K="Pick Rate",Y="Wins",V="Win rate",W="Postbans",q="Postban Rate",z="Success Rate",Q="+/-",J="Point Gain",X="Avg CR",Z="First Turns",tt="First Turn Rate",et="https://epic7.onstove.com",nt=et+"/gg";const rt=function(t){const e=new Uint8Array(t+1),n=[];for(let r=2;r<=t;r++)if(!e[r]){n.push(r);for(let n=r*r;n<=t;n+=r)e[n]=1}return n}(3e4);async function at(t,e){const n=t.transaction(e,"readwrite");n.objectStore(e).clear(),await n.done}const ot={USER:"current-user",BATTLES:"battles",RAW_UPLOAD:"raw-upload",UPLOADED_BATTLES:"uploaded-battles",FILTERED_BATTLES:"filtered-battles",STATS:"stats",FILTER_STR:"filter-str"},it={GLOBAL_USERS:"global-users",EU_USERS:"eu-users",ASIA_USERS:"asia-users",JPN_USERS:"jpn-users",KOR_USERS:"kor-users"},st={...ot,...it,LANG:"lang",HERO_MANAGER:"hero-manager",SEASON_DETAILS:"season-details",AUTO_ZOOM_FLAG:"auto-zoom",AUTO_QUERY_FLAG:"auto-query",ID_SEARCH_FLAG:"id-search",ARTIFACTS:"artifacts",ARTIFACTS_LOWERCASE_NAMES_MAP:"artifacts-lowercase-names-map",ARTIFACT_OBJECT_LIST:"artifact-object-list",HOME_PAGE_STATE:"home-page-state",INTER_PAGE_MANAGER:"inter-page-manager"};let ct={consts:{DB_NAME:"E7ArenaStatsClientDB",DB_VERSION:1,STORE_NAME:"DataStore",META_STORE_NAME:"MetaStore",CACHE_TIMEOUT:1728e5},Keys:{...st},MetaKeys:{TIMESTAMP:"timestamp"},loaded_UM:new Set,openDB:async()=>function(t,e,{blocked:n,upgrade:r,blocking:a,terminated:o}={}){const i=indexedDB.open(t,e),s=l(i);return r&&i.addEventListener("upgradeneeded",t=>{r(l(i.result),t.oldVersion,t.newVersion,l(i.transaction),t)}),n&&i.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),s.then(t=>{o&&t.addEventListener("close",()=>o()),a&&t.addEventListener("versionchange",t=>a(t.oldVersion,t.newVersion,t))}).catch(()=>{}),s}(ct.consts.DB_NAME,ct.consts.DB_VERSION,{upgrade(t){t.objectStoreNames.contains(ct.consts.STORE_NAME)&&t.deleteObjectStore(ct.consts.STORE_NAME),t.objectStoreNames.contains(ct.consts.STORE_NAME)||t.createObjectStore(ct.consts.STORE_NAME),t.objectStoreNames.contains(ct.consts.META_STORE_NAME)||t.createObjectStore(ct.consts.META_STORE_NAME)}}),get:async function(t){const e=await this.openDB(),n=await e.get(this.consts.STORE_NAME,t);if(null===n)return null;return await this.checkCacheTimeout(t)?n:null},cache:async function(t,e){const n=await this.openDB();await n.put(this.consts.STORE_NAME,e,t),await this.setTimestamp(t,Date.now())},delete:async function(t){const e=await this.openDB();await e.delete(this.consts.STORE_NAME,t),await this.deleteTimestamp(t)},deleteDB:async function(){await indexedDB.deleteDatabase(this.consts.DB_NAME)},getTimestamp:async function(t){const e=await this.openDB(),n=`${t+this.MetaKeys.TIMESTAMP}`;return await e.get(this.consts.META_STORE_NAME,n)??0},setTimestamp:async function(t,e){const n=await this.openDB(),r=`${t+this.MetaKeys.TIMESTAMP}`;await n.put(this.consts.META_STORE_NAME,e,r),await n.get(this.consts.META_STORE_NAME,r)},deleteTimestamp:async function(t){const e=await this.openDB(),n=`${t+this.MetaKeys.TIMESTAMP}`;await e.delete(this.consts.META_STORE_NAME,n)},clearData:async function(){const t=await this.openDB();await at(t,this.consts.STORE_NAME),await at(t,this.consts.META_STORE_NAME)},clearUserData:async function(){const t=Object.values(ot);await Promise.all(t.map(t=>this.delete(t)))},clearUserLists:async function(){const t=Object.values(it);await Promise.all(t.map(t=>this.delete(t)))},clearSeasonData:async function(){await this.delete(st.SEASON_DETAILS)},checkCacheTimeout:async function(t){const e=await this.getTimestamp(t),n=Date.now();return!(!e||n-e>ct.consts.CACHE_TIMEOUT)||(await this.delete(t),!1)},getFilterStr:async function(){return await this.get(ct.Keys.FILTER_STR)},setFilterStr:async function(t){await this.cache(ct.Keys.FILTER_STR,t)},getLang:async function(){return await this.get(ct.Keys.LANG)??b.EN},setLang:async function(t){await this.cache(ct.Keys.LANG,t)},getStats:async function(){return await this.get(ct.Keys.STATS)},setStats:async function(t){await this.cache(st.STATS,t)}};const ut=ct,lt={unwrapHtmlElt:function(t){const e=document.getElementById(t);if(null===e)throw new Error(`Could not find element with ID ${t}`);return e},setText:function(t,e){this.unwrapHtmlElt(t).textContent=e}};class ft{_SELECT_DATA_MSG=null;_FILTER_MSG=null;_SELECT_DATA_BODY=null;_SHOW_STATS_BODY=null;_LOAD_DATA_BODY=null;_LATEST_BATTLES_BTN=null;_UPLOAD_FORM=null;_CSV_FILE=null;_USER_QUERY_FORM_NAME=null;_USER_QUERY_FORM_SERVER=null;_AUTO_ZOOM_FLAG=null;_FOOTER=null;_USER_NAME=null;_USER_ID=null;_USER_SERVER=null;_BATTLE_FILTER_TOGGLER=null;_ID_SEARCH_FLAG=null;_SEASON_DETAILS_TBL=null;_PERFORMANCE_STATS_TBL=null;_FIRST_PICK_STATS_TBL=null;_PREBAN_STATS_TBL=null;_PLAYER_TBL=null;_OPPONENT_TBL=null;_BATTLE_TBL=null;_RANK_PLOT=null;get SELECT_DATA_MSG(){return this._SELECT_DATA_MSG||=lt.unwrapHtmlElt("select-data-msg")}get FILTER_MSG(){return this._FILTER_MSG||=lt.unwrapHtmlElt("filterMSG")}get SELECT_DATA_BODY(){return this._SELECT_DATA_BODY||=lt.unwrapHtmlElt("select-data-body")}get SHOW_STATS_BODY(){return this._SHOW_STATS_BODY||=lt.unwrapHtmlElt("show-stats-body")}get LOAD_DATA_BODY(){return this._LOAD_DATA_BODY||=lt.unwrapHtmlElt("load-data-body")}get LATEST_BATTLES_BTN(){return this._LATEST_BATTLES_BTN||=lt.unwrapHtmlElt("latest-battles-btn")}get UPLOAD_FORM(){return this._UPLOAD_FORM||=lt.unwrapHtmlElt("uploadForm")}get CSV_FILE(){return this._CSV_FILE||=lt.unwrapHtmlElt("csvFile")}get USER_QUERY_FORM_NAME(){return this._USER_QUERY_FORM_NAME||=lt.unwrapHtmlElt("user-query-form-name")}get USER_QUERY_FORM_SERVER(){return this._USER_QUERY_FORM_SERVER||=lt.unwrapHtmlElt("user-query-form-server")}get AUTO_ZOOM_FLAG(){return this._AUTO_ZOOM_FLAG||=lt.unwrapHtmlElt("auto-zoom-flag")}get FOOTER_BODY(){return this._FOOTER||=lt.unwrapHtmlElt("footer-body")}get USER_NAME(){return this._USER_NAME||=lt.unwrapHtmlElt("user-name")}get USER_ID(){return this._USER_ID||=lt.unwrapHtmlElt("user-id")}get USER_SERVER(){return this._USER_SERVER||=lt.unwrapHtmlElt("user-server")}get BATTLE_FILTER_TOGGLE(){return this._BATTLE_FILTER_TOGGLER||=lt.unwrapHtmlElt("filter-battle-table")}get ID_SEARCH_FLAG(){return this._ID_SEARCH_FLAG||=lt.unwrapHtmlElt("id-search-flag")}get SEASON_DETAILS_TBL(){return this._SEASON_DETAILS_TBL||=lt.unwrapHtmlElt("season-details-tbl")}get PERFORMANCE_STATS_TBL(){return this._PERFORMANCE_STATS_TBL||=lt.unwrapHtmlElt("performance-stats-tbl")}get FIRST_PICK_STATS_TBL(){return this._FIRST_PICK_STATS_TBL||=lt.unwrapHtmlElt("first-pick-stats-tbl")}get PREBAN_STATS_TBL(){return this._PREBAN_STATS_TBL||=lt.unwrapHtmlElt("preban-stats-tbl")}get PLAYER_TBL(){return this._PLAYER_TBL||=lt.unwrapHtmlElt("player-tbl")}get OPPONENT_TBL(){return this._OPPONENT_TBL||=lt.unwrapHtmlElt("opponent-tbl")}get BATTLES_TBL(){return this._BATTLE_TBL||=lt.unwrapHtmlElt("battles-tbl")}get RANK_PLOT(){return this._RANK_PLOT||=lt.unwrapHtmlElt("rank-plot")}get MESSAGE_ELEMENTS_LIST(){return[this.SELECT_DATA_MSG,this.FILTER_MSG]}}class pt{_SIDEBAR_HIDE_BTN=null;get SIDEBAR_HIDE_BTN(){return this._SIDEBAR_HIDE_BTN||=lt.unwrapHtmlElt("sidebar-hide")}_CLEAR_DATA_BTN=null;get CLEAR_DATA_BTN(){return this._CLEAR_DATA_BTN||=lt.unwrapHtmlElt("clear-data-btn")}_EXPORT_CSV_BTN=null;get EXPORT_DATA_BTN(){return this._EXPORT_CSV_BTN||=lt.unwrapHtmlElt("export-data-btn")}_OFFICIAL_SITE_BTN=null;get OFFICIAL_SITE_BTN(){return this._OFFICIAL_SITE_BTN||=lt.unwrapHtmlElt("official-site-btn")}_USER_NAME=null;get USER_NAME(){return this._USER_NAME||=lt.unwrapHtmlElt("user-name")}_USER_ID=null;get USER_ID(){return this._USER_ID||=lt.unwrapHtmlElt("user-id")}_USER_SERVER=null;get USER_SERVER(){return this._USER_SERVER||=lt.unwrapHtmlElt("user-server")}_SIDEBAR_CONTROL=null;get SIDEBAR_CONTROL(){return this._SIDEBAR_CONTROL||=lt.unwrapHtmlElt("sidebar-control")}}class dt{_SEARCH_DOMAINS=null;get SEARCH_DOMAINS(){return this._SEARCH_DOMAINS||=lt.unwrapHtmlElt("search-domains")}_SEARCH_SUBMIT_BTN=null;get SEARCH_SUBMIT_BTN(){return this._SEARCH_SUBMIT_BTN||=lt.unwrapHtmlElt("search-submit-btn")}_SEARCH_FORM=null;get SEARCH_FORM(){return this._SEARCH_FORM||=lt.unwrapHtmlElt("searchForm")}_SEARCH_TABLE_CONTAINER=null;get SEARCH_TABLE_CONTAINER(){return this._SEARCH_TABLE_CONTAINER||=lt.unwrapHtmlElt("search-table-container")}}class Et{_FILTER_SYNTAX_RULES_CONTAINER=null;get FILTER_SYNTAX_RULES_CONTAINER(){return this._FILTER_SYNTAX_RULES_CONTAINER||=lt.unwrapHtmlElt("filter-syntax-rules-container")}_ALL_CONTENT_CONTAINER=null;get ALL_CONTENT_CONTAINER(){return this._ALL_CONTENT_CONTAINER||=lt.unwrapHtmlElt("all-content-container")}}const _t=new class{HOME_PAGE;NAV_BAR;SEARCH_PAGE;FILTER_SYNTAX_PAGE;_BODY_FOOTER_CONTAINER=null;constructor(){this.HOME_PAGE=new ft,this.NAV_BAR=new pt,this.SEARCH_PAGE=new dt,this.FILTER_SYNTAX_PAGE=new Et}get BODY_FOOTER_CONTAINER(){return this._BODY_FOOTER_CONTAINER??=lt.unwrapHtmlElt("body-footer-container")}};function ht(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return St(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(St(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,St(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,St(f,"constructor",u),St(u,"constructor",c),c.displayName="GeneratorFunction",St(u,a,"GeneratorFunction"),St(f),St(f,a,"Generator"),St(f,r,function(){return this}),St(f,"toString",function(){return"[object Generator]"}),(ht=function(){return{w:o,m:p}})()}function St(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}St=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){St(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},St(t,e,n,r)}function mt(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function Tt(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){mt(o,r,a,i,s,"next",t)}function s(t){mt(o,r,a,i,s,"throw",t)}i(void 0)})}}var yt,gt,At,vt,wt,bt;const Ot={test:function(t){t.rank_plot},fetchFromPython:(bt=Tt(ht().m(function t(e){var n,r;return ht().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch(e);case 1:if((n=t.v).ok){t.n=3;break}return t.n=2,fetch(e);case 2:n=t.v;case 3:return t.n=4,n.json();case 4:return r=t.v,t.a(2,r||null)}},t)})),function(t){return bt.apply(this,arguments)}),fetchHeroData:(wt=Tt(ht().m(function t(){return ht().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.fetchFromPython("/api/get_hero_data");case 1:return t.a(2,t.v)}},t,this)})),function(){return wt.apply(this,arguments)}),rsFetchBattleData:(vt=Tt(ht().m(function t(e){return ht().w(function(t){for(;;)switch(t.n){case 0:if(e){t.n=1;break}throw new Error("Must pass user to fetch battles data");case 1:return t.n=2,fetch("/api/rs_get_battle_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e})});case 2:return t.a(2,t.v)}},t)})),function(t){return vt.apply(this,arguments)}),fetchSeasonDetails:(At=Tt(ht().m(function t(){var e,n,r;return ht().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("/api/get_season_details");case 1:return e=t.v,t.n=2,e.json();case 2:if(!(n=t.v).success){t.n=3;break}return r=JSON.parse(n.seasonDetails),t.a(2,{seasonDetails:r,error:!1});case 3:return t.a(2,{seasonDetails:null,error:n.error});case 4:return t.a(2)}},t)})),function(){return At.apply(this,arguments)}),fetchArtifactJson:(gt=Tt(ht().m(function t(){var e,n,r;return ht().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("/api/get_artifact_json");case 1:return e=t.v,t.n=2,e.json();case 2:if(!(n=t.v).success){t.n=3;break}return r=JSON.parse(n.artifactJson),t.a(2,r);case 3:return t.a(2,null);case 4:return t.a(2)}},t)})),function(){return gt.apply(this,arguments)}),fetchUser:(yt=Tt(ht().m(function t(e){var n,r,a;return ht().w(function(t){for(;;)switch(t.n){case 0:if(e.name&&e.world_code||e.id){t.n=1;break}throw new Error("Must pass a user object with either user.name and user.world_code or user.id to fetch user");case 1:return t.n=2,fetch("/api/get_user_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userData:e})});case 2:return n=t.v,t.n=3,n.json();case 3:if(r=t.v,n.ok){t.n=4;break}throw new Error("Flask server error: ".concat(r.error));case 4:if(r.foundUser){t.n=6;break}if(e.world_code){t.n=5;break}return t.a(2,{user:null,ok:!0});case 5:return t.a(2,{user:null,ok:!0});case 6:return a=r.user,"Found user: ".concat(JSON.stringify(a)),t.a(2,{user:a,ok:!0})}},t)})),function(t){return yt.apply(this,arguments)})};async function Rt(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error: status: ${e.status}`);const n=await e.json();return Object.keys(n),n}catch(t){return console.error("Error fetching global user data:",t),null}}const Pt={fetchHeroJSON:async function(t=null){let e=await Rt("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_hero.json");return e?(t&&e[t]?e=e[t]:t&&!e[t]&&(console.error("Could not find hero data for language:",t),e=null),e):null},fetchUserJSON:async function(t){if(t=t.replace("world_",""),![...O].some(e=>e.replace("world_","")===t))return console.error(`Could not find world code: ${t}`),null;const e=`https://static.smilegatemegaport.com/gameRecord/epic7/epic7_user_world_${t}.json`,n=await Rt(e);return n&&"object"==typeof n&&"users"in n&&Array.isArray(n.users)&&n.users.length,n},fetchArtifactJSON:async function(t=null){let e=await Rt("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_artifact.json"),n=null;if(e&&t&&"object"==typeof e&&t in e){let n=e;if(Array.isArray(n[t]))return n[t]}return n},fetchInfo:async function(t,e,n="en"){const r=new URLSearchParams({nick_no:t,world_code:e,lang:n});try{const t=await fetch("https://epic7.onstove.com/gg/gameApi/getUserInfo",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()});if(!t.ok)return console.error("Error fetching battle list:",t.status,t.statusText),null;return await t.json()}catch(t){return console.error("Request failed:",t),null}}},Lt="~Fodder",Nt="~Empty";const It={getHeroDicts:async function(t=b.EN){const e=await ut.get(ut.Keys.HERO_MANAGER);return e||this.fetchAndCacheHeroManager(t)},createHeroManager:function(t){for(let[e,n]of t.entries()){const t=rt[e];n.prime=t}let e={heroes:[],Empty:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A",prime:1},Fodder:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A",prime:1},name_lookup:{},code_lookup:{},prime_lookup:{},prime_pair_lookup:{}};return e.heroes=t,e=function(t){const e=t.heroes.length,n={attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:Nt,prime:1},r={attribute_cd:"N/A",code:"N/A",grade:"2/3",job_cd:"N/A",name:Lt,prime:rt[e]};return t.heroes.push(n),t.heroes.push(r),t.Fodder=r,t.Empty=n,t}(e),e=function(t){t.name_lookup=t.heroes.reduce((t,e)=>(t[e.name.toLowerCase().replace(/\s+/g,"")]=e,t),{}),t.prime_lookup=t.heroes.reduce((t,e)=>(t[e.prime]=e,t),{}),t.code_lookup=t.heroes.reduce((t,e)=>(t[e.code]=e,t),{});let e=t.heroes.reduce((t,e)=>(t[e.prime]=e.name,t),{});const n=Object.keys(t.prime_lookup).length-1;for(let r=0;r<n-1;r++){const a=rt[r];for(let o=r+1;o<n;o++){const n=rt[o],r=a*n,i=t.prime_lookup[a].name,s=t.prime_lookup[n].name;e[r]=[i,s].sort().join(", ")}}return e[t.Fodder.prime*t.Fodder.prime]=[t.Fodder.name,t.Fodder.name].join(", "),t.prime_pair_lookup=e,t}(e),e},fetchHeroManager:async function(t=b.EN){const e=(await Pt.fetchHeroJSON()??await Ot.fetchHeroData())[t];return this.createHeroManager(e)},fetchAndCacheHeroManager:async function(t=b.EN){const e=await this.fetchHeroManager(t);return await ut.cache(ut.Keys.HERO_MANAGER,e),e},deleteHeroManager:async function(){await ut.delete(ut.Keys.HERO_MANAGER)},getHeroByName:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");if(!t)return e.Empty;const n=t.toLowerCase().replace(/\s+/g,"");return e.name_lookup[n]??null},getHeroByPrime:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");return e.prime_lookup[t]},getHeroByCode:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");return t?e.code_lookup[t]??null:e.Empty},getPairNamesByProduct:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");return e.prime_pair_lookup[t]},EMPTY_NAME:Nt,FODDER_NAME:Lt};const Ct={async getArtifactCodeToNameMap(){let t=await ut.get(ut.Keys.ARTIFACTS);return t||(t=await this.fetchAndCacheArtifacts()),t},getArtifactLowercaseNameMap:async function(){let t=await ut.get(ut.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP);if(null!==t)return t;const e=await this.getArtifactCodeToNameMap();return t=Object.fromEntries(Object.values(e).filter(t=>null!==t).map(t=>[t.toLowerCase(),t])),await ut.cache(ut.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP,t),t},getArtifactObjectList:async function(){let t=await ut.get(ut.Keys.ARTIFACT_OBJECT_LIST);if(null!==t)return t;const e=await this.getArtifactCodeToNameMap();return t=Object.entries(e).map(([t,e])=>({id:t,name:e})),await ut.cache(ut.Keys.ARTIFACT_OBJECT_LIST,t),t},fetchAndCacheArtifacts:async function(){const t=await async function(){let t=await Pt.fetchArtifactJSON("en");return null===t&&(t=await Ot.fetchArtifactJson()),null===t?(console.error("Could not get artifact Json map from E7 server or flask server"),null):Object.fromEntries(t.filter(t=>null!==t.name).map(t=>[t.code,t.name]))}();return null===t?{}:(await ut.cache(ut.Keys.ARTIFACTS,t),t)},clearArtifactData:async function(){await ut.delete(ut.Keys.ARTIFACTS)},convertCodeToName:function(t,e){return e[t]||t}},Dt={date:t=>t[B.DATE_TIME]?new Date(`${t[B.DATE_TIME].slice(0,10)}T00:00:00`):"N/A",season:t=>t[B.SEASON_CODE],"is-first-pick":t=>!!t[B.FIRST_PICK],"is-win":t=>!!t[B.WIN],"victory-points":t=>t[B.P1_POINTS],"p1.picks":t=>t[B.P1_PICKS],"p2.picks":t=>t[B.P2_PICKS],"p1.prebans":t=>t[B.P1_PREBANS],"p2.prebans":t=>t[B.P2_PREBANS],"p1.postban":t=>t[B.P1_POSTBAN],"p2.postban":t=>t[B.P2_POSTBAN],prebans:t=>[...t[B.P1_PREBANS],...t[B.P2_PREBANS]],"p1.pick1":t=>t[B.P1_PICKS][0],"p1.pick2":t=>t[B.P1_PICKS][1],"p1.pick3":t=>t[B.P1_PICKS][2],"p1.pick4":t=>t[B.P1_PICKS][3],"p1.pick5":t=>t[B.P1_PICKS][4],"p2.pick1":t=>t[B.P2_PICKS][0],"p2.pick2":t=>t[B.P2_PICKS][1],"p2.pick3":t=>t[B.P2_PICKS][2],"p2.pick4":t=>t[B.P2_PICKS][3],"p2.pick5":t=>t[B.P2_PICKS][4],"p1.league":t=>t[B.P1_LEAGUE],"p2.league":t=>t[B.P2_LEAGUE],"p1.server":t=>t[B.P1_SERVER],"p2.server":t=>t[B.P2_SERVER],"p1.id":t=>Number(t[B.P1_ID]),"p2.id":t=>Number(t[B.P2_ID]),"p1.mvp":t=>t[B.P1_MVP],"p2.mvp":t=>t[B.P2_MVP],"is-first-turn":t=>!!t[B.FIRST_TURN],"first-turn-hero":t=>t[B.FIRST_TURN_HERO],turns:t=>t[B.TURNS],seconds:t=>t[B.SECONDS],"point-gain":t=>t[B.POINT_GAIN]};function Mt(t,e="i"){return new RegExp(`^(?:${t.source})(?=[,)\\s;]|$)`,e)}function Ft(t,e="i"){return new RegExp(`^(?:${t.source})$`,e)}function kt(t,e="i"){if(t.length<1)throw new Error("orRegex must have at least one pattern");let n=`(?:${t[0].source})`;for(let e=1;e<t.length;e++)n+=`|(?:${t[e].source})`;return new RegExp(n,e)}const Ut=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Bt=Object.keys(Dt),jt=new RegExp(`^(?:${Bt.map(Ut).join("|")})`,"i"),xt=new RegExp(`(?:${["and","or","xor","not"].map(Ut).join("|")})(?=\\()`,"i"),Gt=new RegExp(`(?:${["last-n"].map(Ut).join("|")})(?=\\()`,"i"),Ht=new RegExp(`(?:${["p1.equipment","p2.equipment","p1.artifact","p2.artifact","p1.cr","p2.cr"].map(Ut).join("|")})(?=\\()`,"i"),$t=kt([xt,Gt,Ht]),Kt=/.*/i,Yt=/\d{4}-\d{2}-\d{2}/,Vt=/\{\s*\}/,Wt=/-?\d+/,qt=/season-[1-9]+[0-9]*f?|current-season|last-season/i,zt=/pvp_rta_ss[1-9]+[0-9]*f?/i,Qt=new RegExp(`^${Yt.source}$`,"i"),Jt=new RegExp(`(?:${qt.source})`,"i"),Xt=Kt.source,Zt=Wt.source,te=Yt.source,ee=jt.source,ne=Jt.source,re=new RegExp(`(["'])(${Xt})\\1`,"i"),ae=Ft(re),oe=re.source,ie=new RegExp(`(?:${oe}|${Xt}|${te})`,"i"),se=new RegExp(`(?:${ee}|${ne})`,"i"),ce=ie.source,ue=new RegExp(`\\{\\s*(?:${ce}\\s*)(?:,\\s*${ce}\\s*)*,?\\s*\\}|${Vt.source}`,"i"),le=new RegExp(`${Zt}\\.\\.\\.=?${Zt}|${te}\\.\\.\\.=?${te}`),fe=new RegExp(`^${le.source}$`);let pe={STRING_RE:Kt,DATE_RE:Yt,INT_RE:Wt,EMPTY_SET_RE:Vt,SET_ELEMENT_RE:ie,SET_RE:ue,SET_LITERAL_RE:Ft(ue),STRING_LITERAL_RE:ae,DATE_LITERAL_RE:Qt,INT_LITERAL_RE:/^-?\d+$/,BOOL_LITERAL_RE:/^(true|false)$/i,RANGE_RE:le,RANGE_LITERAL_RE:fe,SEASON_RE:qt,SEASON_LITERAL_RE:Ft(qt),SEASON_CODE_RE:zt,SEASON_CODE_LITERAL_RE:Ft(zt),DATA_WORD_RE:Jt,DATA_WORD_LITERAL_RE:Ft(Jt),FIELD_WORD_RE:jt,FIELD_WORD_LITERAL_RE:Ft(jt),DATAFIELD_RE:se,GLOBAL_FILTER_RE:/last-n\(\d+\)/i,ANCHORED_STR_LITERAL_RE:Ft(ae),CLAUSE_FUNCTIONS_RE:xt,DIRECT_FUNCTIONS_RE:Ht,GLOBAL_FUNCTIONS_RE:Gt,FUNCTIONS_RE:$t,FUNCTION_CALL_RE:/\(.*\)/i,padRegex:Mt,anchorExp:Ft,tokenMatch:function(t){return t.match($t)?"keyword":t.match(/\s+(?:!=|<|>|=|>=|<=|in|!in)(?=\s+)/i)?"operator":t.match(new RegExp(`[a-z0-9."'}=)-]${se.source}(?=[,)\\s;]|$)`,"i"))?null:t.match(Mt(jt))?"field":t.match(Mt(Jt))?"declared-data":t.match(Mt(re))?"string":t.match(Mt(ue))?"set":t.match(Mt(le))?"range":t.match(/[^(,\s;.=0-9\-]+\d+/i)?null:t.match(Mt(Wt))||t.match(Mt(Yt))||t.match(/(?:^|\s)(?:true|false)(?=[,)\s;]|$)/i)?"declared-data":t.match(/[\(\)\{\}\;\,]/)?"bracket":(t.next(),null)},orRegex:kt,escapeRegex:Ut};function de(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ee(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ee(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Ee(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Ee(f,"constructor",u),Ee(u,"constructor",c),c.displayName="GeneratorFunction",Ee(u,a,"GeneratorFunction"),Ee(f),Ee(f,a,"Generator"),Ee(f,r,function(){return this}),Ee(f,"toString",function(){return"[object Generator]"}),(de=function(){return{w:o,m:p}})()}function Ee(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}Ee=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){Ee(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},Ee(t,e,n,r)}function _e(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function he(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){_e(o,r,a,i,s,"next",t)}function s(t){_e(o,r,a,i,s,"throw",t)}i(void 0)})}}var Se,me,Te,ye={fetchAndCacheSeasonDetails:(Te=he(de().m(function t(){var e,n,r,a,o,i,s;return de().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Ot.fetchSeasonDetails();case 1:if(!(e=t.v).error){t.n=2;break}throw new Error("Could not fetch season details: ".concat(e.error));case 2:return(n=e.seasonDetails).forEach(function(t){t.range=[t.Start,t.End].map(function(t){return new Date("".concat(t.split(" ")[0],"T00:00:00"))}),t["Season Number"]=String(t["Season Number"])}),n.sort(function(t,e){return parseInt(t["Season Number"])-parseInt(e["Season Number"])}),r=[n[0]],a=n[0],n.slice(1).forEach(function(t){var e=new Date(+a.range[1]+F),n=new Date(+t.range[0]-F),o=a["Season Number"]+"f",i={"Season Number":o,Code:"pvp_rta_ss"+o,Season:"Pre ".concat(t.Season),Start:e.toISOString().slice(0,10),End:n.toISOString().slice(0,10),Status:"Complete",range:[e,n]};r.push(i),r.push(t),a=t}),a.range[1]<new Date&&(o=new Date(+r.at(-1).range[1]+F),i=a["Season Number"]+"f",s={"Season Number":i,Code:"pvp_rta_ss"+i,Season:"Active Pre-Season",Start:o.toISOString().slice(0,10),End:"N/A",Status:"Active",range:[o,new Date]},r.push(s)),r.reverse(),t.n=3,ut.cache(ut.Keys.SEASON_DETAILS,r);case 3:return t.a(2,r)}},t)})),function(){return Te.apply(this,arguments)}),getSeasonDetails:(me=he(de().m(function t(){var e,n;return de().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ut.get(ut.Keys.SEASON_DETAILS);case 1:if(null==(e=t.v)){t.n=2;break}n=e,t.n=4;break;case 2:return t.n=3,ye.fetchAndCacheSeasonDetails();case 3:n=t.v;case 4:return t.a(2,n)}},t)})),function(){return me.apply(this,arguments)}),clearSeasonDetails:(Se=he(de().m(function t(){return de().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ut.delete(ut.Keys.SEASON_DETAILS);case 1:case 2:return t.a(2)}},t)})),function(){return Se.apply(this,arguments)}),getSeasonNumFromCode:function(t){return t.split("_")[-1]}};const ge=ye;class Ae extends Error{constructor(t){super(t),this.name="Filter Syntax Exception"}}class ve extends Error{constructor(t){super(t),this.name="Filter Type Exception"}}class we extends Error{constructor(t){super(t),this.name="Filter Validation Error"}}const be={"(":")","{":"}",'"':'"',"'":"'"},Oe={"'":'"','"':"'"},Re=Object.fromEntries(Object.entries(be).filter(([t,e])=>t!==e).map(([t,e])=>[e,t]));function Pe(t){const e={};for(const n of t)e[n]=(e[n]||0)+1;return e}const Le={SyntaxException:Ae,TypeException:ve,ValidationError:we,getCharCounts:Pe,tokenizeWithNestedEnclosures:function(t,e=" ",n=0,r=!0){const a=[];let o="",i=[];for(let s=0;s<t.length;s++){const c=t[s];if(e.includes(c)&&i.length===n)o&&(a.push(r?o.trim():o),o="");else if(Re[c]){const e=Re[c];if(i.length>n&&(o+=c),i[i.length-1]!==e){const e=Pe(t);throw(e["'"]||0)%2!=0||(e['"']||0)%2!=0?new Ae(`Error tokenizing: Unbalanced closing character at position ${s}; got string: '${t}' ; if a str type has quote characters in it, wrap it in the opposite quote character.`):new Ae(`Error tokenizing: Unbalanced closing character at position ${s}; got string: '${t}'`)}i.pop()}else i.length>=n&&(o+=c),!be[c]||Oe[c]&&i[i.length-1]===Oe[c]||(i[i.length-1]===be[c]&&c===be[c]?i.pop():i.push(c))}if(i.length>0)throw new Error(`Unbalanced enclosures in input string; unresolved characters from enclosure stack: [ ${i.join(", ")} ]`);return o&&a.push(r?o.trim():o),a},parseDate:function(t){if(!pe.DATE_LITERAL_RE.test(t))throw new Ae(`Invalid date; must be in the format: YYYY-MM-DD ( regex: ${pe.DATE_LITERAL_RE.source} ); got: '${t}'`);const e=t.split(" ")[0],n=new Date(`${e}T00:00:00`);if(isNaN(n.getTime()))throw new Ae(`Invalid date; could not be parsed as a valid date; got: '${t}'`);const r=n.toISOString().split("T")[0],[a,o,i]=r.split("-").map(Number);if(n.getFullYear()!==a||n.getMonth()+1!==o||n.getDate()!==i)throw new Ae(`Invalid date; parsed date: ${n.toISOString()} does not match passed in string: ${e}`);return n.toISOString(),n.constructor.name,n},tryConvert:function(t,e,n,r=null){null===r&&(r=`Could not convert ${n} to ${e}`);try{return t(n)}catch(t){throw new ve(`${r}: ${t.message}`)}},trimSurroundingQuotes:function(t){return t.replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}},Ne=new Set("'\"(),_-.=; ><!1234567890{}~abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),Ie=Object.fromEntries(Object.values(M).map(t=>[t.toLowerCase(),t]));class Ce{}const De={Hero:new class extends Ce{parse(t,e){return It.getHeroByName(t,e.HeroDicts)?.name??null}parserType="Hero"},League:new class extends Ce{parse(t){return U[t]}parserType="League"},Server:new class extends Ce{parse(t){return D[t]}parserType="Server"},Equipment:new class extends Ce{parse(t){return Ie[t.toLowerCase()]}parserType="Equipment"},Artifact:new class extends Ce{parse(t,e){return e.ARTIFACT_LOWERCASE_STRINGS_MAP[t.toLowerCase()]}parserType="Artifact"},Season:new class extends Ce{parse(t,e){let n;if("current-season"===t)return e.SEASON_DETAILS[0].Code;if("last-season"===t)return e.SEASON_DETAILS[1].Code;if(pe.SEASON_LITERAL_RE.test(t))n=t.split("-").at(-1);else{if(!pe.SEASON_CODE_LITERAL_RE.test(t))return null;n=t.split("_ss").at(-1)}e.SEASON_DETAILS.map(t=>t.Code.split("_").at(-1));return e.SEASON_DETAILS.find(t=>t.Code.split("_ss").at(-1)===n)?.Code}parserType="Season Code"}},Me=new Set(["p1.picks","p2.picks","p1.prebans","p2.prebans","prebans"]),Fe={FIELD:"FIELD",RANGE:"RANGE",SET:"SET",INT:"INT",DATE:"DATE",BOOL:"BOOL",STRING:"STRING"};class ke{}class Ue extends ke{type=Fe.FIELD;rawString;extractFn;constructor(t){if(super(),this.rawString=t,!Dt[t])throw new Error("Invalid field");this.extractFn=Dt[t]}getData(){throw new Error("Not implemented for Field")}extractData(t){return this.extractFn(t)}asString(){return`${this.rawString}`}}class Be extends ke{rawString;constructor(t){super(),this.rawString=t}getData(){return this.data}extractData(t){throw new Error("Not implemented for Literals")}asString(){return`${this.fmtString}`}}class je extends Be{type=Fe.STRING;fmtString;data;constructor(t,e,n=Object.values(De)){super(t),t=Le.trimSurroundingQuotes(t),this.data=this.processString(t,e,n),this.fmtString=this.data}processString(t,e,n){const r=function(t,e,n){for(const r of n){const n=r.parse(t,e);if(r.parserType,n)return n}return null}(t,e,n);if(!r){const e=n.map(t=>t.parserType).join(", ");throw new Le.ValidationError(`Invalid string literal: '${t}' ; could not be parsed as a valid instance of any of the following: [${e}]`)}return r}}class xe extends Be{type=Fe.INT;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){const e=parseInt(t);if(isNaN(e))throw new Le.ValidationError(`Invalid integer literal: '${t}'`);return e}}class Ge extends Be{type=Fe.BOOL;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){if("true"===t)return!0;if("false"===t)return!1;throw new Le.ValidationError(`Invalid boolean literal: '${t}'`)}}class He extends Be{type=Fe.DATE;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){return Le.parseDate(t)}}class $e{start;end;endInclusive;constructor(t,e,n){this.start=t,this.end=e,this.endInclusive=n}has(t){return typeof t==typeof this.start&&(!(t<this.start)&&(!(t>this.end)&&(t!==this.end||this.endInclusive)))}includes(t){return this.has(t)}}const Ke=[t=>pe.DATE_LITERAL_RE.test(t)?new He(t):null,t=>pe.INT_LITERAL_RE.test(t)?new xe(t):null];function Ye(t,e,n,r){let a=r(t),o=r(e);return null===a||null===o?null:new $e(a.data,o.data,n)}class Ve extends Be{type=Fe.RANGE;fmtString;data;constructor(t,e){super(t),this.fmtString=t,this.data=this.processString(t,e)}processString(t,e){const n=t.split("..."),r=n[0];let a="="===n[1].charAt(0);const o=n[1].slice(a?1:0);for(const t of Ke){const e=Ye(r,o,a,t);if(null!==e)return e}throw new Le.ValidationError(`Invalid range literal: '${t}' ; ranges must be homogenous and of the format x...y or x...=y for the types: [Date, Integer]`)}}const We=[...Ke],qe=(t,e,n)=>pe.STRING_RE.test(t)?new je(t,e,n):null;class ze extends Be{type=Fe.SET;fmtString;data;constructor(t,e,n=Object.values(De)){super(t),this.fmtString=t,this.data=this.processString(t,e,n)}processString(t,e,n){let r=Le.tokenizeWithNestedEnclosures(t,",",1,!0);r=r.filter(t=>""!==t);const a=new Set;for(const o of r){let r=null;for(const t of We)if(r=t(o),r){a.add(r.data);break}if(!r){if(r=qe(o,e,n),!r)throw new Le.ValidationError(`Invalid set element: '${t}' ; could not be parsed as a valid instance of any of the following types: [Date, Integer, String]`);a.add(r.data)}}return this.fmtString=`{${Array.from(a).join(", ")}}`,a}}const Qe={StringLiteral:je,IntLiteral:xe,BoolLiteral:Ge,DateLiteral:He,RangeLiteral:Ve,SetLiteral:ze,Field:Ue,BaseEltTypes:Fe,FIELD_EXTRACT_FN_MAP:Dt,parseBaseElement:function(t,e){if(pe.STRING_LITERAL_RE.test(t))return new je(t,e);if(pe.INT_LITERAL_RE.test(t))return new xe(t);if(pe.BOOL_LITERAL_RE.test(t))return new Ge(t);if(pe.DATE_LITERAL_RE.test(t))return new He(t);if(pe.RANGE_LITERAL_RE.test(t))return new Ve(t,e);if(pe.SET_LITERAL_RE.test(t))return new ze(t,e);if(pe.SEASON_LITERAL_RE.test(t))return new je(t,e,[De.Season]);if(pe.FIELD_WORD_LITERAL_RE.test(t))return new Ue(t);throw new Le.ValidationError(`Invalid base element: '${t}' ; could not be parsed as a Field or Literal.`)},COLLECTION_FIELDS_SET:Me};const Je={">":(t,e)=>t>e,"<":(t,e)=>t<e,"=":(t,e)=>t===e,">=":(t,e)=>t>=e,"<=":(t,e)=>t<=e,"!=":(t,e)=>t!==e},Xe="in",Ze="compare";class tn{}class en extends tn{type=Xe;opStr;negate=!1;constructor(t=!1){super(),this.negate=t,this.opStr=this.negate?"!in":"in"}call(t,e){const n=Array.isArray(e)?e.includes(t):e.has(t);return this.negate?!n:n}}class nn extends tn{type=Ze;opStr;compareFn;constructor(t){if(super(),this.opStr=t,this.compareFn=Je[t],!this.compareFn)throw new Error(`Unknown operator: ${t}`)}call(t,e){return this.compareFn(t,e)}}function rn(t){switch(t){case"in":return new en;case"!in":return new en(!0);default:return new nn(t)}}const an="and",on="or",sn="xor",cn="not",un="last-n",ln="equipment",fn="artifact",pn="cr",dn="base-filter",En="CLAUSE_FN",_n="HERO_LIST_FN",hn="GLOBAL_FN",Sn="BASE_FILTER";class mn{}class Tn extends mn{}class yn extends Tn{fnType=En;fns=[];constructor(...t){super(),this.fns=t}asString(t=""){let e="";const n=t+"   ";return this.fns.forEach(t=>e+=`${t.asString(n)},\n`),`${t}${this.fnName}(\n${e.trimEnd()}\n${t})`}}class gn extends yn{fnName=an;fnType=En;call(t){return this.fns.every(e=>e.call(t))}}class An extends yn{fnName=on;fnType=En;call(t){return this.fns.some(e=>e.call(t))}}class vn extends yn{fnName=sn;fnType=En;call(t){let e=!1;for(let n of this.fns)e=!e&&n.call(t)||e&&!n.call(t);return e}}class wn extends yn{fnName=cn;fnType=En;constructor(...t){if(super(...t),1!==this.fns.length)throw new Le.SyntaxException(`Invalid NOT function call ; accepts exactly 1 argument ; got: [${this.fns}]`)}call(t){return!this.fns[0].call(t)}}class bn extends Tn{fnType=_n;getHeroes(t){return this.isPlayer1?t[B.P1_PICKS]:t[B.P2_PICKS]}asString(t=""){return`${t}${this.fnName}(${this.argFmtString})`}}class On extends bn{fnName=pn;fnType=_n;heroName;crThreshold=0;operator;targetField;isPlayer1=!1;argFmtString;constructor(t,e){super();const n=t.includes(",")?",":" ",r=Le.tokenizeWithNestedEnclosures(t,n,1,!0);if(3!==r.length)throw new Le.SyntaxException(`Invalid CR function call ; accepts exactly 3 arguments ; got: [${r}] from str: ${t}`);const a=parseInt(r[2]);if(isNaN(a))throw new Le.TypeException(`Invalid CR function call ; third argument must be a valid integer literal ; got: '${r[2]}' from str: ${t}`);const o=rn(r[1]);if(!(o instanceof nn))throw new Le.TypeException(`Invalid CR function call ; second argument must be a valid comparison operator ; got: '${r[1]}' from str: ${t}`);this.heroName=new Qe.StringLiteral(r[0],e,[De.Hero]).data,this.crThreshold=a,this.operator=o,this.isPlayer1=t.includes("p1."),this.targetField=t=>t[B.CR_BAR],this.argFmtString=`${this.heroName} ${this.operator.opStr} ${this.crThreshold}`}call(t){const e=this.getHeroes(t),n=this.targetField(t).find(t=>t[0]===this.heroName);return!!n&&(!!e.includes(this.heroName)&&this.operator.call(n,this.crThreshold))}}function Rn(t,e){for(const n in t)if(t[n]>(e[n]||0))return!1;return!0}class Pn extends bn{fnName=ln;fnType=_n;heroName;targetEquipCounts;isPlayer1=!1;argFmtString;targetField;constructor(t,e){super();const n=Le.tokenizeWithNestedEnclosures(t,",",1,!0);if(2!==n.length)throw new Le.SyntaxException(`Invalid equipment function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${t}`);const r=n[1].includes("{")?n[1]:`{${n[1]}}`;let a=Le.tokenizeWithNestedEnclosures(r,",",1,!0);a=a.map(t=>new Qe.StringLiteral(t,e,[De.Equipment]).data),this.targetEquipCounts=w(a),this.heroName=new Qe.StringLiteral(n[0],e,[De.Hero]).data,this.isPlayer1=t.includes("p1."),this.argFmtString=`${this.heroName}, {${a.join(",")}}`,this.targetField=t=>this.isPlayer1?t[B.P1_EQUIPMENT]:t[B.P2_EQUIPMENT]}call(t){const e=this.getHeroes(t),n=this.targetField(t);for(let t=0;t<e.length;t++)if(e[t]===this.heroName){const e=w(n[t]);return Rn(this.targetEquipCounts,e)}return!1}}class Ln extends bn{fnName=fn;fnType=_n;heroName;targetArtifacts;isPlayer1=!1;argFmtString;targetField;constructor(t,e){super();const n=Le.tokenizeWithNestedEnclosures(t,",",1,!0);if(2!==n.length)throw new Le.SyntaxException(`Invalid artifact function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${t}`);const r=n[1].includes("{")?n[1]:`{${n[1]}}`;let a=Le.tokenizeWithNestedEnclosures(r,",",1,!0);a=a.map(t=>new Qe.StringLiteral(t,e,[De.Artifact]).data),this.targetArtifacts=a,this.heroName=new Qe.StringLiteral(n[0],e,[De.Hero]).data,this.isPlayer1=t.includes("p1."),this.argFmtString=`${this.heroName}, {${a.join(", ")}}`,this.targetField=t=>this.isPlayer1?t[B.P1_ARTIFACTS]:t[B.P2_ARTIFACTS]}call(t){const e=this.getHeroes(t),n=this.targetField(t);for(let t=0;t<e.length;t++)if(e[t]===this.heroName)return this.targetArtifacts.some(e=>n[t].includes(e));return!1}}class Nn extends mn{fnType=hn;asString(t=""){return`${t}${this.fnName}(${this.argFmtString})`}}class In extends Nn{fnName=un;fnType=hn;argFmtString;n;constructor(t){super();const e=Le.tokenizeWithNestedEnclosures(t,",",1,!0);if(1!==e.length)throw new Le.SyntaxException(`Invalid last-n function call ; accepts exactly 1 argument ; got: [${e}] from str: ${t}`);this.n=new Qe.IntLiteral(e[0]).data,this.argFmtString=`${this.n}`}call(t){return t.slice(-this.n)}}function Cn(t,e,n){const r=`${t.asString()} ${e.opStr} ${n.asString()}`;if(t instanceof Qe.Field&&n instanceof Qe.Field)throw new Le.ValidationError(`Invalid base filter; fields cannot be compared with other fields ; got string: [${r}]`);if(t.type!==Qe.BaseEltTypes.FIELD&&n.type!==Qe.BaseEltTypes.FIELD)throw new Le.ValidationError(`Invalid base filter; every base filter must have at least one field ; got string: [${r}]`);if(e instanceof en&&(a=n,!(Qe.COLLECTION_FIELDS_SET.has(a.rawString)||n instanceof Qe.RangeLiteral||n instanceof Qe.SetLiteral)))throw new Le.ValidationError(`Invalid base filter; 'in' operators can only be used with Ranges, Sets, or Fields that correspond to sets like 'p1.picks' ; got string: [${r}]`);var a;return!0}class Dn extends Tn{fnType=Sn;fnName=dn;fmtString;fn;constructor(t,e){super();const n=Le.tokenizeWithNestedEnclosures(t," ",0,!0);if(3!==n.length)throw new Le.SyntaxException(`Invalid base filter; filters must have 3 tokens and be of the form: ['X', operator, 'Y']; got: [${n}] tokens from str: ${t}`);let[r,a,o]=n;const i=rn(a),s=Qe.parseBaseElement(r,e),c=Qe.parseBaseElement(o,e);if(s.asString(),c.asString(),Cn(s,i,c),s instanceof Qe.Field&&!(c instanceof Qe.Field))this.fn=t=>i.call(s.extractData(t),c.getData());else{if(s instanceof Qe.Field||!(c instanceof Qe.Field))throw new Le.ValidationError("Invalid base filter; filters must contain a Field and a Literal; got: "+t);this.fn=t=>i.call(s.getData(),c.extractData(t))}this.fmtString=`${s.asString()} ${a} ${c.asString()}`}call(t){return this.fn(t)}asString(t=""){return`${t}${this.fmtString}`}}const Mn={[dn]:Dn,[an]:gn,[on]:An,[cn]:wn,[sn]:vn,[un]:In,[ln]:Pn,[fn]:Ln,[pn]:On},Fn={AND:gn,OR:An,NOT:wn,XOR:vn,LAST_N:In,EQUIPMENT:Pn,ARTIFACT:Ln,CR:On,BASE_FILTER:Dn};function kn(t){return function(t,e,n){for(let r of t)if(!e.has(r))throw new Le.SyntaxException(`Invalid character within <${n}> ; ' ${r} ' is not allowed; got string: '${t}'`)}(t=t.replace(/[\n\t\r]/g," ").replace(/\s+/g," "),Ne,"Main Filter String"),t=t.toLowerCase()}class Un{_filters;rawString;preParsedString;references;constructor(){this._filters=[],this.rawString="",this.preParsedString="",this.references={HeroDicts:null,ARTIFACT_LOWERCASE_STRINGS_MAP:{},SEASON_DETAILS:[]}}async addReferences(t=null){if(null===(t=t||await It.getHeroDicts()))throw new Error("Hero Manager could not be retrieved to parse filters.");const e=await ge.getSeasonDetails();if(null===e)throw new Error("Season Details could not be retrieved to parse filters.");const n=await Ct.getArtifactLowercaseNameMap();this.references={HeroDicts:t,ARTIFACT_LOWERCASE_STRINGS_MAP:n,SEASON_DETAILS:e}}getFilters(){return function(t){const e=[],n=[];for(const r of t)r instanceof Nn?e.push(r):n.push(r);return[...e,...n]}(this._filters)}asString(){return`[\n${this._filters.map(t=>t.asString("   ")).join(";\n")};\n]`}static async getFiltersFromCache(t=null){const e=await ut.get(ut.Keys.FILTER_STR);if(null===e)return[];return(await this.fromFilterStr(e,t)).getFilters()}static async fromFilterStr(t,e=null){const n=new Un;return n.rawString=t,await n.addReferences(e),n.preParsedString=kn(t),n._filters=n.parse(n.preParsedString),n}parseList(t){return t.reduce((t,e)=>(t.push(...this.parse(e)),t),[])}parse(t){if(""===(t=t.trim()))return[];if(t.includes(";")){const e=t.split(";");return this.parseList(e)}const e=t.split("(")[0].replace(/p[1-2]\./i,""),n=Le.tokenizeWithNestedEnclosures(t,",",1,!0);switch(e){case an:case on:case cn:case sn:const r=function(t,e){for(const n of t)if(n instanceof Nn)throw new Le.SyntaxException(`Global filters not allowed in clause functions; got: ${n.asString()} from string: "${e}"`);return t.filter(t=>t instanceof Tn)}(this.parseList(n),t);return[new Mn[e](...r)];case un:return[new Fn.LAST_N(t)];case ln:case fn:case pn:return[new Mn[e](t,this.references)];default:if(pe.FUNCTION_CALL_RE.test(t))throw new Le.SyntaxException(`Filter String is not a valid function call but a parenthese block was detected; got: ${t}`);return[new Fn.BASE_FILTER(t,this.references)]}}}function Bn(t){return Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bn(t)}function jn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return xn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function xn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$n(r.key),r)}}function Hn(t,e,n){return e&&Gn(t.prototype,e),n&&Gn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $n(t){var e=function(t,e){if("object"!=Bn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Bn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Bn(e)?e:e+""}var Kn={RED:"text-danger",GREEN:"text-safe"},Yn=Hn(function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=e,this.docElement=n,this.classList=r});function Vn(t){if(!t instanceof Yn)throw new Error("Only instances of TextPacket can be passed to this function")}var Wn={queue:[],autoClearElements:[],TextPacket:Yn,STYLES:Kn,clearStyles:function(t){for(var e=0,n=Object.values(Kn);e<n.length;e++){var r=n[e];t.classList.remove(r)}},write:function(t){Vn(t),t.docElement.textContent=t.text,this.clearStyles(t.docElement),t.classList.forEach(function(e){t.docElement.classList.add(e)})},push:function(t){Vn(t),this.queue.push(t)},pushFromObj:function(t){var e=t.text,n=t.docElement,r=t.classList;this.push(new Yn(e,n,r))},bindAutoClear:function(t){var e,n=jn(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.autoClearElements.push(r)}}catch(t){n.e(t)}finally{n.f()}},processQueue:function(){var t=this;this.queue.forEach(function(e){t.write(e)}),this.queue=[]},clearMessages:function(){var t,e=jn(this.autoClearElements);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.textContent="",this.clearStyles(n)}}catch(t){e.e(t)}finally{e.f()}}};var qn,zn,Qn={queueSelectDataMsgGreen:function(t){Wn.push(new Yn(t,_t.HOME_PAGE.SELECT_DATA_MSG,[Kn.GREEN]))},queueSelectDataMsgRed:function(t){Wn.push(new Yn(t,_t.HOME_PAGE.SELECT_DATA_MSG,[Kn.RED]))},queueFilterMsgGreen:function(t){Wn.push(new Yn(t,_t.HOME_PAGE.FILTER_MSG,[Kn.GREEN]))},queueFilterMsgRed:function(t){Wn.push(new Yn(t,_t.HOME_PAGE.FILTER_MSG,[Kn.RED]))}};function Jn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Xn(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Xn(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Xn(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Xn(f,"constructor",u),Xn(u,"constructor",c),c.displayName="GeneratorFunction",Xn(u,a,"GeneratorFunction"),Xn(f),Xn(f,a,"Generator"),Xn(f,r,function(){return this}),Xn(f,"toString",function(){return"[object Generator]"}),(Jn=function(){return{w:o,m:p}})()}function Xn(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}Xn=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){Xn(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},Xn(t,e,n,r)}function Zn(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}const tr={validateFilterSyntax:(qn=Jn().m(function t(e){var n,r,a;return Jn().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,It.getHeroDicts();case 1:return n=t.v,r=document.getElementById("filterMSG"),t.p=2,t.n=3,Un.fromFilterStr(e,n);case 3:return t.v.asString(),Wn.write(new Yn("Validation Passed",r,[Wn.STYLES.GREEN])),t.a(2,!0);case 4:return t.p=4,a=t.v,console.error(a),Wn.write(new Yn("Validation Failed: ".concat(a.message),r,[Wn.STYLES.RED])),t.a(2,!1)}},t,null,[[2,4]])}),zn=function(){var t=this,e=arguments;return new Promise(function(n,r){var a=qn.apply(t,e);function o(t){Zn(a,n,r,o,i,"next",t)}function i(t){Zn(a,n,r,o,i,"throw",t)}o(void 0)})},function(t){return zn.apply(this,arguments)}),setScrollPercent:function(t){"Scrolling to ".concat(t,"%");var e=t/100*(document.documentElement.scrollHeight-window.innerHeight),n=document.documentElement,r=n.style.scrollBehavior;n.style.scrollBehavior="auto",window.scrollTo({top:e}),n.style.scrollBehavior=r},getScrollPercent:function(){var t=window.scrollY||document.documentElement.scrollTop,e=document.documentElement.scrollHeight-window.innerHeight;return 0===e?0:t/e*100},setVisibility:function(t,e){e?t.classList.remove("d-none"):t.classList.add("d-none")}};var er={SELECT_DATA:"select-data",SHOW_STATS:"show-stats",LOAD_DATA:"load-data"};const nr={[R]:ut.Keys.GLOBAL_USERS,[I]:ut.Keys.EU_USERS,[N]:ut.Keys.ASIA_USERS,[L]:ut.Keys.JPN_USERS,[P]:ut.Keys.KOR_USERS};function rr(t,e){return{id:Number(t.nick_no),name:t.nick_nm,code:t.code,rank:Number(t.rank),world_code:e}}async function ar(t){const e=await ut.get(nr[t]);if(null!==e)return e;const n=await async function(t){const e=await Pt.fetchUserJSON(t);if(!e||"object"==typeof e&&!("users"in e))return null;const n=e;return Object.fromEntries(n.users.map(e=>[e.nick_no,rr(e,t)]))}(t);return await ut.cache(nr[t],n),n}const or=t=>C[t];async function ir(t,e){const n=await ar(e),r=n?Object.values(n):[];if(0===r.length)return or(e),{user:null,ok:!1};let a,o;if(t.id)a=t.id,o=t=>t.id;else{if(!t.name)throw new Error("Must pass a user object with either user.name or user.id to find user");a=t.name.toLowerCase(),o=t=>t.name.toLowerCase()}return function(t,e,n){const r=e.find(e=>n(e)===t);return r?(JSON.stringify(r),{user:r,ok:!0}):{user:null,ok:!0}}(a,r,o)}const sr={getUserMap:ar,findUser:async function(t){if(JSON.stringify(t),!t.name&&!t.id||!t.world_code)throw new Error("Must pass a user object with either user.name or user.id, and user.world_code to find user");let e=t.id?`Numeric ID: ${t.id}`:`Name: '${t.name}'`,n=null;if(n=await ir(t,t.world_code),n.ok||(n=await Ot.fetchUser(t)),n.ok){const r=n.user;if(null===r)throw new Error(`Could not find user with ${e} in Server: ${or(t.world_code)}`);return r}throw new Error(`Function did not properly terminate: ${JSON.stringify(n)}`)},setUser:async function(t){await ut.cache(ut.Keys.USER,t)},getUser:async function(){return await ut.get(ut.Keys.USER)},clearUserData:async function(){await ut.clearUserData()},clearUserDataLists:async function(){await ut.clearUserLists()}};function cr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ur(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ur(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,ur(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,ur(f,"constructor",u),ur(u,"constructor",c),c.displayName="GeneratorFunction",ur(u,a,"GeneratorFunction"),ur(f),ur(f,a,"Generator"),ur(f,r,function(){return this}),ur(f,"toString",function(){return"[object Generator]"}),(cr=function(){return{w:o,m:p}})()}function ur(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}ur=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){ur(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},ur(t,e,n,r)}function lr(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function fr(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){lr(o,r,a,i,s,"next",t)}function s(t){lr(o,r,a,i,s,"throw",t)}i(void 0)})}}var pr=new Set(Object.values(er));function dr(t){return!!pr.has(t)||(console.error("Invalid page state: ".concat(t)),!1)}function Er(t){switch(t){case er.SELECT_DATA:return _t.HOME_PAGE.SELECT_DATA_BODY;case er.SHOW_STATS:return _t.HOME_PAGE.SHOW_STATS_BODY;case er.LOAD_DATA:return _t.HOME_PAGE.LOAD_DATA_BODY;default:console.error("Invalid page state: ".concat(t))}}var _r,hr,Sr,mr={getState:(Sr=fr(cr().m(function t(){var e,n,r,a;return cr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ut.get(ut.Keys.HOME_PAGE_STATE);case 1:if(r=e=t.v,!(n=null!==r)){t.n=2;break}n=void 0!==e;case 2:if(!n){t.n=3;break}a=e,t.n=4;break;case 3:a=er.SELECT_DATA;case 4:return t.a(2,a)}},t)})),function(){return Sr.apply(this,arguments)}),setState:(hr=fr(cr().m(function t(e){return cr().w(function(t){for(;;)switch(t.n){case 0:if(dr(e)){t.n=1;break}return t.a(2);case 1:return t.n=2,ut.cache(ut.Keys.HOME_PAGE_STATE,e);case 2:return t.a(2)}},t)})),function(t){return hr.apply(this,arguments)}),resetState:(_r=fr(cr().m(function t(){return cr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ut.delete(ut.Keys.HOME_PAGE_STATE);case 1:return t.a(2)}},t)})),function(){return _r.apply(this,arguments)})};function Tr(t){t?(_t.HOME_PAGE.USER_NAME.innerText=t.name,_t.HOME_PAGE.USER_ID.innerText=t.id,_t.HOME_PAGE.USER_SERVER.innerText=C[t.world_code]):(_t.HOME_PAGE.USER_NAME.innerText="(None)",_t.HOME_PAGE.USER_ID.innerText="(None)",_t.HOME_PAGE.USER_SERVER.innerText="(None)")}function yr(t){return gr.apply(this,arguments)}function gr(){return(gr=fr(cr().m(function t(e){return cr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,sr.clearUserData();case 1:if(Tr(e),!e){t.n=2;break}return t.n=2,sr.setUser(e);case 2:return t.a(2)}},t)}))).apply(this,arguments)}function Ar(){return(Ar=fr(cr().m(function t(){return cr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,yr(null);case 1:return t.a(2)}},t)}))).apply(this,arguments)}var vr={homePageSetView:function(t){if(dr(t)){for(var e=0,n=Object.values(er);e<n.length;e++){var r=n[e];if(t!==r){var a=Er(r);"Hiding ".concat(a.id),tr.setVisibility(a,!1)}}var o=Er(t);"Showing ".concat(o.id),tr.setVisibility(o,!0)}},homePageSetUser:yr,homePageDrawUserInfo:Tr,homePageClearUserData:function(){return Ar.apply(this,arguments)}};const wr={ACTIONS:{CLEAR_USER:"CLEAR_USER",SHOW_NO_USER_MSG:"SHOW_NO_USER_MSG",SHOW_DATA_ALREADY_CLEARED_MSG:"SHOW_DATA_ALREADY_CLEARED_MSG",QUERY_USER:"QUERY_USER"},getState:async function(){return await ut.get(ut.Keys.INTER_PAGE_MANAGER)??{actions:[],messages:[]}},setState:async function(t){await ut.cache(ut.Keys.INTER_PAGE_MANAGER,t)},pushActions:async function(t){let e=await this.getState();e.actions.push(...t),await this.setState(e)},pushMessages:async function(t){let e=await this.getState();e.messages.push(...t),await this.setState(e)},pushState:async function(t){let e=await this.getState();e.actions.push(...t.actions),e.messages.push(...t.messages),await this.setState(e)},flushState:async function(){const t=await this.getState();return await ut.delete(ut.Keys.INTER_PAGE_MANAGER),t}};function br(t){return br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},br(t)}function Or(t){return function(t){if(Array.isArray(t))return Ir(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Nr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,o,i,s=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(t,e)||Nr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pr(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=br(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=br(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==br(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Nr(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function Nr(t,e){if(t){if("string"==typeof t)return Ir(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ir(t,e):void 0}}function Ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Cr=function(t){return t.filter(function(t){return t[B.FIRST_PICK]})};function Dr(t){return(100*t).toFixed(2)+"%"}function Mr(t,e){return Dr(0!==e?t/e:0)}function Fr(t,e){var n=t[B.CR_BAR].find(function(t){return t[0]===e});return n?n[1]:null}function kr(t,e,n){var r,a,o=function(t){return t.filter(function(t){return t[B.WIN]})}(t).length,i=t.length,s=0!==e?i/e:0,c=0!==i?o/i:0,u=t.reduce(function(t,e){return t+(e[B.P1_POSTBAN]===n||e[B.P2_POSTBAN]===n)},0),l=t.reduce(function(t,e){return t+(e[B.WIN]||e[B.P1_POSTBAN]===n||e[B.P2_POSTBAN]===n)},0),f=t.reduce(function(t,e){return t+e[B.POINT_GAIN]},0),p=0,d=0,E=0,_=Lr(t);try{for(_.s();!(a=_.n()).done;){var h=Fr(a.value,n);null!==h&&0!==h&&(p+=1,d+=h,100===h&&(E+=1))}}catch(t){_.e(t)}finally{_.f()}var S=Mr(d/100,p);return Pr(Pr(Pr(Pr(Pr(Pr(Pr(Pr(Pr(Pr(r={},G,n),H,i),K,Dr(s)),Y,o),V,Dr(c)),W,u),q,Mr(u,i)),z,Mr(l,i)),Q,2*o-i),J,f),Pr(Pr(Pr(r,X,S),Z,E),tt,Mr(E,p))}function Ur(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new Set,r=0,a=Object.values(t);r<a.length;r++){var o=a[r];(e?o[B.P1_PICKS_PRIMES]:o[B.P2_PICKS_PRIMES]).forEach(function(t){n.add(t)})}return n}function Br(t){var e=Math.floor(t/60),n=(t%60).toFixed(1);return 0===e?"".concat(n," secs"):"".concat(e," : ").concat(n,"s")}const jr={getHeroStats:function(t,e){if(0===t.length)return{playerHeroStats:[],enemyHeroStats:[]};var n,r=t.length,a=Ur(t,!0),o=Ur(t,!1),i=[],s=[],c=Lr(a);try{var u=function(){var a=n.value,o=It.getHeroByPrime(a,e),s=t.filter(function(t){return t[B.P1_PICKS_PRIME_PRODUCT]%a===0});s.length>0&&i.push(kr(s,r,o.name))};for(c.s();!(n=c.n()).done;)u()}catch(t){c.e(t)}finally{c.f()}var l,f=Lr(o);try{var p=function(){var n=l.value,a=It.getHeroByPrime(n,e),o=t.filter(function(t){return t[B.P2_PICKS_PRIME_PRODUCT]%n===0});o.length>0&&s.push(kr(o,r,a.name))};for(f.s();!(l=f.n()).done;)p()}catch(t){f.e(t)}finally{f.f()}var d=G;return{playerHeroStats:i.sort(function(t,e){return t[d].localeCompare(e[d])}),enemyHeroStats:s.sort(function(t,e){return t[d].localeCompare(e[d])})}},getFirstPickStats:function(t,e){if(0===(t=Cr(Object.values(t))).length)return[];var n,r=t.length,a={},o=Lr(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(0!==i[B.P1_PICKS_PRIMES].length){var s=i[B.P1_PICKS_PRIMES][0];s in a||(a[s]={wins:0,appearances:0}),a[s].wins+=i[B.WIN],a[s].appearances+=1}}}catch(t){o.e(t)}finally{o.f()}var c=Object.entries(a).map(function(t){var n=Rr(t,2),a=n[0],o=n[1];return{hero:It.getHeroByPrime(a,e).name,wins:o.wins,appearances:o.appearances,win_rate:Dr(o.wins/o.appearances),appearance_rate:Dr(o.appearances/r),"+/-":2*o.wins-o.appearances}});return c.sort(function(t,e){return e.appearances-t.appearances}),c},getPrebanStats:function(t,e){var n=It.getHeroByName(It.EMPTY_NAME,e).prime;if(0===t.length)return[];var r,a=function(e,r){return Or(new Set(t.map(function(t){return t[e][r]}).filter(function(t){return t&&t!==n})))},o=a(B.P1_PREBANS_PRIMES,0),i=a(B.P1_PREBANS_PRIMES,1),s=new Set([].concat(Or(o),Or(i))),c=[],u=Lr(s);try{for(u.s();!(r=u.n()).done;){var l=r.value;c.push(l)}}catch(t){u.e(t)}finally{u.f()}var f,p=Lr(s);try{for(p.s();!(f=p.n()).done;){var d,E=f.value,_=Lr(s);try{for(_.s();!(d=_.n()).done;){var h=d.value;E<h&&c.push(E*h)}}catch(t){_.e(t)}finally{_.f()}}}catch(t){p.e(t)}finally{p.f()}for(var S=t.length,m=[],T=function(){var n=g[y],r=t.filter(function(t){return t["P1 Prebans Prime Product"]%n===0}),a=r.length;if(a<1)return 1;var o=r.reduce(function(t,e){return t+e.Win},0),i=S>0?a/S:0,s=a>0?o/a:0,c=2*o-a;m.push({preban:e.prime_pair_lookup[n],wins:o,appearances:a,appearance_rate:Dr(i),win_rate:Dr(s),"+/-":c})},y=0,g=c;y<g.length;y++)T();return m.sort(function(t,e){return e.appearances-t.appearances}),m},getPerformanceStats:function(t){var e,n={servers:[],leagues:[]},r=t.length,a=Object.values(C),o=Object.values(U),i=Lr([].concat(Or(a.map(function(t){return["Server: ".concat(t),function(e){return e["P2 Server"]===t}]})),Or(o.map(function(t){return["League: ".concat(t),function(e){return e["P2 League"]===t}]}))));try{for(i.s();!(e=i.n()).done;){var s=Rr(e.value,2),c=s[0],u=s[1],l=t.filter(u);if(0!==l.length){var f=l.length,p=l.reduce(function(t,e){return t+e.Win},0),d=f>0?p/f:"N/A",E=r>0?f/r:"N/A",_=l.filter(function(t){return t["First Pick"]}),h=_.reduce(function(t,e){return t+e.Win},0),S=l.filter(function(t){return!t["First Pick"]}),m=S.reduce(function(t,e){return t+e.Win},0);(c.toLowerCase().includes("server")?n.servers:n.leagues).push({label:c,count:f,wins:p,win_rate:"N/A"===d?"N/A":Dr(d),frequency:Dr(E),"+/-":2*p-f,fp_games:_.length,sp_games:S.length,fp_wr:_.length>0?Dr(h/_.length):"N/A",sp_wr:S.length>0?Dr(m/S.length):"N/A"})}}}catch(t){i.e(t)}finally{i.f()}return[].concat(Or(n.servers),Or(n.leagues.slice(-4)))},getGeneralStats:function(t,e){t.sort(function(t,e){return new Date(t["Date/Time"])-new Date(e["Date/Time"])});var n,r=t.length,a=t.reduce(function(t,e){return t+e["Point Gain"]},0),o=r>0?a/r:0,i=t.reduce(function(t,e){return t+e.Turns},0),s=r>0?i/r:0,c=t.length>0?Math.max.apply(Math,Or(t.map(function(t){return t.Turns}))):0,u=t.reduce(function(t,e){return t+e.Seconds},0),l=r>0?u/r:0,f=t.length>0?Math.max.apply(Math,Or(t.map(function(t){return t.Seconds}))):0,p=Br(l),d=Br(f),E=t.reduce(function(t,e){return t+e["First Turn"]},0),_=Cr(t),h=function(t){return t.filter(function(t){return!t[B.FIRST_PICK]})}(t),S=_.length,m=h.length,T=_.reduce(function(t,e){return t+e.Win},0),y=h.reduce(function(t,e){return t+e.Win},0),g=r?S/r:0,A=r?m/r:0,v=S?T/S:0,w=m?y/m:0,b=r?(T+y)/r:0,O=0,R=0,P=0,L=0,N=Lr(t);try{for(N.s();!(n=N.n()).done;){n.value.Win?(P+=1,O=Math.max(O,P),L=0):(P=0,L+=1,R=Math.max(R,L))}}catch(t){N.e(t)}finally{N.f()}var I="N/A";return{first_pick_count:S,second_pick_count:m,first_pick_rate:S?Dr(g):I,second_pick_rate:m?Dr(A):I,first_pick_winrate:S?Dr(v):I,second_pick_winrate:m?Dr(w):I,total_winrate:r?Dr(b):I,total_battles:r,total_wins:T+y,max_win_streak:O,max_loss_streak:R,avg_ppg:o.toFixed(2),avg_turns:s.toFixed(2),avg_time:p,max_turns:c,max_time:d,first_turn_games:E,first_turn_rate:r?Dr(E/r):I}}};function xr(t,e){const n=t=>It.getHeroByName(t,e)?.prime??e.Fodder.prime,r=(t,e)=>t*e;t[B.P1_PICKS_PRIMES]=t[B.P1_PICKS].map(n),t[B.P2_PICKS_PRIMES]=t[B.P2_PICKS].map(n),t[B.P1_PICKS_PRIME_PRODUCT]=t[B.P1_PICKS_PRIMES].reduce(r,1),t[B.P2_PICKS_PRIME_PRODUCT]=t[B.P2_PICKS_PRIMES].reduce(r,1),t[B.P1_PREBANS_PRIMES]=t[B.P1_PREBANS].map(n),t[B.P2_PREBANS_PRIMES]=t[B.P2_PREBANS].map(n),t[B.P1_PREBANS_PRIME_PRODUCT]=t[B.P1_PREBANS_PRIMES].reduce(r,1),t[B.P2_PREBANS_PRIME_PRODUCT]=t[B.P2_PREBANS_PRIMES].reduce(r,1)}function Gr(t,e,n){const r=t=>It.getHeroByCode(t,e)?.name??e.Fodder.name,a=(e,r)=>r.map((r,a)=>r?(t=>Ct.convertCodeToName(t,n)||"None")(r):((e,n)=>"p1"===e?t.p2_postban===t.p1_picks[n]:t.p1_postban===t.p2_picks[n])(e,a)?"n/a":"None");const o=t=>t.map(t=>t.map(t=>M[t]||t)),i=t.cr_bar.find(t=>100===t[1]),s=!!i&&t.p1_picks.includes(i[0]),c={[B.SEASON]:t.season_name||"None",[B.SEASON_CODE]:t.season_code||"None",[B.DATE_TIME]:t.date_time,[B.SECONDS]:t.seconds,[B.TURNS]:t.turns,[B.SEQ_NUM]:t.seq_num,[B.P1_ID]:t.p1_id.toString(),[B.P1_SERVER]:C[t.p1_server]||t.p1_server||"None",[B.P2_ID]:t.p2_id.toString(),[B.P2_SERVER]:C[t.p2_server]||t.p2_server||"None",[B.P1_LEAGUE]:v(t.p1_league)||"None",[B.P2_LEAGUE]:v(t.p2_league)||"None",[B.P1_POINTS]:t.p1_win_score,[B.POINT_GAIN]:t.p1_point_delta||null,[B.WIN]:1===t.win,[B.FIRST_PICK]:1===t.first_pick,[B.FIRST_TURN]:!!s,[B.FIRST_TURN_HERO]:i?r(i[0]):"n/a",[B.CR_BAR]:(u=t.cr_bar,u.map(t=>t&&2==t.length?[r(t[0]),t[1]]:["n/a",0])),[B.P1_PREBANS]:t.p1_prebans.map(r),[B.P2_PREBANS]:t.p2_prebans.map(r),[B.P1_PICKS]:t.p1_picks.map(r),[B.P2_PICKS]:t.p2_picks.map(r),[B.P1_POSTBAN]:r(t.p1_postban),[B.P2_POSTBAN]:r(t.p2_postban),[B.P1_EQUIPMENT]:o(t.p1_equipment),[B.P2_EQUIPMENT]:o(t.p2_equipment),[B.P1_ARTIFACTS]:a("p1",t.p1_artifacts),[B.P2_ARTIFACTS]:a("p2",t.p2_artifacts),[B.P1_MVP]:r(t.p1_mvp),[B.P2_MVP]:r(t.p2_mvp)};var u;return xr(c,e),c}function Hr(t,e,n){n=n??Ct.getArtifactCodeToNameMap();let r=[];for(const a of t){let t=Gr(a,e,n);r.push([t["Seq Num"],t])}return Object.fromEntries(r)}function $r(t,e){const n=t.map(t=>{const n=(r=t,Object.fromEntries(Object.entries(r).map(([t,e])=>[t,JSON.parse(e)])));var r;return xr(n,e),n});return Object.fromEntries(n.map(t=>[t[B.SEQ_NUM],t]))}function Kr(t){return Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kr(t)}function Yr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Vr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yr(Object(n),!0).forEach(function(e){Wr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Wr(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=Kr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Kr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Kr(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qr(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Kr(t)+" is not iterable")}function zr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,o,i,s=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(t,e)||Jr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Jr(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function Jr(t,e){if(t){if("string"==typeof t)return Xr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xr(t,e):void 0}}function Xr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Zr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ta(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ta(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,ta(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,ta(f,"constructor",u),ta(u,"constructor",c),c.displayName="GeneratorFunction",ta(u,a,"GeneratorFunction"),ta(f),ta(f,a,"Generator"),ta(f,r,function(){return this}),ta(f,"toString",function(){return"[object Generator]"}),(Zr=function(){return{w:o,m:p}})()}function ta(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}ta=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){ta(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},ta(t,e,n,r)}function ea(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function na(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){ea(o,r,a,i,s,"next",t)}function s(t){ea(o,r,a,i,s,"throw",t)}i(void 0)})}}var ra,aa,oa,ia,sa,ca,ua,la,fa={loaded_servers:new Set,getBattles:(la=na(Zr().m(function t(){var e,n,r,a;return Zr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ut.get(ut.Keys.BATTLES);case 1:if(r=e=t.v,!(n=null!==r)){t.n=2;break}n=void 0!==e;case 2:if(!n){t.n=3;break}a=e,t.n=4;break;case 3:a=null;case 4:return t.a(2,a)}},t)})),function(){return la.apply(this,arguments)}),removeBattles:(ua=na(Zr().m(function t(){return Zr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ut.delete(ut.Keys.BATTLES);case 1:return t.n=2,ut.delete(ut.Keys.UPLOADED_BATTLES);case 2:return t.n=3,ut.delete(ut.Keys.FILTERED_BATTLES);case 3:case 4:return t.a(2)}},t)})),function(){return ua.apply(this,arguments)}),removeFilteredBattles:(ca=na(Zr().m(function t(){return Zr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ut.delete(ut.Keys.FILTERED_BATTLES);case 1:case 2:return t.a(2)}},t)})),function(){return ca.apply(this,arguments)}),applyFilter:(sa=na(Zr().m(function t(e){var n,r,a,o,i,s,c,u,l,f,p,d;return Zr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.getBattles();case 1:n=t.v,r=e.filter(function(t){return t instanceof Tn}),a=e.filter(function(t){return t instanceof Nn}),o=Object.values(n),i=Qr(a);try{for(i.s();!(s=i.n()).done;)c=s.value,"Applying global filter: ".concat(c.asString()),u=o.length,o=c.call(o),n=Object.fromEntries(o.map(function(t){return[t["Seq Num"],t]})),"Filtered ".concat(u-o.length," out of ").concat(u,"; new total = ").concat(o.length)}catch(t){i.e(t)}finally{i.f()}l=Qr(r),t.p=2,p=Zr().m(function t(){var e,r;return Zr().w(function(t){for(;;)switch(t.n){case 0:e=f.value,"Applying local filter: ".concat(e.asString()),r=Object.keys(n).length,n=Object.fromEntries(Object.entries(n).filter(function(t){var n=zr(t,2),r=(n[0],n[1]);return e.call(r)})),"Filtered ".concat(r-Object.keys(n).length," out of ").concat(r,"; new total = ").concat(Object.keys(n).length);case 1:return t.a(2)}},t)}),l.s();case 3:if((f=l.n()).done){t.n=5;break}return t.d(qr(p()),4);case 4:t.n=3;break;case 5:t.n=7;break;case 6:t.p=6,d=t.v,l.e(d);case 7:return t.p=7,l.f(),t.f(7);case 8:return"Caching filtered battles ; total = ".concat(Object.keys(n).length),t.n=9,ut.cache(ut.Keys.FILTERED_BATTLES,n);case 9:return"Filtered battles and stored in cache; modified ['FILTERED_BATTLES']; Applied total of <".concat(r.length+a.length,"> filters"),t.a(2,n)}},t,this,[[2,6,7,8]])})),function(t){return sa.apply(this,arguments)}),extendBattles:(ia=na(Zr().m(function t(e){var n,r,a,o,i;return Zr().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ut.get(ut.Keys.BATTLES);case 1:if(o=n=t.v,!(a=null!==o)){t.n=2;break}a=void 0!==n;case 2:if(!a){t.n=3;break}i=n,t.n=4;break;case 3:i={};case 4:return r=Vr(Vr({},i),this.sortBattlesObj(e)),t.n=5,ut.cache(ut.Keys.BATTLES,r);case 5:return t.a(2,r)}},t,this)})),function(t){return ia.apply(this,arguments)}),cacheQuery:(oa=na(Zr().m(function t(e,n,r){var a,o;return Zr().w(function(t){for(;;)switch(t.n){case 0:if(e){t.n=1;break}return t.a(2,[]);case 1:return"Caching queried battles: ".concat(e.length," battles; modified [BATTLES];"),a=Hr(e,n,r),t.n=2,this.extendBattles(a);case 2:return o=t.v,t.a(2,o)}},t,this)})),function(t,e,n){return oa.apply(this,arguments)}),cacheUpload:(aa=na(Zr().m(function t(e,n){var r,a;return Zr().w(function(t){for(;;)switch(t.n){case 0:if(e){t.n=1;break}return console.error("No uploaded battles provided to cacheUpload"),t.a(2,{});case 1:return r=$r(e,n),t.n=2,ut.cache(ut.Keys.UPLOADED_BATTLES,r);case 2:return t.n=3,this.extendBattles(r);case 3:return a=t.v,t.a(2,a)}},t,this)})),function(t,e){return aa.apply(this,arguments)}),getStats:(ra=na(Zr().m(function t(e,n,r){var a,o,i,s,c,u,l,f,p,d;return Zr().w(function(t){for(;;)switch(t.n){case 0:return a=n.length,"Applying ".concat(a," filters"),o=Object.values(e),t.n=1,this.applyFilter(n);case 1:return i=t.v,s=Object.values(i),c=a>0,t.n=2,jr.getPrebanStats(s,r);case 2:return u=t.v,t.n=3,jr.getFirstPickStats(s,r);case 3:return l=t.v,t.n=4,jr.getGeneralStats(s,r);case 4:return f=t.v,t.n=5,jr.getHeroStats(s,r);case 5:return p=t.v,t.n=6,jr.getPerformanceStats(s);case 6:return d=t.v,t.a(2,{battles:o,filteredBattlesObj:i,prebanStats:u,generalStats:f,firstPickStats:l,playerHeroStats:p.playerHeroStats,enemyHeroStats:p.enemyHeroStats,performanceStats:d,numFilters:a,areFiltersApplied:c})}},t,this)})),function(t,e,n){return ra.apply(this,arguments)}),sortBattlesList:function(t){var e=B.DATE_TIME;return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?t.sort(function(t,n){return new Date(t[e])-new Date(n[e])}):t.sort(function(t,n){return new Date(n[e])-new Date(t[e])})},sortBattlesObj:function(t){var e=B.DATE_TIME;if(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]){var n=Object.values(t).sort(function(t,n){return new Date(t[e])-new Date(n[e])});return Object.fromEntries(n.map(function(t){return[t[B.SEQ_NUM],t]}))}var r=Object.values(t).sort(function(t,n){return new Date(n[e])-new Date(t[e])});return Object.fromEntries(r.map(function(t){return[t[B.SEQ_NUM],t]}))}};const pa={changeLang:async function(t){await da.ClientCache.setLang(t),await da.HeroManager.fetchAndCacheHeroManager(t),window.location.reload()},getLang:async function(){return await da.ClientCache.getLang()}};let da={HeroManager:It,BattleManager:fa,SeasonManager:ge,UserManager:sr,ClientCache:ut,ArtifactManager:Ct,LangManager:pa};function Ea(t,e,n){const r={user:t,filterStr:n,battles:{headers:[],rows:[]}};var a;return r.battles=(a=Object.values(e),{headers:j,rows:a.map(t=>j.map(e=>JSON.stringify(t[e])))}),r}function _a(t){if(!t||"object"!=typeof t)throw new Error("Invalid upload: data is null, undefined, or not an object");if(!("user"in t))throw new Error("Invalid upload: missing 'user' field");if(function(t){if(!t)throw new Error("Invalid user; user is null or undefined");if(!("id"in t)||"number"!=typeof t.id)throw new Error("Invalid user; user.id does not exist or is not a number");if(!("name"in t)||"string"!=typeof t.name)throw new Error("Invalid user; user.name does not exist or is not a string");if(!("code"in t)||"string"!=typeof t.code)throw new Error("Invalid user; user.code does not exist or is not a string");if(!("rank"in t)||"number"!=typeof t.rank)throw new Error("Invalid user; user.rank does not exist or is not a number");if(!("world_code"in t)||"string"!=typeof t.world_code)throw new Error("Invalid user; user.world_code does not exist or is not a string");if(!(t.world_code in C))throw new Error("Invalid user; user.world_code is not a valid world code")}(t.user),!("battles"in t))throw new Error("Invalid upload: missing 'battles' field");return function(t){if(!t||"object"!=typeof t)return!1;if(!("headers"in t)||!Array.isArray(t.headers))throw new Error("Invalid upload: missing headers field");if(t.headers.length!==j.length)throw new Error(`Invalid upload: expected ${j.length} headers, got ${t.headers.length}`);for(let e=0;e<j.length;e++)if(j[e]!==t.headers[e])throw new Error(`Invalid upload: headers do not match at index ${e}; expected ${j[e]}, got ${t.headers[e]}`);if(!("rows"in t)||!Array.isArray(t.rows))throw new Error("Invalid upload: missing rows field or rows is not an array");if(0===t.rows.length)throw new Error("Invalid upload: uploaded data has no battles");for(let e=0;e<t.rows.length;e++){const n=t.rows[e];if(n.length!==j.length)throw new Error(`Invalid upload: expected ${j.length} columns per row, got ${n.length} at index ${e}`)}}(t.battles),!0}const ha={triggerDownload:async function(){const t=await da.UserManager.getUser();if(!t)throw new Error("User not found; cannot export data without an active user");const e=await da.ClientCache.getStats(),n=await da.ClientCache.getFilterStr()||void 0,r=e.areFiltersApplied?" Filtered":"";let a=e.areFiltersApplied?Object.values(e.filteredBattlesObj):e.battles;a=a||[];const o=await Ea(t,a,n),i=(new Date).toISOString().split("T")[0]||"";!function(t,e){const n=JSON.stringify(e),r=new Blob([n],{type:"application/json"}),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download=t.endsWith(".json")?t:`${t}.json`,o.click(),URL.revokeObjectURL(a)}(`${t.name} (${t.id})${r} ${i}`,o)},parseJSON:async function(t){const e=await t.text();!function(t,e=".json",n=60){if(!t.name.endsWith(".json"))throw new Error("File must be .json");const r=1024*n*1024;if(t.size>r)throw new Error(`File must be smaller than ${n}mb, got ${t.size/1048576}mb File.`)}(t);const n=JSON.parse(e);return _a(n),n},restructureParsedUploadBattles:function(t){const e=[];for(const n of t.rows){const t={};j.forEach((e,r)=>{t[e]=n[r]}),e.push(t)}return function(t){const e=new Set(t.map(t=>t[B.P1_ID])),n=new Set(t.map(t=>t[B.P1_SERVER]));if(1!==e.size)throw new Error(`Invalid upload: Multiple P1 IDs found in upload: {${Array.from(e).join(", ")}}`);if(1!==n.size)throw new Error(`Invalid upload: Multiple P1 Servers found in upload: {${Array.from(n).join(", ")}}`);const r=n.values().next().value?.replace(/"|'/g,"");if(!r||!Object.values(C).includes(r))throw new Error(`Invalid upload: Invalid P1 Server found in upload: '${r}'`)}(e),e}};function Sa(){window.location.href=URL_UTILS.HOME_PAGE_URL}function ma(){document.querySelectorAll(".nav-link").forEach(t=>{t.addEventListener("click",async function(e){if(!("dataset"in t)||!t.dataset||"object"!=typeof t.dataset||!("nav"in t.dataset))return;const n=t.dataset.nav;if(Object.values(er).includes(n))if(n===er.SELECT_DATA)await mr.setState(er.SELECT_DATA),Sa();else if(n===er.SHOW_STATS){await sr.getUser()?(await mr.setState(er.SHOW_STATS),Sa()):(await mr.setState(er.SELECT_DATA),await wr.pushState({messages:["Active user not found; you must either query a valid user or upload battles to view hero stats."],actions:[wr.ACTIONS.SHOW_NO_USER_MSG]}),Sa())}})})}function Ta(){_t.NAV_BAR.CLEAR_DATA_BTN.addEventListener("click",async function(){await sr.getUser()?(await mr.setState(er.SELECT_DATA),await wr.pushActions([wr.ACTIONS.CLEAR_USER])):(await mr.setState(er.SELECT_DATA),await wr.pushActions([wr.ACTIONS.SHOW_DATA_ALREADY_CLEARED_MSG])),Sa()})}function ya(){[_t.NAV_BAR.CLEAR_DATA_BTN,_t.NAV_BAR.EXPORT_DATA_BTN,_t.NAV_BAR.OFFICIAL_SITE_BTN].forEach(t=>{t.addEventListener("touchstart",()=>{t.classList.add("touch-hover"),setTimeout(()=>t.classList.remove("touch-hover"),150)})})}function ga(t,e="en"){t?(_t.NAV_BAR.USER_NAME.innerText=t.name,_t.NAV_BAR.USER_ID.innerText=`${t.id}`,_t.NAV_BAR.USER_SERVER.innerText=C[t.world_code],_t.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(function(t,e){const n=`${et}/${e}/gg/battlerecord/${t.world_code}/${t.id}`;return n}(t,e),"_blank","noopener,noreferrer")}):(_t.NAV_BAR.USER_NAME.innerText="(None)",_t.NAV_BAR.USER_ID.innerText="(None)",_t.NAV_BAR.USER_SERVER.innerText="(None)",_t.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(nt,"_blank","noopener,noreferrer")})}function Aa(){_t.NAV_BAR.EXPORT_DATA_BTN.addEventListener("click",async function(){if(!await da.UserManager.getUser())return await wr.pushState({messages:["User not found; cannot export data without an active user"],actions:[wr.ACTIONS.SHOW_NO_USER_MSG]}),await mr.setState(er.SELECT_DATA),void Sa();await ha.triggerDownload()})}let va={addNavListeners:ma,addClearDataBtnListener:Ta,writeUserInfo:ga,initialize:async function(){ga(await sr.getUser()),ma(),Ta(),Aa(),ya()},navToHome:Sa,addExportDataBtnListener:Aa,addBraceButtonListeners:ya,eraseUserFromPage:async function(){await sr.clearUserData(),ga(null)},setUserOnPage:async function(t){await sr.setUser(t),ga(t,await pa.getLang())}};function wa(t){return wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wa(t)}function ba(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=wa(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=wa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wa(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Oa={SOURCE:{QUERY:"query",UPLOAD:"upload",STATS:"stats"}},Ra=ba(ba(ba({},er.SELECT_DATA,0),er.SHOW_STATS,0),er.LOAD_DATA,0),Pa={SOURCE:"SOURCE",AUTO_ZOOM:"AUTO_ZOOM",AUTO_QUERY:"AUTO_QUERY",STATS_POST_RENDER_COMPLETED:"STATS_POST_RENDER_COMPLETED",STATS_PRE_RENDER_COMPLETED:"STATS_PRE_RENDER_COMPLETED",HOME_PAGE_STATE:"STATE",SCROLL_PERCENTS:"SCROLL_PERCENTS",CODE_MIRROR_EDITOR:"CODE_MIRROR_EDITOR",TRY_SET_USER:"TRY_SET_USER",IGNORE_RELAYOUT:"IGNORE_RELAYOUT"},La={KEYS:Pa,VALUES:Oa,SOURCE:null,AUTO_QUERY:null,AUTO_ZOOM:!1,STATS_POST_RENDER_COMPLETED:!1,STATS_PRE_RENDER_COMPLETED:!1,HOME_PAGE_STATE:null,SCROLL_PERCENTS:Ra,CODE_MIRROR_EDITOR:null,TRY_SET_USER:null,IGNORE_RELAYOUT:!1,popKey:function(t){var e=this[t];return this[t]=this._getDefault(t),e},readKey:function(t){return this[t]},_getDefault:function(t){switch(t){case Pa.AUTO_ZOOM:return!1;case Pa.SOURCE:case Pa.AUTO_QUERY:return null;case Pa.STATS_POST_RENDER_COMPLETED:case Pa.STATS_PRE_RENDER_COMPLETED:return!1;case Pa.HOME_PAGE_STATE:return null;case Pa.SCROLL_PERCENTS:return Ra;case Pa.CODE_MIRROR_EDITOR:throw new Error("No default value for key: ".concat(t," ; do not use popKey or _getDefault for this key"));case Pa.TRY_SET_USER:return null;case Pa.IGNORE_RELAYOUT:return!1;default:return null}}};function Na(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ia(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ia(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Ia(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Ia(f,"constructor",u),Ia(u,"constructor",c),c.displayName="GeneratorFunction",Ia(u,a,"GeneratorFunction"),Ia(f),Ia(f,a,"Generator"),Ia(f,r,function(){return this}),Ia(f,"toString",function(){return"[object Generator]"}),(Na=function(){return{w:o,m:p}})()}function Ia(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}Ia=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){Ia(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},Ia(t,e,n,r)}function Ca(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function Da(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){Ca(o,r,a,i,s,"next",t)}function s(t){Ca(o,r,a,i,s,"throw",t)}i(void 0)})}}function Ma(t){Wn.write(new Yn(t,_t.HOME_PAGE.SELECT_DATA_MSG,[Wn.STYLES.RED]))}function Fa(){return Fa=Da(Na().m(function t(e){var n,r,a;return Na().w(function(t){for(;;)switch(t.n){case 0:n=_t.HOME_PAGE.ID_SEARCH_FLAG,r=da.ClientCache.Keys.ID_SEARCH_FLAG,n.addEventListener("click",Da(Na().m(function t(){return Na().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,da.ClientCache.cache(r,n.checked);case 1:return t.a(2)}},t)}))),(a=document.getElementById("userForm")).addEventListener("submit",function(){var t=Da(Na().m(function t(n){var r,o,i,s,c,u;return Na().w(function(t){for(;;)switch(t.n){case 0:if(n.preventDefault(),r=new FormData(a),o=r.get("username"),i=r.get("server"),o){t.n=1;break}Ma("Must enter username"),t.n=4;break;case 1:return t.p=1,t.n=2,da.ClientCache.get(da.ClientCache.Keys.ID_SEARCH_FLAG);case 2:return s=t.v,c=s?{id:o,world_code:i}:{name:o,world_code:i},La.TRY_SET_USER=c,La.AUTO_QUERY=!0,La.SOURCE=La.VALUES.SOURCE.QUERY,e(er.LOAD_DATA),t.a(2);case 3:t.p=3,u=t.v,console.error("Caught Error:",u),Ma(u.message);case 4:return t.a(2)}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),Fa.apply(this,arguments)}function ka(){return ka=Da(Na().m(function t(e){var n,r;return Na().w(function(t){for(;;)switch(t.n){case 0:(n=document.getElementById("auto-query-flag")).addEventListener("click",Da(Na().m(function t(){return Na().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,da.ClientCache.cache(da.ClientCache.Keys.AUTO_QUERY_FLAG,n.checked);case 1:return t.a(2)}},t)}))),r=null,_t.HOME_PAGE.CSV_FILE.addEventListener("change",function(t){r=t.target.files[0]}),_t.HOME_PAGE.UPLOAD_FORM.addEventListener("submit",function(){var t=Da(Na().m(function t(a){var o,i;return Na().w(function(t){for(;;)switch(t.n){case 0:if(a.preventDefault(),o=n.checked,t.p=1,r){t.n=2;break}return Ma("Must upload a file"),t.a(2);case 2:return"Selected File: ".concat(r.name," ; content: ").concat(JSON.stringify(r)),t.n=3,da.ClientCache.cache(da.ClientCache.Keys.RAW_UPLOAD,r);case 3:return La.AUTO_QUERY=o,La.SOURCE=La.VALUES.SOURCE.UPLOAD,e(er.LOAD_DATA),t.a(2);case 4:t.p=4,i=t.v,console.error("Caught Error:",i),Ma(i.message);case 5:return t.a(2)}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),ka.apply(this,arguments)}function Ua(t){!function(t){Fa.apply(this,arguments)}(t),function(t){ka.apply(this,arguments)}(t)}function Ba(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ja(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ja(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,ja(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,ja(f,"constructor",u),ja(u,"constructor",c),c.displayName="GeneratorFunction",ja(u,a,"GeneratorFunction"),ja(f),ja(f,a,"Generator"),ja(f,r,function(){return this}),ja(f,"toString",function(){return"[object Generator]"}),(Ba=function(){return{w:o,m:p}})()}function ja(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}ja=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){ja(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},ja(t,e,n,r)}function xa(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function Ga(){return Ga=function(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){xa(o,r,a,i,s,"next",t)}function s(t){xa(o,r,a,i,s,"throw",t)}i(void 0)})}}(Ba().m(function t(){var e,n;return Ba().w(function(t){for(;;)switch(t.n){case 0:return e=document.getElementById("auto-query-flag"),t.n=1,ut.get(ut.Keys.AUTO_QUERY_FLAG);case 1:return e.checked=t.v,n=_t.HOME_PAGE.ID_SEARCH_FLAG,t.n=2,ut.get(ut.Keys.ID_SEARCH_FLAG);case 2:n.checked=t.v;case 3:return t.a(2)}},t)})),Ga.apply(this,arguments)}var Ha={runLogic:function(){return Ga.apply(this,arguments)},initialize:function(t){Ua(t)}};function $a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ka(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ka(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function Ka(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ya(t){var e=$("#".concat(t));$.fn.dataTable.isDataTable(e)&&e.DataTable().clear().destroy()}function Va(t){var e,n=$a(t=structuredClone(t));try{for(n.s();!(e=n.n()).done;){var r,a=e.value,o=$a(x);try{for(o.s();!(r=o.n()).done;){var i=r.value;a[i]=JSON.stringify(a[i])}}catch(t){o.e(t)}finally{o.f()}}}catch(t){n.e(t)}finally{n.f()}return t}function Wa(t){var e=Number(t.replace("%",""));return e>50?"text-over50":e<50?"text-below50":""}function qa(t){var e=document.getElementById("".concat(t,"-body"));if(!e)throw new Error("Could not find tbody with id ".concat(t,"-body"));return e}var za={populateHeroStatsTable:function(t,e){Ya(t),qa(t).innerHTML="";var n=t.toLowerCase().includes("player"),r=n?"Player":"Enemy",a=[G,H,K,Y,V,q,z,Q,J,X,tt],o=a.filter(function(t){return t!==z}),i=n?a:o,s=$("#".concat(t)).DataTable({layout:{topStart:"buttons"},language:{info:"Total rows: _TOTAL_"},order:[[2,"desc"]],buttons:{name:"primary",buttons:["copy",{extend:"csv",text:"CSV",filename:r+" Hero Stats"},{extend:"excel",text:"Excel",filename:r+" Hero Stats"}]},columnDefs:[{targets:"_all",className:"nowrap"},{targets:4,createdCell:function(t,e){var n=Number(e.replace("%",""));n<50?t.style.color="red":n>50&&(t.style.color="mediumspringgreen")}}],pageLength:50,scrollY:"300px",deferRender:!0,scroller:!0,scrollCollapse:!1,columns:i.map(function(t){return{data:t}})});return s.rows.add(e).draw(),s},populateSeasonDetailsTable:function(t,e){var n=qa(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr");e.innerHTML="\n            <td>".concat(t["Season Number"],"</td>\n            <td>").concat(t.Season,"</td>\n            <td>").concat(t.Start,"</td>\n            <td>").concat(t.End,"</td>\n            <td>").concat(t.Status,"</td>\n            "),n.appendChild(e)})},populateServerStatsTable:function(t,e){var n=qa(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr"),r=t.label.includes("Server")?"cm-keyword":"cm-declared-data";e.innerHTML='\n            <td class="'.concat(r,'">').concat(t.label,"</td>\n            <td>").concat(t.count,"</td>\n            <td>").concat(t.frequency,"</td>\n            <td>").concat(t.wins,'</td>\n            <td class="').concat(Wa(t.win_rate),'">').concat(t.win_rate,"</td>\n            <td>").concat(t["+/-"],'</td>\n            <td class="').concat(Wa(t.fp_wr),'">').concat(t.fp_wr,'</td>\n            <td class="').concat(Wa(t.sp_wr),'">').concat(t.sp_wr,"</td>\n            "),n.appendChild(e)})},populatePlayerPrebansTable:function(t,e){var n=qa(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr");e.innerHTML="\n            <td>".concat(t.preban,"</td>\n            <td>").concat(t.appearances,"</td>\n            <td>").concat(t.appearance_rate,'</td>\n            <td class="').concat(Wa(t.win_rate),'">').concat(t.win_rate,"</td>\n            <td>").concat(t["+/-"],"</td>\n            "),n.appendChild(e)})},populatePlayerFirstPickTable:function(t,e){var n=qa(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr");e.innerHTML="\n            <td>".concat(t.hero,"</td>\n            <td>").concat(t.appearances,"</td>\n            <td>").concat(t.appearance_rate,'</td>\n            <td class="').concat(Wa(t.win_rate),'">').concat(t.win_rate,"</td>\n            <td>").concat(t["+/-"],"</td>\n            "),n.appendChild(e)})},populateFullBattlesTable:function(t,e,n){var r;Ya(t),e=Va(e),qa(t).innerHTML="";var a=(new Date).toISOString().split("T")[0]||"";r=n?"".concat(n.name," (").concat(n.id,") ").concat(a):0===e.length?"Empty":"UID(".concat(e[0]["P1 ID"],") ").concat(a);var o=$("#".concat(t)).DataTable({layout:{topStart:"buttons"},language:{info:"Total rows: _TOTAL_"},order:[[2,"desc"]],columnDefs:[{targets:"_all",className:"nowrap"}],rowCallback:function(t,e,n){var r=t.cells[14],a=t.cells[15],o=t.cells[16];!0===e.Win?r.style.color="mediumspringgreen":!1===e.Win&&(r.style.color="red"),!0===e["First Pick"]&&(a.style.color="deepskyblue"),!0===e["First Turn"]&&(o.style.color="deepskyblue")},buttons:{name:"primary",buttons:["copy",{extend:"csv",text:"CSV",filename:r},{extend:"excel",text:"Excel",filename:r}]},pageLength:50,scrollY:"300px",deferRender:!0,scroller:!0,scrollCollapse:!1,columns:Object.values(B).filter(function(t){return!t.toLowerCase().includes("prime")}).map(function(t){return{data:t}})});return o.rows.add(e).draw(),o},replaceDatatableData:function(t,e){$("#".concat(t)).DataTable().clear().rows.add(e).draw()},replaceBattleData:function(t){t=Va(t);var e=_t.HOME_PAGE.BATTLES_TBL.id;this.replaceDatatableData(e,t)}},Qa=function(t){lt.setText("total-battles",t.total_battles),lt.setText("first-pick-count",t.first_pick_count),lt.setText("first-pick-rate"," (".concat(t.first_pick_rate,")")),lt.setText("second-pick-count",t.second_pick_count),lt.setText("second-pick-rate"," (".concat(t.second_pick_rate,")")),lt.setText("total-winrate",t.total_winrate),lt.setText("first-pick-winrate",t.first_pick_winrate),lt.setText("second-pick-winrate",t.second_pick_winrate),lt.setText("total-wins",t.total_wins),lt.setText("max-win-streak",t.max_win_streak),lt.setText("max-loss-streak",t.max_loss_streak),lt.setText("avg-ppg",t.avg_ppg),lt.setText("avg-turns",t.avg_turns),lt.setText("avg-time",t.avg_time),lt.setText("max-turns",t.max_turns),lt.setText("max-time",t.max_time),lt.setText("first-turn-games",t.first_turn_games),lt.setText("first-turn-rate",t.first_turn_rate)},Ja={"Current Season":"season = current-season","Last Season":"season = last-season","First Pick":"is-first-pick = true","Second Pick":"is-first-pick = false","Champion+ Opponent":"p2.league in {champion, warlord, emperor, legend}","Warlord+ Opponent":"p2.league in {warlord, emperor, legend}","Emperor+ Opponent":"p2.league in {emperor, legend}","Legend Opponent":"p2.league = 'legend'",Wins:"is-win = true",Losses:"is-win = false",extendFilters:function(t,e){var n=Ja[e];return";"!==(t=t.replace(/\s+$/,"")).slice(-1)&&t.length>0?t+=";\n":";"===t.slice(-1)&&(t+="\n"),"".concat(t).concat(n,";")}};const Xa=Ja,Za=16,to=8,eo=2,no=1;function ro(t){const e=t;return{markerSize:Math.max(eo,6-.5*Math.log10(e)),lineWidth:Math.max(no,3-.5*Math.log10(e))}}function ao(t,e){const n={startX:null,endX:null,startY:null,endY:null};for(const[r,a]of t.entries())a["Seq Num"]in e&&(n.startX=null===n.startX||r<n.startX?r-.5:n.startX,n.startY=null===n.startY||a["P1 Points"]<n.startY+50?a["P1 Points"]-50:n.startY,n.endX=null===n.endX||r>n.endX?r+.5:n.endX,n.endY=null===n.endY||a["P1 Points"]>n.endY-50?a["P1 Points"]+50:n.endY);return n}function oo(t,e,n,r=null){e.sort((t,e)=>t["Date/Time"].localeCompare(e["Date/Time"])),n||(n={name:`UID: ${e[0]["P1 ID"]}`});const a=e.map((t,e)=>e),o=e.map(t=>t["P1 Points"]),i=[];for(let[t,n]of e.entries())r&&n["Seq Num"]in r?i.push("#ff9900"):i.push("#0df8fd");const s=e.map(t=>[t["Date/Time"].slice(0,10),t["P1 League"]]),c=ro(e.length),u={x:a,y:o,mode:"lines+markers",line:{color:"#4f9293",width:c.lineWidth},marker:{symbol:"circle",size:c.markerSize,color:i},customdata:s,hovertemplate:"Points: %{y}<br>Date: %{customdata[0]}<br>League: %{customdata[1]}<extra></extra>"},l={autosize:!0,font:{family:"Roboto, Open Sans"},title:{text:`${n.name}'s RTA Point Plot`,font:{size:24,color:"#dddddd"},xanchor:"center",yanchor:"top",y:.95,x:.5},xaxis:{title:{text:"Battle Number (Chronological)",font:{size:18,color:"#dddddd"}},showgrid:!0,gridcolor:"#8d8d8d",zeroline:!1,tickfont:{size:12,color:"#dddddd"},range:null},yaxis:{title:{text:"Victory Points",font:{size:18,color:"#dddddd"}},showgrid:!0,gridcolor:"#8d8d8d",zeroline:!0,zerolinecolor:"#dddddd",zerolinewidth:2,tickfont:{size:12,color:"#dddddd"},range:null},plot_bgcolor:"#1e222d",paper_bgcolor:"#1e222d"},f={responsive:!0};let p,d=!0;return p=document.getElementById("rank-plot"),p||(d=!1,p=document.createElement("div"),p.id="rank-plot",t.appendChild(p)),p.style.width="100%",p.style.height="100%",d?Plotly.react(p,[u],l,f):Plotly.newPlot(p,[u],l,f),p}function io(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return so(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(so(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,so(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,so(f,"constructor",u),so(u,"constructor",c),c.displayName="GeneratorFunction",so(u,a,"GeneratorFunction"),so(f),so(f,a,"Generator"),so(f,r,function(){return this}),so(f,"toString",function(){return"[object Generator]"}),(io=function(){return{w:o,m:p}})()}function so(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}so=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){so(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},so(t,e,n,r)}function co(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function uo(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){co(o,r,a,i,s,"next",t)}function s(t){co(o,r,a,i,s,"throw",t)}i(void 0)})}}function lo(){var t=_t.HOME_PAGE.RANK_PLOT;t.__zoomListenerAttached||(t.__zoomListenerAttached=!0,t.on("plotly_relayout",function(){var e=uo(io().m(function e(n){var r,a,o,i,s,c,u;return io().w(function(e){for(;;)switch(e.n){case 0:if(!La.popKey(La.KEYS.IGNORE_RELAYOUT)){e.n=1;break}return e.a(2);case 1:return e.n=2,ut.getStats();case 2:r=e.v,a=Object.values(r.battles).length,o=ro(a),void 0!==n["xaxis.range[0]"]?(i=[n["xaxis.range[0]"],n["xaxis.range[1]"]],s=a/(i[1]-i[0]),c=Math.min(Math.max(o.markerSize*s,o.markerSize),Za),u=Math.min(Math.max(o.lineWidth*s,o.lineWidth),to),Plotly.restyle(t,{"marker.size":[c],"line.width":[u]})):Plotly.restyle(t,{"marker.size":[o.markerSize],"line.width":[o.lineWidth]});case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()))}function fo(t,e){var n,r;(n=_t.HOME_PAGE.AUTO_ZOOM_FLAG).addEventListener("click",uo(io().m(function t(){return io().w(function(t){for(;;)switch(t.n){case 0:return n.checked,t.n=1,da.ClientCache.cache(da.ClientCache.Keys.AUTO_ZOOM_FLAG,n.checked);case 1:return t.a(2)}},t)}))),(r=_t.HOME_PAGE.BATTLE_FILTER_TOGGLE).addEventListener("click",uo(io().m(function t(){var e;return io().w(function(t){for(;;)switch(t.n){case 0:return r.checked,t.n=1,da.ClientCache.getStats();case 1:e=t.v,r.checked?(e.filteredBattlesObj,za.replaceBattleData(Object.values(e.filteredBattlesObj))):za.replaceBattleData(e.battles);case 2:return t.a(2)}},t)}))),function(t){document.getElementById("premade-filters").addEventListener("click",function(e){e.preventDefault();var n=e.target.closest(".dropdown-item");if(n){var r=n.textContent.trim(),a=t.getValue(),o=Xa.extendFilters(a,r);t.setValue(o)}})}(t),function(t,e){document.getElementById("filterForm").addEventListener("submit",function(){var n=uo(io().m(function n(r){var a,o,i,s;return io().w(function(n){for(;;)switch(n.n){case 0:return r.preventDefault(),document.getElementById("codeArea").value=t.getValue(),a=r.submitter,o=null==a?void 0:a.value,i=t.getValue(),n.n=1,da.ClientCache.getFilterStr();case 1:if(s=n.v,"apply"!==o){n.n=5;break}return n.n=2,tr.validateFilterSyntax(i);case 2:if(!n.v){n.n=4;break}return n.n=3,da.ClientCache.setFilterStr(i);case 3:case 8:return La.AUTO_QUERY=!1,La.SOURCE=La.VALUES.SOURCE.STATS,e(er.LOAD_DATA),n.a(2);case 4:n.n=9;break;case 5:if("check"!==o){n.n=7;break}return n.n=6,tr.validateFilterSyntax(i);case 6:case 9:return n.a(2);case 7:if("clear"!==o){n.n=9;break}if(t.setValue(""),!s){n.n=9;break}return n.n=8,da.ClientCache.setFilterStr("")}},n)}));return function(t){return n.apply(this,arguments)}}())}(t,e),function(t){_t.HOME_PAGE.LATEST_BATTLES_BTN.addEventListener("click",uo(io().m(function e(){return io().w(function(e){for(;;)switch(e.n){case 0:return La.AUTO_QUERY=!0,La.SOURCE=La.VALUES.SOURCE.STATS,e.n=1,t(er.LOAD_DATA);case 1:return e.a(2)}},e)})))}(e)}let po=0;function Eo(){return po+=1,`id-${po}`}let _o=null;const ho="nest",So="adj";class mo{htmlElt;children;childArr;constructor(t){this.htmlElt=t,this.children={},this.childArr=[]}static fromID(t){return new mo(lt.unwrapHtmlElt(t))}static fromElt(t){return new mo(t)}get id(){return this.htmlElt.id}set id(t){this.htmlElt.id=t}addClass(...t){this.htmlElt.classList.add(...t)}addStyle(t){this.htmlElt.setAttribute("style",t)}removeClass(...t){this.htmlElt.classList.remove(...t)}addAttributes(t){for(const[e,n]of Object.entries(t))this.htmlElt.setAttribute(e,n)}appendChild(t){if(t instanceof mo)return this.htmlElt.appendChild(t.htmlElt),t.id||(t.id=Eo()),this.children[t.id]=t,this.childArr.push(t),t;if(t instanceof HTMLElement){let e=new mo(t);return this.appendChild(e)}throw new Error("Only instances of HTMLConstructor or HTMLElement can be passed to this function")}setInnerHtml(t){this.htmlElt.innerHTML=t}appendInnerHTML(t){this.htmlElt.insertAdjacentHTML("beforeend",t)}constructChild(t,e={}){e.id||(e.id=Eo());let n=document.createElement(t),r=new mo(n);return r.addAttributes(e),this.appendChild(r),r}addTextContent(t){this.htmlElt.textContent=t}compose(t){for(let e=0;e<t.length;e++){const n=t[e];if(n.option===ho)return n.children?n.children=[...n.children,...t.slice(e+1)]:n.children=t.slice(e+1),n.option=So,void this.compose([n]);if(n.textContent instanceof Array){const t=[];for(const e of n.textContent){const r=Object.assign({},n);r.textContent=e,t.push(r)}this.compose(t);continue}let r=this.constructChild(n.tag,n.attributes);n.classes&&r.addClass(...n.classes),n.children&&r.compose(n.children),n.textContent&&r.addTextContent(n.textContent),n.style&&r.addStyle(n.style),n.innerHtml&&r.setInnerHtml(n.innerHtml)}}}class To extends mo{thead;tbody;constructor(t,e,n){super(t),this.constructChild("thead",{id:e}),this.constructChild("tbody",{id:n}),this.thead=this.children[e],this.tbody=this.children[n]}static createFromIDs(t,e,n){const r=document.createElement("table");return r.id=t,new To(r,e,n)}addColumns(t){const e=this.thead.constructChild("tr");t.forEach(t=>{e.constructChild("th",{scope:"col"}).addTextContent(t)})}}function yo(t){return yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yo(t)}function go(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ao(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ao(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Ao(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Ao(f,"constructor",u),Ao(u,"constructor",c),c.displayName="GeneratorFunction",Ao(u,a,"GeneratorFunction"),Ao(f),Ao(f,a,"Generator"),Ao(f,r,function(){return this}),Ao(f,"toString",function(){return"[object Generator]"}),(go=function(){return{w:o,m:p}})()}function Ao(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}Ao=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){Ao(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},Ao(t,e,n,r)}function vo(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function wo(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){vo(o,r,a,i,s,"next",t)}function s(t){vo(o,r,a,i,s,"throw",t)}i(void 0)})}}var bo=function(t){return t.areFiltersApplied&&t.battlesList.length>Object.values(t.filteredBattlesObj).length};function Oo(t){return Ro.apply(this,arguments)}function Ro(){return(Ro=wo(go().m(function t(e){var n,r,a,o,i,s,c,u,l,f,p,d,E;return go().w(function(t){for(;;)switch(t.n){case 0:return n=lt.unwrapHtmlElt("rank-plot-container"),t.n=1,sr.getUser();case 1:return r=t.v,t.n=2,ut.get(ut.Keys.AUTO_ZOOM_FLAG);case 2:a=t.v,o=oo(n,e.battles,r,e.numFilters>0?e.filteredBattlesObj:null),lo(),a&&bo(e)&&(i=ao(e.battles,e.filteredBattlesObj),s=Object.values(e.battles).length,c=Object.values(e.filteredBattlesObj).length,u=ro(s),l=s/c,f=Math.min(Math.max(u.markerSize*l,u.markerSize),Za),p=Math.min(Math.max(u.lineWidth*l,u.lineWidth),to),d={"xaxis.range":[i.startX,i.endX],"yaxis.range":[i.startY,i.endY]},E={"marker.size":[f],"line.width":[p]},La.IGNORE_RELAYOUT=!0,Plotly.restyle(o,E),Plotly.relayout(o,d));case 3:return t.a(2)}},t)}))).apply(this,arguments)}function Po(){return Lo.apply(this,arguments)}function Lo(){return(Lo=wo(go().m(function t(){var e,n,r,a;return go().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,sr.getUser();case 1:if(e=t.v){t.n=2;break}return t.a(2);case 2:return t.p=3,t.n=4,da.SeasonManager.getSeasonDetails();case 4:return yo(n=t.v),t.n=5,da.ClientCache.getStats();case 5:return r=t.v,console.time("populateTables"),za.populateSeasonDetailsTable("season-details-tbl",n),za.populateHeroStatsTable("player-tbl",r.playerHeroStats),za.populateHeroStatsTable("opponent-tbl",r.enemyHeroStats),za.populatePlayerFirstPickTable("first-pick-stats-tbl",r.firstPickStats),za.populatePlayerPrebansTable("preban-stats-tbl",r.prebanStats),za.populateServerStatsTable("performance-stats-tbl",r.performanceStats),_t.HOME_PAGE.BATTLE_FILTER_TOGGLE.checked?za.populateFullBattlesTable("battles-tbl",Object.values(r.filteredBattlesObj),e):za.populateFullBattlesTable("battles-tbl",r.battles,e),Qa(r.generalStats),t.n=6,Oo(r);case 6:console.timeEnd("populateTables"),t.n=8;break;case 7:t.p=7,a=t.v,console.error("Error loading data:",a);case 8:return t.a(2)}},t,null,[[3,7]])}))).apply(this,arguments)}function No(){return Io.apply(this,arguments)}function Io(){return(Io=wo(go().m(function t(){var e,n,r;return go().w(function(t){for(;;)switch(t.n){case 0:return CodeMirror.defineMode("filterSyntax",function(){return{token:function(t,e){return pe.tokenMatch(t)}}}),e=document.getElementById("codeArea"),(n=CodeMirror.fromTextArea(e,{mode:"filterSyntax",lineNumbers:!0,theme:"default"})).setSize(null,185),t.n=1,da.ClientCache.getFilterStr();case 1:return(r=t.v)&&n.setValue(r),n.on("change",function(){n.save()}),e.classList.remove("codemirror-hidden"),La.CODE_MIRROR_EDITOR=n,t.a(2,n)}},t)}))).apply(this,arguments)}function Co(){return(Co=wo(go().m(function t(){return go().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Po();case 1:return t.a(2)}},t)}))).apply(this,arguments)}function Do(){return(Do=wo(go().m(function t(){var e;return go().w(function(t){for(;;)switch(t.n){case 0:if(e=La.CODE_MIRROR_EDITOR){t.n=1;break}return console.error("Editor not found in CONTEXT"),t.a(2);case 1:e.refresh();case 2:return t.a(2)}},t)}))).apply(this,arguments)}function Mo(){return Mo=wo(go().m(function t(e){var n,r,a;return go().w(function(t){for(;;)switch(t.n){case 0:return n=_t.HOME_PAGE.AUTO_ZOOM_FLAG,t.n=1,da.ClientCache.get(da.ClientCache.Keys.AUTO_ZOOM_FLAG);case 1:return r=t.v,n.checked=r,t.n=2,da.ClientCache.getStats();case 2:return a=t.v,_t.HOME_PAGE.BATTLE_FILTER_TOGGLE.checked&&za.replaceBattleData(Object.values(a.filteredBattlesObj)),t.n=3,sr.getUser();case 3:if(t.v){t.n=4;break}return e(er.SELECT_DATA),t.a(2);case 4:case 5:_t.HOME_PAGE.CSV_FILE.value="",_t.HOME_PAGE.USER_QUERY_FORM_NAME.value="";case 6:return t.a(2)}},t)})),Mo.apply(this,arguments)}function Fo(){for(var t=[_t.HOME_PAGE.FIRST_PICK_STATS_TBL,_t.HOME_PAGE.PREBAN_STATS_TBL,_t.HOME_PAGE.SEASON_DETAILS_TBL],e=function(){if(_o)return _o;const t=document.createElement("div");t.style.visibility="hidden",t.style.overflow="scroll",document.body.appendChild(t);const e=t.offsetWidth-t.clientWidth;return t.remove(),_o=e,e}(),n=0,r=t;n<r.length;n++){var a=r[n].querySelector("thead");a&&a.style.setProperty("padding-right","".concat(e,"px"))}}function ko(){return ko=wo(go().m(function t(e){var n;return go().w(function(t){for(;;)switch(t.n){case 0:return Fo(),t.n=1,No();case 1:return n=t.v,t.n=2,fo(n,e);case 2:return t.a(2)}},t)})),ko.apply(this,arguments)}var Uo={preFirstRenderLogic:function(){return Co.apply(this,arguments)},postFirstRenderLogic:function(){return Do.apply(this,arguments)},runLogic:function(t){return Mo.apply(this,arguments)},initialize:function(t){return ko.apply(this,arguments)},populateContent:Po};function Bo(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return jo(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(jo(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,jo(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,jo(f,"constructor",u),jo(u,"constructor",c),c.displayName="GeneratorFunction",jo(u,a,"GeneratorFunction"),jo(f),jo(f,a,"Generator"),jo(f,r,function(){return this}),jo(f,"toString",function(){return"[object Generator]"}),(Bo=function(){return{w:o,m:p}})()}function jo(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}jo=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){jo(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},jo(t,e,n,r)}function xo(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function Go(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){xo(o,r,a,i,s,"next",t)}function s(t){xo(o,r,a,i,s,"throw",t)}i(void 0)})}}function Ho(){return $o.apply(this,arguments)}function $o(){return($o=Go(Bo().m(function t(){var e,n,r,a,o;return Bo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,da.ClientCache.get(da.ClientCache.Keys.RAW_UPLOAD);case 1:return e=t.v,t.n=2,ha.parseJSON(e);case 2:return n=t.v,r=ha.restructureParsedUploadBattles(n.battles),a=n.user,t.n=3,da.UserManager.findUser(a);case 3:if(o=t.v){t.n=4;break}throw playerID,new Error("File Upload Error: User not found");case 4:return t.a(2,{user:o,battleArr:r})}},t)}))).apply(this,arguments)}function Ko(t,e){return Yo.apply(this,arguments)}function Yo(){return(Yo=Go(Bo().m(function t(e,n){var r,a,o,i,s;return Bo().w(function(t){for(;;)switch(t.n){case 0:return JSON.stringify(e),t.n=1,da.ArtifactManager.getArtifactCodeToNameMap();case 1:return r=t.v,t.n=2,Ot.rsFetchBattleData(e);case 2:if((a=t.v).ok){t.n=4;break}return t.n=3,a.json();case 3:throw o=t.v,new Error(o.error);case 4:return t.n=5,a.json();case 5:return i=t.v,s=i.battles,t.n=6,da.BattleManager.cacheQuery(s,n,r);case 6:case 7:return t.a(2)}},t)}))).apply(this,arguments)}function Vo(t,e,n){return Wo.apply(this,arguments)}function Wo(){return Wo=Go(Bo().m(function t(e,n,r){var a,o,i,s;return Bo().w(function(t){for(;;)switch(t.n){case 0:return o=[La.VALUES.SOURCE.QUERY,La.VALUES.SOURCE.UPLOAD,La.VALUES.SOURCE.STATS],i=o[1],s=o[2],n===o[0]||n===i?(a=er.SELECT_DATA,Qn.queueSelectDataMsgRed("Failed to load data: ".concat(e.message))):n===s?(a=er.SHOW_STATS,Qn.queueFilterMsgRed("Failed to load data: ".concat(e.message))):(console.error("Invalid source: ".concat(n," ; redirecting to select data")),a=er.SELECT_DATA,Qn.queueSelectDataMsgRed("Failed to load data: ".concat(e.message))),console.error(e),t.n=1,va.eraseUserFromPage();case 1:return t.n=2,r(a);case 2:return t.a(2)}},t)})),Wo.apply(this,arguments)}function qo(t){return zo.apply(this,arguments)}function zo(){return(zo=Go(Bo().m(function t(e){var n;return Bo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,da.UserManager.findUser(e);case 1:if(n=t.v,JSON.stringify(n),null===n){t.n=2;break}return t.a(2,n);case 2:return t.a(2,null)}},t)}))).apply(this,arguments)}function Qo(t){return Jo.apply(this,arguments)}function Jo(){return(Jo=Go(Bo().m(function t(e){var n;return Bo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,da.UserManager.clearUserData();case 1:return t.n=2,da.UserManager.setUser(e);case 2:return t.n=3,da.LangManager.getLang();case 3:n=t.v,va.writeUserInfo(e,n);case 4:return t.a(2)}},t)}))).apply(this,arguments)}function Xo(){return Xo=Go(Bo().m(function t(e){var n,r,a,o,i,s,c,u,l,f,p,d;return Bo().w(function(t){for(;;)switch(t.n){case 0:return n=null,r=null,a=null,t.p=1,t.n=2,da.HeroManager.getHeroDicts();case 2:n=t.v,r=La.popKey(La.KEYS.SOURCE),a=La.popKey(La.KEYS.AUTO_QUERY),t.n=5;break;case 3:return t.p=3,f=t.v,console.error("Could not load reference and context variables: ",f),t.n=4,e(er.SELECT_DATA);case 4:return t.a(2);case 5:if(t.p=5,o=null,r!==La.VALUES.SOURCE.UPLOAD){t.n=9;break}return t.n=6,Ho();case 6:return i=t.v,o=i.user,t.n=7,Qo(o);case 7:return t.n=8,da.BattleManager.cacheUpload(i.battleArr,n);case 8:t.n=12;break;case 9:if(r!==La.VALUES.SOURCE.QUERY){t.n=12;break}if(null!==(s=La.popKey(La.KEYS.TRY_SET_USER))){t.n=10;break}throw new Error("TRY_SET_USER User missing from CONTEXT");case 10:return t.n=11,qo(s);case 11:return o=t.v,t.n=12,Qo(o);case 12:if(null!==o){t.n=14;break}return t.n=13,da.UserManager.getUser();case 13:o=t.v;case 14:if(!a&&r!==La.VALUES.SOURCE.QUERY){t.n=15;break}return t.n=15,Ko(o,n);case 15:return t.n=16,da.BattleManager.getBattles();case 16:return c=t.v,t.n=17,Un.getFiltersFromCache(n);case 17:return u=t.v,"Received Filters: ".concat(JSON.stringify(u)),t.n=18,da.BattleManager.getStats(c,u,n);case 18:return l=t.v,t.n=19,da.ClientCache.setStats(l);case 19:return t.n=20,Uo.populateContent();case 20:return La.STATS_PRE_RENDER_COMPLETED=!0,t.n=21,e(er.SHOW_STATS);case 21:return t.a(2);case 22:return t.p=22,p=t.v,t.p=23,t.n=24,Vo(p,r,e);case 24:return t.a(2);case 25:return t.p=25,d=t.v,console.error("Something went wrong ; redirecting to select data ; error:",d),t.n=26,va.eraseUserFromPage();case 26:return t.n=27,e(er.SELECT_DATA);case 27:return t.a(2)}},t,null,[[23,25],[5,22],[1,3]])})),Xo.apply(this,arguments)}var Zo={runLogic:function(t){return Xo.apply(this,arguments)},initialize:function(){}};function ti(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ei(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ei(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,ei(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,ei(f,"constructor",u),ei(u,"constructor",c),c.displayName="GeneratorFunction",ei(u,a,"GeneratorFunction"),ei(f),ei(f,a,"Generator"),ei(f,r,function(){return this}),ei(f,"toString",function(){return"[object Generator]"}),(ti=function(){return{w:o,m:p}})()}function ei(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}ei=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){ei(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},ei(t,e,n,r)}function ni(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function ri(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){ni(o,r,a,i,s,"next",t)}function s(t){ni(o,r,a,i,s,"throw",t)}i(void 0)})}}function ai(){La.IGNORE_RELAYOUT=!0,setTimeout(function(){Plotly.Plots.resize(document.getElementById("rank-plot"))},20)}function oi(t){return ii.apply(this,arguments)}function ii(){return ii=ri(ti().m(function t(e){return ti().w(function(t){for(;;)switch(t.n){case 0:if(La.STATS_PRE_RENDER_COMPLETED){t.n=2;break}return t.n=1,Uo.preFirstRenderLogic(e);case 1:La.STATS_PRE_RENDER_COMPLETED=!0;case 2:return t.n=3,Uo.runLogic(e);case 3:return t.n=4,vr.homePageSetView(er.SHOW_STATS);case 4:if(La.STATS_POST_RENDER_COMPLETED){t.n=6;break}return t.n=5,Uo.postFirstRenderLogic();case 5:La.STATS_POST_RENDER_COMPLETED=!0;case 6:ai();case 7:return t.a(2)}},t)})),ii.apply(this,arguments)}function si(){return ci.apply(this,arguments)}function ci(){return(ci=ri(ti().m(function t(){var e;return ti().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,mr.getState();case 1:e=t.v,La.SCROLL_PERCENTS[e]=tr.getScrollPercent(),Wn.clearMessages(),Wn.processQueue();case 2:return t.a(2)}},t)}))).apply(this,arguments)}function ui(t){return li.apply(this,arguments)}function li(){return(li=ri(ti().m(function t(e){var n,r;return ti().w(function(t){for(;;)switch(t.n){case 0:if("Switching to state: ".concat(e,", with CONTEXT: "),dr(e)){t.n=1;break}return t.a(2);case 1:return si(),t.n=2,mr.setState(e);case 2:r=e,t.n=r===er.SELECT_DATA?3:r===er.SHOW_STATS?6:r===er.LOAD_DATA?8:11;break;case 3:return t.n=4,Ha.runLogic(ui);case 4:return t.n=5,vr.homePageSetView(e);case 5:return t.a(3,12);case 6:return t.n=7,oi(ui);case 7:return t.a(3,12);case 8:return t.n=9,vr.homePageSetView(e);case 9:return t.n=10,Zo.runLogic(ui);case 10:return t.a(3,12);case 11:console.error("Invalid page state: ".concat(e));case 12:n=La.SCROLL_PERCENTS[e],setTimeout(function(){tr.setScrollPercent(n)},0);case 13:return t.a(2)}},t)}))).apply(this,arguments)}function fi(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return pi(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(pi(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,pi(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,pi(f,"constructor",u),pi(u,"constructor",c),c.displayName="GeneratorFunction",pi(u,a,"GeneratorFunction"),pi(f),pi(f,a,"Generator"),pi(f,r,function(){return this}),pi(f,"toString",function(){return"[object Generator]"}),(fi=function(){return{w:o,m:p}})()}function pi(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}pi=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){pi(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},pi(t,e,n,r)}function di(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function Ei(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){di(o,r,a,i,s,"next",t)}function s(t){di(o,r,a,i,s,"throw",t)}i(void 0)})}}function _i(){document.querySelectorAll(".nav-link").forEach(function(t){t.addEventListener("click",function(){var t=Ei(fi().m(function t(e){var n,r;return fi().w(function(t){for(;;)switch(t.n){case 0:return n=this.dataset.nav,t.n=1,mr.getState();case 1:if(r=t.v,!Object.values(er).includes(n)){t.n=6;break}if(r!==n){t.n=2;break}return"Already in state: ".concat(r," ; returning"),t.a(2);case 2:if(n!==er.SELECT_DATA){t.n=3;break}ui(er.SELECT_DATA,La),t.n=5;break;case 3:if(n!==er.SHOW_STATS){t.n=5;break}return t.n=4,sr.getUser();case 4:t.v?ui(er.SHOW_STATS,La):(Qn.queueSelectDataMsgRed("User not found; Must either query a valid user or upload battles to view hero stats"),ui(er.SELECT_DATA,La));case 5:t.n=7;break;case 6:"Navigating to: ".concat(this.href);case 7:return t.a(2)}},t,this)}));return function(e){return t.apply(this,arguments)}}())}),_t.NAV_BAR.CLEAR_DATA_BTN.addEventListener("click",function(){var t=Ei(fi().m(function t(e){var n;return fi().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,sr.getUser();case 1:if(!(n=t.v)){t.n=4;break}return t.n=2,va.eraseUserFromPage();case 2:return Qn.queueSelectDataMsgGreen("Cleared data of user ".concat(n.name," (").concat(n.id,")")),t.n=3,ui(er.SELECT_DATA);case 3:La.SCROLL_PERCENTS[er.SHOW_STATS]=0,t.n=5;break;case 4:return Qn.queueSelectDataMsgGreen("Data already cleared"),t.n=5,ui(er.SELECT_DATA);case 5:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()),_t.NAV_BAR.SIDEBAR_HIDE_BTN.addEventListener("click",function(t){ai()}),_t.NAV_BAR.SIDEBAR_CONTROL.addEventListener("click",function(t){ai()})}var hi=["Hero Name","Battles","Pick Rate","Wins","Win Rate","Postban Rate","Success Rate","+/-","Point Gain","Avg CR","First Turn Rate"],Si=[{tbl:_t.HOME_PAGE.SEASON_DETAILS_TBL,cols:["","Season","Start","End","Status"]},{tbl:_t.HOME_PAGE.PERFORMANCE_STATS_TBL,cols:["","Battles","Freq","Wins","Win Rate","+/-","FP WR","SP WR"]},{tbl:_t.HOME_PAGE.FIRST_PICK_STATS_TBL,cols:["Hero","Battles","Pick Rate","Win Rate","+/-"]},{tbl:_t.HOME_PAGE.PREBAN_STATS_TBL,cols:["Preban","Battles","Ban Rate","Win Rate","+/-"]},{tbl:_t.HOME_PAGE.PLAYER_TBL,cols:hi},{tbl:_t.HOME_PAGE.OPPONENT_TBL,cols:hi.filter(function(t){return!t.toLowerCase().includes("success")})},{tbl:_t.HOME_PAGE.BATTLES_TBL,cols:Object.values(B).filter(function(t){return!t.toLowerCase().includes("prime")})}];function mi(){Si.forEach(function(t){var e,n,r;e=t.tbl,n=t.cols,r=e.id,new To(e,r+"-head",r+"-body").addColumns(n)})}function Ti(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return yi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yi(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function yi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function gi(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ai(u,"_invoke",function(n,r,a){var o,s,c,u=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!a&&e<l.length;e++){var a,o=l[e],d=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,p.v=r,p.n=o[1]):d<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,E){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,E),s=l,c=E;(e=s<2?t:c)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){o=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,a,o),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ai(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Ai(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Ai(f,"constructor",u),Ai(u,"constructor",c),c.displayName="GeneratorFunction",Ai(u,a,"GeneratorFunction"),Ai(f),Ai(f,a,"Generator"),Ai(f,r,function(){return this}),Ai(f,"toString",function(){return"[object Generator]"}),(gi=function(){return{w:o,m:p}})()}function Ai(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}Ai=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){Ai(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},Ai(t,e,n,r)}function vi(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function wi(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){vi(o,r,a,i,s,"next",t)}function s(t){vi(o,r,a,i,s,"throw",t)}i(void 0)})}}function bi(t,e){return Oi.apply(this,arguments)}function Oi(){return(Oi=wi(gi().m(function t(e,n){var r,a,o,i;return gi().w(function(t){for(;;)switch(t.n){case 0:r=!1,i=e,t.n=i===wr.ACTIONS.CLEAR_USER?1:i===wr.ACTIONS.SHOW_DATA_ALREADY_CLEARED_MSG?5:i===wr.ACTIONS.SHOW_NO_USER_MSG?6:i===wr.ACTIONS.QUERY_USER?7:8;break;case 1:return t.n=2,sr.getUser();case 2:return a=t.v,t.n=3,va.eraseUserFromPage();case 3:return Qn.queueSelectDataMsgGreen("Cleared data of user ".concat(a.name," (").concat(a.id,")")),t.n=4,ui(er.SELECT_DATA);case 4:return r=!0,t.a(3,9);case 5:return Qn.queueSelectDataMsgGreen("Data already cleared"),t.a(3,9);case 6:return o=n.pop()||"Cannot perform action; no active user found.",Qn.queueSelectDataMsgRed(o),t.a(3,9);case 7:return La.AUTO_QUERY=!0,ui(er.LOAD_DATA),r=!0,t.a(3,9);case 8:return console.error("Invalid action: ".concat(e)),t.a(3,9);case 9:return t.a(2,r)}},t)}))).apply(this,arguments)}function Ri(){return Pi.apply(this,arguments)}function Pi(){return(Pi=wi(gi().m(function t(){var e,n,r,a,o,i;return gi().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,wr.flushState();case 1:e=t.v,n=!1,r=Ti(e.actions),t.p=2,r.s();case 3:if((a=r.n()).done){t.n=6;break}return o=a.value,t.n=4,bi(o,e.messages);case 4:n=t.v;case 5:t.n=3;break;case 6:t.n=8;break;case 7:t.p=7,i=t.v,r.e(i);case 8:return t.p=8,r.f(),t.f(8);case 9:return t.a(2,n)}},t,null,[[2,7,8,9]])}))).apply(this,arguments)}function Li(){return Ni.apply(this,arguments)}function Ni(){return(Ni=wi(gi().m(function t(){var e,n,r,a,o;return gi().w(function(t){for(;;)switch(t.n){case 0:_i(),mi(),e=0,n=[Ha,Uo,Zo];case 1:if(!(e<n.length)){t.n=3;break}return r=n[e],t.n=2,r.initialize(ui);case 2:e++,t.n=1;break;case 3:return t.n=4,sr.getUser();case 4:return a=t.v,t.n=5,pa.getLang();case 5:o=t.v,va.writeUserInfo(a,o),va.addExportDataBtnListener(),va.addBraceButtonListeners(),Wn.bindAutoClear(_t.HOME_PAGE.MESSAGE_ELEMENTS_LIST);case 6:return t.a(2)}},t)}))).apply(this,arguments)}function Ii(){return(Ii=wi(gi().m(function t(){return gi().w(function(t){for(;;)switch(t.n){case 0:document.addEventListener("DOMContentLoaded",wi(gi().m(function t(){var e;return gi().w(function(t){for(;;)switch(t.n){case 0:return Li(),t.n=1,mr.getState();case 1:if((e=t.v)!==er.LOAD_DATA){t.n=3;break}return e=er.SELECT_DATA,t.n=2,va.eraseUserFromPage();case 2:return t.n=3,mr.setState(e);case 3:return La.HOME_PAGE_STATE=e,t.n=4,Ri();case 4:if(t.v){t.n=5;break}return t.n=5,ui(e);case 5:tr.setVisibility(_t.HOME_PAGE.FOOTER_BODY,!0);case 6:return t.a(2)}},t)})));case 1:return t.a(2)}},t)}))).apply(this,arguments)}!function(){Ii.apply(this,arguments)}()})();