/*! For license information please see test.784bea1df455d8421b70.bundle.js.LICENSE.txt */
(()=>{"use strict";var e,t,n,r,a,o={40:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(412);async function a(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error: status: ${t.status}`);const n=await t.json();return Object.keys(n),n}catch(e){return console.error("Error fetching global user data:",e),null}}const o={fetchHeroJSON:async function(e=null){let t=await a("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_hero.json");return t?(e&&t[e]?t=t[e]:e&&!t[e]&&(console.error("Could not find hero data for language:",e),t=null),t):null},fetchUserJSON:async function(e){if(e=e.replace("world_",""),![...r.WB].some(t=>t.replace("world_","")===e))return console.error(`Could not find world code: ${e}`),null;const t=`https://static.smilegatemegaport.com/gameRecord/epic7/epic7_user_world_${e}.json`,n=await a(t);return n&&"object"==typeof n&&"users"in n&&Array.isArray(n.users)&&n.users.length,n},fetchArtifactJSON:async function(e=null){let t=await a("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_artifact.json"),n=null;if(t&&e&&"object"==typeof t&&e in t){let n=t;if(Array.isArray(n[e]))return n[e]}return n},fetchInfo:async function(e,t,n="en"){const r=new URLSearchParams({nick_no:e,world_code:t,lang:n});try{const e=await fetch("https://epic7.onstove.com/gg/gameApi/getUserInfo",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()});if(!e.ok)return console.error("Error fetching battle list:",e.status,e.statusText),null;return await e.json()}catch(e){return console.error("Request failed:",e),null}}}},54:(e,t,n)=>{n.d(t,{A:()=>p});var r=n(207);class a extends Error{constructor(e){super(e),this.name="Filter Syntax Exception"}}class o extends Error{constructor(e){super(e),this.name="Filter Type Exception"}}class s extends Error{constructor(e){super(e),this.name="Filter Validation Error"}}const i={"(":")","{":"}",'"':'"',"'":"'"},c={"'":'"','"':"'"},l=Object.fromEntries(Object.entries(i).filter(([e,t])=>e!==t).map(([e,t])=>[t,e]));function u(e){const t={};for(const n of e)t[n]=(t[n]||0)+1;return t}function f(e){return new Date(`${e}T00:00:00Z`)}const p={SyntaxException:a,TypeException:o,ValidationError:s,getCharCounts:u,tokenizeWithNestedEnclosures:function(e,t=" ",n=0,r=!0){const o=[];let s="",f=[];for(let p=0;p<e.length;p++){const _=e[p];if(t.includes(_)&&f.length===n)s&&(o.push(r?s.trim():s),s="");else if(l[_]){const t=l[_];if(f.length>n&&(s+=_),f[f.length-1]!==t){const t=u(e);throw(t["'"]||0)%2!=0||(t['"']||0)%2!=0?new a(`Error tokenizing: Unbalanced closing character at position ${p}; got string: '${e}' ; if a str type has quote characters in it, wrap it in the opposite quote character.`):new a(`Error tokenizing: Unbalanced closing character at position ${p}; got string: '${e}'`)}f.pop()}else f.length>=n&&(s+=_),!i[_]||c[_]&&f[f.length-1]===c[_]||(f[f.length-1]===i[_]&&_===i[_]?f.pop():f.push(_))}if(f.length>0)throw new Error(`Unbalanced enclosures in input string; unresolved characters from enclosure stack: [ ${f.join(", ")} ]`);return s&&o.push(r?s.trim():s),o},parseDate:function(e){if(!r.L.DATE_LITERAL_RE.test(e))throw new a(`Invalid date; must be in the format: YYYY-MM-DD ( regex: ${r.L.DATE_LITERAL_RE.source} ); got: '${e}'`);const t=f(e);if(isNaN(t.getTime()))throw new a(`Invalid date; could not be parsed as a valid date; got: '${e}'`);const n=t.toISOString().split("T")[0],[o,s,i]=n.split("-").map(Number);if(t.getUTCFullYear()!==o||t.getUTCMonth()+1!==s||t.getUTCDate()!==i)throw new a(`Invalid date; parsed date: ${t.toISOString()} does not match passed in string: ${e}`);return t.toISOString(),t.constructor.name,t},tryConvert:function(e,t,n,r=null){null===r&&(r=`Could not convert ${n} to ${t}`);try{return e(n)}catch(e){throw new o(`${r}: ${e.message}`)}},trimSurroundingQuotes:function(e){return e.replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")},castStringToUTCDate:f}},82:(e,t,n)=>{n.d(t,{j:()=>c});var r=n(836),a=n(412),o=n(771);function s(e,t,n){const r={user:e,filterStr:n,battles:{headers:[],rows:[]}};var o;return r.battles=(o=Object.values(t),{headers:a.se,rows:o.map(e=>a.se.map(t=>JSON.stringify(e[t])))}),r}function i(e){if(!e||"object"!=typeof e)throw new Error("Invalid upload: data is null, undefined, or not an object");if(!("user"in e))throw new Error("Invalid upload: missing 'user' field");if((0,o.l)(e.user),!("battles"in e))throw new Error("Invalid upload: missing 'battles' field");return function(e){if(!e||"object"!=typeof e)return!1;if(!("headers"in e)||!Array.isArray(e.headers))throw new Error("Invalid upload: missing headers field");if(e.headers.length!==a.se.length)throw new Error(`Invalid upload: expected ${a.se.length} headers, got ${e.headers.length}`);for(let t=0;t<a.se.length;t++)if(a.se[t]!==e.headers[t])throw new Error(`Invalid upload: headers do not match at index ${t}; expected ${a.se[t]}, got ${e.headers[t]}`);if(!("rows"in e)||!Array.isArray(e.rows))throw new Error("Invalid upload: missing rows field or rows is not an array");if(0===e.rows.length)throw new Error("Invalid upload: uploaded data has no battles");for(let t=0;t<e.rows.length;t++){const n=e.rows[t];if(n.length!==a.se.length)throw new Error(`Invalid upload: expected ${a.se.length} columns per row, got ${n.length} at index ${t}`)}}(e.battles),!0}const c={triggerDownload:async function(){const e=await r.n.UserManager.getUser();if(!e)throw new Error("User not found; cannot export data without an active user");const t=await r.n.ClientCache.getStats(),n=await r.n.ClientCache.getFilterStr()||void 0,a=t.areFiltersApplied?" Filtered":"";let o=t.areFiltersApplied?Object.values(t.filteredBattlesObj):t.battles;o=o||[];const i=await s(e,o,n),c=(new Date).toISOString().split("T")[0]||"";!function(e,t){const n=JSON.stringify(t),r=new Blob([n],{type:"application/json"}),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download=e.endsWith(".json")?e:`${e}.json`,o.click(),URL.revokeObjectURL(a)}(`${e.name} (${e.id})${a} ${c}`,i)},parseJSON:async function(e){!function(e,t=".json",n=60){if(!e.name.endsWith(".json"))throw new Error("File must be .json");const r=1024*n*1024;if(e.size>r)throw new Error(`File must be smaller than ${n}mb, got ${e.size/1048576}mb File.`)}(e);const t=await e.text(),n=JSON.parse(t);return i(n),n},restructureParsedUploadBattles:function(e){const t=[];for(const n of e.rows){const e={};a.se.forEach((t,r)=>{e[t]=n[r]}),t.push(e)}return function(e){const t=new Set(e.map(e=>e[a.Lx.P1_ID])),n=new Set(e.map(e=>e[a.Lx.P1_SERVER]));if(1!==t.size)throw new Error(`Invalid upload: Multiple P1 IDs found in upload: {${Array.from(t).join(", ")}}`);if(1!==n.size)throw new Error(`Invalid upload: Multiple P1 Servers found in upload: {${Array.from(n).join(", ")}}`);const r=n.values().next().value?.replace(/"|'/g,"");if(!r||!Object.values(a.DB).includes(r))throw new Error(`Invalid upload: Invalid P1 Server found in upload: '${r}'`)}(t),t}}},84:(e,t,n)=>{n.d(t,{S:()=>p});var r=n(834),a=n(528),o=n(207),s=n(469),i=n(411),c=n(971),l=n(54),u=n(667);function f(e){return function(e,t,n){for(let r of e)if(!t.has(r))throw new l.A.SyntaxException(`Invalid character within <${n}> ; ' ${r} ' is not allowed; got string: '${e}'`)}(e=e.replace(/[\n\t\r]/g," ").replace(/\s+/g," "),c.yL,"Main Filter String"),e=e.toLowerCase()}class p{_filters;rawString;preParsedString;references;constructor(){this._filters=[],this.rawString="",this.preParsedString="",this.references={HeroDicts:null,ARTIFACT_LOWERCASE_STRINGS_MAP:{},SEASON_DETAILS:[]}}async addReferences(e=null){if(null===(e=e||await a.A.getHeroDicts()))throw new Error("Hero Manager could not be retrieved to parse filters.");const t=await s.A.getSeasonDetails();if(null===t)throw new Error("Season Details could not be retrieved to parse filters.");const n=await r.A.getArtifactLowercaseNameMap();this.references={HeroDicts:e,ARTIFACT_LOWERCASE_STRINGS_MAP:n,SEASON_DETAILS:t}}getFilters(){return function(e){const t=[],n=[];for(const r of e)r instanceof i.y4?t.push(r):n.push(r);return[...t,...n]}(this._filters)}asString(){const e=c.RG;return`[\n${this._filters.map(t=>t.asString(e)).join(";\n")};\n]`}static async getFiltersFromCache(e=null){const t=await u.A.get(u.A.Keys.FILTER_STR);if(null===t)return[];return(await this.fromFilterStr(t,e)).getFilters()}static async fromFilterStr(e,t=null){const n=new p;return n.rawString=e,await n.addReferences(t),n.preParsedString=f(e),n._filters=n.parse(n.preParsedString),n}parseList(e){return e.reduce((e,t)=>(e.push(...this.parse(t)),e),[])}parse(e){if(""===(e=e.trim()))return[];if(e.includes(";")){const t=e.split(";");return this.parseList(t)}const t=e.split("(")[0].replace(/p[1-2]\./i,""),n=l.A.tokenizeWithNestedEnclosures(e,",",1,!0);switch(t){case i.eR.AND:case i.eR.OR:case i.eR.NOT:case i.eR.XOR:const r=function(e,t){for(const n of e)if(n instanceof i.y4)throw new l.A.SyntaxException(`Global filters not allowed in clause functions; got: ${n.asString()} from string: "${t}"`);return e.filter(e=>e instanceof i.Qo)}(this.parseList(n),e);return[new i.CO[t](...r)];case i.eR.LAST_N:return[new i.c2.LAST_N(e)];case i.eR.EQUIPMENT:case i.eR.ARTIFACT:case i.eR.CR:return[new i.CO[t](e,this.references)];default:if(o.L.FUNCTION_CALL_RE.test(e))throw new l.A.SyntaxException(`Filter String is not a valid function call but a parenthese block was detected; got: ${e}`);return[new i.c2.BASE_FILTER(e,this.references)]}}}},92:(e,t,n)=>{function r(e){return e.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())}function a(e){return e.reduce((e,t)=>(e[t]=(e[t]||0)+1,e),{})}n.d(t,{J:()=>a,S:()=>r})},121:(e,t,n)=>{n.d(t,{DG:()=>a.D,qD:()=>E});var r=n(667),a=(n(623),n(940),n(823));n(771),n(412);function o(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,r,a,o){var i=r&&r.prototype instanceof l?r:l,u=Object.create(i.prototype);return s(u,"_invoke",function(n,r,a){var o,s,i,l=0,u=a||[],f=!1,p={p:0,n:0,v:e,a:_,f:_.bind(e,4),d:function(t,n){return o=t,s=0,i=e,p.n=n,c}};function _(n,r){for(s=n,i=r,t=0;!f&&l&&!a&&t<u.length;t++){var a,o=u[t],_=p.p,E=o[2];n>3?(a=E===r)&&(i=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=_&&((a=n<2&&_<o[1])?(s=0,p.v=r,p.n=o[1]):_<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return c;throw f=!0,r}return function(a,u,E){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&_(u,E),s=u,i=E;(t=s<2?e:i)||!f;){o||(s?s<3?(s>1&&(p.n=-1),_(s,i)):p.n=i:p.v=i);try{if(l=2,o){if(s||(a="next"),t=o[a]){if(!(t=t.call(o,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((t=(f=p.n<0)?i:n.call(r,p))!==c)break}catch(t){o=e,s=1,i=t}finally{l=1}}return{value:t,done:f}}}(n,a,o),!0),u}var c={};function l(){}function u(){}function f(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(s(t={},r,function(){return this}),t),_=f.prototype=l.prototype=Object.create(p);function E(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,a,"GeneratorFunction")),e.prototype=Object.create(_),e}return u.prototype=f,s(_,"constructor",f),s(f,"constructor",u),u.displayName="GeneratorFunction",s(f,a,"GeneratorFunction"),s(_),s(_,a,"Generator"),s(_,r,function(){return this}),s(_,"toString",function(){return"[object Generator]"}),(o=function(){return{w:i,m:E}})()}function s(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}s=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var o=function(t,n){s(e,t,function(e){return this._invoke(t,n,e)})};o("next",0),o("throw",1),o("return",2)}},s(e,t,n,r)}function i(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)})}}var l=new Set(Object.values(a.D));function u(e){return!!l.has(e)||(console.error("Invalid page state: ".concat(e)),!1)}var f,p,_,E={getState:(_=c(o().m(function e(){var t,n,s,i;return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.A.get(r.A.Keys.HOME_PAGE_STATE);case 1:if(s=t=e.v,!(n=null!==s)){e.n=2;break}n=void 0!==t;case 2:if(!n){e.n=3;break}i=t,e.n=4;break;case 3:i=a.D.SELECT_DATA;case 4:return e.a(2,i)}},e)})),function(){return _.apply(this,arguments)}),setState:(p=c(o().m(function e(t){return o().w(function(e){for(;;)switch(e.n){case 0:if(u(t)){e.n=1;break}return e.a(2);case 1:return e.n=2,r.A.cache(r.A.Keys.HOME_PAGE_STATE,t);case 2:return e.a(2)}},e)})),function(e){return p.apply(this,arguments)}),resetState:(f=c(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.A.delete(r.A.Keys.HOME_PAGE_STATE);case 1:return e.a(2)}},e)})),function(){return f.apply(this,arguments)})}},136:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(667);const a={ACTIONS:{CLEAR_USER:"CLEAR_USER",SHOW_NO_USER_MSG:"SHOW_NO_USER_MSG",SHOW_DATA_ALREADY_CLEARED_MSG:"SHOW_DATA_ALREADY_CLEARED_MSG",QUERY_USER:"QUERY_USER",REFRESH_REFERENCES:"REFRESH_REFERENCES"},getState:async function(){return await r.A.get(r.A.Keys.INTER_PAGE_MANAGER)??{actions:[],messages:[]}},setState:async function(e){await r.A.cache(r.A.Keys.INTER_PAGE_MANAGER,e)},pushActions:async function(e){let t=await this.getState();t.actions.push(...e),await this.setState(t)},pushAction:async function(e){let t=await this.getState();t.actions.push(e),await this.setState(t)},makeAction:function(e,t){return{action:e,message:t}},flushState:async function(){const e=await this.getState();return await r.A.delete(r.A.Keys.INTER_PAGE_MANAGER),e}}},149:(e,t,n)=>{n.d(t,{W:()=>a});var r=n(836);const a={changeLang:async function(e){await r.n.ClientCache.setLang(e),await r.n.HeroManager.fetchAndCacheHeroManager(e),window.location.reload()},getLang:async function(){return await r.n.ClientCache.getLang()}}},172:(e,t,n)=>{n.d(t,{GF:()=>p,ev:()=>u});n(623);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,s=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw s}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function i(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}var l={RED:"text-danger",GREEN:"text-safe"},u=i(function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text=t,this.docElement=n,this.classList=r});function f(e){if(!e instanceof u)throw new Error("Only instances of TextPacket can be passed to this function")}var p={queue:[],autoClearElements:[],TextPacket:u,STYLES:l,clearStyles:function(e){for(var t=0,n=Object.values(l);t<n.length;t++){var r=n[t];e.classList.remove(r)}},write:function(e){f(e),e.docElement.textContent=e.text,this.clearStyles(e.docElement),e.classList.forEach(function(t){e.docElement.classList.add(t)})},push:function(e){f(e),this.queue.push(e)},pushFromObj:function(e){var t=e.text,n=e.docElement,r=e.classList;this.push(new u(t,n,r))},bindAutoClear:function(e){var t,n=a(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.autoClearElements.push(r)}}catch(e){n.e(e)}finally{n.f()}},processQueue:function(){var e=this;this.queue.forEach(function(t){e.write(t)}),this.queue=[]},clearMessages:function(){var e,t=a(this.autoClearElements);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.textContent="",this.clearStyles(n)}}catch(e){t.e(e)}finally{t.f()}}}},207:(e,t,n)=>{n.d(t,{L:()=>F});var r=n(833);function a(e,t="i"){return new RegExp(`^(?:${e.source})(?=[,)\\s;]|$)`,t)}function o(e,t="i"){return new RegExp(`^(?:${e.source})$`,t)}function s(e,t="i"){if(e.length<1)throw new Error("orRegex must have at least one pattern");let n=`(?:${e[0].source})`;for(let t=1;t<e.length;t++)n+=`|(?:${e[t].source})`;return new RegExp(n,t)}const i=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=Object.keys(r.j),l=new RegExp(`^(?:${c.map(i).join("|")})`,"i"),u=new RegExp(`(?:${["and","or","xor","not"].map(i).join("|")})(?=\\()`,"i"),f=new RegExp(`(?:${["last-n"].map(i).join("|")})(?=\\()`,"i"),p=new RegExp(`(?:${["p1.equipment","p2.equipment","p1.artifact","p2.artifact","p1.cr","p2.cr"].map(i).join("|")})(?=\\()`,"i"),_=s([u,f,p]),E=/.*/i,S=/\d{4}-\d{2}-\d{2}/,d=/\{\s*\}/,A=/-?\d+/,h=/season-[1-9]+[0-9]*f?|current-season|last-season/i,T=/pvp_rta_ss[1-9]+[0-9]*f?/i,m=new RegExp(`^${S.source}$`,"i"),g=new RegExp(`(?:${h.source})`,"i"),R=E.source,w=A.source,L=S.source,N=l.source,P=g.source,I=/"[^"]*"|'[^']*'/i,y=o(I),v=new RegExp(`(?:${I.source}|${R}|${L})`,"i"),O=new RegExp(`(?:${N}|${P})`,"i"),b=v.source,C=new RegExp(`\\{\\s*(?:${b}\\s*)(?:,\\s*${b}\\s*)*,?\\s*\\}|${d.source}`,"i"),x=new RegExp(`${w}\\.\\.\\.=?${w}|${L}\\.\\.\\.=?${L}`),D=new RegExp(`^${x.source}$`);let F={STRING_RE:E,DATE_RE:S,INT_RE:A,EMPTY_SET_RE:d,SET_ELEMENT_RE:v,SET_RE:C,SET_LITERAL_RE:o(C),STRING_LITERAL_RE:y,DATE_LITERAL_RE:m,INT_LITERAL_RE:/^-?\d+$/,BOOL_LITERAL_RE:/^(true|false)$/i,RANGE_RE:x,RANGE_LITERAL_RE:D,SEASON_RE:h,SEASON_LITERAL_RE:o(h),SEASON_CODE_RE:T,SEASON_CODE_LITERAL_RE:o(T),DATA_WORD_RE:g,DATA_WORD_LITERAL_RE:o(g),FIELD_WORD_RE:l,FIELD_WORD_LITERAL_RE:o(l),DATAFIELD_RE:O,GLOBAL_FILTER_RE:/last-n\(\d+\)/i,ANCHORED_STR_LITERAL_RE:o(y),CLAUSE_FUNCTIONS_RE:u,DIRECT_FUNCTIONS_RE:p,GLOBAL_FUNCTIONS_RE:f,FUNCTIONS_RE:_,FUNCTION_CALL_RE:/\(.*\)/i,padRegex:a,anchorExp:o,tokenMatch:function(e){return function(e){return e.match(_)?"keyword":e.match(/\s+(?:!=|<|>|=|>=|<=|in|!in)(?=\s+)/i)?"operator":e.match(new RegExp(`[a-z0-9."'}=)-]${O.source}(?=[,)\\s;]|$)`,"i"))?null:e.match(a(l))?"field":e.match(a(g))?"declared-data":e.match(a(I))?"string":e.match(a(C))?"set":e.match(a(x))?"range":e.match(/[^(,\s;.=0-9\-]+\d+/i)?null:e.match(a(A))||e.match(a(S))||e.match(/(?:^|\s)(?:true|false)(?=[,)\s;]|$)/i)?"declared-data":e.match(/[\(\)\{\}\;\,]/)?"bracket":(e.next(),null)}(e)},orRegex:s,escapeRegex:i}},275:(e,t,n)=>{function r(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function i(n,r,o,s){var i=r&&r.prototype instanceof l?r:l,u=Object.create(i.prototype);return a(u,"_invoke",function(n,r,a){var o,s,i,l=0,u=a||[],f=!1,p={p:0,n:0,v:e,a:_,f:_.bind(e,4),d:function(t,n){return o=t,s=0,i=e,p.n=n,c}};function _(n,r){for(s=n,i=r,t=0;!f&&l&&!a&&t<u.length;t++){var a,o=u[t],_=p.p,E=o[2];n>3?(a=E===r)&&(i=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=_&&((a=n<2&&_<o[1])?(s=0,p.v=r,p.n=o[1]):_<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return c;throw f=!0,r}return function(a,u,E){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&_(u,E),s=u,i=E;(t=s<2?e:i)||!f;){o||(s?s<3?(s>1&&(p.n=-1),_(s,i)):p.n=i:p.v=i);try{if(l=2,o){if(s||(a="next"),t=o[a]){if(!(t=t.call(o,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((t=(f=p.n<0)?i:n.call(r,p))!==c)break}catch(t){o=e,s=1,i=t}finally{l=1}}return{value:t,done:f}}}(n,o,s),!0),u}var c={};function l(){}function u(){}function f(){}t=Object.getPrototypeOf;var p=[][o]?t(t([][o]())):(a(t={},o,function(){return this}),t),_=f.prototype=l.prototype=Object.create(p);function E(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e}return u.prototype=f,a(_,"constructor",f),a(f,"constructor",u),u.displayName="GeneratorFunction",a(f,s,"GeneratorFunction"),a(_),a(_,s,"Generator"),a(_,o,function(){return this}),a(_,"toString",function(){return"[object Generator]"}),(r=function(){return{w:i,m:E}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var s=function(t,n){a(e,t,function(e){return this._invoke(t,n,e)})};s("next",0),s("throw",1),s("return",2)}},a(e,t,n,r)}function o(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var s=e.apply(t,n);function i(e){o(s,r,a,i,c,"next",e)}function c(e){o(s,r,a,i,c,"throw",e)}i(void 0)})}}n.d(t,{A:()=>_});var i,c,l,u,f,p;const _={test:function(e){e.rank_plot},fetchFromPython:(p=s(r().m(function e(t){var n,a;return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fetch(t);case 1:if((n=e.v).ok){e.n=3;break}return e.n=2,fetch(t);case 2:n=e.v;case 3:return e.n=4,n.json();case 4:return a=e.v,e.a(2,a||null)}},e)})),function(e){return p.apply(this,arguments)}),fetchHeroData:(f=s(r().m(function e(){return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.fetchFromPython("/api/get_hero_data");case 1:return e.a(2,e.v)}},e,this)})),function(){return f.apply(this,arguments)}),rsFetchBattleData:(u=s(r().m(function e(t){return r().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}throw new Error("Must pass user to fetch battles data");case 1:return e.n=2,fetch("/api/rs_get_battle_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:t})});case 2:return e.a(2,e.v)}},e)})),function(e){return u.apply(this,arguments)}),fetchSeasonDetails:(l=s(r().m(function e(){var t,n,a;return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fetch("/api/get_season_details");case 1:return t=e.v,e.n=2,t.json();case 2:if(!(n=e.v).success){e.n=3;break}return a=JSON.parse(n.seasonDetails),e.a(2,{seasonDetails:a,error:!1});case 3:return e.a(2,{seasonDetails:null,error:n.error});case 4:return e.a(2)}},e)})),function(){return l.apply(this,arguments)}),fetchArtifactJson:(c=s(r().m(function e(){var t,n,a;return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fetch("/api/get_artifact_json");case 1:return t=e.v,e.n=2,t.json();case 2:if(!(n=e.v).success){e.n=3;break}return a=JSON.parse(n.artifactJson),e.a(2,a);case 3:return e.a(2,null);case 4:return e.a(2)}},e)})),function(){return c.apply(this,arguments)}),fetchUser:(i=s(r().m(function e(t){var n,a,o;return r().w(function(e){for(;;)switch(e.n){case 0:if(t.name&&t.world_code||t.id){e.n=1;break}throw new Error("Must pass a user object with either user.name and user.world_code or user.id to fetch user");case 1:return e.n=2,fetch("/api/get_user_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userData:t})});case 2:return n=e.v,e.n=3,n.json();case 3:if(a=e.v,n.ok){e.n=4;break}throw new Error("Flask server error: ".concat(a.error));case 4:if(a.foundUser){e.n=6;break}if(t.world_code){e.n=5;break}return e.a(2,{user:null,ok:!0});case 5:return e.a(2,{user:null,ok:!0});case 6:return o=a.user,"Found user: ".concat(JSON.stringify(o)),e.a(2,{user:o,ok:!0})}},e)})),function(e){return i.apply(this,arguments)})}},319:(e,t,n)=>{n.d(t,{A$:()=>l,Qi:()=>i,aQ:()=>c});n(699);const r={">":(e,t)=>e>t,"<":(e,t)=>e<t,"=":(e,t)=>e===t,">=":(e,t)=>e>=t,"<=":(e,t)=>e<=t,"!=":(e,t)=>e!==t},a="in",o="compare";class s{}class i extends s{type=a;opStr;negate=!1;constructor(e=!1){super(),this.negate=e,this.opStr=this.negate?"!in":"in"}call(e,t){const n=Array.isArray(t)?t.includes(e):t.has(e);return this.negate?!n:n}}class c extends s{type=o;opStr;compareFn;constructor(e){if(super(),this.opStr=e,this.compareFn=r[e],!this.compareFn)throw new Error(`Unknown operator: ${e}`)}call(e,t){return this.compareFn(e,t)}}function l(e){switch(e){case"in":return new i;case"!in":return new i(!0);default:return new c(e)}}},334:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(667),a=n(913),o=n(933),s=n(411),i=n(412);function c(e,t){const n=t.filter(e=>e instanceof s.Qo),r=t.filter(e=>e instanceof s.y4);for(let t of r)t.asString(),e=t.call(e);for(let t of n)t.asString(),e=e.filter(e=>t.call(e));return e}const l={loaded_servers:new Set,getBattles:async function(){const e=await r.A.get(r.A.Keys.BATTLES)??null;return r.A.setTimeoutDataNow(r.A.Keys.BATTLES),e},applyFilters:c,extendBattles:async function(e){const t={...await r.A.get(r.A.Keys.BATTLES)??{},...this.sortBattlesObj(e)};return await r.A.cache(r.A.Keys.BATTLES,t),t},cacheQuery:async function(e,t,n){if(!e)return[];e.length;const r=(0,o.d)(e,t,n);return await this.extendBattles(r)},cacheUpload:async function(e,t){if(!e)return console.error("No uploaded battles provided to cacheUpload"),{};const n=(0,o.j)(e,t);return await this.extendBattles(n)},getStats:async function(e,t,n){const r=t.length,o=Object.values(e),s=c(o,t),l=r>0,u=await a.A.getPrebanStats(s,n),f=await a.A.getFirstPickStats(s,n),p=await a.A.getGeneralStats(s),_=await a.A.getHeroStats(s,n),E=await a.A.getPerformanceStats(s);return{battles:o,filteredBattlesObj:Object.fromEntries(s.map(e=>[e[i.Lx.SEQ_NUM],e])),prebanStats:u,generalStats:p,firstPickStats:f,playerHeroStats:_.playerHeroStats,enemyHeroStats:_.enemyHeroStats,performanceStats:E,numFilters:r,areFiltersApplied:l}},sortBattlesList:function(e,t=!0){const n=i.Lx.DATE_TIME;return t?e.sort((e,t)=>+new Date(e[n])-+new Date(t[n])):e.sort((e,t)=>+new Date(t[n])-+new Date(e[n]))},sortBattlesObj:function(e,t=!0){const n=i.Lx.DATE_TIME;if(t){let t=Object.values(e).sort((e,t)=>+new Date(e[n])-+new Date(t[n]));return Object.fromEntries(t.map(e=>[e[i.Lx.SEQ_NUM],e]))}{let t=Object.values(e).sort((e,t)=>+new Date(t[n])-+new Date(e[n]));return Object.fromEntries(t.map(e=>[e[i.Lx.SEQ_NUM],e]))}}}},411:(e,t,n)=>{n.d(t,{CO:()=>b,Qo:()=>d,c2:()=>C,eR:()=>u,y4:()=>I});var r=n(92),a=n(412),o=n(699),s=n(319),i=n(971),c=n(54),l=n(413);const u={AND:"and",OR:"or",XOR:"xor",NOT:"not",LAST_N:"last-n",EQUIPMENT:"equipment",ARTIFACT:"artifact",CR:"cr",BASE_FILTER:"base-filter"},f="CLAUSE_FN",p="HERO_LIST_FN",_="GLOBAL_FN",E="BASE_FILTER";class S{}class d extends S{}class A extends d{fnType=f;fns=[];constructor(...e){super(),this.fns=e}asString(e=""){let t="";const n=e+i.RG;return this.fns.forEach(e=>t+=`${e.asString(n)},\n`),`${e}${this.fnName}(\n${t.trimEnd()}\n${e})`}}class h extends A{fnName=u.AND;fnType=f;call(e){return this.fns.every(t=>t.call(e))}}class T extends A{fnName=u.OR;fnType=f;call(e){return this.fns.some(t=>t.call(e))}}class m extends A{fnName=u.XOR;fnType=f;call(e){let t=!1;for(let n of this.fns)t=!t&&n.call(e)||t&&!n.call(e);return t}}class g extends A{fnName=u.NOT;fnType=f;constructor(...e){if(super(...e),1!==this.fns.length)throw new c.A.SyntaxException(`Invalid NOT function call ; accepts exactly 1 argument ; got: [${this.fns}]`)}call(e){return!this.fns[0].call(e)}}class R extends d{fnType=p;getHeroes(e){return this.isPlayer1?e[a.Lx.P1_PICKS]:e[a.Lx.P2_PICKS]}asString(e=""){return`${e}${this.isPlayer1?"p1.":"p2."}${this.fnName}(${this.argFmtString})`}}class w extends R{fnName=u.CR;fnType=p;heroName;crThreshold=0;operator;targetField;isPlayer1=!1;argFmtString;constructor(e,t){super();const n=e.includes(",")?",":" ",r=c.A.tokenizeWithNestedEnclosures(e,n,1,!0);if(3!==r.length)throw new c.A.SyntaxException(`Invalid CR function call ; accepts exactly 3 arguments ; got: [${r}] from str: ${e}`);const i=parseInt(r[2]);if(isNaN(i))throw new c.A.TypeException(`Invalid CR function call ; third argument must be a valid integer literal ; got: '${r[2]}' from str: ${e}`);const u=(0,s.A$)(r[1]);if(!(u instanceof s.aQ))throw new c.A.TypeException(`Invalid CR function call ; second argument must be a valid comparison operator ; got: '${r[1]}' from str: ${e}`);this.heroName=new o.H3.StringLiteral(r[0],t,[l.xD.Hero]).data,this.crThreshold=i,this.operator=u,this.isPlayer1=e.includes("p1."),this.targetField=e=>e[a.Lx.CR_BAR],this.argFmtString=`${this.heroName} ${this.operator.opStr} ${this.crThreshold}`}call(e){const t=this.getHeroes(e),n=this.targetField(e).find(e=>e[0]===this.heroName);return!!n&&(!!t.includes(this.heroName)&&this.operator.call(n[1],this.crThreshold))}}function L(e,t){for(const n in e)if(e[n]>(t[n]||0))return!1;return!0}class N extends R{fnName=u.EQUIPMENT;fnType=p;heroName;targetEquipCounts;isPlayer1=!1;argFmtString;targetField;constructor(e,t){super();const n=c.A.tokenizeWithNestedEnclosures(e,",",1,!0);if(2!==n.length)throw new c.A.SyntaxException(`Invalid equipment function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${e}`);const s=n[1].includes("{")?n[1]:`{${n[1]}}`;let i=c.A.tokenizeWithNestedEnclosures(s,",",1,!0);i=i.map(e=>new o.H3.StringLiteral(e,t,[l.xD.Equipment]).data),this.targetEquipCounts=(0,r.J)(i),this.heroName=new o.H3.StringLiteral(n[0],t,[l.xD.Hero]).data,this.isPlayer1=e.includes("p1."),this.argFmtString=`${this.heroName}, {${i.join(",")}}`,this.targetField=e=>this.isPlayer1?e[a.Lx.P1_EQUIPMENT]:e[a.Lx.P2_EQUIPMENT]}call(e){const t=this.getHeroes(e),n=this.targetField(e);for(let e=0;e<t.length;e++)if(t[e]===this.heroName){const t=(0,r.J)(n[e]);return L(this.targetEquipCounts,t)}return!1}}class P extends R{fnName=u.ARTIFACT;fnType=p;heroName;targetArtifacts;isPlayer1=!1;argFmtString;targetField;constructor(e,t){super();const n=c.A.tokenizeWithNestedEnclosures(e,",",1,!0);if(2!==n.length)throw new c.A.SyntaxException(`Invalid artifact function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${e}`);const r=n[1].includes("{")?n[1]:`{${n[1]}}`;let s=c.A.tokenizeWithNestedEnclosures(r,",",1,!0);s=s.map(e=>new o.H3.StringLiteral(e,t,[l.xD.Artifact]).data),this.targetArtifacts=s,this.heroName=new o.H3.StringLiteral(n[0],t,[l.xD.Hero]).data,this.isPlayer1=e.includes("p1."),this.argFmtString=`${this.heroName}, {${s.join(", ")}}`,this.targetField=e=>this.isPlayer1?e[a.Lx.P1_ARTIFACTS]:e[a.Lx.P2_ARTIFACTS]}call(e){const t=this.getHeroes(e),n=this.targetField(e);for(let e=0;e<t.length;e++)if(t[e]===this.heroName)return this.targetArtifacts.some(t=>n[e].includes(t));return!1}}class I extends S{fnType=_;asString(e=""){return`${e}${this.fnName}(${this.argFmtString})`}}class y extends I{fnName=u.LAST_N;fnType=_;argFmtString;n;constructor(e){super();const t=c.A.tokenizeWithNestedEnclosures(e,",",1,!0);if(1!==t.length)throw new c.A.SyntaxException(`Invalid last-n function call ; accepts exactly 1 argument ; got: [${t}] from str: ${e}`);this.n=new o.H3.IntLiteral(t[0]).data,this.argFmtString=`${this.n}`}call(e){return e.slice(-this.n)}}function v(e,t,n){const r=`${e.asString()} ${t.opStr} ${n.asString()}`;if(e instanceof o.H3.Field&&n instanceof o.H3.Field)throw new c.A.ValidationError(`Invalid base filter; fields cannot be compared with other fields ; got string: [${r}]`);if(e.type!==o.H3.BaseEltTypes.FIELD&&n.type!==o.H3.BaseEltTypes.FIELD)throw new c.A.ValidationError(`Invalid base filter; every base filter must have at least one field ; got string: [${r}]`);if(t instanceof s.Qi&&(a=n,!(o.H3.COLLECTION_FIELDS_SET.has(a.rawString)||n instanceof o.H3.RangeLiteral||n instanceof o.H3.SetLiteral)))throw new c.A.ValidationError(`Invalid base filter; 'in' operators can only be used with Ranges, Sets, or Fields that correspond to sets like 'p1.picks' ; got string: [${r}]`);var a;return!0}class O extends d{fnType=E;fnName=u.BASE_FILTER;fmtString;fn;constructor(e,t){super();const n=c.A.tokenizeWithNestedEnclosures(e," ",0,!0);if(3!==n.length)throw new c.A.SyntaxException(`Invalid base filter; filters must have 3 tokens and be of the form: ['X', operator, 'Y']; got tokens: [${n}] from str: ${e}`);let[r,a,i]=n;const l=(0,s.A$)(a),u=o.H3.parseBaseElement(r,t),f=o.H3.parseBaseElement(i,t);if(u.asString(),f.asString(),v(u,l,f),u instanceof o.H3.Field&&!(f instanceof o.H3.Field))this.fn=e=>l.call(u.extractData(e),f.getData());else{if(u instanceof o.H3.Field||!(f instanceof o.H3.Field))throw new c.A.ValidationError("Invalid base filter; filters must contain a Field and a Literal; got: "+e);this.fn=e=>l.call(u.getData(),f.extractData(e))}this.fmtString=`${u.asString()} ${a} ${f.asString()}`}call(e){return this.fn(e)}asString(e=""){return`${e}${this.fmtString}`}}const b={[u.BASE_FILTER]:O,[u.AND]:h,[u.OR]:T,[u.NOT]:g,[u.XOR]:m,[u.LAST_N]:y,[u.EQUIPMENT]:N,[u.ARTIFACT]:P,[u.CR]:w},C={AND:h,OR:T,NOT:g,XOR:m,LAST_N:y,EQUIPMENT:N,ARTIFACT:P,CR:w,BASE_FILTER:O}},412:(e,t,n)=>{n.d(t,{$k:()=>i,D5:()=>_,DB:()=>s,F4:()=>E,F7:()=>o,Lx:()=>f,W4:()=>S,WB:()=>a,Yj:()=>r,bh:()=>d,hc:()=>l,pc:()=>u,pg:()=>c,se:()=>p});const r={CODES:{DE:"de",KO:"ko",PT:"pt",TH:"th",ZH_TW:"zh-TW",JA:"ja",EN:"en",FR:"fr",ZH_CN:"zh-CN",ES:"es"},NAMES:{DE:"German",KO:"Korean",PT:"Portuguese",TH:"Thai",ZH_TW:"Chinese (Traditional, Taiwan)",JA:"Japanese",EN:"English",FR:"French",ZH_CN:"Chinese (Simplified, China)",ES:"Spanish"}},a=new Set(["world_kor","world_global","world_jpn","world_asia","world_eu"]),o={GLOBAL:"world_global",KOR:"world_kor",JPN:"world_jpn",ASIA:"world_asia",EU:"world_eu"},s={[o.GLOBAL]:"Global",[o.KOR]:"Korea",[o.JPN]:"Japan",[o.ASIA]:"Asia",[o.EU]:"Europe"},i=(s.world_global,o.GLOBAL,s.world_kor,o.KOR,s.world_jpn,o.JPN,s.world_asia,o.ASIA,s.world_eu,o.EU,Object.fromEntries(Object.values(s).map(e=>[e.toLowerCase(),e]))),c={set_speed:"Speed",set_acc:"Hit",set_cri:"Critical",set_res:"Resist",set_def:"Defense",set_att:"Attack",set_max_hp:"Health",set_cri_dmg:"Destruction",set_coop:"Unity",set_immune:"Immunity",set_rage:"Rage",set_vampire:"Lifesteal",set_shield:"Protection",set_revenge:"Revenge",set_penetrate:"Penetration",set_torrent:"Torrent",set_counter:"Counter",set_scar:"Injury"},l=864e5,u={bronze:"Bronze",silver:"Silver",gold:"Gold",master:"Master",challenger:"Challenger",champion:"Champion",warlord:"Warlord",emperor:"Emperor",legend:"Legend"},f={SEASON:"Season",SEASON_CODE:"Season Code",DATE_TIME:"Date/Time",SECONDS:"Seconds",TURNS:"Turns",SEQ_NUM:"Seq Num",P1_ID:"P1 ID",P1_SERVER:"P1 Server",P2_ID:"P2 ID",P2_SERVER:"P2 Server",P1_LEAGUE:"P1 League",P2_LEAGUE:"P2 League",P1_POINTS:"P1 Points",POINT_GAIN:"Point Gain",WIN:"Win",FIRST_PICK:"First Pick",FIRST_TURN:"First Turn",FIRST_TURN_HERO:"First Turn Hero",CR_BAR:"CR Bar",P1_PREBANS:"P1 Prebans",P2_PREBANS:"P2 Prebans",P1_PICKS:"P1 Picks",P2_PICKS:"P2 Picks",P1_POSTBAN:"P1 Postban",P2_POSTBAN:"P2 Postban",P1_EQUIPMENT:"P1 Equipment",P2_EQUIPMENT:"P2 Equipment",P1_ARTIFACTS:"P1 Artifacts",P2_ARTIFACTS:"P2 Artifacts",P1_MVP:"P1 MVP",P2_MVP:"P2 MVP",P1_PICKS_PRIMES:"P1 Picks Primes",P2_PICKS_PRIMES:"P2 Picks Primes",P1_PREBANS_PRIMES:"P1 Prebans Primes",P2_PREBANS_PRIMES:"P2 Prebans Primes"},p=(Object.values(f).filter(e=>!e.toLowerCase().includes("prime")),Object.values(f).filter(e=>!e.toLowerCase().includes("prime"))),_=(f.P1_EQUIPMENT,f.P2_EQUIPMENT,f.P1_ARTIFACTS,f.P2_ARTIFACTS,f.CR_BAR,f.P1_PREBANS,f.P2_PREBANS,f.P1_PICKS,f.P2_PICKS,f.FIRST_PICK,f.FIRST_TURN,f.WIN,f.SECONDS,f.TURNS,f.P1_POINTS,f.POINT_GAIN,f.P1_LEAGUE,f.P2_LEAGUE,{HERO_NAME:"Hero Name",BATTLES:"Battles",PICK_RATE:"Pick Rate",WINS:"Wins",WIN_RATE:"Win rate",POSTBANS:"Postbans",POSTBAN_RATE:"Postban Rate",SUCCESS_RATE:"Success Rate",PLUS_MINUS:"+/-",POINT_GAIN:"Point Gain",AVG_CR:"Avg CR",FIRST_TURNS:"First Turns",FIRST_TURN_RATE:"First Turn Rate"}),E="https://epic7.onstove.com",S=E+"/gg";const d=function(e){const t=new Uint8Array(e+1),n=[];for(let r=2;r<=e;r++)if(!t[r]){n.push(r);for(let n=r*r;n<=e;n+=r)t[n]=1}return n}(3e4)},413:(e,t,n)=>{n.d(t,{QV:()=>c,xD:()=>l});var r=n(528),a=n(412),o=n(971),s=n(207);class i{}function c(e,t,n){for(const r of n){const n=r.parse(e,t);if(r.parserType,n)return n}return null}const l={Hero:new class extends i{parse(e,t){return r.A.getHeroByName(e,t.HeroDicts)?.name??null}parserType="Hero"},League:new class extends i{parse(e){return a.pc,a.pc[e]}parserType="League"},Server:new class extends i{parse(e){return a.$k[e]}parserType="Server"},Equipment:new class extends i{parse(e){return o.Nk[e.toLowerCase()]}parserType="Equipment"},Artifact:new class extends i{parse(e,t){return t.ARTIFACT_LOWERCASE_STRINGS_MAP[e.toLowerCase()]}parserType="Artifact"},Season:new class extends i{parse(e,t){let n;if("current-season"===e)return t.SEASON_DETAILS[0].Code;if("last-season"===e)return t.SEASON_DETAILS[1].Code;if(s.L.SEASON_LITERAL_RE.test(e))n=e.split("-").at(-1);else{if(!s.L.SEASON_CODE_LITERAL_RE.test(e))return null;n=e.split("_ss").at(-1)}t.SEASON_DETAILS.map(e=>e.Code.split("_").at(-1));return t.SEASON_DETAILS.find(e=>e.Code.split("_ss").at(-1)===n)?.Code}parserType="Season Code"}}},442:(e,t,n)=>{n.a(e,async(e,t)=>{try{var r=n(836),a=n(493),o=n(874);function s(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var s=r&&r.prototype instanceof l?r:l,u=Object.create(s.prototype);return i(u,"_invoke",function(n,r,a){var o,s,i,l=0,u=a||[],f=!1,p={p:0,n:0,v:e,a:_,f:_.bind(e,4),d:function(t,n){return o=t,s=0,i=e,p.n=n,c}};function _(n,r){for(s=n,i=r,t=0;!f&&l&&!a&&t<u.length;t++){var a,o=u[t],_=p.p,E=o[2];n>3?(a=E===r)&&(i=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=_&&((a=n<2&&_<o[1])?(s=0,p.v=r,p.n=o[1]):_<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,s=0))}if(a||n>1)return c;throw f=!0,r}return function(a,u,E){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&_(u,E),s=u,i=E;(t=s<2?e:i)||!f;){o||(s?s<3?(s>1&&(p.n=-1),_(s,i)):p.n=i:p.v=i);try{if(l=2,o){if(s||(a="next"),t=o[a]){if(!(t=t.call(o,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((t=(f=p.n<0)?i:n.call(r,p))!==c)break}catch(t){o=e,s=1,i=t}finally{l=1}}return{value:t,done:f}}}(n,a,o),!0),u}var c={};function l(){}function u(){}function f(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(i(t={},r,function(){return this}),t),_=f.prototype=l.prototype=Object.create(p);function E(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,i(e,a,"GeneratorFunction")),e.prototype=Object.create(_),e}return u.prototype=f,i(_,"constructor",f),i(f,"constructor",u),u.displayName="GeneratorFunction",i(f,a,"GeneratorFunction"),i(_),i(_,a,"Generator"),i(_,r,function(){return this}),i(_,"toString",function(){return"[object Generator]"}),(s=function(){return{w:o,m:E}})()}function i(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}i=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var o=function(t,n){i(e,t,function(e){return this._invoke(t,n,e)})};o("next",0),o("throw",1),o("return",2)}},i(e,t,n,r)}function c(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function l(){return u.apply(this,arguments)}function u(){var e;return e=s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.n.ClientCache.clearReferenceData();case 1:return e.n=2,o.Su.initialize();case 2:return e.n=3,(0,a.N$)();case 3:return e.a(2)}},e)}),u=function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function s(e){c(o,r,a,s,i,"next",e)}function i(e){c(o,r,a,s,i,"throw",e)}s(void 0)})},u.apply(this,arguments)}await l(),t()}catch(f){t(f)}},1)},469:(e,t,n)=>{n.d(t,{A:()=>c});var r=n(667),a=n(275),o=n(412),s=n(207);let i={fetchAndCacheSeasonDetails:async function(){const e=await a.A.fetchSeasonDetails();if(e.error)throw new Error(`Could not fetch season details: ${e.error}`);const t=e.seasonDetails;t.forEach(e=>{e.range=[e.Start,e.End].map(e=>new Date(`${e.split(" ")[0]}T00:00:00`)),e["Season Number"]=String(e["Season Number"])}),t.sort((e,t)=>parseInt(e["Season Number"])-parseInt(t["Season Number"]));const n=[t[0]];let s=t[0];if(t.slice(1).forEach(e=>{const[t,r]=[new Date(+s.range[1]+o.hc),new Date(+e.range[0]-o.hc)],a=s["Season Number"]+"f",i={"Season Number":a,Code:"pvp_rta_ss"+a,Season:`Pre ${e.Season}`,Start:t.toISOString().slice(0,10),End:r.toISOString().slice(0,10),Status:"Complete",range:[t,r]};n.push(i),n.push(e),s=e}),s.range[1]<new Date){const e=new Date(+s.range[1]+o.hc),t=s["Season Number"]+"f",r={"Season Number":t,Code:"pvp_rta_ss"+t,Season:"Active Pre-Season",Start:e.toISOString().slice(0,10),End:"N/A",Status:"Active",range:[e,new Date]};n.push(r)}return n.reverse(),await r.A.cache(r.A.Keys.SEASON_DETAILS,n),n},getSeasonDetails:async function(){const e=await r.A.get(r.A.Keys.SEASON_DETAILS);return e||await i.fetchAndCacheSeasonDetails()},clearSeasonDetails:async function(){await r.A.delete(r.A.Keys.SEASON_DETAILS)},getSeasonNumFromCode:function(e){return e.split("_")[-1]},reaquireIfNeeded:async function(e){const t=await i.getSeasonDetails(),n=new Set(t.map(e=>e.Code));e.forEach(e=>{const t=e[o.Lx.SEASON_CODE];s.L.SEASON_CODE_LITERAL_RE.test(t)||console.error("Battle contains invalid season code:",t,e),n.has(e[o.Lx.SEASON_CODE])||i.fetchAndCacheSeasonDetails()})}};const c=i},493:(e,t,n)=>{n.d(t,{N$:()=>M});var r=n(836),a=n(84),o=n(334),s=n(412),i=n(913);const c=i.A.computeGenericStats,l=e=>e.reduce((e,t)=>e+ +t.Win,0),u=e=>l(e)/e.length,f=e=>2*l(e)-e.length;function p(e){return new Set(function(e){return e.map(e=>Number(e[s.Lx.SEQ_NUM]))}(e))}function _(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function E(e){const t={};for(const n of e){const e=n.toString();t[e]=(t[e]||0)+1}return t}function S(e,t,n,r=!0){return e.filter(e=>r?n.includes(e[t]):!n.includes(e[t]))}function d(e,t,n,r=!0){return e.filter(e=>r?n(e[t]):!n(e[t]))}function A(e,t){return e.filter(e=>!t.has(Number(e[s.Lx.SEQ_NUM])))}function h({battles:e,crEvalFn:t,heroName:n}){return e.filter(e=>{const r=e[s.Lx.CR_BAR].find(e=>e[0]===n);return!!r&&t(r[1])})}function T(e,{heroNames:t,pick:n,isP1:r}){const a=r?s.Lx.P1_PICKS:s.Lx.P2_PICKS;return e.filter(e=>{const r=e[a][n-1];return t.includes(r)})}function m({battles:e,heroName:t,isP1:n}){const r=n?s.Lx.P1_PICKS:s.Lx.P2_PICKS;return e.filter(e=>e[r].includes(t))}function g({battle:e,heroName:t,isP1:n}){return e[n?s.Lx.P1_PICKS:s.Lx.P2_PICKS].indexOf(t)}function R({battles:e,heroName:t,targetEquipVec:n,isP1:r}){const a=r?s.Lx.P1_EQUIPMENT:s.Lx.P2_EQUIPMENT;return e.filter(e=>{const o=e[a],s=g({battle:e,heroName:t,isP1:r});return-1!==s&&function(e,t){const n=Array.from(e),r=Array.from(t),a=E(n),o=E(r);for(const e in a){if(!(e in o))return!1;if(o[e]<a[e])return!1}return!0}(n,o[s])})}function w({battles:e,heroName:t,artifactNames:n,isP1:r}){const a=r?s.Lx.P1_ARTIFACTS:s.Lx.P2_ARTIFACTS;return e.filter(e=>{const o=e[a],s=g({battle:e,heroName:t,isP1:r});if(-1===s)return!1;const i=o[s];return n.includes(i)})}function L(e,t){const n=e[s.Lx.CR_BAR].find(e=>e[0]===t);return n?n[1]:null}function N(e,t){let n=0;for(const r of e){const e=L(r,t);null!==e&&(n+=e)}return i.A.divideToPercentString(n/100,e.length)}function P(e,t){const n=e.filter(e=>e[s.Lx.FIRST_TURN_HERO]===t).length;return i.A.divideToPercentString(n,e.length)}function I(e,t){return[...e,...t]}const y=[{name:"isWinTrue",filterStr:"is-win = true;",eval:(e,t)=>_(p(d(e,s.Lx.WIN,e=>!0===e)),p(t))},{name:"notFirstPick",filterStr:"is-first-pick != false;",eval:(e,t)=>_(p(d(e,s.Lx.FIRST_PICK,e=>!1!==e)),p(t))},{name:"highVictoryPoints",filterStr:"victory-points > 2500;",eval:(e,t)=>_(p(d(e,s.Lx.P1_POINTS,e=>e>2500)),p(t))},{name:"shortBattle",filterStr:"turns <= 10;",eval:(e,t)=>_(p(d(e,s.Lx.TURNS,e=>e<=10)),p(t))},{name:"negativePointGain",filterStr:"point-gain < 0;",eval:(e,t)=>_(p(d(e,s.Lx.POINT_GAIN,e=>e<0)),p(t))},{name:"after2025Aug",filterStr:"date >= 2025-08-01;",eval:(e,t)=>_(p(d(e,s.Lx.DATE_TIME,e=>e.slice(0,10)>="2025-08-01")),p(t))},{name:"july2025Range",filterStr:"date in 2025-07-01...2025-07-31;",eval:(e,t)=>{const n=d(e,s.Lx.DATE_TIME,e=>e.slice(0,10)>="2025-07-01"&&e.slice(0,10)<"2025-07-31");return _(p(n),p(t))}},{name:"p2LeagueChampion",filterStr:'p2.league = "champion";',eval:(e,t)=>_(p(d(e,s.Lx.P2_LEAGUE,e=>"Champion"===e)),p(t))},{name:"notZioFirstTurn",filterStr:"first-turn-hero != 'Zio';",eval:(e,t)=>_(p(d(e,s.Lx.FIRST_TURN_HERO,e=>"Zio"===e,!1)),p(t))},{name:"p1serverGlobal",filterStr:'p1.server = "Global";',eval:(e,t)=>_(p(d(e,s.Lx.P1_SERVER,e=>"Global"===e)),p(t))},{name:"p2serverGlobal",filterStr:'p2.server = "Global";',eval:(e,t)=>_(p(d(e,s.Lx.P2_SERVER,e=>"Global"===e)),p(t))},{name:"rinakInPrebans",filterStr:'"Rinak" in prebans;',eval:(e,t)=>_(p(I(d(e,s.Lx.P1_PREBANS,e=>e.includes("Rinak")),d(e,s.Lx.P2_PREBANS,e=>e.includes("Rinak")))),p(t))},{name:"peiraNotInP2Picks",filterStr:'"Lone Wolf Peira" !in p2.picks;',eval:(e,t)=>{const n=A(e,p(m({battles:e,heroName:"Lone Wolf Peira",isP1:!1})));return _(p(n),p(t))}},{name:"pick1InSet",filterStr:'p1.pick1 in { "Lone Wolf Peira", "Boss Arunka"};',eval:(e,t)=>_(p(T(e,{heroNames:["Lone Wolf Peira","Boss Arunka"],pick:1,isP1:!0})),p(t))},{name:"Season 17f",filterStr:"season = season-17f;",eval:(e,t)=>_(p(d(e,s.Lx.SEASON_CODE,e=>e.includes("17f"))),p(t))},{name:"Season 17",filterStr:"season = season-17;",eval:(e,t)=>_(p(d(e,s.Lx.SEASON_CODE,e=>"pvp_rta_ss17"===e)),p(t))},{name:"Season Code Set",filterStr:'season in { "pvp_rta_ss17", "pvp_rta_ss17f" };',eval:(e,t)=>_(p(d(e,s.Lx.SEASON_CODE,e=>"pvp_rta_ss17"===e||"pvp_rta_ss17f"===e)),p(t))},{name:"victoryPointsRange",filterStr:"victory-points in 2400...=2600;",eval:(e,t)=>_(p(d(e,s.Lx.P1_POINTS,e=>e>=2400&&e<=2600)),p(t))},{name:"dateNotInRange",filterStr:"date !in 2025-07-15...=2025-07-31;",eval:(e,t)=>_(p(d(e,s.Lx.DATE_TIME,e=>!(e.slice(0,10)>="2025-07-15"&&e.slice(0,10)<="2025-07-31"))),p(t))},{name:"andExample",filterStr:'AND(is-win = true, p2.league = "Champion", victory-points > 2400);',eval:(e,t)=>{const n=S(e,s.Lx.WIN,[!0]);return _(p(d(S(n,s.Lx.P2_LEAGUE,["Champion"]),s.Lx.P1_POINTS,e=>e>2400)),p(t))}},{name:"orExample",filterStr:'OR(p2.server = "Global", p2.server = "Asia", p2.server = "Europe");',eval:(e,t)=>_(p(S(e,s.Lx.P2_SERVER,["Global","Asia","Europe"])),p(t))},{name:"xorExample",filterStr:"XOR(is-first-pick = true, is-first-turn = true);",eval:(e,t)=>{const n=S(e,s.Lx.FIRST_PICK,[!0]),r=S(e,s.Lx.FIRST_TURN,[!0]),a=p(n),o=p(r);return _(a.difference(o).union(o.difference(a)),p(t))}},{name:"notExample",filterStr:"NOT(is-win = true);",eval:(e,t)=>_(p(S(e,s.Lx.WIN,[!0],!1)),p(t))},{name:"notPickExample",filterStr:'NOT(p1.pick1 = "Arbiter Vildred");',eval:(e,t)=>{const n=A(e,p(T(e,{pick:1,heroNames:["Arbiter Vildred"],isP1:!0})));return _(p(n),p(t))}},{name:"nestedAndOr",filterStr:'AND(OR(is-win = true, point-gain > 0), NOT(p2.league = "challenger"));',eval:(e,t)=>{const n=S(e,s.Lx.P2_LEAGUE,[s.pc.challenger],!1);return _(p(I(S(n,s.Lx.WIN,[!0]),d(n,s.Lx.POINT_GAIN,e=>e>0))),p(t))}},{name:"equipmentExample1",filterStr:'p1.equipment("Arbiter Vildred", {Torrent, Torrent, Immunity});',eval:(e,t)=>{const n=R({battles:e,heroName:"Arbiter Vildred",targetEquipVec:["Torrent","Torrent","Immunity"],isP1:!0});return _(p(n),p(t))}},{name:"equipmentExample2",filterStr:'p1.equipment("Arbiter Vildred", {Torrent, Torrent, Torrent});',eval:(e,t)=>_(p(R({battles:e,heroName:"Arbiter Vildred",targetEquipVec:["Torrent","Torrent","Torrent"],isP1:!0})),p(t))},{name:"equipmentExampleBelian",filterStr:'p1.equipment("Belian", {Counter, Immunity,});',eval:(e,t)=>_(p(R({battles:e,heroName:"Belian",targetEquipVec:["Counter","Immunity"],isP1:!0})),p(t))},{name:"equipmentSingle",filterStr:'p2.equipment("Lone Wolf Peira", "Speed");',eval:(e,t)=>_(p(R({battles:e,heroName:"Lone Wolf Peira",targetEquipVec:["Speed"],isP1:!1})),p(t))},{name:"artifactSingle",filterStr:'p1.artifact("Arbiter Vildred", "Alexa\'s Basket");',eval:(e,t)=>_(p(w({battles:e,heroName:"Arbiter Vildred",artifactNames:["Alexa's Basket"],isP1:!0})),p(t))},{name:"artifactSet",filterStr:'p2.artifact("Abyssal Yufine", {"Elbris Ritual Sword", "Aurius"});',eval:(e,t)=>{const n=w({battles:e,heroName:"Abyssal Yufine",artifactNames:["Elbris Ritual Sword","Aurius"],isP1:!1});return _(p(n),p(t))}},{name:"crEqual",filterStr:'p2.cr("Harsetti" = 100);',eval:(e,t)=>_(p(m({battles:h({battles:e,crEvalFn:e=>100===e,heroName:"Harsetti"}),heroName:"Harsetti",isP1:!1})),p(t))},{name:"crGreater",filterStr:'p1.cr("Amid", > , 95);',eval:(e,t)=>_(p(m({battles:h({battles:e,crEvalFn:e=>e>95,heroName:"Amid"}),heroName:"Amid",isP1:!0})),p(t))},{name:"last100",filterStr:"last-N(100);",eval:(e,t)=>{e=structuredClone(e),e=o.A.sortBattlesList(e,!1),t=o.A.sortBattlesList(t,!1);return _(p(e.slice(0,100)),p(t))}},{name:"last10",filterStr:"last-N(10);",eval:(e,t)=>{e=structuredClone(e);const n=(e=o.A.sortBattlesList(e,!1)).slice(0,10);return _(p(n),p(t))}},{name:"semicolonChain",filterStr:'is-win = true; p2.league = "Champion"; last-N(100);',eval:(e,t)=>{const n=S((e=o.A.sortBattlesList(e,!1)).slice(0,100),s.Lx.P2_LEAGUE,[s.pc.champion]);return _(p(S(n,s.Lx.WIN,[!0])),p(t))}},{name:"commasInOr",filterStr:'OR(p2.server = "Global", p2.server = "Asia");',eval:(e,t)=>_(p(S(e,s.Lx.P2_SERVER,["Global","Asia"])),p(t))},{name:"setWithStrings",filterStr:'p1.pick3 in {Zio, "Amid", "Lionheart Cermia"};',eval:(e,t)=>_(p(T(e,{heroNames:["Zio","Amid","Lionheart Cermia"],pick:3,isP1:!0})),p(t))},{name:"parenthesesNot",filterStr:"NOT(is-first-turn = true);",eval:(e,t)=>_(p(S(e,s.Lx.FIRST_TURN,[!1])),p(t))},{name:"nestedParentheses",filterStr:'AND(is-win = true, OR(p2.server = "Global", p2.server = "Korea"));',eval:(e,t)=>{const n=S(e,s.Lx.WIN,[!0]);return _(p(I(S(n,s.Lx.P2_SERVER,["Global"]),S(n,s.Lx.P2_SERVER,["Korea"]))),p(t))}},{name:"braceHeroSet",filterStr:'p1.pick1 in {"Abyssal Yufine", "New Moon luna"};',eval:(e,t)=>{const n=T(e,{heroNames:["Abyssal Yufine","New Moon Luna"],pick:1,isP1:!0});return _(p(n),p(t))}},{name:"braceVictoryPoints",filterStr:"victory-points in {1646, 1668};",eval:(e,t)=>_(p(S(e,s.Lx.P1_POINTS,[1646,1668])),p(t))},{name:"braceDateSet",filterStr:"date in {2025-01-01, 2025-01-05, 2025-01-07};",eval:(e,t)=>{const n=function(e,t){return e.filter(e=>t.includes(e[s.Lx.DATE_TIME].slice(0,10)))}(e,["2025-01-01","2025-01-05","2025-01-07"]);return _(p(n),p(t))}},{name:"trailingSetComma",filterStr:'p1.pick1 in { "Lone Wolf Peira", "Boss Arunka", };',eval:(e,t)=>_(p(T(e,{heroNames:["Lone Wolf Peira","Boss Arunka"],pick:1,isP1:!0})),p(t))}],v=[{name:"Total Win Rate",filterStr:"is-win = true;",eval:(e,t)=>[u(t),c(e,t.length).wins/t.length]},{name:"Global Server Win Rate",filterStr:'p2.server = "Global"',eval:(e,t)=>{const n=u(t),r=e.filter(e=>e[s.Lx.P2_SERVER]===s.DB[s.F7.GLOBAL]);return[n,c(r,r.length).wins/r.length]}},{name:"Champion Opponent Second Pick Win Rate",filterStr:'p2.league = "Champion"; is-win = true; is-first-pick = false',eval:(e,t)=>{const n=d(S(e,s.Lx.P2_LEAGUE,[s.pc.champion]),s.Lx.FIRST_PICK,e=>!e),r=i.A.divideToPercentString(t.length,n.length),a=i.A.getPerformanceStats(e).find(e=>e.label.toLowerCase().includes("champion"));if(!a)return[r,"Champ Stats not found"];return[r,a.sp_wr]}},{name:"Boss Arunka +/-",filterStr:'"Boss Arunka" in p1.picks;',eval:(e,t)=>{const n=f(t),r=e.filter(e=>e[s.Lx.P1_PICKS].includes("Boss Arunka"));return[n,c(r,r.length).plusMinus]}},{name:"Preban Harsetti",filterStr:'"harsetti" in p1.prebans',eval:(e,t,n)=>{const r=f(t),a=i.A.getPrebanStats(e,n).find(e=>"harsetti"===e.preban.toLowerCase());let o;return o=a?a["+/-"]:0,[r,o]}},{name:"Preban Rinak Arunka",filterStr:'"boss arunka" in p1.prebans; "rinak" in p1.prebans;',eval:(e,t,n)=>{let r=f(t)+u(t);isNaN(r)&&(r=0);const a=i.A.getPrebanStats(e,n).find(e=>{const t=e.preban.toLowerCase();return t.includes("rinak")&&t.includes("boss arunka")});let o;return o=a?a["+/-"]+a.wins/a.appearances:0,[r,o]}},{name:"Success Rate New Moon Luna",filterStr:'OR(\n\t\t\t\t\t\tAND(\n\t\t\t\t\t\t\t"New Moon Luna" in p1.picks,\n\t\t\t\t\t\t\tis-win = true,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tp2.postban = "New Moon Luna"\n\t\t\t\t\t)\n\t\t\t\t\t',eval(e,t){const n=m({battles:e,heroName:"New Moon Luna",isP1:!0});return[i.A.divideToPercentString(t.length,n.length),i.A.queryStats(n,e.length,"New Moon Luna")["Success Rate"]]}},{name:"CR Stats Lone Wolf Peira",filterStr:'"lone wolf peira" in p1.picks; "lone wolf peira" != p2.postban;',eval(e,t){const n=N(t,"Lone Wolf Peira")+P(t,"Lone Wolf Peira"),r=m({battles:e,heroName:"Lone Wolf Peira",isP1:!0}),a=i.A.computeCRStats(r,"Lone Wolf Peira");return[n,a.avgCR+a.firstTurnRate]}},{name:"Player CR Stats Zio",filterStr:'"zio" in p1.picks; "zio" != p2.postban;',eval(e,t){const n=N(t,"Zio")+P(t,"Zio"),r=m({battles:e,heroName:"Zio",isP1:!0}),a=i.A.computeCRStats(r,"Zio");return[n,a.avgCR+a.firstTurnRate]}},{name:"Enemy CR Stats Zio",filterStr:'"zio" in p2.picks; "zio" != p1.postban;',eval(e,t){const n=N(t,"Zio")+P(t,"Zio"),r=m({battles:e,heroName:"Zio",isP1:!1}),a=i.A.computeCRStats(r,"Zio");return[n,a.avgCR+a.firstTurnRate]}},{name:"Total Wins",filterStr:"is-win = true;",eval(e,t){const n=i.A.getGeneralStats(e).total_wins;return[t.length,n]}},{name:"Second Pick Winrate",filterStr:"is-win = true; is-first-pick = false;",eval(e,t){const n=i.A.getGeneralStats(e).second_pick_winrate,r=d(e,s.Lx.FIRST_PICK,e=>!e);return[i.A.divideToPercentString(t.length,r.length),n]}},{name:"Max Turns",filterStr:"",eval(e){const t=i.A.getGeneralStats(e).max_turns;return[Math.max(...e.map(e=>e[s.Lx.TURNS])),t]}},{name:"Max Time",filterStr:"",eval(e){const t=i.A.getGeneralStats(e).max_time;return[i.A.secondsToTimeStr(Math.max(...e.map(e=>e[s.Lx.SECONDS]))),t]}},{name:"Average PPG",filterStr:"",eval(e){const t=i.A.getGeneralStats(e).avg_ppg,n=e.reduce((e,t)=>e+(t[s.Lx.POINT_GAIN]||0),0);return[i.A.divideToString(n,e.length),t]}}],O="~NotImplemented~",b=["~CM~"];const C=new class{originalLog=console.log;suppressCategories=b;boundCategory=null;captures={};captureKey=null;log(...e){null===this.captureKey?this.boundCategory&&this.suppressCategories.includes(this.boundCategory)||this.originalLog.apply(console,e):this.captures[this.captureKey].push(e)}initialize(){console.log=function(...e){this.log.apply(C,e)}}bindCategory(e){this.boundCategory=e}unbindCategory(){this.boundCategory=null}bindCapture(e){this.captures[e]=this.captures[e]||[],this.captureKey=e}unbindCapture(){this.captureKey=null}};C.initialize();const x=()=>console.log("------------------------------------------------");async function D(e,t,n,o){try{const s=(await a.S.fromFilterStr(e.filterStr,n)).getFilters(),i=await r.n.BattleManager.applyFilters(t,s);if(o)return!0;const c=e.eval(t,i,n);if(Array.isArray(c)){const[n,r]=c;if(n!==r)return console.error(`Test: "${e.name}" Failed; Filter Result: ${n}; Script Result: ${r}; `,t,i),!1}else if("boolean"==typeof c){if(!c)return console.error(`Test: "${e.name}" Failed; `,t,i),!1}else if(c===O)return e.name,!1;return!0}catch(t){return console.error(`Test: "${e.name}" Failed: `,t),!1}}async function F(e,t,n){C.bindCapture(e.name);const r=await D(e,t,n);C.unbindCapture(),r?e.name:(x(),C.captures[e.name],x())}async function B(e,t,n){C.bindCapture(e.name);const r=await D(e,t,n,!0);C.unbindCapture(),r?e.name:(x(),C.captures[e.name],x())}async function M(){const e=await r.n.BattleManager.getBattles();if(!e)return void console.error("No battles found for stats tests");const t=Object.values(e),n=await r.n.HeroManager.getHeroDicts();await async function(e,t){const n=Object.values(e);for(const e of y)await B(e,n,t)}(t,n),await async function(e,t){const n=Object.values(e);for(const e of y)await F(e,n,t)}(t,n),await async function(e,t){const n=Object.values(e);for(const e of v)await F(e,n,t)}(t,n),C.captures}},494:(e,t,n)=>{n.d(t,{K:()=>r});const r={unwrapHtmlElt:function(e){const t=document.getElementById(e);if(null===t)throw new Error(`Could not find element with ID ${e}`);return t},setText:function(e,t){this.unwrapHtmlElt(e).textContent=t}}},528:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(667),a=n(412),o=n(275),s=n(40);const i="~Fodder",c="~Empty";const l={getHeroDicts:async function(e=a.Yj.CODES.EN){const t=await r.A.get(r.A.Keys.HERO_MANAGER);return t||this.fetchAndCacheHeroManager(e)},createHeroManager:function(e){for(let[t,n]of e.entries()){const e=a.bh[t];n.prime=e}let t={heroes:[],Empty:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A",prime:1},Fodder:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A",prime:1},name_lookup:{},code_lookup:{},prime_lookup:{},prime_pair_lookup:{}};return t.heroes=e,t=function(e){const t=e.heroes.length,n={attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:c,prime:1},r={attribute_cd:"N/A",code:"N/A",grade:"2/3",job_cd:"N/A",name:i,prime:a.bh[t]};return e.heroes.push(n),e.heroes.push(r),e.Fodder=r,e.Empty=n,e}(t),t=function(e){e.name_lookup=e.heroes.reduce((e,t)=>(e[t.name.toLowerCase().replace(/\s+/g,"")]=t,e),{}),e.prime_lookup=e.heroes.reduce((e,t)=>(e[t.prime]=t,e),{}),e.code_lookup=e.heroes.reduce((e,t)=>(e[t.code]=t,e),{});let t=e.heroes.reduce((e,t)=>(e[t.prime]=t.name,e),{});const n=Object.keys(e.prime_lookup).length-1;for(let r=0;r<n-1;r++){const o=a.bh[r];for(let s=r+1;s<n;s++){const n=a.bh[s],r=o*n,i=e.prime_lookup[o].name,c=e.prime_lookup[n].name;t[r]=[i,c].sort().join(", ")}}return t[e.Fodder.prime*e.Fodder.prime]=[e.Fodder.name,e.Fodder.name].join(", "),e.prime_pair_lookup=t,e}(t),t},fetchHeroManager:async function(e=a.Yj.CODES.EN){const t=(await s.A.fetchHeroJSON()??await o.A.fetchHeroData())[e];return this.createHeroManager(t)},fetchAndCacheHeroManager:async function(e=a.Yj.CODES.EN){const t=await this.fetchHeroManager(e);return await r.A.cache(r.A.Keys.HERO_MANAGER,t),t},deleteHeroManager:async function(){await r.A.delete(r.A.Keys.HERO_MANAGER)},getHeroByName:function(e,t){if(!t)throw new Error("HeroManager instance must be passed to lookup functions");if(!e)return t.Empty;const n=e.toLowerCase().replace(/\s+/g,"");return t.name_lookup[n]??null},getHeroByPrime:function(e,t){if(!t)throw new Error("HeroManager instance must be passed to lookup functions");return t.prime_lookup[e]??null},getHeroByCode:function(e,t){if(!t)throw new Error("HeroManager instance must be passed to lookup functions");return e?t.code_lookup[e]??null:t.Empty},getPairNamesByProduct:function(e,t){if(!t)throw new Error("HeroManager instance must be passed to lookup functions");return t.prime_pair_lookup[e]},EMPTY_NAME:c,FODDER_NAME:i}},602:(e,t,n)=>{n.d(t,{P2:()=>S});const r=(e,t)=>t.some(t=>e instanceof t);let a,o;const s=new WeakMap,i=new WeakMap,c=new WeakMap;let l={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return s.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function u(e){l=e(l)}function f(e){return(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(E(this),t),_(this.request)}:function(...t){return _(e.apply(E(this),t))}}function p(e){return"function"==typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(s.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",o),e.removeEventListener("abort",o)},a=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",o),e.addEventListener("abort",o)});s.set(e,t)}(e),r(e,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,l):e)}function _(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",o)},a=()=>{t(_(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",o)});return c.set(t,e),t}(e);if(i.has(e))return i.get(e);const t=p(e);return t!==e&&(i.set(e,t),c.set(t,e)),t}const E=e=>c.get(e);function S(e,t,{blocked:n,upgrade:r,blocking:a,terminated:o}={}){const s=indexedDB.open(e,t),i=_(s);return r&&s.addEventListener("upgradeneeded",e=>{r(_(s.result),e.oldVersion,e.newVersion,_(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),i.then(e=>{o&&e.addEventListener("close",()=>o()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),i}const d=["get","getKey","getAll","getAllKeys","count"],A=["put","add","delete","clear"],h=new Map;function T(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(h.get(t))return h.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=A.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!d.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,a?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),a&&o.done]))[0]};return h.set(t,o),o}u(e=>({...e,get:(t,n,r)=>T(t,n)||e.get(t,n,r),has:(t,n)=>!!T(t,n)||e.has(t,n)}));const m=["continue","continuePrimaryKey","advance"],g={},R=new WeakMap,w=new WeakMap,L={get(e,t){if(!m.includes(t))return e[t];let n=g[t];return n||(n=g[t]=function(...e){R.set(this,w.get(this)[t](...e))}),n}};async function*N(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const n=new Proxy(t,L);for(w.set(n,t),c.set(n,E(t));t;)yield n,t=await(R.get(n)||t.continue()),R.delete(n)}function P(e,t){return t===Symbol.asyncIterator&&r(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&r(e,[IDBIndex,IDBObjectStore])}u(e=>({...e,get:(t,n,r)=>P(t,n)?N:e.get(t,n,r),has:(t,n)=>P(t,n)||e.has(t,n)}))},623:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(494);class a{_SELECT_DATA_MSG=null;_FILTER_MSG=null;_SELECT_DATA_BODY=null;_SHOW_STATS_BODY=null;_LOAD_DATA_BODY=null;_LATEST_BATTLES_BTN=null;_UPLOAD_FORM=null;_CSV_FILE=null;_USER_QUERY_FORM_NAME=null;_USER_QUERY_FORM_SERVER=null;_AUTO_ZOOM_FLAG=null;_FOOTER=null;_USER_NAME=null;_USER_ID=null;_USER_SERVER=null;_BATTLE_FILTER_TOGGLER=null;_ID_SEARCH_FLAG=null;_SEASON_DETAILS_TBL=null;_PERFORMANCE_STATS_TBL=null;_FIRST_PICK_STATS_TBL=null;_PREBAN_STATS_TBL=null;_PLAYER_TBL=null;_OPPONENT_TBL=null;_BATTLE_TBL=null;_RANK_PLOT=null;get SELECT_DATA_MSG(){return this._SELECT_DATA_MSG||=r.K.unwrapHtmlElt("select-data-msg")}get FILTER_MSG(){return this._FILTER_MSG||=r.K.unwrapHtmlElt("filterMSG")}get SELECT_DATA_BODY(){return this._SELECT_DATA_BODY||=r.K.unwrapHtmlElt("select-data-body")}get SHOW_STATS_BODY(){return this._SHOW_STATS_BODY||=r.K.unwrapHtmlElt("show-stats-body")}get LOAD_DATA_BODY(){return this._LOAD_DATA_BODY||=r.K.unwrapHtmlElt("load-data-body")}get LATEST_BATTLES_BTN(){return this._LATEST_BATTLES_BTN||=r.K.unwrapHtmlElt("latest-battles-btn")}get UPLOAD_FORM(){return this._UPLOAD_FORM||=r.K.unwrapHtmlElt("uploadForm")}get CSV_FILE(){return this._CSV_FILE||=r.K.unwrapHtmlElt("csvFile")}get USER_QUERY_FORM_NAME(){return this._USER_QUERY_FORM_NAME||=r.K.unwrapHtmlElt("user-query-form-name")}get USER_QUERY_FORM_SERVER(){return this._USER_QUERY_FORM_SERVER||=r.K.unwrapHtmlElt("user-query-form-server")}get AUTO_ZOOM_FLAG(){return this._AUTO_ZOOM_FLAG||=r.K.unwrapHtmlElt("auto-zoom-flag")}get USER_NAME(){return this._USER_NAME||=r.K.unwrapHtmlElt("user-name")}get USER_ID(){return this._USER_ID||=r.K.unwrapHtmlElt("user-id")}get USER_SERVER(){return this._USER_SERVER||=r.K.unwrapHtmlElt("user-server")}get BATTLE_FILTER_TOGGLE(){return this._BATTLE_FILTER_TOGGLER||=r.K.unwrapHtmlElt("filter-battle-table")}get ID_SEARCH_FLAG(){return this._ID_SEARCH_FLAG||=r.K.unwrapHtmlElt("id-search-flag")}get SEASON_DETAILS_TBL(){return this._SEASON_DETAILS_TBL||=r.K.unwrapHtmlElt("season-details-tbl")}get PERFORMANCE_STATS_TBL(){return this._PERFORMANCE_STATS_TBL||=r.K.unwrapHtmlElt("performance-stats-tbl")}get FIRST_PICK_STATS_TBL(){return this._FIRST_PICK_STATS_TBL||=r.K.unwrapHtmlElt("first-pick-stats-tbl")}get PREBAN_STATS_TBL(){return this._PREBAN_STATS_TBL||=r.K.unwrapHtmlElt("preban-stats-tbl")}get PLAYER_TBL(){return this._PLAYER_TBL||=r.K.unwrapHtmlElt("player-tbl")}get OPPONENT_TBL(){return this._OPPONENT_TBL||=r.K.unwrapHtmlElt("opponent-tbl")}get BATTLES_TBL(){return this._BATTLE_TBL||=r.K.unwrapHtmlElt("battles-tbl")}get RANK_PLOT(){return this._RANK_PLOT||=r.K.unwrapHtmlElt("rank-plot")}get MESSAGE_ELEMENTS_LIST(){return[this.SELECT_DATA_MSG,this.FILTER_MSG]}}class o{_SIDEBAR_HIDE_BTN=null;get SIDEBAR_HIDE_BTN(){return this._SIDEBAR_HIDE_BTN||=r.K.unwrapHtmlElt("sidebar-hide")}_CLEAR_DATA_BTN=null;get CLEAR_DATA_BTN(){return this._CLEAR_DATA_BTN||=r.K.unwrapHtmlElt("clear-data-btn")}_EXPORT_CSV_BTN=null;get EXPORT_DATA_BTN(){return this._EXPORT_CSV_BTN||=r.K.unwrapHtmlElt("export-data-btn")}_OFFICIAL_SITE_BTN=null;get OFFICIAL_SITE_BTN(){return this._OFFICIAL_SITE_BTN||=r.K.unwrapHtmlElt("official-site-btn")}_USER_NAME=null;get USER_NAME(){return this._USER_NAME||=r.K.unwrapHtmlElt("user-name")}_USER_ID=null;get USER_ID(){return this._USER_ID||=r.K.unwrapHtmlElt("user-id")}_USER_SERVER=null;get USER_SERVER(){return this._USER_SERVER||=r.K.unwrapHtmlElt("user-server")}_SIDEBAR_CONTROL=null;get SIDEBAR_CONTROL(){return this._SIDEBAR_CONTROL||=r.K.unwrapHtmlElt("sidebar-control")}_REFRESH_REFERENCES_BTN=null;get REFRESH_REFERENCES_BTN(){return this._REFRESH_REFERENCES_BTN||=r.K.unwrapHtmlElt("refresh-references-btn")}}class s{_SEARCH_DOMAINS=null;get SEARCH_DOMAINS(){return this._SEARCH_DOMAINS||=r.K.unwrapHtmlElt("search-domains")}_SEARCH_SUBMIT_BTN=null;get SEARCH_SUBMIT_BTN(){return this._SEARCH_SUBMIT_BTN||=r.K.unwrapHtmlElt("search-submit-btn")}_SEARCH_FORM=null;get SEARCH_FORM(){return this._SEARCH_FORM||=r.K.unwrapHtmlElt("searchForm")}_SEARCH_TABLE_CONTAINER=null;get SEARCH_TABLE_CONTAINER(){return this._SEARCH_TABLE_CONTAINER||=r.K.unwrapHtmlElt("search-table-container")}}class i{_FILTER_SYNTAX_RULES_CONTAINER=null;get FILTER_SYNTAX_RULES_CONTAINER(){return this._FILTER_SYNTAX_RULES_CONTAINER||=r.K.unwrapHtmlElt("filter-syntax-rules-container")}_ALL_CONTENT_CONTAINER=null;get ALL_CONTENT_CONTAINER(){return this._ALL_CONTENT_CONTAINER||=r.K.unwrapHtmlElt("all-content-container")}}class c{IDS={OVERVIEW_CONTAINER:"overview-container",OVERVIEW_CARD:"overview-card",RETURN_BTN:"info-return-btn",RETURN_CONTAINER:"info-return-container",FILTER_SYNTAX_CONTAINER:"filter-syntax-rules-container",FILTER_EXAMPLES_AND_TEST_CONTAINER:"filter-syntax-examples-and-test-container",INFORMATION_CONTENT_LINKS_CONTAINER:"information-content-links-container",ALL_CONTENT_CONTAINER:"all-content-container",FILTER_OVERVIEW:"filter-rules-card",FIELD_SYNTAX:"fields-card",FUNCTION_SYNTAX:"functions-card",OPERATOR_SYNTAX:"operators-card",DATA_SYNTAX:"declared-data-card",STRUCTURAL_SYNTAX:"structural-syntax-card",EX_FILTER_1:"exFilter1",EX_FILTER_2:"exFilter2",EX_FILTER_3:"exFilter3",EX_FILTER_4:"exFilter4",EX_FILTER_5:"exFilter5",TEST_FILTER_FORM:"test-filter-form",TEST_FILTER_MESSAGE:"filterMSG",TEST_SYNTAX_CARD:"test-syntax-card",CHECK_SYNTAX_BTN:"check-syntax-btn"};_CACHE={};constructor(){this._CACHE={}}getFromId(e){return this._CACHE[e]||=r.K.unwrapHtmlElt(e)}}const l=new class{HOME_PAGE;NAV_BAR;SEARCH_PAGE;FILTER_SYNTAX_PAGE;INFO_PAGE;_BODY_FOOTER_CONTAINER=null;_FOOTER_WRAPPER=null;constructor(){this.HOME_PAGE=new a,this.NAV_BAR=new o,this.SEARCH_PAGE=new s,this.FILTER_SYNTAX_PAGE=new i,this.INFO_PAGE=new c}get BODY_FOOTER_CONTAINER(){return this._BODY_FOOTER_CONTAINER??=r.K.unwrapHtmlElt("body-footer-container")}get FOOTER_WRAPPER(){return this._FOOTER_WRAPPER||=r.K.unwrapHtmlElt("footer-wrapper")}}},667:(e,t,n)=>{n.d(t,{A:()=>m});var r=n(602),a=n(412);async function o(e,t){const n=e.transaction(t,"readwrite");n.objectStore(t).clear(),await n.done}const s={USER:"current-user",BATTLES:"battles",RAW_UPLOAD:"raw-upload",STATS:"stats",FILTER_STR:"filter-str"},i={GLOBAL_USERS:"global-users",EU_USERS:"eu-users",ASIA_USERS:"asia-users",JPN_USERS:"jpn-users",KOR_USERS:"kor-users"},c={...i,ARTIFACTS:"artifacts",ARTIFACTS_LOWERCASE_NAMES_MAP:"artifacts-lowercase-names-map",ARTIFACT_OBJECT_LIST:"artifact-object-list",HERO_MANAGER:"hero-manager",SEASON_DETAILS:"season-details"},l={...s,...c,LANG:"lang",AUTO_ZOOM_FLAG:"auto-zoom",AUTO_QUERY_FLAG:"auto-query",ID_SEARCH_FLAG:"id-search",HOME_PAGE_STATE:"home-page-state",INTER_PAGE_MANAGER:"inter-page-manager"},u=864e5,f=2*u,p=3*(7*u),_=u,E=Object.values(c),S=Object.values(s).filter(e=>e!==s.FILTER_STR);function d(e){return E.includes(e)?_:S.includes(e)?p:f}const A="DataStore",h="MetaStore";let T={consts:{DB_NAME:"E7ArenaStatsClientDB",DB_VERSION:1,STORE_NAME:A,META_STORE_NAME:h},Keys:{...l},MetaKeys:{TIMESTAMP:"timestamp"},loaded_UM:new Set,openDB:async function(){return await(0,r.P2)(T.consts.DB_NAME,T.consts.DB_VERSION,{upgrade(e){e.objectStoreNames.contains(A)&&e.deleteObjectStore(A),e.objectStoreNames.contains(A)||e.createObjectStore(A),e.objectStoreNames.contains(h)||e.createObjectStore(h)}})},get:async function(e){const t=await this.openDB(),n=await t.get(A,e);if(!n)return null;return await this.checkCacheTimeout(e)?n:null},cache:async function(e,t){const n=await this.openDB();await n.put(A,t,e),await this.setTimeoutDataNow(e)},delete:async function(e){const t=await this.openDB();await t.delete(A,e),await this.deleteTimeoutData(e)},deleteDB:async function(){await indexedDB.deleteDatabase(this.consts.DB_NAME)},getTimeoutData:async function(e){const t=await this.openDB(),n=`${e+this.MetaKeys.TIMESTAMP}`;return await t.get(h,n)||null},setTimeoutData:async function(e,t){const n=await this.openDB(),r=`${e+this.MetaKeys.TIMESTAMP}`;await n.put(h,t,r)},setTimeoutDataNow:async function(e){const t=function(e){return[Date.now(),d(e)]}(e);await this.setTimeoutData(e,t)},deleteTimeoutData:async function(e){const t=await this.openDB(),n=`${e+this.MetaKeys.TIMESTAMP}`;await t.delete(h,n)},clearData:async function(){const e=await this.openDB();await o(e,A),await o(e,h)},clearUserData:async function(){const e=Object.values(s);await Promise.all(e.map(e=>this.delete(e)))},clearUserLists:async function(){const e=Object.values(i);await Promise.all(e.map(e=>this.delete(e)))},clearSeasonData:async function(){await this.delete(l.SEASON_DETAILS)},clearReferenceData:async function(){const e=Object.values(c);await Promise.all(e.map(e=>this.delete(e)))},checkCacheTimeout:async function(e){const t=await this.getTimeoutData(e),n=Date.now();if(!t)return!1;if(r=t,!Array.isArray(r)||2!==r.length||"number"!=typeof r[0]||"number"!=typeof r[1])return await this.delete(e),!1;var r;const[a,o]=t;return n-a>o?(await this.delete(e),!1):(d(e),t[0],!0)},getFilterStr:async function(){return await this.get(l.FILTER_STR)},setFilterStr:async function(e){await this.cache(l.FILTER_STR,e)},getLang:async function(){return await this.get(l.LANG)??a.Yj.CODES.EN},setLang:async function(e){await this.cache(l.LANG,e)},getStats:async function(){return await this.get(l.STATS)},setStats:async function(e){await this.cache(l.STATS,e)}};const m=T},699:(e,t,n)=>{n.d(t,{H3:()=>w});var r=n(207),a=n(54),o=n(413),s=n(833);const i=new Set(["p1.picks","p2.picks","p1.prebans","p2.prebans","prebans"]),c={FIELD:"FIELD",RANGE:"RANGE",SET:"SET",INT:"INT",DATE:"DATE",BOOL:"BOOL",STRING:"STRING"};class l{}class u extends l{type=c.FIELD;rawString;extractFn;constructor(e){if(super(),this.rawString=e,!s.j[e])throw new Error("Invalid field");this.extractFn=s.j[e]}getData(){throw new Error("Not implemented for Field")}extractData(e){return this.extractFn(e)}asString(){return`${this.rawString}`}}class f extends l{rawString;constructor(e){super(),this.rawString=e}getData(){return this.data}extractData(e){throw new Error("Not implemented for Literals")}asString(){return`${this.fmtString}`}}class p extends f{type=c.STRING;fmtString;data;constructor(e,t,n=Object.values(o.xD)){super(e),e=a.A.trimSurroundingQuotes(e),this.data=this.processString(e,t,n),this.fmtString=this.data}processString(e,t,n){const r=(0,o.QV)(e,t,n);if(!r){const t=n.map(e=>e.parserType).join(", ");throw new a.A.ValidationError(`Invalid string literal: '${e}' ; could not be parsed as a valid instance of any of the following: [${t}]`)}return r}}class _ extends f{type=c.INT;fmtString;data;constructor(e){super(e),this.data=this.processString(e),this.fmtString=e}processString(e){const t=parseInt(e);if(isNaN(t))throw new a.A.ValidationError(`Invalid integer literal: '${e}'`);return t}}class E extends f{type=c.BOOL;fmtString;data;constructor(e){super(e),this.data=this.processString(e),this.fmtString=e}processString(e){if("true"===e)return!0;if("false"===e)return!1;throw new a.A.ValidationError(`Invalid boolean literal: '${e}'`)}}class S extends f{type=c.DATE;fmtString;data;constructor(e){super(e),this.data=this.processString(e),this.fmtString=e}processString(e){return a.A.parseDate(e).getTime()}}class d{start;end;endInclusive;constructor(e,t,n){this.start=e,this.end=t,this.endInclusive=n}has(e){return"number"==typeof e&&"number"==typeof this.start&&"number"==typeof this.end&&(!(e<this.start)&&(!(e>this.end)&&(e!==this.end||this.endInclusive)))}includes(e){return this.has(e)}}const A=[e=>r.L.DATE_LITERAL_RE.test(e)?new S(e):null,e=>r.L.INT_LITERAL_RE.test(e)?new _(e):null];function h(e,t,n,r){let a=r(e),o=r(t);return null===a||null===o?null:new d(a.data,o.data,n)}class T extends f{type=c.RANGE;fmtString;data;constructor(e,t){super(e),this.fmtString=e,this.data=this.processString(e,t)}processString(e,t){const n=e.split("..."),r=n[0];let o="="===n[1].charAt(0);const s=n[1].slice(o?1:0);for(const e of A){const t=h(r,s,o,e);if(null!==t)return t}throw new a.A.ValidationError(`Invalid range literal: '${e}' ; ranges must be homogenous and of the format x...y or x...=y for the types: [Date, Integer]`)}}const m=[...A],g=(e,t,n)=>r.L.STRING_RE.test(e)?new p(e,t,n):null;class R extends f{type=c.SET;fmtString;data;constructor(e,t,n=Object.values(o.xD)){super(e),this.fmtString=e,this.data=this.processString(e,t,n)}processString(e,t,n){let r=a.A.tokenizeWithNestedEnclosures(e,",",1,!0);r=r.filter(e=>""!==e);const o=new Set;for(const s of r){let r=null;for(const e of m)if(r=e(s),r){o.add(r.data);break}if(!r){if(r=g(s,t,n),!r)throw new a.A.ValidationError(`Invalid set element: '${e}' ; could not be parsed as a valid instance of any of the following types: [Date, Integer, String]`);o.add(r.data)}}return this.fmtString=`{${Array.from(o).join(", ")}}`,o}}const w={StringLiteral:p,IntLiteral:_,BoolLiteral:E,DateLiteral:S,RangeLiteral:T,SetLiteral:R,Field:u,BaseEltTypes:c,FIELD_EXTRACT_FN_MAP:s.j,parseBaseElement:function(e,t){if(r.L.STRING_LITERAL_RE.test(e))return new p(e,t);if(r.L.INT_LITERAL_RE.test(e))return new _(e);if(r.L.BOOL_LITERAL_RE.test(e))return new E(e);if(r.L.DATE_LITERAL_RE.test(e))return new S(e);if(r.L.RANGE_LITERAL_RE.test(e))return new T(e,t);if(r.L.SET_LITERAL_RE.test(e))return new R(e,t);if(r.L.SEASON_LITERAL_RE.test(e))return new p(e,t,[o.xD.Season]);if(r.L.FIELD_WORD_LITERAL_RE.test(e))return new u(e);throw new a.A.ValidationError(`Invalid base element: '${e}' ; could not be parsed as a Field or Literal.`)},COLLECTION_FIELDS_SET:i}},771:(e,t,n)=>{n.d(t,{A:()=>_,l:()=>c});var r=n(412),a=n(667),o=n(40),s=n(275);const i={[r.F7.GLOBAL]:a.A.Keys.GLOBAL_USERS,[r.F7.EU]:a.A.Keys.EU_USERS,[r.F7.ASIA]:a.A.Keys.ASIA_USERS,[r.F7.JPN]:a.A.Keys.JPN_USERS,[r.F7.KOR]:a.A.Keys.KOR_USERS};function c(e){if(!e)throw new Error("Invalid user; user is null or undefined");if(!("id"in e)||"number"!=typeof e.id)throw new Error("Invalid user; user id does not exist or is not a number");if(!("name"in e)||"string"!=typeof e.name)throw new Error("Invalid user; user name does not exist or is not a string");if(!("world_code"in e)||"string"!=typeof e.world_code)throw new Error("Invalid user; user.world_code does not exist or is not a string");if(!(e.world_code in r.DB))throw new Error("Invalid user; user.world_code is not a valid world code");return!0}function l(e,t){return{id:Number(e.nick_no),name:e.nick_nm,code:e.code||null,rank:Number(e.rank),world_code:t}}async function u(e){const t=await a.A.get(i[e]);if(null!==t)return t;const n=await async function(e){const t=await o.A.fetchUserJSON(e);if(!t||"object"==typeof t&&!("users"in t))return null;const n=t;return Object.fromEntries(n.users.map(t=>[t.nick_no,l(t,e)]))}(e);return await a.A.cache(i[e],n),n}const f=e=>r.DB[e];async function p(e,t){const n=await u(t),r=n?Object.values(n):[];if(0===r.length)return f(t),{user:null,ok:!1};let a,o;if(e.id)a=e.id,o=e=>e.id;else{if(!e.name)throw new Error("Must pass a user object with either user.name or user.id to find user");a=e.name.toLowerCase(),o=e=>e.name.toLowerCase()}return function(e,t,n){const r=t.find(t=>n(t)===e);return r?(JSON.stringify(r),{user:r,ok:!0}):{user:null,ok:!0}}(a,r,o)}const _={getUserMap:u,findUser:async function(e){if(JSON.stringify(e),!e.name&&!e.id||!e.world_code)throw new Error("Must pass a user object with either user.name or user.id, and user.world_code to find user");let t=e.id?`Numeric ID: ${e.id}`:`Name: '${e.name}'`,n=null;if(n=await p(e,e.world_code),n.ok||(n=await s.A.fetchUser(e)),n.ok){const r=n.user;if(null===r)throw new Error(`Could not find user with ${t} in Server: ${f(e.world_code)}`);return r}throw new Error(`Function did not properly terminate: ${JSON.stringify(n)}`)},setUser:async function(e){await a.A.cache(a.A.Keys.USER,e)},getUser:async function(){const e=await a.A.get(a.A.Keys.USER);return await a.A.setTimeoutDataNow(a.A.Keys.USER),e},clearUserData:async function(){await a.A.clearUserData()},clearUserDataLists:async function(){await a.A.clearUserLists()}}},823:(e,t,n)=>{n.d(t,{D:()=>r});var r={SELECT_DATA:"select-data",SHOW_STATS:"show-stats",LOAD_DATA:"load-data"}},833:(e,t,n)=>{n.d(t,{j:()=>o});var r=n(412),a=n(54);const o={date:e=>e[r.Lx.DATE_TIME]?a.A.castStringToUTCDate(e[r.Lx.DATE_TIME].split(" ")[0]).getTime():"N/A",season:e=>e[r.Lx.SEASON_CODE],"is-first-pick":e=>!!e[r.Lx.FIRST_PICK],"is-win":e=>!!e[r.Lx.WIN],"victory-points":e=>e[r.Lx.P1_POINTS],"p1.picks":e=>e[r.Lx.P1_PICKS],"p2.picks":e=>e[r.Lx.P2_PICKS],"p1.prebans":e=>e[r.Lx.P1_PREBANS],"p2.prebans":e=>e[r.Lx.P2_PREBANS],"p1.postban":e=>e[r.Lx.P1_POSTBAN],"p2.postban":e=>e[r.Lx.P2_POSTBAN],postbans:e=>[e[r.Lx.P1_POSTBAN],e[r.Lx.P2_POSTBAN]],prebans:e=>[...e[r.Lx.P1_PREBANS],...e[r.Lx.P2_PREBANS]],"p1.pick1":e=>e[r.Lx.P1_PICKS][0],"p1.pick2":e=>e[r.Lx.P1_PICKS][1],"p1.pick3":e=>e[r.Lx.P1_PICKS][2],"p1.pick4":e=>e[r.Lx.P1_PICKS][3],"p1.pick5":e=>e[r.Lx.P1_PICKS][4],"p2.pick1":e=>e[r.Lx.P2_PICKS][0],"p2.pick2":e=>e[r.Lx.P2_PICKS][1],"p2.pick3":e=>e[r.Lx.P2_PICKS][2],"p2.pick4":e=>e[r.Lx.P2_PICKS][3],"p2.pick5":e=>e[r.Lx.P2_PICKS][4],"p1.league":e=>e[r.Lx.P1_LEAGUE],"p2.league":e=>e[r.Lx.P2_LEAGUE],"p1.server":e=>e[r.Lx.P1_SERVER],"p2.server":e=>e[r.Lx.P2_SERVER],"p1.id":e=>Number(e[r.Lx.P1_ID]),"p2.id":e=>Number(e[r.Lx.P2_ID]),"p1.mvp":e=>e[r.Lx.P1_MVP],"p2.mvp":e=>e[r.Lx.P2_MVP],"is-first-turn":e=>!!e[r.Lx.FIRST_TURN],"first-turn-hero":e=>e[r.Lx.FIRST_TURN_HERO],turns:e=>e[r.Lx.TURNS],seconds:e=>e[r.Lx.SECONDS],"point-gain":e=>e[r.Lx.POINT_GAIN]}},834:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(667),a=n(40),o=n(275);const s={async getArtifactCodeToNameMap(){let e=await r.A.get(r.A.Keys.ARTIFACTS);return e||(e=await this.fetchAndCacheArtifacts()),e},getArtifactLowercaseNameMap:async function(){let e=await r.A.get(r.A.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP);if(null!==e)return e;const t=await this.getArtifactCodeToNameMap();return e=Object.fromEntries(Object.values(t).filter(e=>null!==e).map(e=>[e.toLowerCase(),e])),await r.A.cache(r.A.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP,e),e},getArtifactObjectList:async function(){let e=await r.A.get(r.A.Keys.ARTIFACT_OBJECT_LIST);if(null!==e)return e;const t=await this.getArtifactCodeToNameMap();return e=Object.entries(t).map(([e,t])=>({id:e,name:t})),await r.A.cache(r.A.Keys.ARTIFACT_OBJECT_LIST,e),e},fetchAndCacheArtifacts:async function(){const e=await async function(){let e=await a.A.fetchArtifactJSON("en");return null===e&&(e=await o.A.fetchArtifactJson()),null===e?(console.error("Could not get artifact Json map from E7 server or flask server"),null):Object.fromEntries(e.filter(e=>null!==e.name).map(e=>[e.code,e.name]))}();return null===e?{}:(await r.A.cache(r.A.Keys.ARTIFACTS,e),e)},clearArtifactData:async function(){await r.A.delete(r.A.Keys.ARTIFACTS)},convertCodeToName:function(e,t){return t[e]||e}}},836:(e,t,n)=>{n.d(t,{n:()=>u});var r=n(528),a=n(334),o=n(469),s=n(667),i=n(771),c=n(834),l=n(149);let u={HeroManager:r.A,BattleManager:a.A,SeasonManager:o.A,UserManager:i.A,ClientCache:s.A,ArtifactManager:c.A,LangManager:l.W}},874:(e,t,n)=>{n.d(t,{Su:()=>A});var r=n(121),a=n(412),o=n(771),s=n(623),i=n(136),c=n(836),l=n(149),u=n(82);function f(){window.location.href=URL_UTILS.HOME_PAGE_URL}function p(){document.querySelectorAll(".nav-link").forEach(e=>{e.addEventListener("click",async function(t){if(!("dataset"in e)||!e.dataset||"object"!=typeof e.dataset||!("nav"in e.dataset))return;const n=e.dataset.nav;if(Object.values(r.DG).includes(n))if(n===r.DG.SELECT_DATA)await r.qD.setState(r.DG.SELECT_DATA),f();else if(n===r.DG.SHOW_STATS){await o.A.getUser()?(await r.qD.setState(r.DG.SHOW_STATS),f()):(await r.qD.setState(r.DG.SELECT_DATA),await i.A.pushAction({message:"Active user not found; you must either query a valid user or upload battles to view hero stats.",action:i.A.ACTIONS.SHOW_NO_USER_MSG}),f())}})})}function _(){s.A.NAV_BAR.CLEAR_DATA_BTN.addEventListener("click",async function(){await o.A.getUser()?(await r.qD.setState(r.DG.SELECT_DATA),await i.A.pushAction({action:i.A.ACTIONS.CLEAR_USER})):(await r.qD.setState(r.DG.SELECT_DATA),await i.A.pushAction({action:i.A.ACTIONS.SHOW_DATA_ALREADY_CLEARED_MSG})),f()})}function E(){[s.A.NAV_BAR.CLEAR_DATA_BTN,s.A.NAV_BAR.EXPORT_DATA_BTN,s.A.NAV_BAR.OFFICIAL_SITE_BTN].forEach(e=>{e.addEventListener("touchstart",()=>{e.classList.add("touch-hover"),setTimeout(()=>e.classList.remove("touch-hover"),150)})})}function S(e,t="en"){e?(s.A.NAV_BAR.USER_NAME.innerText=e.name,s.A.NAV_BAR.USER_ID.innerText=`${e.id}`,s.A.NAV_BAR.USER_SERVER.innerText=a.DB[e.world_code],s.A.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(function(e,t){const n=`${a.F4}/${t}/gg/battlerecord/${e.world_code}/${e.id}`;return n}(e,t),"_blank","noopener,noreferrer")}):(s.A.NAV_BAR.USER_NAME.innerText="(None)",s.A.NAV_BAR.USER_ID.innerText="(None)",s.A.NAV_BAR.USER_SERVER.innerText="(None)",s.A.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(a.W4,"_blank","noopener,noreferrer")})}function d(){s.A.NAV_BAR.EXPORT_DATA_BTN.addEventListener("click",async function(){if(!await c.n.UserManager.getUser())return await i.A.pushAction({message:"User not found; cannot export data without an active user",action:i.A.ACTIONS.SHOW_NO_USER_MSG}),await r.qD.setState(r.DG.SELECT_DATA),void f();await u.j.triggerDownload()})}let A={addNavListeners:p,addClearDataBtnListener:_,writeUserInfo:S,initialize:async function(){S(await o.A.getUser()),p(),_(),d(),E()},navToHome:f,addExportDataBtnListener:d,addBraceButtonListeners:E,eraseUserFromPage:async function(){await o.A.clearUserData(),S(null)},setUserOnPage:async function(e){await o.A.setUser(e),S(e,await l.W.getLang())}}},913:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(528),a=n(412);const o=e=>e.filter(e=>e[a.Lx.FIRST_PICK]),s="N/A";function i(e){return(100*e).toFixed(2)+"%"}function c(e,t,n=!1){return 0===t?n?"0.00%":s:i(e/t)}function l(e,t){return 0===t?s:(e/t).toFixed(2)}function u(e,t){const n=e[a.Lx.CR_BAR].find(e=>e[0]===t);return n?n[1]:null}function f(e,t){const n=e.filter(e=>{const n=e[a.Lx.P1_PICKS].includes(t)||e[a.Lx.P2_PICKS].includes(t),r=e[a.Lx.P1_POSTBAN]!==t&&e[a.Lx.P2_POSTBAN]!==t;return n&&r});let r=n.length,o=0,s=0;for(const e of n){const n=u(e,t);null!==n&&(o+=n,s+=+(100===n))}return{avgCR:c(o/100,r,!0),firstTurns:s,firstTurnRate:c(s,r,!0)}}function p(e,t){const n=(r=e,r.filter(e=>e[a.Lx.WIN])).length;var r;const o=e.length,s=e.filter(e=>e[a.Lx.FIRST_TURN]).length,i=c(s,e.length),u=e.reduce((e,t)=>e+(t[a.Lx.POINT_GAIN]||0),0);return{wins:n,subsetLength:o,frequency:c(e.length,t),winRate:c(n,e.length),plusMinus:2*n-o,pointGain:e.reduce((e,t)=>e+(t[a.Lx.POINT_GAIN]||0),0),avgPPG:l(u,o),firstTurns:s,firstTurnRate:i}}function _(e,t,n){const r=p(e,t),o=e.reduce((e,t)=>e+ +(t[a.Lx.P1_POSTBAN]===n||t[a.Lx.P2_POSTBAN]===n),0),s=e.reduce((e,t)=>e+ +(t[a.Lx.WIN]||t[a.Lx.P1_POSTBAN]===n||t[a.Lx.P2_POSTBAN]===n),0),i=f(e,n);return{[a.D5.HERO_NAME]:n,[a.D5.BATTLES]:r.subsetLength,[a.D5.PICK_RATE]:r.frequency,[a.D5.WINS]:r.wins,[a.D5.WIN_RATE]:r.winRate,[a.D5.POSTBANS]:o,[a.D5.POSTBAN_RATE]:c(o,r.subsetLength),[a.D5.SUCCESS_RATE]:c(s,r.subsetLength),[a.D5.PLUS_MINUS]:r.plusMinus,[a.D5.POINT_GAIN]:r.pointGain,[a.D5.AVG_CR]:i.avgCR,[a.D5.FIRST_TURNS]:i.firstTurns,[a.D5.FIRST_TURN_RATE]:i.firstTurnRate}}function E(e,t=!0){const n=new Set;for(const r of Object.values(e)){(t?r[a.Lx.P1_PICKS_PRIMES]:r[a.Lx.P2_PICKS_PRIMES]).forEach(e=>{n.add(e)})}return n}function S(e){let t;const n=Math.floor(e/60),r=(e%60).toFixed(1);return t=0===n?`${r} secs`:`${n} : ${r}s`,t}const d={getHeroStats:function(e,t){if(0===e.length)return{playerHeroStats:[],enemyHeroStats:[]};const n=e.length,o=E(e,!0),s=E(e,!1),i=[],c=[];for(const s of o){const o=r.A.getHeroByPrime(s,t);if(!o)continue;const c=e.filter(e=>e[a.Lx.P1_PICKS_PRIMES].includes(s));c.length>0&&i.push(_(c,n,o.name))}for(const o of s){const s=r.A.getHeroByPrime(o,t);if(!s)continue;const i=e.filter(e=>e[a.Lx.P2_PICKS_PRIMES].includes(o));i.length>0&&c.push(_(i,n,s.name))}const l=a.D5.HERO_NAME;return{playerHeroStats:i.sort((e,t)=>e[l].localeCompare(t[l])),enemyHeroStats:c.sort((e,t)=>e[l].localeCompare(t[l]))}},getFirstPickStats:function(e,t){if(0===(e=o(Object.values(e))).length)return[];const n=e.length,s={};for(const t of e){if(0===t[a.Lx.P1_PICKS_PRIMES].length)continue;const e=t[a.Lx.P1_PICKS_PRIMES][0];e in s||(s[e]={wins:0,appearances:0}),s[e].wins+=+t[a.Lx.WIN],s[e].appearances+=1}const c=Object.entries(s).map(([e,a])=>({hero:r.A.getHeroByPrime(e,t)?.name??r.A.EMPTY_NAME,wins:a.wins,appearances:a.appearances,win_rate:i(a.wins/a.appearances),appearance_rate:i(a.appearances/n),"+/-":2*a.wins-a.appearances}));return c.sort((e,t)=>t.appearances-e.appearances),c},getPrebanStats:function(e,t){if(0===e.length)return[];const n=e=>e.reduce((e,t)=>e*t,1),r=new Set;for(const o of e){const e=o[a.Lx.P1_PREBANS_PRIMES];if(0===e.length)continue;for(const n of e)n!==t.Empty.prime&&r.add(n);const s=n(e);s!==t.Empty.prime&&r.add(s)}const o=e.length,s=[];for(const i of r){const r=p(e.filter(e=>{const t=e[a.Lx.P1_PREBANS_PRIMES];return t.includes(i)||n(t)===i}),o);s.push({preban:t.prime_pair_lookup[i],wins:r.wins,appearances:r.subsetLength,appearance_rate:r.frequency,win_rate:r.winRate,"+/-":r.plusMinus})}return s.sort((e,t)=>t.appearances-e.appearances),s},getPerformanceStats:function(e){const t={servers:[],leagues:[]},n=e.length,r=Object.values(a.DB),o=Object.values(a.pc),s=[...r.map(e=>[`Server: ${e}`,t=>t["P2 Server"]===e]),...o.map(e=>[`League: ${e}`,t=>t["P2 League"]===e])];for(const[r,o]of s){const s=e.filter(o),c=s.length;if(0===c)continue;const l=p(s,n),u=s.filter(e=>e[a.Lx.FIRST_PICK]),f=u.reduce((e,t)=>e+ +t[a.Lx.WIN],0),_=s.filter(e=>!e[a.Lx.FIRST_PICK]),E=_.reduce((e,t)=>e+ +t[a.Lx.WIN],0);(r.toLowerCase().includes("server")?t.servers:t.leagues).push({label:r,count:c,wins:l.wins,win_rate:l.winRate,frequency:l.frequency,"+/-":l.plusMinus,fp_games:u.length,sp_games:_.length,fp_wr:u.length>0?i(f/u.length):"N/A",sp_wr:_.length>0?i(E/_.length):"N/A"})}return[...t.servers,...t.leagues.slice(-4)]},getGeneralStats:function(e){e.sort((e,t)=>new Date(e["Date/Time"]).getTime()-new Date(t["Date/Time"]).getTime());const t=e.length,n=l(e.reduce((e,t)=>e+(t["Point Gain"]||0),0),t),r=l(e.reduce((e,t)=>e+t.Turns,0),t),u=e.length>0?Math.max(...e.map(e=>e.Turns)):0,f=e.reduce((e,t)=>e+t.Seconds,0),_=t>0?f/t:0,E=e.length>0?Math.max(...e.map(e=>e.Seconds)):0;let d=S(_),A=S(E);const h=e.reduce((e,t)=>e+ +t["First Turn"],0),T=o(e),m=(e=>e.filter(e=>!e[a.Lx.FIRST_PICK]))(e),g=p(T,t),R=p(m,t),w=c(g.wins+R.wins,t);let[L,N,P,I]=[0,0,0,0];for(let t of e)t.Win?(P+=1,L=Math.max(L,P),I=0):(P=0,I+=1,N=Math.max(N,I));return{first_pick_count:g.subsetLength,second_pick_count:R.subsetLength,first_pick_rate:g.frequency,second_pick_rate:R.frequency,first_pick_winrate:g.winRate,second_pick_winrate:R.winRate,total_winrate:w,total_battles:t,total_wins:g.wins+R.wins,max_win_streak:L,max_loss_streak:N,avg_ppg:n,avg_turns:r,avg_time:d,max_turns:u,max_time:A,first_turn_games:h,first_turn_rate:t?i(h/t):s}},computeGenericStats:p,queryStats:_,toPercent:i,divideToPercentString:c,divideToString:l,computeCRStats:f,secondsToTimeStr:S}},933:(e,t,n)=>{n.d(t,{d:()=>f,j:()=>p});var r=n(528),a=n(834),o=n(412),s=n(92);function i(e,t){const n=e=>r.A.getHeroByName(e,t)?.prime??t.Fodder.prime;e[o.Lx.P1_PICKS_PRIMES]=e[o.Lx.P1_PICKS].map(n),e[o.Lx.P2_PICKS_PRIMES]=e[o.Lx.P2_PICKS].map(n),e[o.Lx.P1_PREBANS_PRIMES]=e[o.Lx.P1_PREBANS].map(n),e[o.Lx.P2_PREBANS_PRIMES]=e[o.Lx.P2_PREBANS].map(n)}const c="p1",l="p2";function u(e,t,n){const u=e=>r.A.getHeroByCode(e,t)?.name??t.Fodder.name,f=(t,r)=>r.map((r,o)=>r?(e=>a.A.convertCodeToName(e,n)||"None")(r):((t,n)=>t===c?e.p2_postban===e.p1_picks[n]:e.p1_postban===e.p2_picks[n])(t,o)?"n/a":"None");const p=e=>e.map(e=>e.map(e=>o.pg[e]||e)),_=e.cr_bar.find(e=>100===e[1]),E=!!_&&e.p1_picks.includes(_[0]),S={[o.Lx.SEASON]:e.season_name||"None",[o.Lx.SEASON_CODE]:e.season_code||"None",[o.Lx.DATE_TIME]:e.date_time,[o.Lx.SECONDS]:e.seconds,[o.Lx.TURNS]:e.turns,[o.Lx.SEQ_NUM]:e.seq_num,[o.Lx.P1_ID]:e.p1_id.toString(),[o.Lx.P1_SERVER]:o.DB[e.p1_server]||e.p1_server||"None",[o.Lx.P2_ID]:e.p2_id.toString(),[o.Lx.P2_SERVER]:o.DB[e.p2_server]||e.p2_server||"None",[o.Lx.P1_LEAGUE]:(0,s.S)(e.p1_league)||"None",[o.Lx.P2_LEAGUE]:(0,s.S)(e.p2_league)||"None",[o.Lx.P1_POINTS]:e.p1_win_score,[o.Lx.POINT_GAIN]:e.p1_point_delta||null,[o.Lx.WIN]:1===e.win,[o.Lx.FIRST_PICK]:1===e.first_pick,[o.Lx.FIRST_TURN]:!!E,[o.Lx.FIRST_TURN_HERO]:_?u(_[0]):"n/a",[o.Lx.CR_BAR]:(d=e.cr_bar,d.map(e=>e&&2==e.length?[u(e[0]),e[1]]:["n/a",0])),[o.Lx.P1_PREBANS]:e.p1_prebans.map(u),[o.Lx.P2_PREBANS]:e.p2_prebans.map(u),[o.Lx.P1_PICKS]:e.p1_picks.map(u),[o.Lx.P2_PICKS]:e.p2_picks.map(u),[o.Lx.P1_POSTBAN]:u(e.p1_postban),[o.Lx.P2_POSTBAN]:u(e.p2_postban),[o.Lx.P1_EQUIPMENT]:p(e.p1_equipment),[o.Lx.P2_EQUIPMENT]:p(e.p2_equipment),[o.Lx.P1_ARTIFACTS]:f(c,e.p1_artifacts),[o.Lx.P2_ARTIFACTS]:f(l,e.p2_artifacts),[o.Lx.P1_MVP]:u(e.p1_mvp),[o.Lx.P2_MVP]:u(e.p2_mvp)};var d;return i(S,t),S}function f(e,t,n){n=n??a.A.getArtifactCodeToNameMap();let r=[];for(const a of e){let e=u(a,t,n);r.push([e["Seq Num"],e])}return Object.fromEntries(r)}function p(e,t){const n=e.map(e=>{const n=(r=e,Object.fromEntries(Object.entries(r).map(([e,t])=>[e,JSON.parse(t)])));var r;return i(n,t),n});return Object.fromEntries(n.map(e=>[e[o.Lx.SEQ_NUM],e]))}},940:(e,t,n)=>{n.d(t,{A:()=>f});var r,a,o=n(528),s=n(84),i=n(172);function c(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof i?r:i,u=Object.create(c.prototype);return l(u,"_invoke",function(n,r,a){var o,i,c,l=0,u=a||[],f=!1,p={p:0,n:0,v:e,a:_,f:_.bind(e,4),d:function(t,n){return o=t,i=0,c=e,p.n=n,s}};function _(n,r){for(i=n,c=r,t=0;!f&&l&&!a&&t<u.length;t++){var a,o=u[t],_=p.p,E=o[2];n>3?(a=E===r)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=_&&((a=n<2&&_<o[1])?(i=0,p.v=r,p.n=o[1]):_<E&&(a=n<3||o[0]>r||r>E)&&(o[4]=n,o[5]=r,p.n=E,i=0))}if(a||n>1)return s;throw f=!0,r}return function(a,u,E){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&_(u,E),i=u,c=E;(t=i<2?e:c)||!f;){o||(i?i<3?(i>1&&(p.n=-1),_(i,c)):p.n=c:p.v=c);try{if(l=2,o){if(i||(a="next"),t=o[a]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==s)break}catch(t){o=e,i=1,c=t}finally{l=1}}return{value:t,done:f}}}(n,a,o),!0),u}var s={};function i(){}function u(){}function f(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(l(t={},r,function(){return this}),t),_=f.prototype=i.prototype=Object.create(p);function E(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=Object.create(_),e}return u.prototype=f,l(_,"constructor",f),l(f,"constructor",u),u.displayName="GeneratorFunction",l(f,a,"GeneratorFunction"),l(_),l(_,a,"Generator"),l(_,r,function(){return this}),l(_,"toString",function(){return"[object Generator]"}),(c=function(){return{w:o,m:E}})()}function l(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var o=function(t,n){l(e,t,function(e){return this._invoke(t,n,e)})};o("next",0),o("throw",1),o("return",2)}},l(e,t,n,r)}function u(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}const f={validateFilterSyntax:(r=c().m(function e(t){var n,r,a;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,o.A.getHeroDicts();case 1:return n=e.v,r=document.getElementById("filterMSG"),e.p=2,e.n=3,s.S.fromFilterStr(t,n);case 3:return e.v.asString(),i.GF.write(new i.ev("Validation Passed",r,[i.GF.STYLES.GREEN])),e.a(2,!0);case 4:return e.p=4,a=e.v,console.error(a),i.GF.write(new i.ev("Validation Failed: ".concat(a.message),r,[i.GF.STYLES.RED])),e.a(2,!1)}},e,null,[[2,4]])}),a=function(){var e=this,t=arguments;return new Promise(function(n,a){var o=r.apply(e,t);function s(e){u(o,n,a,s,i,"next",e)}function i(e){u(o,n,a,s,i,"throw",e)}s(void 0)})},function(e){return a.apply(this,arguments)}),setScrollPercent:function(e){"Scrolling to ".concat(e,"%");var t=e/100*(document.documentElement.scrollHeight-window.innerHeight),n=document.documentElement,r=n.style.scrollBehavior;n.style.scrollBehavior="auto",window.scrollTo({top:t}),n.style.scrollBehavior=r},getScrollPercent:function(){var e=window.scrollY||document.documentElement.scrollTop,t=document.documentElement.scrollHeight-window.innerHeight;return 0===t?0:e/t*100},setVisibility:function(e,t){t?e.classList.remove("d-none"):e.classList.add("d-none")}}},971:(e,t,n)=>{n.d(t,{Nk:()=>s,RG:()=>o,yL:()=>a});var r=n(412);const a=new Set("'\"(),_-.=; ><!1234567890{}~abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),o="   ",s=Object.fromEntries(Object.values(r.pg).map(e=>[e.toLowerCase(),e]))}},s={};function i(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return o[e](n,n.exports,i),n.exports}e="function"==typeof Symbol,t=e?Symbol("webpack queues"):"__webpack_queues__",n=e?Symbol("webpack exports"):"__webpack_exports__",r=e?Symbol("webpack error"):"__webpack_error__",a=e=>{e&&e.d<1&&(e.d=1,e.forEach(e=>e.r--),e.forEach(e=>e.r--?e.r++:e()))},i.a=(e,o,s)=>{var i;s&&((i=[]).d=-1);var c,l,u,f=new Set,p=e.exports,_=new Promise((e,t)=>{u=t,l=e});_[n]=p,_[t]=e=>(i&&e(i),f.forEach(e),_.catch(e=>{})),e.exports=_,o(e=>{var o;c=(e=>e.map(e=>{if(null!==e&&"object"==typeof e){if(e[t])return e;if(e.then){var o=[];o.d=0,e.then(e=>{s[n]=e,a(o)},e=>{s[r]=e,a(o)});var s={};return s[t]=e=>e(o),s}}var i={};return i[t]=e=>{},i[n]=e,i}))(e);var s=()=>c.map(e=>{if(e[r])throw e[r];return e[n]}),l=new Promise(e=>{(o=()=>e(s)).r=0;var n=e=>e!==i&&!f.has(e)&&(f.add(e),e&&!e.d&&(o.r++,e.push(o)));c.map(e=>e[t](n))});return o.r?l:s()},e=>(e?u(_[r]=e):l(p),a(i))),i&&i.d<0&&(i.d=0)},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);i(442)})();