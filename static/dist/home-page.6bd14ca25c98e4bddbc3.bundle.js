/*! For license information please see home-page.6bd14ca25c98e4bddbc3.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,n,r,a,o={40:(t,e,n)=>{n.d(e,{A:()=>o});var r=n(412);async function a(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error: status: ${e.status}`);const n=await e.json();return Object.keys(n),n}catch(t){return console.error("Error fetching global user data:",t),null}}const o={fetchHeroJSON:async function(t=null){let e=await a("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_hero.json");return e?(t&&e[t]?e=e[t]:t&&!e[t]&&(console.error("Could not find hero data for language:",t),e=null),e):null},fetchUserJSON:async function(t){if(t=t.replace("world_",""),![...r.WB].some(e=>e.replace("world_","")===t))return console.error(`Could not find world code: ${t}`),null;const e=`https://static.smilegatemegaport.com/gameRecord/epic7/epic7_user_world_${t}.json`,n=await a(e);return n&&"object"==typeof n&&"users"in n&&Array.isArray(n.users)&&n.users.length,n},fetchArtifactJSON:async function(t=null){let e=await a("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_artifact.json"),n=null;if(e&&t&&"object"==typeof e&&t in e){let n=e;if(Array.isArray(n[t]))return n[t]}return n},fetchInfo:async function(t,e,n="en"){const r=new URLSearchParams({nick_no:t,world_code:e,lang:n});try{const t=await fetch("https://epic7.onstove.com/gg/gameApi/getUserInfo",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()});if(!t.ok)return console.error("Error fetching battle list:",t.status,t.statusText),null;return await t.json()}catch(t){return console.error("Request failed:",t),null}}}},42:(t,e,n)=>{n.d(e,{c2:()=>at,CO:()=>rt,eR:()=>M,y4:()=>Z,Qo:()=>j});var r=n(92),a=n(412),o=n(207),s=n(54),i=n(528),c=n(971);class l{}const u={Hero:new class extends l{parse(t,e){return i.A.getHeroByName(t,e.HeroDicts)?.name??null}parserType="Hero"},League:new class extends l{parse(t){return a.pc,a.pc[t]}parserType="League"},Server:new class extends l{parse(t){return a.$k[t]}parserType="Server"},Equipment:new class extends l{parse(t){return c.Nk[t.toLowerCase()]}parserType="Equipment"},Artifact:new class extends l{parse(t,e){return e.ARTIFACT_LOWERCASE_STRINGS_MAP[t.toLowerCase()]}parserType="Artifact"},Season:new class extends l{parse(t,e){let n;if("current-season"===t)return e.SEASON_DETAILS[0].Code;if("last-season"===t)return e.SEASON_DETAILS[1].Code;if(o.L.SEASON_LITERAL_RE.test(t))n=t.split("-").at(-1);else{if(!o.L.SEASON_CODE_LITERAL_RE.test(t))return null;n=t.split("_ss").at(-1)}e.SEASON_DETAILS.map(t=>t.Code.split("_").at(-1));return e.SEASON_DETAILS.find(t=>t.Code.split("_ss").at(-1)===n)?.Code}parserType="Season Code"}};var f=n(833);const E=new Set(["p1.picks","p2.picks","p1.prebans","p2.prebans","prebans","postbans"]),d={FIELD:"FIELD",RANGE:"RANGE",SET:"SET",INT:"INT",DATE:"DATE",BOOL:"BOOL",STRING:"STRING"};class p{}class _ extends p{type=d.FIELD;rawString;extractFn;constructor(t){if(super(),this.rawString=t,!f.j[t])throw new Error("Invalid field");this.extractFn=f.j[t]}getData(){throw new Error("Not implemented for Field")}extractData(t){return this.extractFn(t)}asString(){return`${this.rawString}`}}class S extends p{rawString;constructor(t){super(),this.rawString=t}getData(){return this.data}extractData(t){throw new Error("Not implemented for Literals")}asString(){return`${this.fmtString}`}}class A extends S{type=d.STRING;fmtString;data;constructor(t,e,n=Object.values(u)){super(t),t=s.A.trimSurroundingQuotes(t),this.data=this.processString(t,e,n),this.fmtString=this.data}processString(t,e,n){const r=function(t,e,n){for(const r of n){const n=r.parse(t,e);if(r.parserType,n)return n}return null}(t,e,n);if(!r){const e=n.map(t=>t.parserType).join(", ");throw new s.A.ValidationError(`Invalid string literal: '${t}' ; could not be parsed as a valid instance of any of the following: [${e}]`)}return r}}class h extends S{type=d.INT;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){const e=parseInt(t);if(isNaN(e))throw new s.A.ValidationError(`Invalid integer literal: '${t}'`);return e}}class T extends S{type=d.BOOL;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){if("true"===t)return!0;if("false"===t)return!1;throw new s.A.ValidationError(`Invalid boolean literal: '${t}'`)}}class m extends S{type=d.DATE;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){return s.A.parseDate(t).getTime()}}class g{start;end;endInclusive;constructor(t,e,n){this.start=t,this.end=e,this.endInclusive=n}has(t){return"number"==typeof t&&"number"==typeof this.start&&"number"==typeof this.end&&(!(t<this.start)&&(!(t>this.end)&&(t!==this.end||this.endInclusive)))}includes(t){return this.has(t)}}const w=[t=>o.L.DATE_LITERAL_RE.test(t)?new m(t):null,t=>o.L.INT_LITERAL_RE.test(t)?new h(t):null];function R(t,e,n,r){let a=r(t),o=r(e);return null===a||null===o?null:new g(a.data,o.data,n)}class O extends S{type=d.RANGE;fmtString;data;constructor(t,e){super(t),this.fmtString=t,this.data=this.processString(t,e)}processString(t,e){const n=t.split("..."),r=n[0];let a="="===n[1].charAt(0);const o=n[1].slice(a?1:0);for(const t of w){const e=R(r,o,a,t);if(null!==e)return e}throw new s.A.ValidationError(`Invalid range literal: '${t}' ; ranges must be homogenous and of the format x...y or x...=y for the types: [Date, Integer]`)}}const y=[...w],L=(t,e,n)=>o.L.STRING_RE.test(t)?new A(t,e,n):null;class v extends S{type=d.SET;fmtString;data;constructor(t,e,n=Object.values(u)){super(t),this.fmtString=t,this.data=this.processString(t,e,n)}processString(t,e,n){let r=s.A.tokenizeWithNestedEnclosures(t,",",1,!0);r=r.filter(t=>""!==t);const a=new Set;for(const o of r){let r=null;for(const t of y)if(r=t(o),r){a.add(r.data);break}if(!r){if(r=L(o,e,n),!r)throw new s.A.ValidationError(`Invalid set element: '${t}' ; could not be parsed as a valid instance of any of the following types: [Date, Integer, String]`);a.add(r.data)}}return this.fmtString=`{${Array.from(a).join(", ")}}`,a}}const N={StringLiteral:A,IntLiteral:h,BoolLiteral:T,DateLiteral:m,RangeLiteral:O,SetLiteral:v,Field:_,BaseEltTypes:d,FIELD_EXTRACT_FN_MAP:f.j,parseBaseElement:function(t,e){if(o.L.STRING_LITERAL_RE.test(t))return new A(t,e);if(o.L.INT_LITERAL_RE.test(t))return new h(t);if(o.L.BOOL_LITERAL_RE.test(t))return new T(t);if(o.L.DATE_LITERAL_RE.test(t))return new m(t);if(o.L.RANGE_LITERAL_RE.test(t))return new O(t,e);if(o.L.SET_LITERAL_RE.test(t))return new v(t,e);if(o.L.SEASON_LITERAL_RE.test(t))return new A(t,e,[u.Season]);if(o.L.FIELD_WORD_LITERAL_RE.test(t))return new _(t);throw new s.A.ValidationError(`Invalid base element: '${t}' ; could not be parsed as a Field or Literal.`)},COLLECTION_FIELDS_SET:E};const b={">":(t,e)=>t>e,"<":(t,e)=>t<e,"=":(t,e)=>t===e,">=":(t,e)=>t>=e,"<=":(t,e)=>t<=e,"!=":(t,e)=>t!==e},P="in",I="compare";class D{}class C extends D{type=P;opStr;negate=!1;constructor(t=!1){super(),this.negate=t,this.opStr=this.negate?"!in":"in"}call(t,e){const n=Array.isArray(e)?e.includes(t):e.has(t);return this.negate?!n:n}}class x extends D{type=I;opStr;compareFn;constructor(t){if(super(),this.opStr=t,this.compareFn=b[t],!this.compareFn)throw new Error(`Unknown operator: ${t}`)}call(t,e){return this.compareFn(t,e)}}function F(t){switch(t){case"in":return new C;case"!in":return new C(!0);default:return new x(t)}}const M={AND:"and",OR:"or",XOR:"xor",NOT:"not",LAST_N:"last-n",EQUIPMENT:"equipment",ARTIFACT:"artifact",CR:"cr",BASE_FILTER:"base-filter"},B="CLAUSE_FN",U="HERO_LIST_FN",H="GLOBAL_FN",G="BASE_FILTER";class k{}class j extends k{}class K extends j{fnType=B;fns=[];constructor(...t){super(),this.fns=t}asString(t=""){let e="";const n=t+c.RG;return this.fns.forEach(t=>e+=`${t.asString(n)},\n`),`${t}${this.fnName}(\n${e.trimEnd()}\n${t})`}}class $ extends K{fnName=M.AND;fnType=B;call(t){return this.fns.every(e=>e.call(t))}}class Y extends K{fnName=M.OR;fnType=B;call(t){return this.fns.some(e=>e.call(t))}}class V extends K{fnName=M.XOR;fnType=B;call(t){let e=!1;for(let n of this.fns)e=!e&&n.call(t)||e&&!n.call(t);return e}}class W extends K{fnName=M.NOT;fnType=B;constructor(...t){if(super(...t),1!==this.fns.length)throw new s.A.SyntaxException(`Invalid NOT function call ; accepts exactly 1 argument ; got: [${this.fns}]`)}call(t){return!this.fns[0].call(t)}}class q extends j{fnType=U;getHeroes(t){return this.isPlayer1?t[a.Lx.P1_PICKS]:t[a.Lx.P2_PICKS]}asString(t=""){return`${t}${this.isPlayer1?"p1.":"p2."}${this.fnName}(${this.argFmtString})`}}class z extends q{fnName=M.CR;fnType=U;heroName;crThreshold=0;operator;targetField;isPlayer1=!1;argFmtString;constructor(t,e){super();const n=t.includes(",")?",":" ",r=s.A.tokenizeWithNestedEnclosures(t,n,1,!0);if(3!==r.length)throw new s.A.SyntaxException(`Invalid CR function call ; accepts exactly 3 arguments ; got: [${r}] from str: ${t}`);const o=parseInt(r[2]);if(isNaN(o))throw new s.A.TypeException(`Invalid CR function call ; third argument must be a valid integer literal ; got: '${r[2]}' from str: ${t}`);const i=F(r[1]);if(!(i instanceof x))throw new s.A.TypeException(`Invalid CR function call ; second argument must be a valid comparison operator ; got: '${r[1]}' from str: ${t}`);this.heroName=new N.StringLiteral(r[0],e,[u.Hero]).data,this.crThreshold=o,this.operator=i,this.isPlayer1=t.includes("p1."),this.targetField=t=>t[a.Lx.CR_BAR],this.argFmtString=`${this.heroName} ${this.operator.opStr} ${this.crThreshold}`}call(t){const e=this.getHeroes(t),n=this.targetField(t).find(t=>t[0]===this.heroName);return!!n&&(!!e.includes(this.heroName)&&this.operator.call(n[1],this.crThreshold))}}function Q(t,e){for(const n in t)if(t[n]>(e[n]||0))return!1;return!0}class J extends q{fnName=M.EQUIPMENT;fnType=U;heroName;targetEquipCounts;isPlayer1=!1;argFmtString;targetField;constructor(t,e){super();const n=s.A.tokenizeWithNestedEnclosures(t,",",1,!0);if(2!==n.length)throw new s.A.SyntaxException(`Invalid equipment function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${t}`);const o=n[1].includes("{")?n[1]:`{${n[1]}}`;let i=s.A.tokenizeWithNestedEnclosures(o,",",1,!0);i=i.map(t=>new N.StringLiteral(t,e,[u.Equipment]).data),this.targetEquipCounts=(0,r.J)(i),this.heroName=new N.StringLiteral(n[0],e,[u.Hero]).data,this.isPlayer1=t.includes("p1."),this.argFmtString=`${this.heroName}, {${i.join(",")}}`,this.targetField=t=>this.isPlayer1?t[a.Lx.P1_EQUIPMENT]:t[a.Lx.P2_EQUIPMENT]}call(t){const e=this.getHeroes(t),n=this.targetField(t);for(let t=0;t<e.length;t++)if(e[t]===this.heroName){const e=(0,r.J)(n[t]);return Q(this.targetEquipCounts,e)}return!1}}class X extends q{fnName=M.ARTIFACT;fnType=U;heroName;targetArtifacts;isPlayer1=!1;argFmtString;targetField;constructor(t,e){super();const n=s.A.tokenizeWithNestedEnclosures(t,",",1,!0);if(2!==n.length)throw new s.A.SyntaxException(`Invalid artifact function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${t}`);const r=n[1].includes("{")?n[1]:`{${n[1]}}`;let o=s.A.tokenizeWithNestedEnclosures(r,",",1,!0);o=o.map(t=>new N.StringLiteral(t,e,[u.Artifact]).data),this.targetArtifacts=o,this.heroName=new N.StringLiteral(n[0],e,[u.Hero]).data,this.isPlayer1=t.includes("p1."),this.argFmtString=`${this.heroName}, {${o.join(", ")}}`,this.targetField=t=>this.isPlayer1?t[a.Lx.P1_ARTIFACTS]:t[a.Lx.P2_ARTIFACTS]}call(t){const e=this.getHeroes(t),n=this.targetField(t);for(let t=0;t<e.length;t++)if(e[t]===this.heroName)return this.targetArtifacts.some(e=>n[t].includes(e));return!1}}class Z extends k{fnType=H;asString(t=""){return`${t}${this.fnName}(${this.argFmtString})`}}class tt extends Z{fnName=M.LAST_N;fnType=H;argFmtString;n;constructor(t){super();const e=s.A.tokenizeWithNestedEnclosures(t,",",1,!0);if(1!==e.length)throw new s.A.SyntaxException(`Invalid last-n function call ; accepts exactly 1 argument ; got: [${e}] from str: ${t}`);this.n=new N.IntLiteral(e[0]).data,this.argFmtString=`${this.n}`}call(t){return t.slice(-this.n)}}function et(t,e,n){const r=`${t.asString()} ${e.opStr} ${n.asString()}`;if(t instanceof N.Field&&n instanceof N.Field)throw new s.A.ValidationError(`Invalid base filter; fields cannot be compared with other fields ; got string: [${r}]`);if(t.type!==N.BaseEltTypes.FIELD&&n.type!==N.BaseEltTypes.FIELD)throw new s.A.ValidationError(`Invalid base filter; every base filter must have at least one field ; got string: [${r}]`);if(e instanceof C&&(a=n,!(N.COLLECTION_FIELDS_SET.has(a.rawString)||n instanceof N.RangeLiteral||n instanceof N.SetLiteral)))throw new s.A.ValidationError(`Invalid base filter; 'in' operators can only be used with Ranges, Sets, or Fields that correspond to sets like 'p1.picks' ; got string: [${r}]`);var a;return!0}class nt extends j{fnType=G;fnName=M.BASE_FILTER;fmtString;fn;constructor(t,e){super();const n=s.A.tokenizeWithNestedEnclosures(t," ",0,!0);if(3!==n.length)throw new s.A.SyntaxException(`Invalid base filter; filters must have 3 tokens and be of the form: ['X', operator, 'Y']; got tokens: [${n}] from str: ${t}`);let[r,a,o]=n;const i=F(a),c=N.parseBaseElement(r,e),l=N.parseBaseElement(o,e);if(c.asString(),l.asString(),et(c,i,l),c instanceof N.Field&&!(l instanceof N.Field))this.fn=t=>i.call(c.extractData(t),l.getData());else{if(c instanceof N.Field||!(l instanceof N.Field))throw new s.A.ValidationError("Invalid base filter; filters must contain a Field and a Literal; got: "+t);this.fn=t=>i.call(c.getData(),l.extractData(t))}this.fmtString=`${c.asString()} ${a} ${l.asString()}`}call(t){return this.fn(t)}asString(t=""){return`${t}${this.fmtString}`}}const rt={[M.BASE_FILTER]:nt,[M.AND]:$,[M.OR]:Y,[M.NOT]:W,[M.XOR]:V,[M.LAST_N]:tt,[M.EQUIPMENT]:J,[M.ARTIFACT]:X,[M.CR]:z},at={AND:$,OR:Y,NOT:W,XOR:V,LAST_N:tt,EQUIPMENT:J,ARTIFACT:X,CR:z,BASE_FILTER:nt}},54:(t,e,n)=>{n.d(e,{A:()=>E});var r=n(207);class a extends Error{constructor(t){super(t),this.name="Filter Syntax Exception"}}class o extends Error{constructor(t){super(t),this.name="Filter Type Exception"}}class s extends Error{constructor(t){super(t),this.name="Filter Validation Error"}}const i={"(":")","{":"}",'"':'"',"'":"'"},c={"'":'"','"':"'"},l=Object.fromEntries(Object.entries(i).filter(([t,e])=>t!==e).map(([t,e])=>[e,t]));function u(t){const e={};for(const n of t)e[n]=(e[n]||0)+1;return e}function f(t){return new Date(`${t}T00:00:00Z`)}const E={SyntaxException:a,TypeException:o,ValidationError:s,getCharCounts:u,tokenizeWithNestedEnclosures:function(t,e=" ",n=0,r=!0){const o=[];let s="",f=[];for(let E=0;E<t.length;E++){const d=t[E];if(e.includes(d)&&f.length===n)s&&(o.push(r?s.trim():s),s="");else if(l[d]){const e=l[d];if(f.length>n&&(s+=d),f[f.length-1]!==e){const e=u(t);throw(e["'"]||0)%2!=0||(e['"']||0)%2!=0?new a(`Error tokenizing: Unbalanced closing character at position ${E}; got string: '${t}' ; if a str type has quote characters in it, wrap it in the opposite quote character.`):new a(`Error tokenizing: Unbalanced closing character at position ${E}; got string: '${t}'`)}f.pop()}else f.length>=n&&(s+=d),!i[d]||c[d]&&f[f.length-1]===c[d]||(f[f.length-1]===i[d]&&d===i[d]?f.pop():f.push(d))}if(f.length>0)throw new Error(`Unbalanced enclosures in input string; unresolved characters from enclosure stack: [ ${f.join(", ")} ]`);return s&&o.push(r?s.trim():s),o},parseDate:function(t){if(!r.L.DATE_LITERAL_RE.test(t))throw new a(`Invalid date; must be in the format: YYYY-MM-DD ( regex: ${r.L.DATE_LITERAL_RE.source} ); got: '${t}'`);const e=f(t);if(isNaN(e.getTime()))throw new a(`Invalid date; could not be parsed as a valid date; got: '${t}'`);const n=e.toISOString().split("T")[0],[o,s,i]=n.split("-").map(Number);if(e.getUTCFullYear()!==o||e.getUTCMonth()+1!==s||e.getUTCDate()!==i)throw new a(`Invalid date; parsed date: ${e.toISOString()} does not match passed in string: ${t}`);return e.toISOString(),e.constructor.name,e},tryConvert:function(t,e,n,r=null){null===r&&(r=`Could not convert ${n} to ${e}`);try{return t(n)}catch(t){throw new o(`${r}: ${t.message}`)}},trimSurroundingQuotes:function(t){return t.replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")},castStringToUTCDate:f}},58:(t,e,n)=>{n.d(e,{I:()=>f,q:()=>u});var r=n(541),a=n(623),o=n(412),s=["Hero Name","Battles","Pick Rate","Wins","Win Rate","Postban Rate","Success Rate","+/-","Point Gain","Avg CR","First Turn Rate"],i=[{tbl:a.A.HOME_PAGE.SEASON_DETAILS_TBL,cols:["","Season","Start","End","Status"]},{tbl:a.A.HOME_PAGE.PERFORMANCE_STATS_TBL,cols:["","Battles","Freq","Wins","Win Rate","+/-","FP WR","SP WR"]},{tbl:a.A.HOME_PAGE.FIRST_PICK_STATS_TBL,cols:["Hero","Battles","Pick Rate","Win Rate","+/-"]},{tbl:a.A.HOME_PAGE.PREBAN_STATS_TBL,cols:["Preban","Battles","Ban Rate","Win Rate","+/-"]},{tbl:a.A.HOME_PAGE.PLAYER_TBL,cols:s},{tbl:a.A.HOME_PAGE.OPPONENT_TBL,cols:s.filter(function(t){return!t.toLowerCase().includes("success")})},{tbl:a.A.HOME_PAGE.BATTLES_TBL,cols:Object.values(o.Lx).filter(function(t){return!t.toLowerCase().includes("prime")})}];function c(t,e){var n=t.id;new r.j5(t,n+"-head",n+"-body").addColumns(e)}var l=[{tblID:a.A.HOME_PAGE.IDS.HERO_PLAYER_TBL,cols:s},{tblID:a.A.HOME_PAGE.IDS.HERO_OPPONENT_TBL,cols:s.filter(function(t){return!t.toLowerCase().includes("success")})}];function u(){l.forEach(function(t){c(a.A.HOME_PAGE.getElt(t.tblID),t.cols)})}function f(){i.forEach(function(t){c(t.tbl,t.cols)})}},82:(t,e,n)=>{n.d(e,{j:()=>c});var r=n(836),a=n(412),o=n(771);function s(t,e,n){const r={user:t,filterStr:n,battles:{headers:[],rows:[]}};var o;return r.battles=(o=Object.values(e),{headers:a.se,rows:o.map(t=>a.se.map(e=>JSON.stringify(t[e])))}),r}function i(t){if(!t||"object"!=typeof t)throw new Error("Invalid upload: data is null, undefined, or not an object");if(!("user"in t))throw new Error("Invalid upload: missing 'user' field");if((0,o.l)(t.user),!("battles"in t))throw new Error("Invalid upload: missing 'battles' field");return function(t){if(!t||"object"!=typeof t)return!1;if(!("headers"in t)||!Array.isArray(t.headers))throw new Error("Invalid upload: missing headers field");if(t.headers.length!==a.se.length)throw new Error(`Invalid upload: expected ${a.se.length} headers, got ${t.headers.length}`);for(let e=0;e<a.se.length;e++)if(a.se[e]!==t.headers[e])throw new Error(`Invalid upload: headers do not match at index ${e}; expected ${a.se[e]}, got ${t.headers[e]}`);if(!("rows"in t)||!Array.isArray(t.rows))throw new Error("Invalid upload: missing rows field or rows is not an array");if(0===t.rows.length)throw new Error("Invalid upload: uploaded data has no battles");for(let e=0;e<t.rows.length;e++){const n=t.rows[e];if(n.length!==a.se.length)throw new Error(`Invalid upload: expected ${a.se.length} columns per row, got ${n.length} at index ${e}`)}}(t.battles),!0}const c={triggerDownload:async function(){const t=await r.n.UserManager.getUser();if(!t)throw new Error("User not found; cannot export data without an active user");const e=await r.n.ClientCache.getStats(),n=await r.n.ClientCache.getFilterStr()||void 0,a=e.areFiltersApplied?" Filtered":"";let o=e.areFiltersApplied?Object.values(e.filteredBattlesObj):e.battles;o=o||[];const i=await s(t,o,n),c=(new Date).toISOString().split("T")[0]||"";!function(t,e){const n=JSON.stringify(e),r=new Blob([n],{type:"application/json"}),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download=t.endsWith(".json")?t:`${t}.json`,o.click(),URL.revokeObjectURL(a)}(`${t.name} (${t.id})${a} ${c}`,i)},parseJSON:async function(t){!function(t,e=".json",n=60){if(!t.name.endsWith(".json"))throw new Error("File must be .json");const r=1024*n*1024;if(t.size>r)throw new Error(`File must be smaller than ${n}mb, got ${t.size/1048576}mb File.`)}(t);const e=await t.text(),n=JSON.parse(e);return i(n),n},restructureParsedUploadBattles:function(t){const e=[];for(const n of t.rows){const t={};a.se.forEach((e,r)=>{t[e]=n[r]}),e.push(t)}return function(t){const e=new Set(t.map(t=>t[a.Lx.P1_ID])),n=new Set(t.map(t=>t[a.Lx.P1_SERVER]));if(1!==e.size)throw new Error(`Invalid upload: Multiple P1 IDs found in upload: {${Array.from(e).join(", ")}}`);if(1!==n.size)throw new Error(`Invalid upload: Multiple P1 Servers found in upload: {${Array.from(n).join(", ")}}`);const r=n.values().next().value?.replace(/"|'/g,"");if(!r||!Object.values(a.DB).includes(r))throw new Error(`Invalid upload: Invalid P1 Server found in upload: '${r}'`)}(e),e}}},84:(t,e,n)=>{n.d(e,{S:()=>E});var r=n(834),a=n(528),o=n(207),s=n(469),i=n(42),c=n(971),l=n(54),u=n(545);function f(t){return function(t,e,n){for(let r of t)if(!e.has(r))throw new l.A.SyntaxException(`Invalid character within <${n}> ; ' ${r} ' is not allowed; got string: '${t}'`)}(t=t.replace(/[\n\t\r]/g," ").replace(/\s+/g," "),c.yL,"Main Filter String"),t=t.toLowerCase()}class E{_filters;rawString;preParsedString;references;constructor(){this._filters=[],this.rawString="",this.preParsedString="",this.references={HeroDicts:null,ARTIFACT_LOWERCASE_STRINGS_MAP:{},SEASON_DETAILS:[]}}async addReferences(t=null){if(null===(t=t||await a.A.getHeroDicts()))throw new Error("Hero Manager could not be retrieved to parse filters.");const e=await s.A.getSeasonDetails();if(null===e)throw new Error("Season Details could not be retrieved to parse filters.");const n=await r.A.getArtifactLowercaseNameMap();this.references={HeroDicts:t,ARTIFACT_LOWERCASE_STRINGS_MAP:n,SEASON_DETAILS:e}}getFilters(){return function(t){const e=[],n=[];for(const r of t)r instanceof i.y4?e.push(r):n.push(r);return[...e,...n]}(this._filters)}asString(){const t=c.RG;return`[\n${this._filters.map(e=>e.asString(t)).join(";\n")};\n]`}static async getFiltersFromCache(t=null){const e=await u.A.get(u.A.Keys.FILTER_STR);if(null===e)return[];return(await this.fromFilterStr(e,t)).getFilters()}static async fromFilterStr(t,e=null){const n=new E;return n.rawString=t,await n.addReferences(e),n.preParsedString=f(t),n._filters=n.parse(n.preParsedString),n}parseList(t){return t.reduce((t,e)=>(t.push(...this.parse(e)),t),[])}parse(t){if(""===(t=t.trim()))return[];if(t.includes(";")){const e=t.split(";");return this.parseList(e)}const e=t.split("(")[0].replace(/p[1-2]\./i,""),n=l.A.tokenizeWithNestedEnclosures(t,",",1,!0);switch(e){case i.eR.AND:case i.eR.OR:case i.eR.NOT:case i.eR.XOR:const r=function(t,e){for(const n of t)if(n instanceof i.y4)throw new l.A.SyntaxException(`Global filters not allowed in clause functions; got: ${n.asString()} from string: "${e}"`);return t.filter(t=>t instanceof i.Qo)}(this.parseList(n),t);return[new i.CO[e](...r)];case i.eR.LAST_N:return[new i.c2.LAST_N(t)];case i.eR.EQUIPMENT:case i.eR.ARTIFACT:case i.eR.CR:return[new i.CO[e](t,this.references)];default:if(o.L.FUNCTION_CALL_RE.test(t))throw new l.A.SyntaxException(`Filter String is not a valid function call but a parenthese block was detected; got: ${t}`);return[new i.c2.BASE_FILTER(t,this.references)]}}}},92:(t,e,n)=>{function r(t){return t.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())}function a(t){return t.reduce((t,e)=>(t[e]=(t[e]||0)+1,t),{})}n.d(e,{J:()=>a,S:()=>r})},136:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(545);const a={ACTIONS:{CLEAR_USER:"CLEAR_USER",SHOW_NO_USER_MSG:"SHOW_NO_USER_MSG",SHOW_DATA_ALREADY_CLEARED_MSG:"SHOW_DATA_ALREADY_CLEARED_MSG",QUERY_USER:"QUERY_USER",REFRESH_REFERENCES:"REFRESH_REFERENCES"},getState:async function(){return await r.A.get(r.A.Keys.INTER_PAGE_MANAGER)??{actions:[],messages:[]}},setState:async function(t){await r.A.cache(r.A.Keys.INTER_PAGE_MANAGER,t)},pushActions:async function(t){let e=await this.getState();e.actions.push(...t),await this.setState(e)},pushAction:async function(t){let e=await this.getState();e.actions.push(t),await this.setState(e)},makeAction:function(t,e){return{action:t,message:e}},flushState:async function(){const t=await this.getState();return await r.A.delete(r.A.Keys.INTER_PAGE_MANAGER),t}}},149:(t,e,n)=>{n.d(e,{W:()=>a});var r=n(836);const a={changeLang:async function(t){await r.n.ClientCache.setLang(t),await r.n.HeroManager.fetchAndCacheHeroManager(t),window.location.reload()},getLang:async function(){return await r.n.ClientCache.getLang()}}},172:(t,e,n)=>{n.d(e,{GF:()=>p,ev:()=>E,l5:()=>_});var r=n(494),a=n(623);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function l(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var f={RED:"text-danger",GREEN:"text-safe",E_BLUE:"text-e-blue"},E=l(function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=e,this.docElement=n,this.classList=r});function d(t){if(!t instanceof E)throw new Error("Only instances of TextPacket can be passed to this function")}var p={queue:[],autoClearElements:[],TextPacket:E,STYLES:f,clearStyles:function(t){for(var e=0,n=Object.values(f);e<n.length;e++){var r=n[e];t.classList.remove(r)}},write:function(t){d(t),t.docElement.textContent=t.text,this.clearStyles(t.docElement),t.classList.forEach(function(e){t.docElement.classList.add(e)})},writeStr:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.write(new E(t,e,n))},writeStrFromID:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=r.K.unwrapHtmlElt(e);this.writeStr(t,a,n)},push:function(t){d(t),this.queue.push(t)},pushFromObj:function(t){var e=t.text,n=t.docElement,r=t.classList;this.push(new E(e,n,r))},bindAutoClear:function(t){var e,n=s(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.autoClearElements.push(r)}}catch(t){n.e(t)}finally{n.f()}},processQueue:function(){var t=this;this.queue.forEach(function(e){t.write(e)}),this.queue=[]},clearMessages:function(){var t,e=s(this.autoClearElements);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.textContent="",this.clearStyles(n)}}catch(t){e.e(t)}finally{e.f()}}};var _={queueSelectDataMsgGreen:function(t){p.push(new E(t,a.A.HOME_PAGE.SELECT_DATA_MSG,[f.GREEN]))},queueSelectDataMsgRed:function(t){p.push(new E(t,a.A.HOME_PAGE.SELECT_DATA_MSG,[f.RED]))},queueFilterMsgGreen:function(t){p.push(new E(t,a.A.HOME_PAGE.FILTER_MSG,[f.GREEN]))},queueFilterMsgRed:function(t){p.push(new E(t,a.A.HOME_PAGE.FILTER_MSG,[f.RED]))}}},181:(t,e,n)=>{n.d(e,{S:()=>l});var r=n(507);const a={SOURCE:{QUERY:"query",UPLOAD:"upload",STATS:"stats"}},o={...Object.fromEntries(Object.values(r.D).map(t=>[t,0])),toString:function(){return JSON.stringify(this,null,2)}},s={SOURCE:"SOURCE",AUTO_ZOOM:"AUTO_ZOOM",AUTO_QUERY:"AUTO_QUERY",STATS_POST_RENDER_COMPLETED:"STATS_POST_RENDER_COMPLETED",STATS_PRE_RENDER_COMPLETED:"STATS_PRE_RENDER_COMPLETED",SCROLL_PERCENTS:"SCROLL_PERCENTS",CODE_MIRROR_EDITOR:"CODE_MIRROR_EDITOR",TRY_SET_USER:"TRY_SET_USER",IGNORE_RELAYOUT:"IGNORE_RELAYOUT",IS_FIRST_RENDER:"IS_FIRST_RENDER"};function i(t){switch(t){case s.AUTO_ZOOM:return!1;case s.SOURCE:case s.AUTO_QUERY:return null;case s.STATS_POST_RENDER_COMPLETED:case s.STATS_PRE_RENDER_COMPLETED:return!1;case s.SCROLL_PERCENTS:return o;case s.CODE_MIRROR_EDITOR:case s.TRY_SET_USER:return null;case s.IGNORE_RELAYOUT:return!1;case s.IS_FIRST_RENDER:return!0;default:return console.error(`No default value for key: ${t}`),null}}const c=Object.fromEntries(Object.entries(s).map(([t])=>[t,i(t)]));const l=function(){const t={KEYS:s,VALUES:a,...c,popKey:function(t){const e=this[t];return this[t]=i(t),e},readKey:function(t){return this[t]},toString(){let t="CONTEXT:\n";for(const e in s){t+=`\t${e}: ${this[e]}\n`}return t}};return t.toString(),t}()},207:(t,e,n)=>{n.d(e,{L:()=>F});var r=n(833);function a(t,e="i"){return new RegExp(`^(?:${t.source})(?=[,)\\s;]|$)`,e)}function o(t,e="i"){return new RegExp(`^(?:${t.source})$`,e)}function s(t,e="i"){if(t.length<1)throw new Error("orRegex must have at least one pattern");let n=`(?:${t[0].source})`;for(let e=1;e<t.length;e++)n+=`|(?:${t[e].source})`;return new RegExp(n,e)}const i=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=Object.keys(r.j),l=new RegExp(`^(?:${c.map(i).join("|")})`,"i"),u=new RegExp(`(?:${["and","or","xor","not"].map(i).join("|")})(?=\\()`,"i"),f=new RegExp(`(?:${["last-n"].map(i).join("|")})(?=\\()`,"i"),E=new RegExp(`(?:${["p1.equipment","p2.equipment","p1.artifact","p2.artifact","p1.cr","p2.cr"].map(i).join("|")})(?=\\()`,"i"),d=s([u,f,E]),p=/.*/i,_=/\d{4}-\d{2}-\d{2}/,S=/\{\s*\}/,A=/-?\d+/,h=/season-[1-9]+[0-9]*f?|current-season|last-season/i,T=/pvp_rta_ss[1-9]+[0-9]*f?/i,m=new RegExp(`^${_.source}$`,"i"),g=new RegExp(`(?:${h.source})`,"i"),w=p.source,R=A.source,O=_.source,y=l.source,L=g.source,v=/"[^"]*"|'[^']*'/i,N=o(v),b=new RegExp(`(?:${v.source}|${w}|${O})`,"i"),P=new RegExp(`(?:${y}|${L})`,"i"),I=b.source,D=new RegExp(`\\{\\s*(?:${I}\\s*)(?:,\\s*${I}\\s*)*,?\\s*\\}|${S.source}`,"i"),C=new RegExp(`${R}\\.\\.\\.=?${R}|${O}\\.\\.\\.=?${O}`),x=new RegExp(`^${C.source}$`);let F={STRING_RE:p,DATE_RE:_,INT_RE:A,EMPTY_SET_RE:S,SET_ELEMENT_RE:b,SET_RE:D,SET_LITERAL_RE:o(D),STRING_LITERAL_RE:N,DATE_LITERAL_RE:m,INT_LITERAL_RE:/^-?\d+$/,BOOL_LITERAL_RE:/^(true|false)$/i,RANGE_RE:C,RANGE_LITERAL_RE:x,SEASON_RE:h,SEASON_LITERAL_RE:o(h),SEASON_CODE_RE:T,SEASON_CODE_LITERAL_RE:o(T),DATA_WORD_RE:g,DATA_WORD_LITERAL_RE:o(g),FIELD_WORD_RE:l,FIELD_WORD_LITERAL_RE:o(l),DATAFIELD_RE:P,GLOBAL_FILTER_RE:/last-n\(\d+\)/i,ANCHORED_STR_LITERAL_RE:o(N),CLAUSE_FUNCTIONS_RE:u,DIRECT_FUNCTIONS_RE:E,GLOBAL_FUNCTIONS_RE:f,FUNCTIONS_RE:d,FUNCTION_CALL_RE:/\(.*\)/i,padRegex:a,anchorExp:o,tokenMatch:function(t){return function(t){return t.match(d)?"keyword":t.match(/\s+(?:!=|<|>|=|>=|<=|in|!in)(?=\s+)/i)?"operator":t.match(new RegExp(`[a-z0-9."'}=)-]${P.source}(?=[,)\\s;]|$)`,"i"))?null:t.match(a(l))?"field":t.match(a(g))?"declared-data":t.match(a(v))?"string":t.match(a(D))?"set":t.match(a(C))?"range":t.match(/[^(,\s;.=0-9\-]+\d+/i)?null:t.match(a(A))||t.match(a(_))||t.match(/(?:^|\s)(?:true|false)(?=[,)\s;]|$)/i)?"declared-data":t.match(/[\(\)\{\}\;\,]/)?"bracket":(t.next(),null)}(t)},orRegex:s,escapeRegex:i}},275:(t,e,n)=>{function r(){var t,e,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function i(n,r,o,s){var i=r&&r.prototype instanceof l?r:l,u=Object.create(i.prototype);return a(u,"_invoke",function(n,r,a){var o,s,i,l=0,u=a||[],f=!1,E={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,i=t,E.n=n,c}};function d(n,r){for(s=n,i=r,e=0;!f&&l&&!a&&e<u.length;e++){var a,o=u[e],d=E.p,p=o[2];n>3?(a=p===r)&&(i=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,E.v=r,E.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,E.n=p,s=0))}if(a||n>1)return c;throw f=!0,r}return function(a,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),s=u,i=p;(e=s<2?t:i)||!f;){o||(s?s<3?(s>1&&(E.n=-1),d(s,i)):E.n=i:E.v=i);try{if(l=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=E.n<0)?i:n.call(r,E))!==c)break}catch(e){o=t,s=1,i=e}finally{l=1}}return{value:e,done:f}}}(n,o,s),!0),u}var c={};function l(){}function u(){}function f(){}e=Object.getPrototypeOf;var E=[][o]?e(e([][o]())):(a(e={},o,function(){return this}),e),d=f.prototype=l.prototype=Object.create(E);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,a(t,s,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=f,a(d,"constructor",f),a(f,"constructor",u),u.displayName="GeneratorFunction",a(f,s,"GeneratorFunction"),a(d),a(d,s,"Generator"),a(d,o,function(){return this}),a(d,"toString",function(){return"[object Generator]"}),(r=function(){return{w:i,m:p}})()}function a(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var s=function(e,n){a(t,e,function(t){return this._invoke(e,n,t)})};s("next",0),s("throw",1),s("return",2)}},a(t,e,n,r)}function o(t,e,n,r,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}function s(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var s=t.apply(e,n);function i(t){o(s,r,a,i,c,"next",t)}function c(t){o(s,r,a,i,c,"throw",t)}i(void 0)})}}n.d(e,{A:()=>d});var i,c,l,u,f,E;const d={test:function(t){t.rank_plot},fetchFromPython:(E=s(r().m(function t(e){var n,a;return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch(e);case 1:if((n=t.v).ok){t.n=3;break}return t.n=2,fetch(e);case 2:n=t.v;case 3:return t.n=4,n.json();case 4:return a=t.v,t.a(2,a||null)}},t)})),function(t){return E.apply(this,arguments)}),fetchHeroData:(f=s(r().m(function t(){return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.fetchFromPython("/api/get_hero_data");case 1:return t.a(2,t.v)}},t,this)})),function(){return f.apply(this,arguments)}),rsFetchBattleData:(u=s(r().m(function t(e){return r().w(function(t){for(;;)switch(t.n){case 0:if(e){t.n=1;break}throw new Error("Must pass user to fetch battles data");case 1:return t.n=2,fetch("/api/rs_get_battle_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e})});case 2:return t.a(2,t.v)}},t)})),function(t){return u.apply(this,arguments)}),fetchSeasonDetails:(l=s(r().m(function t(){var e,n,a;return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("/api/get_season_details");case 1:return e=t.v,t.n=2,e.json();case 2:if(!(n=t.v).success){t.n=3;break}return a=JSON.parse(n.seasonDetails),t.a(2,{seasonDetails:a,error:!1});case 3:return t.a(2,{seasonDetails:null,error:n.error});case 4:return t.a(2)}},t)})),function(){return l.apply(this,arguments)}),fetchArtifactJson:(c=s(r().m(function t(){var e,n,a;return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("/api/get_artifact_json");case 1:return e=t.v,t.n=2,e.json();case 2:if(!(n=t.v).success){t.n=3;break}return a=JSON.parse(n.artifactJson),t.a(2,a);case 3:return t.a(2,null);case 4:return t.a(2)}},t)})),function(){return c.apply(this,arguments)}),fetchUser:(i=s(r().m(function t(e){var n,a,o;return r().w(function(t){for(;;)switch(t.n){case 0:if(e.name&&e.world_code||e.id){t.n=1;break}throw new Error("Must pass a user object with either user.name and user.world_code or user.id to fetch user");case 1:return t.n=2,fetch("/api/get_user_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userData:e})});case 2:return n=t.v,t.n=3,n.json();case 3:if(a=t.v,n.ok){t.n=4;break}throw new Error("Flask server error: ".concat(a.error));case 4:if(a.foundUser){t.n=6;break}if(e.world_code){t.n=5;break}return t.a(2,{user:null,ok:!0});case 5:return t.a(2,{user:null,ok:!0});case 6:return o=a.user,"Found user: ".concat(JSON.stringify(o)),t.a(2,{user:o,ok:!0})}},t)})),function(t){return i.apply(this,arguments)})}},412:(t,e,n)=>{n.d(e,{$k:()=>i,D5:()=>p,DB:()=>s,E_:()=>d,F4:()=>_,F7:()=>o,Lx:()=>f,W4:()=>S,WB:()=>a,Yj:()=>r,hc:()=>l,pc:()=>u,pg:()=>c,se:()=>E});const r={CODES:{DE:"de",KO:"ko",PT:"pt",TH:"th",ZH_TW:"zh-TW",JA:"ja",EN:"en",FR:"fr",ZH_CN:"zh-CN",ES:"es"},NAMES:{DE:"German",KO:"Korean",PT:"Portuguese",TH:"Thai",ZH_TW:"Chinese (Traditional, Taiwan)",JA:"Japanese",EN:"English",FR:"French",ZH_CN:"Chinese (Simplified, China)",ES:"Spanish"}},a=new Set(["world_kor","world_global","world_jpn","world_asia","world_eu"]),o={GLOBAL:"world_global",KOR:"world_kor",JPN:"world_jpn",ASIA:"world_asia",EU:"world_eu"},s={[o.GLOBAL]:"Global",[o.KOR]:"Korea",[o.JPN]:"Japan",[o.ASIA]:"Asia",[o.EU]:"Europe"},i=(s.world_global,o.GLOBAL,s.world_kor,o.KOR,s.world_jpn,o.JPN,s.world_asia,o.ASIA,s.world_eu,o.EU,Object.fromEntries(Object.values(s).map(t=>[t.toLowerCase(),t]))),c={set_speed:"Speed",set_acc:"Hit",set_cri:"Critical",set_res:"Resist",set_def:"Defense",set_att:"Attack",set_max_hp:"Health",set_cri_dmg:"Destruction",set_coop:"Unity",set_immune:"Immunity",set_rage:"Rage",set_vampire:"Lifesteal",set_shield:"Protection",set_revenge:"Revenge",set_penetrate:"Penetration",set_torrent:"Torrent",set_counter:"Counter",set_scar:"Injury",set_revenant:"Reversal",set_riposte:"Riposte"},l=864e5,u={bronze:"Bronze",silver:"Silver",gold:"Gold",master:"Master",challenger:"Challenger",champion:"Champion",warlord:"Warlord",emperor:"Emperor",legend:"Legend"},f={SEASON:"Season",SEASON_CODE:"Season Code",DATE_TIME:"Date/Time",SECONDS:"Seconds",TURNS:"Turns",SEQ_NUM:"Seq Num",P1_ID:"P1 ID",P1_SERVER:"P1 Server",P2_ID:"P2 ID",P2_SERVER:"P2 Server",P1_LEAGUE:"P1 League",P2_LEAGUE:"P2 League",P1_POINTS:"P1 Points",POINT_GAIN:"Point Gain",WIN:"Win",FIRST_PICK:"First Pick",FIRST_TURN:"First Turn",FIRST_TURN_HERO:"First Turn Hero",CR_BAR:"CR Bar",P1_PREBANS:"P1 Prebans",P2_PREBANS:"P2 Prebans",P1_PICKS:"P1 Picks",P2_PICKS:"P2 Picks",P1_POSTBAN:"P1 Postban",P2_POSTBAN:"P2 Postban",P1_EQUIPMENT:"P1 Equipment",P2_EQUIPMENT:"P2 Equipment",P1_ARTIFACTS:"P1 Artifacts",P2_ARTIFACTS:"P2 Artifacts",P1_MVP:"P1 MVP",P2_MVP:"P2 MVP"},E=(Object.values(f).filter(t=>!t.toLowerCase().includes("prime")),Object.values(f).filter(t=>!t.toLowerCase().includes("prime"))),d=[f.P1_EQUIPMENT,f.P2_EQUIPMENT,f.P1_ARTIFACTS,f.P2_ARTIFACTS,f.CR_BAR,f.P1_PREBANS,f.P2_PREBANS,f.P1_PICKS,f.P2_PICKS],p=(f.FIRST_PICK,f.FIRST_TURN,f.WIN,f.SECONDS,f.TURNS,f.P1_POINTS,f.POINT_GAIN,f.P1_LEAGUE,f.P2_LEAGUE,{HERO_NAME:"Hero Name",BATTLES:"Battles",PICK_RATE:"Pick Rate",WINS:"Wins",WIN_RATE:"Win rate",POSTBANS:"Postbans",POSTBAN_RATE:"Postban Rate",SUCCESS_RATE:"Success Rate",PLUS_MINUS:"+/-",POINT_GAIN:"Point Gain",AVG_CR:"Avg CR",FIRST_TURNS:"First Turns",FIRST_TURN_RATE:"First Turn Rate"}),_="https://epic7.onstove.com",S=_+"/gg"},418:(t,e,n)=>{n.d(e,{f:()=>r});class r{wrapperLogic;views;dispatch;initialize;constructor(t,e){this.wrapperLogic=t,this.views=e,this.bindViews()}bindViews(){const t=this;this.dispatch=async function(e){await t.wrapperLogic.preDispatch(e);for(const n of t.views)n.triggerState===e&&await n.handleDispatch(t.dispatch);await t.wrapperLogic.postDispatch(e)},this.initialize=async function(){await t.wrapperLogic.preInitialize(t.dispatch);for(const e of t.views)await e.initialize(t.dispatch);await t.wrapperLogic.postInitialize(t.dispatch)}}appendView(t){this.views.push(t),this.bindViews()}}},469:(t,e,n)=>{n.d(e,{A:()=>c});var r=n(545),a=n(275),o=n(412),s=n(207);let i={fetchAndCacheSeasonDetails:async function(){const t=await a.A.fetchSeasonDetails();if(t.error)throw new Error(`Could not fetch season details: ${t.error}`);const e=t.seasonDetails;e.forEach(t=>{t.range=[t.Start,t.End].map(t=>new Date(`${t.split(" ")[0]}T00:00:00`)),t["Season Number"]=String(t["Season Number"])}),e.sort((t,e)=>parseInt(t["Season Number"])-parseInt(e["Season Number"]));const n=[e[0]];let s=e[0];if(e.slice(1).forEach(t=>{const[e,r]=[new Date(+s.range[1]+o.hc),new Date(+t.range[0]-o.hc)],a=s["Season Number"]+"f",i={"Season Number":a,Code:"pvp_rta_ss"+a,Season:`Pre ${t.Season}`,Start:e.toISOString().slice(0,10),End:r.toISOString().slice(0,10),Status:"Complete",range:[e,r]};n.push(i),n.push(t),s=t}),s.range[1]<new Date){const t=new Date(+s.range[1]+o.hc),e=s["Season Number"]+"f",r={"Season Number":e,Code:"pvp_rta_ss"+e,Season:"Active Pre-Season",Start:t.toISOString().slice(0,10),End:"N/A",Status:"Active",range:[t,new Date]};n.push(r)}return n.reverse(),await r.A.cache(r.A.Keys.SEASON_DETAILS,n),n},getSeasonDetails:async function(){const t=await r.A.get(r.A.Keys.SEASON_DETAILS);return t||await i.fetchAndCacheSeasonDetails()},clearSeasonDetails:async function(){await r.A.delete(r.A.Keys.SEASON_DETAILS)},getSeasonNumFromCode:function(t){return t.split("_").at(-1)},reaquireIfNeeded:async function(t){const e=await i.getSeasonDetails(),n=new Set(e.map(t=>t.Code));t.forEach(t=>{const e=t[o.Lx.SEASON_CODE];s.L.SEASON_CODE_LITERAL_RE.test(e)||console.error("Battle contains invalid season code:",e,t),n.has(t[o.Lx.SEASON_CODE])||i.fetchAndCacheSeasonDetails()})}};const c=i},494:(t,e,n)=>{n.d(e,{K:()=>r});const r={unwrapHtmlElt:function(t){const e=document.getElementById(t);if(null===e)throw new Error(`Could not find element with ID ${t}`);return e},setText:function(t,e){this.unwrapHtmlElt(t).textContent=e}}},497:(t,e,n)=>{n.d(e,{KJ:()=>_,pq:()=>E});var r=n(545),a=n(623),o=n(940),s=n(507),i=n(771),c=n(412);const l=new Set(Object.values(s.D));function u(t){return!!l.has(t)||(console.error(`Invalid page state: ${t}`),!1)}function f(t){switch(t){case s.D.SELECT_DATA:return a.A.HOME_PAGE.SELECT_DATA_BODY;case s.D.SHOW_STATS:return a.A.HOME_PAGE.SHOW_STATS_BODY;case s.D.LOAD_DATA:return a.A.HOME_PAGE.LOAD_DATA_BODY;case s.D.HERO_INFO:return a.A.HOME_PAGE.HERO_INFO_BODY;default:console.error(`Invalid page state: ${t}`)}}let E={getState:async function(){return await r.A.get(r.A.Keys.HOME_PAGE_STATE)??s.D.SELECT_DATA},setState:async function(t){u(t)&&await r.A.cache(r.A.Keys.HOME_PAGE_STATE,t)},resetState:async function(){await r.A.delete(r.A.Keys.HOME_PAGE_STATE)}};function d(t){t?(a.A.HOME_PAGE.USER_NAME.innerText=t.name,a.A.HOME_PAGE.USER_ID.innerText=`${t.id}`,a.A.HOME_PAGE.USER_SERVER.innerText=c.DB[t.world_code]):(a.A.HOME_PAGE.USER_NAME.innerText="(None)",a.A.HOME_PAGE.USER_ID.innerText="(None)",a.A.HOME_PAGE.USER_SERVER.innerText="(None)")}async function p(t){await i.A.clearUserData(),d(t),t&&await i.A.setUser(t)}let _={homePageSetView:function(t){if(!u(t))return;for(const e of Object.values(s.D)){if(t===e)continue;const n=f(e);n&&(n.id,o.A.setVisibility(n,!1))}const e=f(t);e&&(e.id,o.A.setVisibility(e,!0)),o.A.setVisibility(a.A.BODY_FOOTER_CONTAINER,!0)},homePageSetUser:p,homePageDrawUserInfo:d,homePageClearUserData:async function(){await p(null)}}},507:(t,e,n)=>{n.d(e,{D:()=>r});const r={SELECT_DATA:"select-data",SHOW_STATS:"show-stats",LOAD_DATA:"load-data",HERO_INFO:"hero-info"}},528:(t,e,n)=>{n.d(e,{A:()=>l});var r=n(545),a=n(412),o=n(275),s=n(40);const i="~Fodder",c="~Empty";const l={getHeroDicts:async function(t=a.Yj.CODES.EN){const e=await r.A.get(r.A.Keys.HERO_MANAGER);return e||this.fetchAndCacheHeroManager(t)},createHeroManager:function(t){let e={heroes:[],Empty:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A"},Fodder:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A"},name_lookup:{},code_lookup:{}};return e.heroes=t,e=function(t){t.heroes.length;const e={attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:c},n={attribute_cd:"N/A",code:"N/A",grade:"2/3",job_cd:"N/A",name:i};return t.heroes.push(e),t.heroes.push(n),t.Fodder=n,t.Empty=e,t}(e),e=function(t){return t.name_lookup=t.heroes.reduce((t,e)=>(t[e.name.toLowerCase().replace(/\s+/g,"")]=e,t),{}),t.code_lookup=t.heroes.reduce((t,e)=>(t[e.code]=e,t),{}),t}(e),e},fetchHeroManager:async function(t=a.Yj.CODES.EN){const e=(await s.A.fetchHeroJSON()??await o.A.fetchHeroData())[t];return this.createHeroManager(e)},fetchAndCacheHeroManager:async function(t=a.Yj.CODES.EN){const e=await this.fetchHeroManager(t);return await r.A.cache(r.A.Keys.HERO_MANAGER,e),e},deleteHeroManager:async function(){await r.A.delete(r.A.Keys.HERO_MANAGER)},getHeroByName:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");if(!t)return e.Empty;const n=t.toLowerCase().replace(/\s+/g,"");return e.name_lookup[n]??null},getHeroByCode:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");return t?e.code_lookup[t]??null:e.Empty},EMPTY_NAME:c,FODDER_NAME:i}},541:(t,e,n)=>{n.d(e,{XJ:()=>i,j5:()=>d});var r=n(494);let a=0;function o(){return a+=1,`id-${a}`}let s=null;function i(){if(s)return s;const t=document.createElement("div");t.style.visibility="hidden",t.style.overflow="scroll",document.body.appendChild(t);const e=t.offsetWidth-t.clientWidth;return t.remove(),s=e,e}const c="nest",l="end-nest",u="adj",f="~end-nest~";class E{htmlElt;children;childArr;constructor(t){this.htmlElt=t,this.children={},this.childArr=[]}static fromID(t){return new E(r.K.unwrapHtmlElt(t))}static fromElt(t){return new E(t)}get id(){return this.htmlElt.id}set id(t){this.htmlElt.id=t}addClass(...t){this.htmlElt.classList.add(...t)}addStyle(t){this.htmlElt.setAttribute("style",t)}removeClass(...t){this.htmlElt.classList.remove(...t)}addAttributes(t){for(const[e,n]of Object.entries(t))this.htmlElt.setAttribute(e,n)}appendChild(t){if(t instanceof E)return this.htmlElt.appendChild(t.htmlElt),t.id||(t.id=o()),this.children[t.id]=t,this.childArr.push(t),t;if(t instanceof HTMLElement){let e=new E(t);return this.appendChild(e)}throw new Error("Only instances of HTMLConstructor or HTMLElement can be passed to this function")}setInnerHtml(t){this.htmlElt.innerHTML=t}appendInnerHTML(t){this.htmlElt.insertAdjacentHTML("beforeend",t)}constructChild(t,e={}){e.id||(e.id=o());let n=document.createElement(t),r=new E(n);return r.addAttributes(e),this.appendChild(r),r}addTextContent(t){this.htmlElt.textContent=t}compose(t){for(let e=0;e<t.length;e++){const n=t[e];if(n.option===c){const r=[];for(let n=e+1;n<t.length;n++){const e=t[n];if(e.option===l)break;r.push(e)}n.children?n.children=[...n.children,...r]:n.children=r,n.option=u,this.compose([n]),e+=r.length;continue}if(n.tag===f)continue;if(n.textContent instanceof Array){const t=[];for(const e of n.textContent){const r=Object.assign({},n);r.textContent=e,t.push(r)}this.compose(t);continue}let r=this.constructChild(n.tag,n.attributes);n.classes&&r.addClass(...n.classes),n.children&&r.compose(n.children),n.textContent&&r.addTextContent(n.textContent),n.style&&r.addStyle(n.style),n.innerHtml&&r.setInnerHtml(n.innerHtml)}}}class d extends E{thead;tbody;constructor(t,e,n){super(t),this.constructChild("thead",{id:e}),this.constructChild("tbody",{id:n}),this.thead=this.children[e],this.tbody=this.children[n]}static createFromIDs(t,e,n){const r=document.createElement("table");return r.id=t,new d(r,e,n)}addColumns(t){const e=this.thead.constructChild("tr");t.forEach(t=>{e.constructChild("th",{scope:"col"}).addTextContent(t)})}}},545:(t,e,n)=>{n.d(e,{A:()=>K});const r=(t,e)=>e.some(e=>t instanceof e);let a,o;const s=new WeakMap,i=new WeakMap,c=new WeakMap;let l={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return s.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return d(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function u(t){l=t(l)}function f(t){return(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(p(this),e),d(this.request)}:function(...e){return d(t.apply(p(this),e))}}function E(t){return"function"==typeof t?f(t):(t instanceof IDBTransaction&&function(t){if(s.has(t))return;const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{e(),r()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});s.set(t,e)}(t),r(t,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,l):t)}function d(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{e(d(t.result)),r()},o=()=>{n(t.error),r()};t.addEventListener("success",a),t.addEventListener("error",o)});return c.set(e,t),e}(t);if(i.has(t))return i.get(t);const e=E(t);return e!==t&&(i.set(t,e),c.set(e,t)),e}const p=t=>c.get(t);const _=["get","getKey","getAll","getAllKeys","count"],S=["put","add","delete","clear"],A=new Map;function h(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(A.get(e))return A.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=S.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!_.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,a?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(e.shift())),(await Promise.all([s[n](...e),a&&o.done]))[0]};return A.set(e,o),o}u(t=>({...t,get:(e,n,r)=>h(e,n)||t.get(e,n,r),has:(e,n)=>!!h(e,n)||t.has(e,n)}));const T=["continue","continuePrimaryKey","advance"],m={},g=new WeakMap,w=new WeakMap,R={get(t,e){if(!T.includes(e))return t[e];let n=m[e];return n||(n=m[e]=function(...t){g.set(this,w.get(this)[e](...t))}),n}};async function*O(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const n=new Proxy(e,R);for(w.set(n,e),c.set(n,p(e));e;)yield n,e=await(g.get(n)||e.continue()),g.delete(n)}function y(t,e){return e===Symbol.asyncIterator&&r(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===e&&r(t,[IDBIndex,IDBObjectStore])}u(t=>({...t,get:(e,n,r)=>y(e,n)?O:t.get(e,n,r),has:(e,n)=>y(e,n)||t.has(e,n)}));var L=n(412);async function v(t,e){const n=t.transaction(e,"readwrite");n.objectStore(e).clear(),await n.done}const N={USER:"current-user",BATTLES:"battles",RAW_UPLOAD:"raw-upload",STATS:"stats",FILTER_STR:"filter-str"},b={GLOBAL_USERS:"global-users",EU_USERS:"eu-users",ASIA_USERS:"asia-users",JPN_USERS:"jpn-users",KOR_USERS:"kor-users"},P={...b,ARTIFACTS:"artifacts",ARTIFACTS_LOWERCASE_NAMES_MAP:"artifacts-lowercase-names-map",ARTIFACT_OBJECT_LIST:"artifact-object-list",HERO_MANAGER:"hero-manager",SEASON_DETAILS:"season-details"},I={...N,...P,LANG:"lang",AUTO_ZOOM_FLAG:"auto-zoom",AUTO_QUERY_FLAG:"auto-query",ID_SEARCH_FLAG:"id-search",HOME_PAGE_STATE:"home-page-state",INTER_PAGE_MANAGER:"inter-page-manager"},D=864e5,C=2*D,x=3*(7*D),F=D,M=Object.values(P),B=Object.values(N).filter(t=>t!==N.FILTER_STR);function U(t){const[e,n]=t;return`[${new Date(e)}, ${n}]`}function H(t){return M.includes(t)?F:B.includes(t)?x:C}const G="DataStore",k="MetaStore";let j={consts:{DB_NAME:"E7ArenaStatsClientDB",DB_VERSION:1,STORE_NAME:G,META_STORE_NAME:k},Keys:{...I},MetaKeys:{TIMESTAMP:"timestamp"},loaded_UM:new Set,openDB:async function(){return await function(t,e,{blocked:n,upgrade:r,blocking:a,terminated:o}={}){const s=indexedDB.open(t,e),i=d(s);return r&&s.addEventListener("upgradeneeded",t=>{r(d(s.result),t.oldVersion,t.newVersion,d(s.transaction),t)}),n&&s.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),i.then(t=>{o&&t.addEventListener("close",()=>o()),a&&t.addEventListener("versionchange",t=>a(t.oldVersion,t.newVersion,t))}).catch(()=>{}),i}(j.consts.DB_NAME,j.consts.DB_VERSION,{upgrade(t){t.objectStoreNames.contains(G)&&t.deleteObjectStore(G),t.objectStoreNames.contains(G)||t.createObjectStore(G),t.objectStoreNames.contains(k)||t.createObjectStore(k)}})},get:async function(t){const e=await this.openDB(),n=await e.get(G,t);if(!n)return null;return await this.checkCacheTimeout(t)?n:null},cache:async function(t,e){const n=await this.openDB();await n.put(G,e,t),await this.setTimeoutDataNow(t)},delete:async function(t){const e=await this.openDB();await e.delete(G,t),await this.deleteTimeoutData(t)},deleteDB:async function(){await indexedDB.deleteDatabase(this.consts.DB_NAME)},getTimeoutData:async function(t){const e=await this.openDB(),n=`${t+this.MetaKeys.TIMESTAMP}`;return await e.get(k,n)||null},setTimeoutData:async function(t,e){const n=await this.openDB(),r=`${t+this.MetaKeys.TIMESTAMP}`;await n.put(k,e,r)},setTimeoutDataNow:async function(t){const e=function(t){return[Date.now(),H(t)]}(t);await this.setTimeoutData(t,e)},deleteTimeoutData:async function(t){const e=await this.openDB(),n=`${t+this.MetaKeys.TIMESTAMP}`;await e.delete(k,n)},clearData:async function(){const t=await this.openDB();await v(t,G),await v(t,k)},clearUserData:async function(){const t=Object.values(N);await Promise.all(t.map(t=>this.delete(t)))},clearUserLists:async function(){const t=Object.values(b);await Promise.all(t.map(t=>this.delete(t)))},clearSeasonData:async function(){await this.delete(I.SEASON_DETAILS)},clearReferenceData:async function(){const t=Object.values(P);await Promise.all(t.map(t=>this.delete(t)))},checkCacheTimeout:async function(t){const e=await this.getTimeoutData(t),n=Date.now();if(!e)return!1;if(r=e,!Array.isArray(r)||2!==r.length||"number"!=typeof r[0]||"number"!=typeof r[1])return await this.delete(t),!1;var r;const[a,o]=e;return n-a>o?(U(e),new Date(n),await this.delete(t),!1):(U(e),new Date(n),H(t),e[0],!0)},getFilterStr:async function(){return await this.get(I.FILTER_STR)},setFilterStr:async function(t){await this.cache(I.FILTER_STR,t)},getLang:async function(){return await this.get(I.LANG)??L.Yj.CODES.EN},setLang:async function(t){await this.cache(I.LANG,t)},getStats:async function(){return await this.get(I.STATS)},setStats:async function(t){await this.cache(I.STATS,t)}};const K=j},612:(t,e,n)=>{n.d(e,{l:()=>pt});var r=n(836),a=n(494),o=n(497),s=n(172),i=n(623),c=n(507),l=n(940),u=n(58),f=n(412),E=n(913),d=n(793);const p=i.A.HOME_PAGE.SEARCH_INPUT,_=i.A.HOME_PAGE.HERO_SEARCH_OPTIONS,S=i.A.HOME_PAGE.HERO_INFO_BODY,A=i.A.HOME_PAGE.getElt(i.A.HOME_PAGE.IDS.HERO_DEFAULT_CONTENT);async function h(t){p.value=t,p.textContent=t,_.classList.remove("show"),l.A.setVisibility(A,!1);const e=await r.n.ClientCache.getStats().then(t=>Object.values(t?t.filteredBattlesObj:{})),n=function({battles:t,heroName:e,isP1:n}){const r=n?f.Lx.P1_PICKS:f.Lx.P2_PICKS;return t.filter(t=>t[r].includes(e))}({battles:e,heroName:t,isP1:!0}),a=E.A.queryStats(n,e.length,t);s.GF.writeStrFromID(a["Pick Rate"],"pick-rate-value",[s.GF.STYLES.E_BLUE]),s.GF.writeStrFromID(a["Win rate"],"win-rate-value",[s.GF.STYLES.E_BLUE]),s.GF.writeStrFromID(a["Postban Rate"],"postban-rate-value",[s.GF.STYLES.E_BLUE]);const o=await r.n.HeroManager.getHeroDicts(),c=E.A.getHeroStats(n,o);d.c.populateHeroStatsTable(i.A.HOME_PAGE.IDS.HERO_PLAYER_TBL,c.playerHeroStats),d.c.populateHeroStatsTable(i.A.HOME_PAGE.IDS.HERO_OPPONENT_TBL,c.enemyHeroStats),s.GF.writeStrFromID(`${t}`,"selected-hero-value",[s.GF.STYLES.E_BLUE]),s.GF.writeStrFromID(`${n.length}`,"battles-picked-value",[s.GF.STYLES.E_BLUE]);const u=i.A.HOME_PAGE.getElt(i.A.HOME_PAGE.IDS.HERO_INFO_CONTENT);l.A.setVisibility(u,!0)}function T(){p.addEventListener("click",function(t){t.stopPropagation(),p.value="",p.textContent="",_.classList.add("show")}),S.addEventListener("click",function(t){const e=t.target;p.contains(e)||_.contains(e)||_.classList.remove("show")}),p.addEventListener("input",function(){const t=this.value.toLowerCase();document.querySelectorAll(".option-list .option").forEach(e=>{e.textContent.toLowerCase().includes(t)?e.style.display="block":e.style.display="none"})}),document.querySelectorAll(".option-list .option").forEach(t=>{t.addEventListener("click",async function(){await h(t.textContent)})})}function m(t,e,n){return`\n    <div class="col-lg-12">\n        <div class="card">\n            <div class="card-header fixed-height-table-header kpi-header">\n                <h5>${e}</h5>\n                <br>\n                <h6 style="font-size: 0.7em;">\n                    ${n}\n                </h6>\n            </div>\n            <div class="card-body kpi-body">\n                <table id="${t}" class="display compact cell-border" style="width:100%">\n                </table>\n            </div>\n        </div>\n    </div>\n    `}function g(){const t=document.createElement("div");return t.classList.add("d-flex","flex-row","mb-2","gap-3"),t}async function w(){const t=i.A.HOME_PAGE.getElt(i.A.HOME_PAGE.IDS.SEARCH_INPUT);t.value="",t.textContent="";const e=i.A.HOME_PAGE.getElt(i.A.HOME_PAGE.IDS.HERO_INFO_CONTENT);l.A.setVisibility(e,!1),await async function(){const t=await r.n.UserManager.getUser(),e=await r.n.ClientCache.getStats(),n=a.K.unwrapHtmlElt("default-text");t?s.GF.write(new s.ev("Use the search and dropdown menu to select a hero and view statistics.",n,[])):s.GF.write(new s.ev("No data loaded: Query or Upload data on the 'Select Data' page to view hero information.",n,[s.GF.STYLES.RED]));const o=a.K.unwrapHtmlElt("filters-applied"),i=a.K.unwrapHtmlElt("num-battles");if(e){const t=e.numFilters,n=Object.values(e.filteredBattlesObj).length;s.GF.write(new s.ev(`${t}`,o,[])),s.GF.write(new s.ev(`${n}`,i,[]))}else s.GF.write(new s.ev("n/a",o,[])),s.GF.write(new s.ev("n/a",i,[]))}();const n=i.A.HOME_PAGE.getElt(i.A.HOME_PAGE.IDS.HERO_DEFAULT_CONTENT);l.A.setVisibility(n,!0)}async function R(t){await w()}let O={runLogic:R,initialize:async function(t){await async function(){const t=a.K.unwrapHtmlElt("hero-option-list"),e=await r.n.HeroManager.getHeroDicts();new Set(e.heroes.filter(t=>t.name!==e.Empty.name&&t.name!==e.Fodder.name).map(t=>t.name).sort((t,e)=>t.localeCompare(e))).forEach(e=>{const n=document.createElement("div");n.classList.add("option"),n.textContent=e,n.dataset.value=e,t.appendChild(n)})}(),T();const e=i.A.HOME_PAGE.getElt(i.A.HOME_PAGE.IDS.HERO_INFO_CONTENT);!function(t){const e=g(),n=g(),r=[e,n];e.innerHTML='\n    <div class="col-md-3">\n        <div class="card mb-0 p-2 d-flex justify-content-center flex-column align-items-center">\n            <span class="f-16">Selected Hero</span>\n            <span class="f-16" id="selected-hero-value">&nbsp;</span>\n        </div>\n    </div>\n    ',n.innerHTML='\n    <div class="col-md-2">\n        <div class="card p-2 d-flex justify-content-center flex-column align-items-center"">\n            <span class="f-16">Battles Picked</span>\n            <span class="f-16" id="battles-picked-value">&nbsp;</span>\n        </div>\n    </div>\n    <div class="col-md-2">\n        <div class="card p-2 d-flex justify-content-center flex-column align-items-center" id="pick-rate">\n            <span class="f-16">Pick Rate</span>\n            <span class="f-16" id="pick-rate-value">&nbsp;</span>\n        </div>\n    </div>\n    <div class="col-md-2">\n        <div class="card p-2 d-flex justify-content-center flex-column align-items-center" id="win-rate">\n            <span class="f-16">Win Rate</span>\n            <span class="f-16" id="win-rate-value">&nbsp;</span>\n        </div>\n    </div>\n    <div class="col-md-2">\n        <div class="card p-2 d-flex justify-content-center flex-column align-items-center" id="postban-rate">\n            <span class="f-16">Postban Rate</span>\n            <span class="f-16" id="postban-rate-value">&nbsp;</span>\n        </div>\n    </div>\n    ',r.forEach(e=>t.appendChild(e))}(e),function(t){const e=m("hero-player-tbl","Teammate Heroes","Displays statistics for heroes computed based on when they appear on the player's team. Success Rate indicates percentage of games in which the player won the game or the hero was post banned."),n=m("hero-opponent-tbl","Opponent Heroes","Displays statistics for heroes computed based on when they appear on the enemy team. Win rate, +/-, postban rate, and point gain are relative to the player while pick rate, Avg CR, and first turn rate are relative to the opponent."),r=document.createElement("div");r.innerHTML=e+n,t.appendChild(r),(0,u.q)()}(e)},triggerState:c.D.HERO_INFO,handleDispatch:async function(t){await R(),await o.KJ.homePageSetView(c.D.HERO_INFO)}};var y=n(181),L=n(84),v=n(892),N=n(874);function b(t){}var P=n(275),I=n(82);function D(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return C(l,"_invoke",function(n,r,a){var o,i,c,l=0,u=a||[],f=!1,E={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,i=0,c=t,E.n=n,s}};function d(n,r){for(i=n,c=r,e=0;!f&&l&&!a&&e<u.length;e++){var a,o=u[e],d=E.p,p=o[2];n>3?(a=p===r)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(i=0,E.v=r,E.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,E.n=p,i=0))}if(a||n>1)return s;throw f=!0,r}return function(a,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),i=u,c=p;(e=i<2?t:c)||!f;){o||(i?i<3?(i>1&&(E.n=-1),d(i,c)):E.n=c:E.v=c);try{if(l=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(f=E.n<0)?c:n.call(r,E))!==s)break}catch(e){o=t,i=1,c=e}finally{l=1}}return{value:e,done:f}}}(n,a,o),!0),l}var s={};function i(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(C(e={},r,function(){return this}),e),f=l.prototype=i.prototype=Object.create(u);function E(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,C(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=l,C(f,"constructor",l),C(l,"constructor",c),c.displayName="GeneratorFunction",C(l,a,"GeneratorFunction"),C(f),C(f,a,"Generator"),C(f,r,function(){return this}),C(f,"toString",function(){return"[object Generator]"}),(D=function(){return{w:o,m:E}})()}function C(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}C=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){C(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},C(t,e,n,r)}function x(t,e,n,r,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}function F(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function s(t){x(o,r,a,s,i,"next",t)}function i(t){x(o,r,a,s,i,"throw",t)}s(void 0)})}}function M(){return B.apply(this,arguments)}function B(){return(B=F(D().m(function t(){var e,n,a,o,s;return D().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.n.ClientCache.get(r.n.ClientCache.Keys.RAW_UPLOAD);case 1:return e=t.v,t.n=2,I.j.parseJSON(e);case 2:return n=t.v,a=I.j.restructureParsedUploadBattles(n.battles),o=n.user,t.n=3,r.n.UserManager.findUser(o);case 3:if(s=t.v){t.n=4;break}throw playerID,new Error("File Upload Error: User not found");case 4:return t.a(2,{user:s,battleArr:a})}},t)}))).apply(this,arguments)}function U(t,e){return H.apply(this,arguments)}function H(){return(H=F(D().m(function t(e,n){var a,o,s,i,c;return D().w(function(t){for(;;)switch(t.n){case 0:return JSON.stringify(e),t.n=1,r.n.ArtifactManager.getArtifactCodeToNameMap();case 1:return a=t.v,t.n=2,P.A.rsFetchBattleData(e);case 2:if((o=t.v).ok){t.n=4;break}return t.n=3,o.json();case 3:throw s=t.v,new Error(s.error);case 4:return t.n=5,o.json();case 5:return i=t.v,c=i.battles,t.n=6,r.n.BattleManager.cacheQuery(c,n,a);case 6:case 7:return t.a(2)}},t)}))).apply(this,arguments)}function G(t,e,n){return k.apply(this,arguments)}function k(){return(k=F(D().m(function t(e,n,r){var a,o,i,l;return D().w(function(t){for(;;)switch(t.n){case 0:return o=[y.S.VALUES.SOURCE.QUERY,y.S.VALUES.SOURCE.UPLOAD,y.S.VALUES.SOURCE.STATS],i=o[1],l=o[2],n===o[0]||n===i?(a=c.D.SELECT_DATA,s.l5.queueSelectDataMsgRed("Failed to load data: ".concat(e.message))):n===l?(a=c.D.SHOW_STATS,s.l5.queueFilterMsgRed("Failed to load data: ".concat(e.message))):(console.error("Invalid source: ".concat(n," ; redirecting to select data")),a=c.D.SELECT_DATA,s.l5.queueSelectDataMsgRed("Failed to load data: ".concat(e.message))),console.error(e),t.n=1,N.Su.eraseUserFromPage();case 1:return t.n=2,r(a);case 2:return t.a(2)}},t)}))).apply(this,arguments)}function j(t){return K.apply(this,arguments)}function K(){return(K=F(D().m(function t(e){var n;return D().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.n.UserManager.findUser(e);case 1:if(n=t.v,JSON.stringify(n),null===n){t.n=2;break}return t.a(2,n);case 2:return t.a(2,null)}},t)}))).apply(this,arguments)}function $(t){return Y.apply(this,arguments)}function Y(){return(Y=F(D().m(function t(e){var n;return D().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.n.UserManager.clearUserData();case 1:return t.n=2,r.n.UserManager.setUser(e);case 2:return t.n=3,r.n.LangManager.getLang();case 3:n=t.v,N.Su.writeUserInfo(e,n);case 4:return t.a(2)}},t)}))).apply(this,arguments)}function V(t){return W.apply(this,arguments)}function W(){return(W=F(D().m(function t(e){var n,a,o,s,i,l,u,f,E,d,p,_;return D().w(function(t){for(;;)switch(t.n){case 0:return n=null,a=null,o=null,t.p=1,t.n=2,r.n.HeroManager.getHeroDicts();case 2:n=t.v,a=y.S.popKey(y.S.KEYS.SOURCE),o=y.S.popKey(y.S.KEYS.AUTO_QUERY),t.n=5;break;case 3:return t.p=3,d=t.v,console.error("Could not load reference and context variables: ",d),t.n=4,e(c.D.SELECT_DATA);case 4:return t.a(2);case 5:if(t.p=5,s=null,a!==y.S.VALUES.SOURCE.UPLOAD){t.n=9;break}return t.n=6,M();case 6:return i=t.v,s=i.user,t.n=7,$(s);case 7:return t.n=8,r.n.BattleManager.cacheUpload(i.battleArr,n);case 8:t.n=12;break;case 9:if(a!==y.S.VALUES.SOURCE.QUERY){t.n=12;break}if(null!==(l=y.S.popKey(y.S.KEYS.TRY_SET_USER))){t.n=10;break}throw new Error("TRY_SET_USER User missing from CONTEXT");case 10:return t.n=11,j(l);case 11:return s=t.v,t.n=12,$(s);case 12:if(null!==s){t.n=14;break}return t.n=13,r.n.UserManager.getUser();case 13:s=t.v;case 14:if(!o&&a!==y.S.VALUES.SOURCE.QUERY){t.n=15;break}return t.n=15,U(s,n);case 15:return t.n=16,r.n.BattleManager.getBattles();case 16:return u=t.v,Object.values(u),t.n=17,L.S.getFiltersFromCache(n);case 17:return f=t.v,"Received Filters: ".concat(JSON.stringify(f)),t.n=18,r.n.BattleManager.getStats(u,f,n);case 18:return E=t.v,t.n=19,r.n.ClientCache.setStats(E);case 19:return t.n=20,v.b.populateContent();case 20:return y.S.STATS_PRE_RENDER_COMPLETED=!0,t.n=21,e(c.D.SHOW_STATS);case 21:return t.a(2);case 22:return t.p=22,p=t.v,t.p=23,t.n=24,G(p,a,e);case 24:return t.a(2);case 25:return t.p=25,_=t.v,console.error("Something went wrong ; redirecting to select data ; error:",_),t.n=26,N.Su.eraseUserFromPage();case 26:return t.n=27,e(c.D.SELECT_DATA);case 27:return t.a(2)}},t,null,[[23,25],[5,22],[1,3]])}))).apply(this,arguments)}function q(){return(q=F(D().m(function t(){return D().w(function(t){for(;;)switch(t.n){case 0:b();case 1:return t.a(2)}},t)}))).apply(this,arguments)}function z(){return(z=F(D().m(function t(e){return D().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.KJ.homePageSetView(c.D.LOAD_DATA);case 1:return t.n=2,V(e);case 2:return t.a(2)}},t)}))).apply(this,arguments)}var Q={runLogic:V,initialize:function(){return q.apply(this,arguments)},triggerState:c.D.LOAD_DATA,handleDispatch:function(t){return z.apply(this,arguments)}},J=n(545);function X(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return Z(l,"_invoke",function(n,r,a){var o,i,c,l=0,u=a||[],f=!1,E={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,i=0,c=t,E.n=n,s}};function d(n,r){for(i=n,c=r,e=0;!f&&l&&!a&&e<u.length;e++){var a,o=u[e],d=E.p,p=o[2];n>3?(a=p===r)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(i=0,E.v=r,E.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,E.n=p,i=0))}if(a||n>1)return s;throw f=!0,r}return function(a,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),i=u,c=p;(e=i<2?t:c)||!f;){o||(i?i<3?(i>1&&(E.n=-1),d(i,c)):E.n=c:E.v=c);try{if(l=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(f=E.n<0)?c:n.call(r,E))!==s)break}catch(e){o=t,i=1,c=e}finally{l=1}}return{value:e,done:f}}}(n,a,o),!0),l}var s={};function i(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(Z(e={},r,function(){return this}),e),f=l.prototype=i.prototype=Object.create(u);function E(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Z(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=l,Z(f,"constructor",l),Z(l,"constructor",c),c.displayName="GeneratorFunction",Z(l,a,"GeneratorFunction"),Z(f),Z(f,a,"Generator"),Z(f,r,function(){return this}),Z(f,"toString",function(){return"[object Generator]"}),(X=function(){return{w:o,m:E}})()}function Z(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}Z=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){Z(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},Z(t,e,n,r)}function tt(t,e,n,r,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}function et(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function s(t){tt(o,r,a,s,i,"next",t)}function i(t){tt(o,r,a,s,i,"throw",t)}s(void 0)})}}function nt(t){s.GF.write(new s.ev(t,i.A.HOME_PAGE.SELECT_DATA_MSG,[s.GF.STYLES.RED]))}function rt(){return rt=et(X().m(function t(e){var n,a,o;return X().w(function(t){for(;;)switch(t.n){case 0:n=i.A.HOME_PAGE.ID_SEARCH_FLAG,a=r.n.ClientCache.Keys.ID_SEARCH_FLAG,n.addEventListener("click",et(X().m(function t(){return X().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.n.ClientCache.cache(a,n.checked);case 1:return t.a(2)}},t)}))),(o=document.getElementById("userForm")).addEventListener("submit",function(){var t=et(X().m(function t(n){var a,s,i,l,u,f;return X().w(function(t){for(;;)switch(t.n){case 0:if(n.preventDefault(),a=new FormData(o),s=a.get("username"),i=a.get("server"),s){t.n=1;break}nt("Must enter username"),t.n=4;break;case 1:return t.p=1,t.n=2,r.n.ClientCache.get(r.n.ClientCache.Keys.ID_SEARCH_FLAG);case 2:return l=t.v,u=l?{id:Number(s),name:s,world_code:i}:{name:s,world_code:i},y.S.TRY_SET_USER=u,y.S.AUTO_QUERY=!0,y.S.SOURCE=y.S.VALUES.SOURCE.QUERY,e(c.D.LOAD_DATA),t.a(2);case 3:t.p=3,f=t.v,console.error("Caught Error:",f),nt(f.message);case 4:return t.a(2)}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),rt.apply(this,arguments)}function at(){return at=et(X().m(function t(e){var n,a;return X().w(function(t){for(;;)switch(t.n){case 0:(n=document.getElementById("auto-query-flag")).addEventListener("click",et(X().m(function t(){return X().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.n.ClientCache.cache(r.n.ClientCache.Keys.AUTO_QUERY_FLAG,n.checked);case 1:return t.a(2)}},t)}))),a=null,i.A.HOME_PAGE.CSV_FILE.addEventListener("change",function(t){a=t.target.files[0]}),i.A.HOME_PAGE.UPLOAD_FORM.addEventListener("submit",function(){var t=et(X().m(function t(o){var s,i;return X().w(function(t){for(;;)switch(t.n){case 0:if(o.preventDefault(),s=n.checked,t.p=1,a){t.n=2;break}return nt("Must upload a file"),t.a(2);case 2:return"Selected File: ".concat(a.name," ; content: ").concat(JSON.stringify(a)),t.n=3,r.n.ClientCache.cache(r.n.ClientCache.Keys.RAW_UPLOAD,a);case 3:return y.S.AUTO_QUERY=s,y.S.SOURCE=y.S.VALUES.SOURCE.UPLOAD,e(c.D.LOAD_DATA),t.a(2);case 4:t.p=4,i=t.v,console.error("Caught Error:",i),nt(i.message);case 5:return t.a(2)}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),at.apply(this,arguments)}function ot(t){!function(t){rt.apply(this,arguments)}(t),function(t){at.apply(this,arguments)}(t)}function st(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return it(l,"_invoke",function(n,r,a){var o,i,c,l=0,u=a||[],f=!1,E={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,i=0,c=t,E.n=n,s}};function d(n,r){for(i=n,c=r,e=0;!f&&l&&!a&&e<u.length;e++){var a,o=u[e],d=E.p,p=o[2];n>3?(a=p===r)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(i=0,E.v=r,E.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,E.n=p,i=0))}if(a||n>1)return s;throw f=!0,r}return function(a,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),i=u,c=p;(e=i<2?t:c)||!f;){o||(i?i<3?(i>1&&(E.n=-1),d(i,c)):E.n=c:E.v=c);try{if(l=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(f=E.n<0)?c:n.call(r,E))!==s)break}catch(e){o=t,i=1,c=e}finally{l=1}}return{value:e,done:f}}}(n,a,o),!0),l}var s={};function i(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(it(e={},r,function(){return this}),e),f=l.prototype=i.prototype=Object.create(u);function E(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,it(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=l,it(f,"constructor",l),it(l,"constructor",c),c.displayName="GeneratorFunction",it(l,a,"GeneratorFunction"),it(f),it(f,a,"Generator"),it(f,r,function(){return this}),it(f,"toString",function(){return"[object Generator]"}),(st=function(){return{w:o,m:E}})()}function it(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}it=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){it(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},it(t,e,n,r)}function ct(t,e,n,r,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}function lt(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function s(t){ct(o,r,a,s,i,"next",t)}function i(t){ct(o,r,a,s,i,"throw",t)}s(void 0)})}}function ut(){return ft.apply(this,arguments)}function ft(){return(ft=lt(st().m(function t(){var e,n;return st().w(function(t){for(;;)switch(t.n){case 0:return e=document.getElementById("auto-query-flag"),t.n=1,J.A.get(J.A.Keys.AUTO_QUERY_FLAG);case 1:return e.checked=t.v,n=i.A.HOME_PAGE.ID_SEARCH_FLAG,t.n=2,J.A.get(J.A.Keys.ID_SEARCH_FLAG);case 2:n.checked=t.v;case 3:return t.a(2)}},t)}))).apply(this,arguments)}function Et(){return(Et=lt(st().m(function t(e){return st().w(function(t){for(;;)switch(t.n){case 0:ot(e);case 1:return t.a(2)}},t)}))).apply(this,arguments)}function dt(){return(dt=lt(st().m(function t(e){return st().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.KJ.homePageSetView(c.D.SELECT_DATA);case 1:return t.n=2,ut(e);case 2:return t.a(2)}},t)}))).apply(this,arguments)}const pt=[O,Q,{runLogic:ut,initialize:function(t){return Et.apply(this,arguments)},triggerState:c.D.SELECT_DATA,handleDispatch:function(t){return dt.apply(this,arguments)}},v.b]},623:(t,e,n)=>{n.d(e,{A:()=>u});var r=n(494);const a={SELECT_DATA_MSG:"select-data-msg",FILTER_MSG:"filterMSG",SELECT_DATA_BODY:"select-data-body",SHOW_STATS_BODY:"show-stats-body",LOAD_DATA_BODY:"load-data-body",HERO_INFO_BODY:"hero-info-body",HERO_INFO_CONTENT:"hero-info-content",HERO_DEFAULT_CONTENT:"default-content",LATEST_BATTLES_BTN:"latest-battles-btn",UPLOAD_FORM:"uploadForm",CSV_FILE:"csvFile",USER_QUERY_FORM_NAME:"user-query-form-name",USER_QUERY_FORM_SERVER:"user-query-form-server",AUTO_ZOOM_FLAG:"auto-zoom-flag",USER_NAME:"user-name",USER_ID:"user-id",USER_SERVER:"user-server",BATTLE_FILTER_TOGGLER:"filter-battle-table",ID_SEARCH_FLAG:"id-search-flag",SEASON_DETAILS_TBL:"season-details-tbl",PERFORMANCE_STATS_TBL:"performance-stats-tbl",FIRST_PICK_STATS_TBL:"first-pick-stats-tbl",PREBAN_STATS_TBL:"preban-stats-tbl",PLAYER_TBL:"player-tbl",OPPONENT_TBL:"opponent-tbl",BATTLES_TBL:"battles-tbl",RANK_PLOT:"rank-plot",SEARCH_INPUT:"searchInput",HERO_SEARCH_OPTIONS:"hero-option-list",HERO_PLAYER_TBL:"hero-player-tbl",HERO_OPPONENT_TBL:"hero-opponent-tbl"};class o{IDS=a;_SELECT_DATA_MSG=null;_FILTER_MSG=null;_SELECT_DATA_BODY=null;_SHOW_STATS_BODY=null;_LOAD_DATA_BODY=null;_HERO_INFO_BODY=null;_LATEST_BATTLES_BTN=null;_UPLOAD_FORM=null;_CSV_FILE=null;_USER_QUERY_FORM_NAME=null;_USER_QUERY_FORM_SERVER=null;_AUTO_ZOOM_FLAG=null;_FOOTER=null;_USER_NAME=null;_USER_ID=null;_USER_SERVER=null;_BATTLE_FILTER_TOGGLER=null;_ID_SEARCH_FLAG=null;_SEASON_DETAILS_TBL=null;_PERFORMANCE_STATS_TBL=null;_FIRST_PICK_STATS_TBL=null;_PREBAN_STATS_TBL=null;_PLAYER_TBL=null;_OPPONENT_TBL=null;_BATTLE_TBL=null;_RANK_PLOT=null;_HERO_PLAYER_TBL=null;_HERO_OPPONENT_TBL=null;_SEARCH_INPUT=null;_SEARCH_OPTIONS=null;getElt(t){return r.K.unwrapHtmlElt(t)}get SELECT_DATA_MSG(){return this._SELECT_DATA_MSG||=r.K.unwrapHtmlElt("select-data-msg")}get FILTER_MSG(){return this._FILTER_MSG||=r.K.unwrapHtmlElt("filterMSG")}get SELECT_DATA_BODY(){return this._SELECT_DATA_BODY||=r.K.unwrapHtmlElt("select-data-body")}get SHOW_STATS_BODY(){return this._SHOW_STATS_BODY||=r.K.unwrapHtmlElt("show-stats-body")}get LOAD_DATA_BODY(){return this._LOAD_DATA_BODY||=r.K.unwrapHtmlElt("load-data-body")}get HERO_INFO_BODY(){return this._HERO_INFO_BODY||=r.K.unwrapHtmlElt("hero-info-body")}get LATEST_BATTLES_BTN(){return this._LATEST_BATTLES_BTN||=r.K.unwrapHtmlElt("latest-battles-btn")}get UPLOAD_FORM(){return this._UPLOAD_FORM||=r.K.unwrapHtmlElt("uploadForm")}get CSV_FILE(){return this._CSV_FILE||=r.K.unwrapHtmlElt("csvFile")}get USER_QUERY_FORM_NAME(){return this._USER_QUERY_FORM_NAME||=r.K.unwrapHtmlElt("user-query-form-name")}get USER_QUERY_FORM_SERVER(){return this._USER_QUERY_FORM_SERVER||=r.K.unwrapHtmlElt("user-query-form-server")}get AUTO_ZOOM_FLAG(){return this._AUTO_ZOOM_FLAG||=r.K.unwrapHtmlElt("auto-zoom-flag")}get USER_NAME(){return this._USER_NAME||=r.K.unwrapHtmlElt("user-name")}get USER_ID(){return this._USER_ID||=r.K.unwrapHtmlElt("user-id")}get USER_SERVER(){return this._USER_SERVER||=r.K.unwrapHtmlElt("user-server")}get BATTLE_FILTER_TOGGLE(){return this._BATTLE_FILTER_TOGGLER||=r.K.unwrapHtmlElt("filter-battle-table")}get ID_SEARCH_FLAG(){return this._ID_SEARCH_FLAG||=r.K.unwrapHtmlElt("id-search-flag")}get SEASON_DETAILS_TBL(){return this._SEASON_DETAILS_TBL||=r.K.unwrapHtmlElt("season-details-tbl")}get PERFORMANCE_STATS_TBL(){return this._PERFORMANCE_STATS_TBL||=r.K.unwrapHtmlElt("performance-stats-tbl")}get FIRST_PICK_STATS_TBL(){return this._FIRST_PICK_STATS_TBL||=r.K.unwrapHtmlElt("first-pick-stats-tbl")}get PREBAN_STATS_TBL(){return this._PREBAN_STATS_TBL||=r.K.unwrapHtmlElt("preban-stats-tbl")}get PLAYER_TBL(){return this._PLAYER_TBL||=r.K.unwrapHtmlElt("player-tbl")}get OPPONENT_TBL(){return this._OPPONENT_TBL||=r.K.unwrapHtmlElt("opponent-tbl")}get BATTLES_TBL(){return this._BATTLE_TBL||=r.K.unwrapHtmlElt("battles-tbl")}get RANK_PLOT(){return this._RANK_PLOT||=r.K.unwrapHtmlElt("rank-plot")}get MESSAGE_ELEMENTS_LIST(){return[this.SELECT_DATA_MSG,this.FILTER_MSG]}get SEARCH_INPUT(){return this._SEARCH_INPUT||=r.K.unwrapHtmlElt("searchInput")}get HERO_SEARCH_OPTIONS(){return this._SEARCH_OPTIONS||=r.K.unwrapHtmlElt("hero-option-list")}get HERO_PLAYER_TBL(){return this._HERO_PLAYER_TBL||=r.K.unwrapHtmlElt("hero-player-tbl")}get HERO_OPPONENT_TBL(){return this._HERO_OPPONENT_TBL||=r.K.unwrapHtmlElt("hero-opponent-tbl")}}class s{_SIDEBAR_HIDE_BTN=null;get SIDEBAR_HIDE_BTN(){return this._SIDEBAR_HIDE_BTN||=r.K.unwrapHtmlElt("sidebar-hide")}_CLEAR_DATA_BTN=null;get CLEAR_DATA_BTN(){return this._CLEAR_DATA_BTN||=r.K.unwrapHtmlElt("clear-data-btn")}_EXPORT_CSV_BTN=null;get EXPORT_DATA_BTN(){return this._EXPORT_CSV_BTN||=r.K.unwrapHtmlElt("export-data-btn")}_OFFICIAL_SITE_BTN=null;get OFFICIAL_SITE_BTN(){return this._OFFICIAL_SITE_BTN||=r.K.unwrapHtmlElt("official-site-btn")}_USER_NAME=null;get USER_NAME(){return this._USER_NAME||=r.K.unwrapHtmlElt("user-name")}_USER_ID=null;get USER_ID(){return this._USER_ID||=r.K.unwrapHtmlElt("user-id")}_USER_SERVER=null;get USER_SERVER(){return this._USER_SERVER||=r.K.unwrapHtmlElt("user-server")}_SIDEBAR_CONTROL=null;get SIDEBAR_CONTROL(){return this._SIDEBAR_CONTROL||=r.K.unwrapHtmlElt("sidebar-control")}_REFRESH_REFERENCES_BTN=null;get REFRESH_REFERENCES_BTN(){return this._REFRESH_REFERENCES_BTN||=r.K.unwrapHtmlElt("refresh-references-btn")}}class i{_SEARCH_DOMAINS=null;get SEARCH_DOMAINS(){return this._SEARCH_DOMAINS||=r.K.unwrapHtmlElt("search-domains")}_SEARCH_SUBMIT_BTN=null;get SEARCH_SUBMIT_BTN(){return this._SEARCH_SUBMIT_BTN||=r.K.unwrapHtmlElt("search-submit-btn")}_SEARCH_FORM=null;get SEARCH_FORM(){return this._SEARCH_FORM||=r.K.unwrapHtmlElt("searchForm")}_SEARCH_TABLE_CONTAINER=null;get SEARCH_TABLE_CONTAINER(){return this._SEARCH_TABLE_CONTAINER||=r.K.unwrapHtmlElt("search-table-container")}}class c{_FILTER_SYNTAX_RULES_CONTAINER=null;get FILTER_SYNTAX_RULES_CONTAINER(){return this._FILTER_SYNTAX_RULES_CONTAINER||=r.K.unwrapHtmlElt("filter-syntax-rules-container")}_ALL_CONTENT_CONTAINER=null;get ALL_CONTENT_CONTAINER(){return this._ALL_CONTENT_CONTAINER||=r.K.unwrapHtmlElt("all-content-container")}}class l{IDS={OVERVIEW_CONTAINER:"overview-container",OVERVIEW_CARD:"overview-card",RETURN_BTN:"info-return-btn",RETURN_CONTAINER:"info-return-container",FILTER_SYNTAX_CONTAINER:"filter-syntax-rules-container",FILTER_EXAMPLES_AND_TEST_CONTAINER:"filter-syntax-examples-and-test-container",INFORMATION_CONTENT_LINKS_CONTAINER:"information-content-links-container",ALL_CONTENT_CONTAINER:"all-content-container",FILTER_OVERVIEW:"filter-rules-card",FIELD_SYNTAX:"fields-card",FUNCTION_SYNTAX:"functions-card",OPERATOR_SYNTAX:"operators-card",DATA_SYNTAX:"declared-data-card",STRUCTURAL_SYNTAX:"structural-syntax-card",EX_FILTER_1:"exFilter1",EX_FILTER_2:"exFilter2",EX_FILTER_3:"exFilter3",EX_FILTER_4:"exFilter4",EX_FILTER_5:"exFilter5",TEST_FILTER_FORM:"test-filter-form",TEST_FILTER_MESSAGE:"filterMSG",TEST_SYNTAX_CARD:"test-syntax-card",CHECK_SYNTAX_BTN:"check-syntax-btn"};_CACHE={};constructor(){this._CACHE={}}getFromId(t){return this._CACHE[t]||=r.K.unwrapHtmlElt(t)}}const u=new class{HOME_PAGE;NAV_BAR;SEARCH_PAGE;FILTER_SYNTAX_PAGE;INFO_PAGE;_BODY_FOOTER_CONTAINER=null;_FOOTER_WRAPPER=null;constructor(){this.HOME_PAGE=new o,this.NAV_BAR=new s,this.SEARCH_PAGE=new i,this.FILTER_SYNTAX_PAGE=new c,this.INFO_PAGE=new l}get BODY_FOOTER_CONTAINER(){return this._BODY_FOOTER_CONTAINER??=r.K.unwrapHtmlElt("body-footer-container")}get FOOTER_WRAPPER(){return this._FOOTER_WRAPPER||=r.K.unwrapHtmlElt("footer-wrapper")}}},643:(t,e,n)=>{n.a(t,async(t,e)=>{try{var r=n(497),a=n(507),o=n(874),s=n(172),i=n(181),c=n(940),l=n(623),u=n(136),f=n(771),E=n(679),d=n(58),p=n(149),_=n(418),S=n(612);async function A(t){const e=t.action;let n=t.message;switch(e){case u.A.ACTIONS.CLEAR_USER:const c=await f.A.getUser();if(!c)break;await o.Su.eraseUserFromPage(),s.l5.queueSelectDataMsgGreen(`Cleared data of user ${c.name} (${c.id})`),r.pq.setState(a.D.SELECT_DATA);break;case u.A.ACTIONS.SHOW_DATA_ALREADY_CLEARED_MSG:s.l5.queueSelectDataMsgGreen("Data already cleared");break;case u.A.ACTIONS.SHOW_NO_USER_MSG:n=t.message||"Cannot perform action; no active user found.",s.l5.queueSelectDataMsgRed(n);break;case u.A.ACTIONS.QUERY_USER:i.S.AUTO_QUERY=!0,r.pq.setState(a.D.LOAD_DATA);break;default:console.error(`Invalid action: ${e}`)}}async function h(){const t=await u.A.flushState();for(const e of t.actions)await A(e)}const T={preInitialize:async t=>{(0,E.x)(t),(0,d.I)()},postInitialize:async()=>{const t=await f.A.getUser(),e=await p.W.getLang();o.Su.writeUserInfo(t,e),o.Su.addExportDataBtnListener(),o.Su.addBraceButtonListeners(),s.GF.bindAutoClear(l.A.HOME_PAGE.MESSAGE_ELEMENTS_LIST);let n=await r.pq.getState();n===a.D.LOAD_DATA&&(n=a.D.SELECT_DATA,await o.Su.eraseUserFromPage(),await r.pq.setState(n)),await h()},preDispatch:async t=>{i.S.toString();let e=await r.pq.getState();i.S.SCROLL_PERCENTS[e]=c.A.getScrollPercent(),s.GF.clearMessages(),s.GF.processQueue(),await r.pq.setState(t)},postDispatch:async t=>{let e=i.S.SCROLL_PERCENTS[t];setTimeout(()=>{c.A.setScrollPercent(e)},0),i.S.IS_FIRST_RENDER=!1}},m=new _.f(T,S.l);async function g(){document.addEventListener("DOMContentLoaded",async()=>{await m.initialize();const t=await r.pq.getState();await m.dispatch(t)})}await g(),e()}catch(w){e(w)}},1)},679:(t,e,n)=>{n.d(e,{x:()=>_});var r=n(497),a=n(874),o=n(172),s=n(181),i=n(623),c=n(771),l=n(892),u=n(507);function f(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return E(l,"_invoke",function(n,r,a){var o,i,c,l=0,u=a||[],f=!1,E={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,i=0,c=t,E.n=n,s}};function d(n,r){for(i=n,c=r,e=0;!f&&l&&!a&&e<u.length;e++){var a,o=u[e],d=E.p,p=o[2];n>3?(a=p===r)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(i=0,E.v=r,E.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,E.n=p,i=0))}if(a||n>1)return s;throw f=!0,r}return function(a,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),i=u,c=p;(e=i<2?t:c)||!f;){o||(i?i<3?(i>1&&(E.n=-1),d(i,c)):E.n=c:E.v=c);try{if(l=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(f=E.n<0)?c:n.call(r,E))!==s)break}catch(e){o=t,i=1,c=e}finally{l=1}}return{value:e,done:f}}}(n,a,o),!0),l}var s={};function i(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(E(e={},r,function(){return this}),e),d=l.prototype=i.prototype=Object.create(u);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,E(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=l,E(d,"constructor",l),E(l,"constructor",c),c.displayName="GeneratorFunction",E(l,a,"GeneratorFunction"),E(d),E(d,a,"Generator"),E(d,r,function(){return this}),E(d,"toString",function(){return"[object Generator]"}),(f=function(){return{w:o,m:p}})()}function E(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}E=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){E(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},E(t,e,n,r)}function d(t,e,n,r,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}function p(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function s(t){d(o,r,a,s,i,"next",t)}function i(t){d(o,r,a,s,i,"throw",t)}s(void 0)})}}function _(t){var e;e=t,document.querySelectorAll(".nav-link").forEach(function(t){t.addEventListener("click",function(){var t=p(f().m(function t(n){var a,i;return f().w(function(t){for(;;)switch(t.n){case 0:return a=this.dataset.nav,t.n=1,r.pq.getState();case 1:if(i=t.v,!Object.values(u.D).includes(a)){t.n=7;break}if(i!==a){t.n=2;break}return"Already in state: ".concat(i," ; returning"),t.a(2);case 2:if(a!==u.D.SELECT_DATA){t.n=3;break}e(u.D.SELECT_DATA),t.n=6;break;case 3:if(a!==u.D.HERO_INFO){t.n=4;break}e(u.D.HERO_INFO),t.n=6;break;case 4:if(a!==u.D.SHOW_STATS){t.n=6;break}return t.n=5,c.A.getUser();case 5:t.v?e(u.D.SHOW_STATS,s.S):(o.l5.queueSelectDataMsgRed("User not found; Must either query a valid user or upload battles to view hero stats"),e(u.D.SELECT_DATA,s.S));case 6:t.n=8;break;case 7:"Navigating to: ".concat(this.href);case 8:return t.a(2)}},t,this)}));return function(e){return t.apply(this,arguments)}}())}),function(t){i.A.NAV_BAR.CLEAR_DATA_BTN.addEventListener("click",function(){var e=p(f().m(function e(n){var r;return f().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,c.A.getUser();case 1:if(!(r=e.v)){e.n=4;break}return e.n=2,a.Su.eraseUserFromPage();case 2:return o.l5.queueSelectDataMsgGreen("Cleared data of user ".concat(r.name," (").concat(r.id,")")),e.n=3,t(u.D.SELECT_DATA);case 3:s.S.SCROLL_PERCENTS[u.D.SHOW_STATS]=0,e.n=5;break;case 4:return o.l5.queueSelectDataMsgGreen("Data already cleared"),e.n=5,t(u.D.SELECT_DATA);case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}())}(t),i.A.NAV_BAR.SIDEBAR_HIDE_BTN.addEventListener("click",function(t){(0,l.W)()}),i.A.NAV_BAR.SIDEBAR_CONTROL.addEventListener("click",function(t){(0,l.W)()})}},719:(t,e,n)=>{n.d(e,{A:()=>d});var r=n(545),a=n(913),o=n(528),s=n(834),i=n(412),c=n(92);function l(t,e,n){const r=t=>o.A.getHeroByCode(t,e)?.name??e.Fodder.name,a=(e,r)=>r.map((r,a)=>r?(t=>s.A.convertCodeToName(t,n)||"None")(r):((e,n)=>"p1"===e?t.p2_postban===t.p1_picks[n]:t.p1_postban===t.p2_picks[n])(e,a)?"n/a":"None");const l=t=>t.map(t=>t.map(t=>i.pg[t]||t)),u=t.cr_bar.find(t=>100===t[1]),f=!!u&&t.p1_picks.includes(u[0]);var E;return{[i.Lx.SEASON]:t.season_name||"None",[i.Lx.SEASON_CODE]:t.season_code||"None",[i.Lx.DATE_TIME]:t.date_time,[i.Lx.SECONDS]:t.seconds,[i.Lx.TURNS]:t.turns,[i.Lx.SEQ_NUM]:t.seq_num,[i.Lx.P1_ID]:t.p1_id.toString(),[i.Lx.P1_SERVER]:i.DB[t.p1_server]||t.p1_server||"None",[i.Lx.P2_ID]:t.p2_id.toString(),[i.Lx.P2_SERVER]:i.DB[t.p2_server]||t.p2_server||"None",[i.Lx.P1_LEAGUE]:(0,c.S)(t.p1_league)||"None",[i.Lx.P2_LEAGUE]:(0,c.S)(t.p2_league)||"None",[i.Lx.P1_POINTS]:t.p1_win_score,[i.Lx.POINT_GAIN]:t.p1_point_delta||null,[i.Lx.WIN]:1===t.win,[i.Lx.FIRST_PICK]:1===t.first_pick,[i.Lx.FIRST_TURN]:!!f,[i.Lx.FIRST_TURN_HERO]:u?r(u[0]):"n/a",[i.Lx.CR_BAR]:(E=t.cr_bar,E.map(t=>t&&2==t.length?[r(t[0]),t[1]]:["n/a",0])),[i.Lx.P1_PREBANS]:t.p1_prebans.map(r),[i.Lx.P2_PREBANS]:t.p2_prebans.map(r),[i.Lx.P1_PICKS]:t.p1_picks.map(r),[i.Lx.P2_PICKS]:t.p2_picks.map(r),[i.Lx.P1_POSTBAN]:r(t.p1_postban),[i.Lx.P2_POSTBAN]:r(t.p2_postban),[i.Lx.P1_EQUIPMENT]:l(t.p1_equipment),[i.Lx.P2_EQUIPMENT]:l(t.p2_equipment),[i.Lx.P1_ARTIFACTS]:a("p1",t.p1_artifacts),[i.Lx.P2_ARTIFACTS]:a("p2",t.p2_artifacts),[i.Lx.P1_MVP]:r(t.p1_mvp),[i.Lx.P2_MVP]:r(t.p2_mvp)}}function u(t){let e=function(t){for(const[e,n]of Object.entries(i.pg))t[i.Lx.P1_EQUIPMENT]=t[i.Lx.P1_EQUIPMENT].replaceAll(e,n),t[i.Lx.P2_EQUIPMENT]=t[i.Lx.P2_EQUIPMENT].replaceAll(e,n);return t}(t);return Object.fromEntries(Object.entries(e).map(([t,e])=>[t,JSON.parse(e)]))}var f=n(42);function E(t,e){const n=e.filter(t=>t instanceof f.Qo),r=e.filter(t=>t instanceof f.y4);for(let e of r)e.asString(),t=e.call(t);for(let e of n)e.asString(),t=t.filter(t=>e.call(t));return t}const d={loaded_servers:new Set,getBattles:async function(){const t=await r.A.get(r.A.Keys.BATTLES)??null;return r.A.setTimeoutDataNow(r.A.Keys.BATTLES),t},applyFilters:E,extendBattles:async function(t){const e={...await r.A.get(r.A.Keys.BATTLES)??{},...this.sortBattlesObj(t)};return await r.A.cache(r.A.Keys.BATTLES,e),e},cacheQuery:async function(t,e,n){if(!t)return[];t.length;const r=function(t,e,n){n=n??s.A.getArtifactCodeToNameMap();let r=[];for(const a of t){let t=l(a,e,n);r.push([t["Seq Num"],t])}return Object.fromEntries(r)}(t,e,n);return await this.extendBattles(r)},cacheUpload:async function(t,e){if(!t)return console.error("No uploaded battles provided to cacheUpload"),{};const n=function(t){const e=t.map(t=>u(t));return Object.fromEntries(e.map(t=>[t[i.Lx.SEQ_NUM],t]))}(t);return await this.extendBattles(n)},getStats:async function(t,e,n){const r=e.length,o=Object.values(t),s=E(o,e),c=r>0,l=await a.A.getPrebanStats(s,n),u=await a.A.getFirstPickStats(s,n),f=await a.A.getGeneralStats(s),d=await a.A.getHeroStats(s,n),p=await a.A.getPerformanceStats(s);return{battles:o,filteredBattlesObj:Object.fromEntries(s.map(t=>[t[i.Lx.SEQ_NUM],t])),prebanStats:l,generalStats:f,firstPickStats:u,playerHeroStats:d.playerHeroStats,enemyHeroStats:d.enemyHeroStats,performanceStats:p,numFilters:r,areFiltersApplied:c}},sortBattlesList:function(t,e=!0){const n=i.Lx.DATE_TIME;return e?t.sort((t,e)=>+new Date(t[n])-+new Date(e[n])):t.sort((t,e)=>+new Date(e[n])-+new Date(t[n]))},sortBattlesObj:function(t,e=!0){const n=i.Lx.DATE_TIME;if(e){let e=Object.values(t).sort((t,e)=>+new Date(t[n])-+new Date(e[n]));return Object.fromEntries(e.map(t=>[t[i.Lx.SEQ_NUM],t]))}{let e=Object.values(t).sort((t,e)=>+new Date(e[n])-+new Date(t[n]));return Object.fromEntries(e.map(t=>[t[i.Lx.SEQ_NUM],t]))}}}},771:(t,e,n)=>{n.d(e,{A:()=>d,l:()=>c});var r=n(412),a=n(545),o=n(40),s=n(275);const i={[r.F7.GLOBAL]:a.A.Keys.GLOBAL_USERS,[r.F7.EU]:a.A.Keys.EU_USERS,[r.F7.ASIA]:a.A.Keys.ASIA_USERS,[r.F7.JPN]:a.A.Keys.JPN_USERS,[r.F7.KOR]:a.A.Keys.KOR_USERS};function c(t){if(!t)throw new Error("Invalid user; user is null or undefined");if(!("id"in t)||"number"!=typeof t.id)throw new Error("Invalid user; user id does not exist or is not a number");if(!("name"in t)||"string"!=typeof t.name)throw new Error("Invalid user; user name does not exist or is not a string");if(!("world_code"in t)||"string"!=typeof t.world_code)throw new Error("Invalid user; user.world_code does not exist or is not a string");if(!(t.world_code in r.DB))throw new Error("Invalid user; user.world_code is not a valid world code");return!0}function l(t,e){return{id:Number(t.nick_no),name:t.nick_nm,code:t.code||null,rank:Number(t.rank),world_code:e}}async function u(t){const e=await a.A.get(i[t]);if(null!==e)return e;const n=await async function(t){const e=await o.A.fetchUserJSON(t);if(!e||"object"==typeof e&&!("users"in e))return null;const n=e;return Object.fromEntries(n.users.map(e=>[e.nick_no,l(e,t)]))}(t);return await a.A.cache(i[t],n),n}const f=t=>r.DB[t];async function E(t,e){const n=await u(e),r=n?Object.values(n):[];if(0===r.length)return f(e),{user:null,ok:!1};let a,o;if(t.id)a=t.id,o=t=>t.id;else{if(!t.name)throw new Error("Must pass a user object with either user.name or user.id to find user");a=t.name.toLowerCase(),o=t=>t.name.toLowerCase()}return function(t,e,n){const r=e.find(e=>n(e)===t);return r?(JSON.stringify(r),{user:r,ok:!0}):{user:null,ok:!0}}(a,r,o)}const d={getUserMap:u,findUser:async function(t){if(JSON.stringify(t),!t.name&&!t.id||!t.world_code)throw new Error("Must pass a user object with either user.name or user.id, and user.world_code to find user");let e=t.id?`Numeric ID: ${t.id}`:`Name: '${t.name}'`,n=null;if(n=await E(t,t.world_code),n.ok||(n=await s.A.fetchUser(t)),n.ok){const r=n.user;if(null===r)throw new Error(`Could not find user with ${e} in Server: ${f(t.world_code)}`);return r}throw new Error(`Function did not properly terminate: ${JSON.stringify(n)}`)},setUser:async function(t){await a.A.cache(a.A.Keys.USER,t)},getUser:async function(){const t=await a.A.get(a.A.Keys.USER);return await a.A.setTimeoutDataNow(a.A.Keys.USER),t},clearUserData:async function(){await a.A.clearUserData()},clearUserDataLists:async function(){await a.A.clearUserLists()}}},793:(t,e,n)=>{n.d(e,{W:()=>d,c:()=>E});var r=n(412),a=n(494),o=n(623);function s(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function c(t){var e=$("#".concat(t));$.fn.dataTable.isDataTable(e)&&e.DataTable().clear().destroy()}function l(t){var e,n=s(t=structuredClone(t));try{for(n.s();!(e=n.n()).done;){var a,o=e.value,i=s(r.E_);try{for(i.s();!(a=i.n()).done;){var c=a.value;o[c]=JSON.stringify(o[c])}}catch(t){i.e(t)}finally{i.f()}}}catch(t){n.e(t)}finally{n.f()}return t}function u(t){var e=Number(t.replace("%",""));return e>50?"text-over50":e<50?"text-below50":""}function f(t){var e=document.getElementById("".concat(t,"-body"));if(!e)throw new Error("Could not find tbody with id ".concat(t,"-body"));return e}var E={populateHeroStatsTable:function(t,e){c(t),f(t).innerHTML="";var n=t.toLowerCase().includes("player"),a=n?"Player":"Enemy",o=[r.D5.HERO_NAME,r.D5.BATTLES,r.D5.PICK_RATE,r.D5.WINS,r.D5.WIN_RATE,r.D5.POSTBAN_RATE,r.D5.SUCCESS_RATE,r.D5.PLUS_MINUS,r.D5.POINT_GAIN,r.D5.AVG_CR,r.D5.FIRST_TURN_RATE],s=o.filter(function(t){return t!==r.D5.SUCCESS_RATE}),i=n?o:s,l=$("#".concat(t)).DataTable({layout:{topStart:"buttons"},language:{info:"Total rows: _TOTAL_"},order:[[2,"desc"]],buttons:{name:"primary",buttons:["copy",{extend:"csv",text:"CSV",filename:a+" Hero Stats"},{extend:"excel",text:"Excel",filename:a+" Hero Stats"}]},columnDefs:[{targets:"_all",className:"nowrap"},{targets:4,createdCell:function(t,e){var n=Number(e.replace("%",""));n<50?t.style.color="red":n>50&&(t.style.color="mediumspringgreen")}}],pageLength:50,scrollY:"300px",deferRender:!0,scroller:!0,scrollCollapse:!1,columns:i.map(function(t){return{data:t}})});return l.rows.add(e).draw(),l},populateSeasonDetailsTable:function(t,e){var n=f(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr");e.innerHTML="\n            <td>".concat(t["Season Number"],"</td>\n            <td>").concat(t.Season,"</td>\n            <td>").concat(t.Start,"</td>\n            <td>").concat(t.End,"</td>\n            <td>").concat(t.Status,"</td>\n            "),n.appendChild(e)})},populateServerStatsTable:function(t,e){var n=f(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr"),r=t.label.includes("Server")?"cm-keyword":"cm-declared-data";e.innerHTML='\n            <td class="'.concat(r,'">').concat(t.label,"</td>\n            <td>").concat(t.count,"</td>\n            <td>").concat(t.frequency,"</td>\n            <td>").concat(t.wins,'</td>\n            <td class="').concat(u(t.win_rate),'">').concat(t.win_rate,"</td>\n            <td>").concat(t["+/-"],'</td>\n            <td class="').concat(u(t.fp_wr),'">').concat(t.fp_wr,'</td>\n            <td class="').concat(u(t.sp_wr),'">').concat(t.sp_wr,"</td>\n            "),n.appendChild(e)})},populatePlayerPrebansTable:function(t,e){var n=f(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr");e.innerHTML="\n            <td>".concat(t.preban,"</td>\n            <td>").concat(t.appearances,"</td>\n            <td>").concat(t.appearance_rate,'</td>\n            <td class="').concat(u(t.win_rate),'">').concat(t.win_rate,"</td>\n            <td>").concat(t["+/-"],"</td>\n            "),n.appendChild(e)})},populatePlayerFirstPickTable:function(t,e){var n=f(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr");e.innerHTML="\n            <td>".concat(t.hero,"</td>\n            <td>").concat(t.appearances,"</td>\n            <td>").concat(t.appearance_rate,'</td>\n            <td class="').concat(u(t.win_rate),'">').concat(t.win_rate,"</td>\n            <td>").concat(t["+/-"],"</td>\n            "),n.appendChild(e)})},populateFullBattlesTable:function(t,e,n){var a;c(t),e=l(e),f(t).innerHTML="";var o=(new Date).toISOString().split("T")[0]||"";a=n?"".concat(n.name," (").concat(n.id,") ").concat(o):0===e.length?"Empty":"UID(".concat(e[0]["P1 ID"],") ").concat(o);var s=$("#".concat(t)).DataTable({layout:{topStart:"buttons"},language:{info:"Total rows: _TOTAL_"},order:[[2,"desc"]],columnDefs:[{targets:"_all",className:"nowrap"}],rowCallback:function(t,e,n){var r=t.cells[14],a=t.cells[15],o=t.cells[16];!0===e.Win?r.style.color="mediumspringgreen":!1===e.Win&&(r.style.color="red"),!0===e["First Pick"]&&(a.style.color="deepskyblue"),!0===e["First Turn"]&&(o.style.color="deepskyblue")},buttons:{name:"primary",buttons:["copy",{extend:"csv",text:"CSV",filename:a},{extend:"excel",text:"Excel",filename:a}]},pageLength:50,scrollY:"300px",deferRender:!0,scroller:!0,scrollCollapse:!1,columns:Object.values(r.Lx).filter(function(t){return!t.toLowerCase().includes("prime")}).map(function(t){return{data:t}})});return s.rows.add(e).draw(),s},replaceDatatableData:function(t,e){$("#".concat(t)).DataTable().clear().rows.add(e).draw()},replaceBattleData:function(t){t=l(t);var e=o.A.HOME_PAGE.BATTLES_TBL.id;this.replaceDatatableData(e,t)}},d={populateGeneralStats:function(t){a.K.setText("total-battles",t.total_battles),a.K.setText("first-pick-count",t.first_pick_count),a.K.setText("first-pick-rate"," (".concat(t.first_pick_rate,")")),a.K.setText("second-pick-count",t.second_pick_count),a.K.setText("second-pick-rate"," (".concat(t.second_pick_rate,")")),a.K.setText("total-winrate",t.total_winrate),a.K.setText("first-pick-winrate",t.first_pick_winrate),a.K.setText("second-pick-winrate",t.second_pick_winrate),a.K.setText("total-wins",t.total_wins),a.K.setText("max-win-streak",t.max_win_streak),a.K.setText("max-loss-streak",t.max_loss_streak),a.K.setText("avg-ppg",t.avg_ppg),a.K.setText("avg-turns",t.avg_turns),a.K.setText("avg-time",t.avg_time),a.K.setText("max-turns",t.max_turns),a.K.setText("max-time",t.max_time),a.K.setText("first-turn-games",t.first_turn_games),a.K.setText("first-turn-rate",t.first_turn_rate)}}},833:(t,e,n)=>{n.d(e,{j:()=>o});var r=n(412),a=n(54);const o={date:t=>t[r.Lx.DATE_TIME]?a.A.castStringToUTCDate(t[r.Lx.DATE_TIME].split(" ")[0]).getTime():"N/A",season:t=>t[r.Lx.SEASON_CODE],"is-first-pick":t=>!!t[r.Lx.FIRST_PICK],"is-win":t=>!!t[r.Lx.WIN],"victory-points":t=>t[r.Lx.P1_POINTS],"p1.picks":t=>t[r.Lx.P1_PICKS],"p2.picks":t=>t[r.Lx.P2_PICKS],"p1.prebans":t=>t[r.Lx.P1_PREBANS],"p2.prebans":t=>t[r.Lx.P2_PREBANS],"p1.postban":t=>t[r.Lx.P1_POSTBAN],"p2.postban":t=>t[r.Lx.P2_POSTBAN],postbans:t=>[t[r.Lx.P1_POSTBAN],t[r.Lx.P2_POSTBAN]],prebans:t=>[...t[r.Lx.P1_PREBANS],...t[r.Lx.P2_PREBANS]],"p1.pick1":t=>t[r.Lx.P1_PICKS][0],"p1.pick2":t=>t[r.Lx.P1_PICKS][1],"p1.pick3":t=>t[r.Lx.P1_PICKS][2],"p1.pick4":t=>t[r.Lx.P1_PICKS][3],"p1.pick5":t=>t[r.Lx.P1_PICKS][4],"p2.pick1":t=>t[r.Lx.P2_PICKS][0],"p2.pick2":t=>t[r.Lx.P2_PICKS][1],"p2.pick3":t=>t[r.Lx.P2_PICKS][2],"p2.pick4":t=>t[r.Lx.P2_PICKS][3],"p2.pick5":t=>t[r.Lx.P2_PICKS][4],"p1.league":t=>t[r.Lx.P1_LEAGUE],"p2.league":t=>t[r.Lx.P2_LEAGUE],"p1.server":t=>t[r.Lx.P1_SERVER],"p2.server":t=>t[r.Lx.P2_SERVER],"p1.id":t=>Number(t[r.Lx.P1_ID]),"p2.id":t=>Number(t[r.Lx.P2_ID]),"p1.mvp":t=>t[r.Lx.P1_MVP],"p2.mvp":t=>t[r.Lx.P2_MVP],"is-first-turn":t=>!!t[r.Lx.FIRST_TURN],"first-turn-hero":t=>t[r.Lx.FIRST_TURN_HERO],turns:t=>t[r.Lx.TURNS],seconds:t=>t[r.Lx.SECONDS],"point-gain":t=>t[r.Lx.POINT_GAIN]}},834:(t,e,n)=>{n.d(e,{A:()=>s});var r=n(545),a=n(40),o=n(275);const s={async getArtifactCodeToNameMap(){let t=await r.A.get(r.A.Keys.ARTIFACTS);return t||(t=await this.fetchAndCacheArtifacts()),t},getArtifactLowercaseNameMap:async function(){let t=await r.A.get(r.A.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP);if(null!==t)return t;const e=await this.getArtifactCodeToNameMap();return t=Object.fromEntries(Object.values(e).filter(t=>null!==t).map(t=>[t.toLowerCase(),t])),await r.A.cache(r.A.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP,t),t},getArtifactObjectList:async function(){let t=await r.A.get(r.A.Keys.ARTIFACT_OBJECT_LIST);if(null!==t)return t;const e=await this.getArtifactCodeToNameMap();return t=Object.entries(e).map(([t,e])=>({id:t,name:e})),await r.A.cache(r.A.Keys.ARTIFACT_OBJECT_LIST,t),t},fetchAndCacheArtifacts:async function(){const t=await async function(){let t=await a.A.fetchArtifactJSON("en");return null===t&&(t=await o.A.fetchArtifactJson()),null===t?(console.error("Could not get artifact Json map from E7 server or flask server"),null):Object.fromEntries(t.filter(t=>null!==t.name).map(t=>[t.code,t.name]))}();return null===t?{}:(await r.A.cache(r.A.Keys.ARTIFACTS,t),t)},clearArtifactData:async function(){await r.A.delete(r.A.Keys.ARTIFACTS)},convertCodeToName:function(t,e){return e[t]||t}}},836:(t,e,n)=>{n.d(e,{n:()=>u});var r=n(528),a=n(719),o=n(469),s=n(545),i=n(771),c=n(834),l=n(149);let u={HeroManager:r.A,BattleManager:a.A,SeasonManager:o.A,UserManager:i.A,ClientCache:s.A,ArtifactManager:c.A,LangManager:l.W}},874:(t,e,n)=>{n.d(e,{Su:()=>h});var r=n(497),a=n(412),o=n(771),s=n(623),i=n(136),c=n(836),l=n(149),u=n(82),f=n(507);function E(){window.location.href=URL_UTILS.HOME_PAGE_URL}function d(){document.querySelectorAll(".nav-link").forEach(t=>{t.addEventListener("click",async function(e){if(!("dataset"in t)||!t.dataset||"object"!=typeof t.dataset||!("nav"in t.dataset))return;const n=t.dataset.nav;if(Object.values(f.D).includes(n))if(n===f.D.SELECT_DATA)await r.pq.setState(f.D.SELECT_DATA),E();else if(n===f.D.HERO_INFO)await r.pq.setState(f.D.HERO_INFO),E();else if(n===f.D.SHOW_STATS){await o.A.getUser()?(await r.pq.setState(f.D.SHOW_STATS),E()):(await r.pq.setState(f.D.SELECT_DATA),await i.A.pushAction({message:"Active user not found; you must either query a valid user or upload battles to view hero stats.",action:i.A.ACTIONS.SHOW_NO_USER_MSG}),E())}})})}function p(){s.A.NAV_BAR.CLEAR_DATA_BTN.addEventListener("click",async function(){await o.A.getUser()?(await r.pq.setState(f.D.SELECT_DATA),await i.A.pushAction({action:i.A.ACTIONS.CLEAR_USER})):(await r.pq.setState(f.D.SELECT_DATA),await i.A.pushAction({action:i.A.ACTIONS.SHOW_DATA_ALREADY_CLEARED_MSG})),E()})}function _(){[s.A.NAV_BAR.CLEAR_DATA_BTN,s.A.NAV_BAR.EXPORT_DATA_BTN,s.A.NAV_BAR.OFFICIAL_SITE_BTN].forEach(t=>{t.addEventListener("touchstart",()=>{t.classList.add("touch-hover"),setTimeout(()=>t.classList.remove("touch-hover"),150)})})}function S(t,e="en"){t?(s.A.NAV_BAR.USER_NAME.innerText=t.name,s.A.NAV_BAR.USER_ID.innerText=`${t.id}`,s.A.NAV_BAR.USER_SERVER.innerText=a.DB[t.world_code],s.A.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(function(t,e){const n=`${a.F4}/${e}/gg/battlerecord/${t.world_code}/${t.id}`;return n}(t,e),"_blank","noopener,noreferrer")}):(s.A.NAV_BAR.USER_NAME.innerText="(None)",s.A.NAV_BAR.USER_ID.innerText="(None)",s.A.NAV_BAR.USER_SERVER.innerText="(None)",s.A.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(a.W4,"_blank","noopener,noreferrer")})}function A(){s.A.NAV_BAR.EXPORT_DATA_BTN.addEventListener("click",async function(){if(!await c.n.UserManager.getUser())return await i.A.pushAction({message:"User not found; cannot export data without an active user",action:i.A.ACTIONS.SHOW_NO_USER_MSG}),await r.pq.setState(f.D.SELECT_DATA),void E();await u.j.triggerDownload()})}let h={addNavListeners:d,addClearDataBtnListener:p,writeUserInfo:S,initialize:async function(){S(await o.A.getUser()),d(),p(),A(),_()},navToHome:E,addExportDataBtnListener:A,addBraceButtonListeners:_,eraseUserFromPage:async function(){await o.A.clearUserData(),S(null)},setUserOnPage:async function(t){await o.A.setUser(t),S(t,await l.W.getLang())}}},892:(t,e,n)=>{n.d(e,{b:()=>tt,W:()=>B});var r=n(771),a=n(545),o=n(793),s=n(836),i=n(207),c={"Current Season":"season = current-season","Last Season":"season = last-season","First Pick":"is-first-pick = true","Second Pick":"is-first-pick = false","Champion+ Opponent":"p2.league in {champion, warlord, emperor, legend}","Warlord+ Opponent":"p2.league in {warlord, emperor, legend}","Emperor+ Opponent":"p2.league in {emperor, legend}","Legend Opponent":"p2.league = 'legend'",Wins:"is-win = true",Losses:"is-win = false",extendFilters:function(t,e){var n=c[e];return";"!==(t=t.replace(/\s+$/,"")).slice(-1)&&t.length>0?t+=";\n":";"===t.slice(-1)&&(t+="\n"),"".concat(t).concat(n,";")}};const l=c;var u=n(940),f=n(181),E=n(507),d=n(623),p=n(412);const _=16,S=8,A=2,h=1;function T(t,e){return Math.log(t)/Math.log(e)}function m(t){const e=t;return{markerSize:Math.max(A,_-2*T(e,2.4)),lineWidth:Math.max(h,S-T(e,2.4))}}function g(t,e){const n={startX:null,endX:null,startY:null,endY:null};for(const[r,a]of t.entries())a["Seq Num"]in e&&(n.startX=null===n.startX||r<n.startX?r-.5:n.startX,n.startY=null===n.startY||a["P1 Points"]<n.startY+50?a["P1 Points"]-50:n.startY,n.endX=null===n.endX||r>n.endX?r+.5:n.endX,n.endY=null===n.endY||a["P1 Points"]>n.endY-50?a["P1 Points"]+50:n.endY);return n}function w(t,e,n,r=null){e.sort((t,e)=>t["Date/Time"].localeCompare(e["Date/Time"])),n||(n={name:`UID: ${e[0]["P1 ID"]}`});const a=e.map((t,e)=>e),o=e.map(t=>t["P1 Points"]),s=[];for(let[t,n]of e.entries())r&&n["Seq Num"]in r?s.push("#ff9900"):s.push("#0df8fd");const i=e.map(t=>[t[p.Lx.DATE_TIME].slice(0,10),t[p.Lx.SEASON],t[p.Lx.P1_LEAGUE]]),c=m(e.length),l={x:a,y:o,mode:"lines+markers",line:{color:"#4f9293",width:c.lineWidth},marker:{symbol:"circle",size:c.markerSize,color:s},customdata:i,hovertemplate:"Points: %{y}<br>Date: %{customdata[0]}<br>Season: %{customdata[1]}<br>League: %{customdata[2]}<extra></extra>"},u={autosize:!0,font:{family:"Roboto, Open Sans"},hoverlabel:{bgcolor:"rgba(0, 0, 0, 0.5)",font:{color:"white"},bordercolor:"rgba(0, 0, 0, 0.5)"},hovermode:"x unified",title:{text:`${n.name}'s RTA Point Plot`,font:{size:24,color:"#dddddd"},xanchor:"center",yanchor:"top",y:.95,x:.5},xaxis:{title:{text:"Battle Number (Chronological)",font:{size:18,color:"#dddddd"}},showgrid:!0,gridcolor:"#8d8d8d",zeroline:!1,tickfont:{size:12,color:"#dddddd"},range:null},yaxis:{title:{text:"Victory Points",font:{size:18,color:"#dddddd"}},showgrid:!0,gridcolor:"#8d8d8d",zeroline:!0,zerolinecolor:"#dddddd",zerolinewidth:2,tickfont:{size:12,color:"#dddddd"},range:null},plot_bgcolor:"#1e222d",paper_bgcolor:"#1e222d"},f={responsive:!0};let E,d=!0;return E=document.getElementById("rank-plot"),E||(d=!1,E=document.createElement("div"),E.id="rank-plot",t.appendChild(E)),E.style.width="100%",E.style.height="100%",d?Plotly.react(E,[l],u,f):Plotly.newPlot(E,[l],u,f),E}function R(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return O(l,"_invoke",function(n,r,a){var o,i,c,l=0,u=a||[],f=!1,E={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,i=0,c=t,E.n=n,s}};function d(n,r){for(i=n,c=r,e=0;!f&&l&&!a&&e<u.length;e++){var a,o=u[e],d=E.p,p=o[2];n>3?(a=p===r)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(i=0,E.v=r,E.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,E.n=p,i=0))}if(a||n>1)return s;throw f=!0,r}return function(a,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),i=u,c=p;(e=i<2?t:c)||!f;){o||(i?i<3?(i>1&&(E.n=-1),d(i,c)):E.n=c:E.v=c);try{if(l=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(f=E.n<0)?c:n.call(r,E))!==s)break}catch(e){o=t,i=1,c=e}finally{l=1}}return{value:e,done:f}}}(n,a,o),!0),l}var s={};function i(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(O(e={},r,function(){return this}),e),f=l.prototype=i.prototype=Object.create(u);function E(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,O(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=l,O(f,"constructor",l),O(l,"constructor",c),c.displayName="GeneratorFunction",O(l,a,"GeneratorFunction"),O(f),O(f,a,"Generator"),O(f,r,function(){return this}),O(f,"toString",function(){return"[object Generator]"}),(R=function(){return{w:o,m:E}})()}function O(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}O=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){O(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},O(t,e,n,r)}function y(t,e,n,r,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}function L(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function s(t){y(o,r,a,s,i,"next",t)}function i(t){y(o,r,a,s,i,"throw",t)}s(void 0)})}}function v(){var t=d.A.HOME_PAGE.RANK_PLOT;t.__zoomListenerAttached||(t.__zoomListenerAttached=!0,t.on("plotly_relayout",function(){var e=L(R().m(function e(n){var r,o,s,i,c,l,u;return R().w(function(e){for(;;)switch(e.n){case 0:if(!f.S.popKey(f.S.KEYS.IGNORE_RELAYOUT)){e.n=1;break}return e.a(2);case 1:return e.n=2,a.A.getStats();case 2:r=e.v,o=Object.values(r.battles).length,s=m(o),void 0!==n["xaxis.range[0]"]?(i=[n["xaxis.range[0]"],n["xaxis.range[1]"]],c=m(i[1]-i[0]),l=c.markerSize,u=c.lineWidth,Plotly.restyle(t,{"marker.size":[l],"line.width":[u]})):(Plotly.restyle(t,{"marker.size":[s.markerSize],"line.width":[s.lineWidth]}),s.markerSize,s.lineWidth);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()))}function N(t,e){var n,r;(n=d.A.HOME_PAGE.AUTO_ZOOM_FLAG).addEventListener("click",L(R().m(function t(){return R().w(function(t){for(;;)switch(t.n){case 0:return n.checked,t.n=1,s.n.ClientCache.cache(s.n.ClientCache.Keys.AUTO_ZOOM_FLAG,n.checked);case 1:return t.a(2)}},t)}))),(r=d.A.HOME_PAGE.BATTLE_FILTER_TOGGLE).addEventListener("click",L(R().m(function t(){var e;return R().w(function(t){for(;;)switch(t.n){case 0:return r.checked,t.n=1,s.n.ClientCache.getStats();case 1:e=t.v,r.checked?(e.filteredBattlesObj,o.c.replaceBattleData(Object.values(e.filteredBattlesObj))):o.c.replaceBattleData(e.battles);case 2:return t.a(2)}},t)}))),function(t){document.getElementById("premade-filters").addEventListener("click",function(e){e.preventDefault();var n=e.target.closest(".dropdown-item");if(n){var r=n.textContent.trim(),a=t.getValue(),o=l.extendFilters(a,r);t.setValue(o)}})}(t),function(t,e){document.getElementById("filterForm").addEventListener("submit",function(){var n=L(R().m(function n(r){var a,o,i,c;return R().w(function(n){for(;;)switch(n.n){case 0:return r.preventDefault(),document.getElementById("codeArea").value=t.getValue(),a=r.submitter,o=null==a?void 0:a.value,i=t.getValue(),n.n=1,s.n.ClientCache.getFilterStr();case 1:if(c=n.v,"apply"!==o){n.n=5;break}return n.n=2,u.A.validateFilterSyntax(i);case 2:if(!n.v){n.n=4;break}return n.n=3,s.n.ClientCache.setFilterStr(i);case 3:case 8:return f.S.AUTO_QUERY=!1,f.S.SOURCE=f.S.VALUES.SOURCE.STATS,e(E.D.LOAD_DATA),n.a(2);case 4:n.n=9;break;case 5:if("check"!==o){n.n=7;break}return n.n=6,u.A.validateFilterSyntax(i);case 6:case 9:return n.a(2);case 7:if("clear"!==o){n.n=9;break}if(t.setValue(""),!c){n.n=9;break}return n.n=8,s.n.ClientCache.setFilterStr("")}},n)}));return function(t){return n.apply(this,arguments)}}())}(t,e),function(t){d.A.HOME_PAGE.LATEST_BATTLES_BTN.addEventListener("click",L(R().m(function e(){return R().w(function(e){for(;;)switch(e.n){case 0:return f.S.AUTO_QUERY=!0,f.S.SOURCE=f.S.VALUES.SOURCE.STATS,e.n=1,t(E.D.LOAD_DATA);case 1:return e.a(2)}},e)})))}(e)}var b=n(494),P=n(541),I=n(497);function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function C(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return x(l,"_invoke",function(n,r,a){var o,i,c,l=0,u=a||[],f=!1,E={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,i=0,c=t,E.n=n,s}};function d(n,r){for(i=n,c=r,e=0;!f&&l&&!a&&e<u.length;e++){var a,o=u[e],d=E.p,p=o[2];n>3?(a=p===r)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(i=0,E.v=r,E.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,E.n=p,i=0))}if(a||n>1)return s;throw f=!0,r}return function(a,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),i=u,c=p;(e=i<2?t:c)||!f;){o||(i?i<3?(i>1&&(E.n=-1),d(i,c)):E.n=c:E.v=c);try{if(l=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(f=E.n<0)?c:n.call(r,E))!==s)break}catch(e){o=t,i=1,c=e}finally{l=1}}return{value:e,done:f}}}(n,a,o),!0),l}var s={};function i(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(x(e={},r,function(){return this}),e),f=l.prototype=i.prototype=Object.create(u);function E(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,x(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=l,x(f,"constructor",l),x(l,"constructor",c),c.displayName="GeneratorFunction",x(l,a,"GeneratorFunction"),x(f),x(f,a,"Generator"),x(f,r,function(){return this}),x(f,"toString",function(){return"[object Generator]"}),(C=function(){return{w:o,m:E}})()}function x(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}x=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){x(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},x(t,e,n,r)}function F(t,e,n,r,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}function M(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function s(t){F(o,r,a,s,i,"next",t)}function i(t){F(o,r,a,s,i,"throw",t)}s(void 0)})}}function B(){f.S.STATS_PRE_RENDER_COMPLETED&&(f.S.IGNORE_RELAYOUT=!0,setTimeout(function(){Plotly.Plots.resize(document.getElementById("rank-plot"))},20))}var U=function(t){return t.areFiltersApplied&&t.battles.length>Object.values(t.filteredBattlesObj).length};function H(t){return G.apply(this,arguments)}function G(){return(G=M(C().m(function t(e){var n,o,s,i,c,l,u,E;return C().w(function(t){for(;;)switch(t.n){case 0:return n=b.K.unwrapHtmlElt("rank-plot-container"),t.n=1,r.A.getUser();case 1:return o=t.v,t.n=2,a.A.get(a.A.Keys.AUTO_ZOOM_FLAG);case 2:s=t.v,i=w(n,e.battles,o,e.numFilters>0?e.filteredBattlesObj:null),v(),s&&U(e)&&(c=g(e.battles,e.filteredBattlesObj),l=m(c.endX-c.startX),u={"xaxis.range":[c.startX,c.endX],"yaxis.range":[c.startY,c.endY]},E={"marker.size":[l.markerSize],"line.width":[l.lineWidth]},f.S.IGNORE_RELAYOUT=!0,Plotly.restyle(i,E),Plotly.relayout(i,u));case 3:return t.a(2)}},t)}))).apply(this,arguments)}function k(){return j.apply(this,arguments)}function j(){return(j=M(C().m(function t(){var e,n,a,i;return C().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.A.getUser();case 1:if(e=t.v){t.n=2;break}return t.a(2);case 2:return t.p=3,t.n=4,s.n.SeasonManager.getSeasonDetails();case 4:return D(n=t.v),t.n=5,s.n.ClientCache.getStats();case 5:return a=t.v,console.time("populateTables"),o.c.populateSeasonDetailsTable("season-details-tbl",n),o.c.populateHeroStatsTable("player-tbl",a.playerHeroStats),o.c.populateHeroStatsTable("opponent-tbl",a.enemyHeroStats),o.c.populatePlayerFirstPickTable("first-pick-stats-tbl",a.firstPickStats),o.c.populatePlayerPrebansTable("preban-stats-tbl",a.prebanStats),o.c.populateServerStatsTable("performance-stats-tbl",a.performanceStats),d.A.HOME_PAGE.BATTLE_FILTER_TOGGLE.checked?o.c.populateFullBattlesTable("battles-tbl",Object.values(a.filteredBattlesObj),e):o.c.populateFullBattlesTable("battles-tbl",a.battles,e),o.W.populateGeneralStats(a.generalStats),t.n=6,H(a);case 6:console.timeEnd("populateTables"),t.n=8;break;case 7:t.p=7,i=t.v,console.error("Error loading data:",i);case 8:return t.a(2)}},t,null,[[3,7]])}))).apply(this,arguments)}function K(){return $.apply(this,arguments)}function $(){return($=M(C().m(function t(){var e,n,r;return C().w(function(t){for(;;)switch(t.n){case 0:return CodeMirror.defineMode("filterSyntax",function(){return{token:function(t,e){return i.L.tokenMatch(t)}}}),e=document.getElementById("codeArea"),(n=CodeMirror.fromTextArea(e,{mode:"filterSyntax",lineNumbers:!0,theme:"default"})).setSize(null,185),t.n=1,s.n.ClientCache.getFilterStr();case 1:return(r=t.v)&&n.setValue(r),n.on("change",function(){n.save()}),e.classList.remove("codemirror-hidden"),f.S.CODE_MIRROR_EDITOR=n,t.a(2,n)}},t)}))).apply(this,arguments)}function Y(){return V.apply(this,arguments)}function V(){return(V=M(C().m(function t(){return C().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,k();case 1:return t.a(2)}},t)}))).apply(this,arguments)}function W(){return q.apply(this,arguments)}function q(){return(q=M(C().m(function t(){var e;return C().w(function(t){for(;;)switch(t.n){case 0:if(e=f.S.CODE_MIRROR_EDITOR){t.n=1;break}return console.error("Editor not found in CONTEXT"),t.a(2);case 1:e.refresh();case 2:return t.a(2)}},t)}))).apply(this,arguments)}function z(t){return Q.apply(this,arguments)}function Q(){return(Q=M(C().m(function t(e){var n,a,i;return C().w(function(t){for(;;)switch(t.n){case 0:return n=d.A.HOME_PAGE.AUTO_ZOOM_FLAG,t.n=1,s.n.ClientCache.get(s.n.ClientCache.Keys.AUTO_ZOOM_FLAG);case 1:return a=t.v,n.checked=a,t.n=2,s.n.ClientCache.getStats();case 2:return i=t.v,d.A.HOME_PAGE.BATTLE_FILTER_TOGGLE.checked&&o.c.replaceBattleData(Object.values(i.filteredBattlesObj)),t.n=3,r.A.getUser();case 3:if(t.v){t.n=4;break}return e(E.D.SELECT_DATA),t.a(2);case 4:case 5:d.A.HOME_PAGE.CSV_FILE.value="",d.A.HOME_PAGE.USER_QUERY_FORM_NAME.value="";case 6:return t.a(2)}},t)}))).apply(this,arguments)}function J(){for(var t=[d.A.HOME_PAGE.FIRST_PICK_STATS_TBL,d.A.HOME_PAGE.PREBAN_STATS_TBL,d.A.HOME_PAGE.SEASON_DETAILS_TBL],e=(0,P.XJ)(),n=0,r=t;n<r.length;n++){var a=r[n].querySelector("thead");a&&a.style.setProperty("padding-right","".concat(e,"px"))}}function X(){return(X=M(C().m(function t(e){var n;return C().w(function(t){for(;;)switch(t.n){case 0:return J(),t.n=1,K();case 1:return n=t.v,t.n=2,N(n,e);case 2:return t.a(2)}},t)}))).apply(this,arguments)}function Z(){return(Z=M(C().m(function t(e){return C().w(function(t){for(;;)switch(t.n){case 0:if(f.S.STATS_PRE_RENDER_COMPLETED){t.n=3;break}if(f.S.IS_FIRST_RENDER){t.n=1;break}return t.n=1,I.KJ.homePageSetView(E.D.LOAD_DATA);case 1:return t.n=2,Y(e);case 2:f.S.STATS_PRE_RENDER_COMPLETED=!0;case 3:return t.n=4,z(e);case 4:return t.n=5,I.KJ.homePageSetView(E.D.SHOW_STATS);case 5:if(f.S.STATS_POST_RENDER_COMPLETED){t.n=7;break}return t.n=6,W();case 6:f.S.STATS_POST_RENDER_COMPLETED=!0;case 7:B();case 8:return t.a(2)}},t)}))).apply(this,arguments)}var tt={preFirstRenderLogic:Y,postFirstRenderLogic:W,runLogic:z,initialize:function(t){return X.apply(this,arguments)},populateContent:k,triggerState:E.D.SHOW_STATS,handleDispatch:function(t){return Z.apply(this,arguments)}}},913:(t,e,n)=>{n.d(e,{A:()=>h});var r=n(528),a=n(412);const o=t=>t.filter(t=>t[a.Lx.FIRST_PICK]),s="N/A";function i(t){return(100*t).toFixed(2)+"%"}function c(t,e,n=!1){return 0===e?n?"0.00%":s:i(t/e)}function l(t,e){return 0===e?s:(t/e).toFixed(2)}function u(t,e){const n=t[a.Lx.CR_BAR].find(t=>t[0]===e);return n?n[1]:null}function f(t,e){const n=t.filter(t=>{const n=t[a.Lx.P1_PICKS].includes(e)||t[a.Lx.P2_PICKS].includes(e),r=t[a.Lx.P1_POSTBAN]!==e&&t[a.Lx.P2_POSTBAN]!==e;return n&&r});let r=n.length,o=0,s=0;for(const t of n){const n=u(t,e);null!==n&&(o+=n,s+=+(100===n))}return{avgCR:c(o/100,r,!0),firstTurns:s,firstTurnRate:c(s,r,!0)}}function E(t,e){const n=(r=t,r.filter(t=>t[a.Lx.WIN])).length;var r;const o=t.length,s=t.filter(t=>t[a.Lx.FIRST_TURN]).length,i=c(s,t.length),u=t.reduce((t,e)=>t+(e[a.Lx.POINT_GAIN]||0),0);return{wins:n,subsetLength:o,frequency:c(t.length,e),winRate:c(n,t.length),plusMinus:2*n-o,pointGain:t.reduce((t,e)=>t+(e[a.Lx.POINT_GAIN]||0),0),avgPPG:l(u,o),firstTurns:s,firstTurnRate:i}}function d(t,e,n){const r=E(t,e),o=t.reduce((t,e)=>t+ +(e[a.Lx.P1_POSTBAN]===n||e[a.Lx.P2_POSTBAN]===n),0),s=t.reduce((t,e)=>t+ +(e[a.Lx.WIN]||e[a.Lx.P1_POSTBAN]===n||e[a.Lx.P2_POSTBAN]===n),0),i=f(t,n);return{[a.D5.HERO_NAME]:n,[a.D5.BATTLES]:r.subsetLength,[a.D5.PICK_RATE]:r.frequency,[a.D5.WINS]:r.wins,[a.D5.WIN_RATE]:r.winRate,[a.D5.POSTBANS]:o,[a.D5.POSTBAN_RATE]:c(o,r.subsetLength),[a.D5.SUCCESS_RATE]:c(s,r.subsetLength),[a.D5.PLUS_MINUS]:r.plusMinus,[a.D5.POINT_GAIN]:r.pointGain,[a.D5.AVG_CR]:i.avgCR,[a.D5.FIRST_TURNS]:i.firstTurns,[a.D5.FIRST_TURN_RATE]:i.firstTurnRate}}function p(t,e=!0){const n=new Set;for(const r of Object.values(t)){(e?r[a.Lx.P1_PICKS]:r[a.Lx.P2_PICKS]).forEach(t=>{n.add(t)})}return n}function _(t){return t.sort(),t.join("~")}function S(t,e){return t.map(t=>r.A.getHeroByName(t,e)?.code??e.Empty.code).filter(t=>t!==e.Empty.code)}function A(t){let e;const n=Math.floor(t/60),r=(t%60).toFixed(1);return e=0===n?`${r} secs`:`${n} : ${r}s`,e}const h={getHeroStats:function(t,e){if(0===t.length)return{playerHeroStats:[],enemyHeroStats:[]};const n=t.length,o=p(t,!0),s=p(t,!1),i=[],c=[];for(const s of o){const o=r.A.getHeroByName(s,e);if(!o)continue;const c=t.filter(t=>t[a.Lx.P1_PICKS].includes(s));c.length>0&&i.push(d(c,n,o.name))}for(const o of s){const s=r.A.getHeroByName(o,e);if(!s)continue;const i=t.filter(t=>t[a.Lx.P2_PICKS].includes(o));i.length>0&&c.push(d(i,n,s.name))}const l=a.D5.HERO_NAME;return{playerHeroStats:i.sort((t,e)=>t[l].localeCompare(e[l])),enemyHeroStats:c.sort((t,e)=>t[l].localeCompare(e[l]))}},getFirstPickStats:function(t,e){if(0===(t=o(Object.values(t))).length)return[];const n=t.length,s={};for(const e of t){if(0===e[a.Lx.P1_PICKS].length)continue;const t=e[a.Lx.P1_PICKS][0];t in s||(s[t]={wins:0,appearances:0}),s[t].wins+=+e[a.Lx.WIN],s[t].appearances+=1}const c=Object.entries(s).map(([t,a])=>({hero:r.A.getHeroByName(t,e)?.name??r.A.EMPTY_NAME,wins:a.wins,appearances:a.appearances,win_rate:i(a.wins/a.appearances),appearance_rate:i(a.appearances/n),"+/-":2*a.wins-a.appearances}));return c.sort((t,e)=>e.appearances-t.appearances),c},getPrebanStats:function(t,e){if(0===t.length)return[];const n=new Set;for(const r of t){const t=S(r[a.Lx.P1_PREBANS],e);if(0!==t.length){for(const r of t)r!==e.Empty.code&&n.add(r);t.length>1&&n.add(_(t))}}const o=t.length,s=[];for(const i of n){const n=E(t.filter(t=>_(S(t[a.Lx.P1_PREBANS],e)).includes(i)),o),c=i.split("~").map(t=>r.A.getHeroByCode(t,e)?.name??e.Empty.name).sort().join(", ");n.wins,n.subsetLength,s.push({preban:c,wins:n.wins,appearances:n.subsetLength,appearance_rate:n.frequency,win_rate:n.winRate,"+/-":n.plusMinus})}return s.sort((t,e)=>e.appearances-t.appearances),s},getPerformanceStats:function(t){const e={servers:[],leagues:[]},n=t.length,r=Object.values(a.DB),o=Object.values(a.pc),s=[...r.map(t=>[`Server: ${t}`,e=>e["P2 Server"]===t]),...o.map(t=>[`League: ${t}`,e=>e["P2 League"]===t])];for(const[r,o]of s){const s=t.filter(o),c=s.length;if(0===c)continue;const l=E(s,n),u=s.filter(t=>t[a.Lx.FIRST_PICK]),f=u.reduce((t,e)=>t+ +e[a.Lx.WIN],0),d=s.filter(t=>!t[a.Lx.FIRST_PICK]),p=d.reduce((t,e)=>t+ +e[a.Lx.WIN],0);(r.toLowerCase().includes("server")?e.servers:e.leagues).push({label:r,count:c,wins:l.wins,win_rate:l.winRate,frequency:l.frequency,"+/-":l.plusMinus,fp_games:u.length,sp_games:d.length,fp_wr:u.length>0?i(f/u.length):"N/A",sp_wr:d.length>0?i(p/d.length):"N/A"})}return[...e.servers,...e.leagues.slice(-4)]},getGeneralStats:function(t){t.sort((t,e)=>new Date(t["Date/Time"]).getTime()-new Date(e["Date/Time"]).getTime());const e=t.length,n=l(t.reduce((t,e)=>t+(e["Point Gain"]||0),0),e),r=l(t.reduce((t,e)=>t+e.Turns,0),e),u=t.length>0?Math.max(...t.map(t=>t.Turns)):0,f=t.reduce((t,e)=>t+e.Seconds,0),d=e>0?f/e:0,p=t.length>0?Math.max(...t.map(t=>t.Seconds)):0;let _=A(d),S=A(p);const h=t.reduce((t,e)=>t+ +e["First Turn"],0),T=o(t),m=(t=>t.filter(t=>!t[a.Lx.FIRST_PICK]))(t),g=E(T,e),w=E(m,e),R=c(g.wins+w.wins,e);let[O,y,L,v]=[0,0,0,0];for(let e of t)e.Win?(L+=1,O=Math.max(O,L),v=0):(L=0,v+=1,y=Math.max(y,v));return{first_pick_count:g.subsetLength,second_pick_count:w.subsetLength,first_pick_rate:g.frequency,second_pick_rate:w.frequency,first_pick_winrate:g.winRate,second_pick_winrate:w.winRate,total_winrate:R,total_battles:e,total_wins:g.wins+w.wins,max_win_streak:O,max_loss_streak:y,avg_ppg:n,avg_turns:r,avg_time:_,max_turns:u,max_time:S,first_turn_games:h,first_turn_rate:e?i(h/e):s}},computeGenericStats:E,queryStats:d,toPercent:i,divideToPercentString:c,divideToString:l,computeCRStats:f,secondsToTimeStr:A}},940:(t,e,n)=>{n.d(e,{A:()=>f});var r,a,o=n(528),s=n(84),i=n(172);function c(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof i?r:i,u=Object.create(c.prototype);return l(u,"_invoke",function(n,r,a){var o,i,c,l=0,u=a||[],f=!1,E={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,i=0,c=t,E.n=n,s}};function d(n,r){for(i=n,c=r,e=0;!f&&l&&!a&&e<u.length;e++){var a,o=u[e],d=E.p,p=o[2];n>3?(a=p===r)&&(c=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=n<2&&d<o[1])?(i=0,E.v=r,E.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,E.n=p,i=0))}if(a||n>1)return s;throw f=!0,r}return function(a,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),i=u,c=p;(e=i<2?t:c)||!f;){o||(i?i<3?(i>1&&(E.n=-1),d(i,c)):E.n=c:E.v=c);try{if(l=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(f=E.n<0)?c:n.call(r,E))!==s)break}catch(e){o=t,i=1,c=e}finally{l=1}}return{value:e,done:f}}}(n,a,o),!0),u}var s={};function i(){}function u(){}function f(){}e=Object.getPrototypeOf;var E=[][r]?e(e([][r]())):(l(e={},r,function(){return this}),e),d=f.prototype=i.prototype=Object.create(E);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,l(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=f,l(d,"constructor",f),l(f,"constructor",u),u.displayName="GeneratorFunction",l(f,a,"GeneratorFunction"),l(d),l(d,a,"Generator"),l(d,r,function(){return this}),l(d,"toString",function(){return"[object Generator]"}),(c=function(){return{w:o,m:p}})()}function l(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}l=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){l(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},l(t,e,n,r)}function u(t,e,n,r,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}const f={validateFilterSyntax:(r=c().m(function t(e){var n,r,a;return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.A.getHeroDicts();case 1:return n=t.v,r=document.getElementById("filterMSG"),t.p=2,t.n=3,s.S.fromFilterStr(e,n);case 3:return t.v.asString(),i.GF.write(new i.ev("Validation Passed",r,[i.GF.STYLES.GREEN])),t.a(2,!0);case 4:return t.p=4,a=t.v,console.error(a),i.GF.write(new i.ev("Validation Failed: ".concat(a.message),r,[i.GF.STYLES.RED])),t.a(2,!1)}},t,null,[[2,4]])}),a=function(){var t=this,e=arguments;return new Promise(function(n,a){var o=r.apply(t,e);function s(t){u(o,n,a,s,i,"next",t)}function i(t){u(o,n,a,s,i,"throw",t)}s(void 0)})},function(t){return a.apply(this,arguments)}),setScrollPercent:function(t){"Scrolling to ".concat(t,"%");var e=t/100*(document.documentElement.scrollHeight-window.innerHeight),n=document.documentElement,r=n.style.scrollBehavior;n.style.scrollBehavior="auto",window.scrollTo({top:e}),n.style.scrollBehavior=r},getScrollPercent:function(){var t=window.scrollY||document.documentElement.scrollTop,e=document.documentElement.scrollHeight-window.innerHeight;return 0===e?0:t/e*100},setVisibility:function(t,e){e?t.classList.remove("d-none"):t.classList.add("d-none")}}},971:(t,e,n)=>{n.d(e,{Nk:()=>s,RG:()=>o,yL:()=>a});var r=n(412);const a=new Set("'\"(),_-.=; ><!1234567890{}~abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),o="   ",s=Object.fromEntries(Object.values(r.pg).map(t=>[t.toLowerCase(),t]))}},s={};function i(t){var e=s[t];if(void 0!==e)return e.exports;var n=s[t]={exports:{}};return o[t](n,n.exports,i),n.exports}t="function"==typeof Symbol,e=t?Symbol("webpack queues"):"__webpack_queues__",n=t?Symbol("webpack exports"):"__webpack_exports__",r=t?Symbol("webpack error"):"__webpack_error__",a=t=>{t&&t.d<1&&(t.d=1,t.forEach(t=>t.r--),t.forEach(t=>t.r--?t.r++:t()))},i.a=(t,o,s)=>{var i;s&&((i=[]).d=-1);var c,l,u,f=new Set,E=t.exports,d=new Promise((t,e)=>{u=e,l=t});d[n]=E,d[e]=t=>(i&&t(i),f.forEach(t),d.catch(t=>{})),t.exports=d,o(t=>{var o;c=(t=>t.map(t=>{if(null!==t&&"object"==typeof t){if(t[e])return t;if(t.then){var o=[];o.d=0,t.then(t=>{s[n]=t,a(o)},t=>{s[r]=t,a(o)});var s={};return s[e]=t=>t(o),s}}var i={};return i[e]=t=>{},i[n]=t,i}))(t);var s=()=>c.map(t=>{if(t[r])throw t[r];return t[n]}),l=new Promise(t=>{(o=()=>t(s)).r=0;var n=t=>t!==i&&!f.has(t)&&(f.add(t),t&&!t.d&&(o.r++,t.push(o)));c.map(t=>t[e](n))});return o.r?l:s()},t=>(t?u(d[r]=t):l(E),a(i))),i&&i.d<0&&(i.d=0)},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);i(643)})();