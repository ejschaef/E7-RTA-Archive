/*! For license information please see information.fbb10233239782ce336d.bundle.js.LICENSE.txt */
(()=>{"use strict";var e,t,n,r,a,s={40:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(412);async function a(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error: status: ${t.status}`);const n=await t.json();return Object.keys(n),n}catch(e){return console.error("Error fetching global user data:",e),null}}const s={fetchHeroJSON:async function(e=null){let t=await a("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_hero.json");return t?(e&&t[e]?t=t[e]:e&&!t[e]&&(console.error("Could not find hero data for language:",e),t=null),t):null},fetchUserJSON:async function(e){if(e=e.replace("world_",""),![...r.WB].some(t=>t.replace("world_","")===e))return console.error(`Could not find world code: ${e}`),null;const t=`https://static.smilegatemegaport.com/gameRecord/epic7/epic7_user_world_${e}.json`,n=await a(t);return n&&"object"==typeof n&&"users"in n&&Array.isArray(n.users)&&n.users.length,n},fetchArtifactJSON:async function(e=null){let t=await a("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_artifact.json"),n=null;if(t&&e&&"object"==typeof t&&e in t){let n=t;if(Array.isArray(n[e]))return n[e]}return n},fetchInfo:async function(e,t,n="en"){const r=new URLSearchParams({nick_no:e,world_code:t,lang:n});try{const e=await fetch("https://epic7.onstove.com/gg/gameApi/getUserInfo",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()});if(!e.ok)return console.error("Error fetching battle list:",e.status,e.statusText),null;return await e.json()}catch(e){return console.error("Request failed:",e),null}}}},42:(e,t,n)=>{n.d(t,{c2:()=>ae,CO:()=>re,eR:()=>B,y4:()=>Z,Qo:()=>$});var r=n(92),a=n(412),s=n(207),i=n(54),o=n(528),l=n(971);class c{}const u={Hero:new class extends c{parse(e,t){return o.A.getHeroByName(e,t.HeroDicts)?.name??null}parserType="Hero"},League:new class extends c{parse(e){return a.pc,a.pc[e]}parserType="League"},Server:new class extends c{parse(e){return a.$k[e]}parserType="Server"},Equipment:new class extends c{parse(e){return l.Nk[e.toLowerCase()]}parserType="Equipment"},Artifact:new class extends c{parse(e,t){return t.ARTIFACT_LOWERCASE_STRINGS_MAP[e.toLowerCase()]}parserType="Artifact"},Season:new class extends c{parse(e,t){let n;if("current-season"===e)return t.SEASON_DETAILS[0].Code;if("last-season"===e)return t.SEASON_DETAILS[1].Code;if(s.L.SEASON_LITERAL_RE.test(e))n=e.split("-").at(-1);else{if(!s.L.SEASON_CODE_LITERAL_RE.test(e))return null;n=e.split("_ss").at(-1)}t.SEASON_DETAILS.map(e=>e.Code.split("_").at(-1));return t.SEASON_DETAILS.find(e=>e.Code.split("_ss").at(-1)===n)?.Code}parserType="Season Code"}};var d=n(833);const f=new Set(["p1.picks","p2.picks","p1.prebans","p2.prebans","prebans","postbans"]),h={FIELD:"FIELD",RANGE:"RANGE",SET:"SET",INT:"INT",DATE:"DATE",BOOL:"BOOL",STRING:"STRING"};class p{}class E extends p{type=h.FIELD;rawString;extractFn;constructor(e){if(super(),this.rawString=e,!d.j[e])throw new Error("Invalid field");this.extractFn=d.j[e]}getData(){throw new Error("Not implemented for Field")}extractData(e){return this.extractFn(e)}asString(){return`${this.rawString}`}}class _ extends p{rawString;constructor(e){super(),this.rawString=e}getData(){return this.data}extractData(e){throw new Error("Not implemented for Literals")}asString(){return`${this.fmtString}`}}class A extends _{type=h.STRING;fmtString;data;constructor(e,t,n=Object.values(u)){super(e),e=i.A.trimSurroundingQuotes(e),this.data=this.processString(e,t,n),this.fmtString=this.data}processString(e,t,n){const r=function(e,t,n){for(const r of n){const n=r.parse(e,t);if(r.parserType,n)return n}return null}(e,t,n);if(!r){const t=n.map(e=>e.parserType).join(", ");throw new i.A.ValidationError(`Invalid string literal: '${e}' ; could not be parsed as a valid instance of any of the following: [${t}]`)}return r}}class S extends _{type=h.INT;fmtString;data;constructor(e){super(e),this.data=this.processString(e),this.fmtString=e}processString(e){const t=parseInt(e);if(isNaN(t))throw new i.A.ValidationError(`Invalid integer literal: '${e}'`);return t}}class T extends _{type=h.BOOL;fmtString;data;constructor(e){super(e),this.data=this.processString(e),this.fmtString=e}processString(e){if("true"===e)return!0;if("false"===e)return!1;throw new i.A.ValidationError(`Invalid boolean literal: '${e}'`)}}class g extends _{type=h.DATE;fmtString;data;constructor(e){super(e),this.data=this.processString(e),this.fmtString=e}processString(e){return i.A.parseDate(e).getTime()}}class m{start;end;endInclusive;constructor(e,t,n){this.start=e,this.end=t,this.endInclusive=n}has(e){return"number"==typeof e&&"number"==typeof this.start&&"number"==typeof this.end&&(!(e<this.start)&&(!(e>this.end)&&(e!==this.end||this.endInclusive)))}includes(e){return this.has(e)}}const w=[e=>s.L.DATE_LITERAL_RE.test(e)?new g(e):null,e=>s.L.INT_LITERAL_RE.test(e)?new S(e):null];function R(e,t,n,r){let a=r(e),s=r(t);return null===a||null===s?null:new m(a.data,s.data,n)}class N extends _{type=h.RANGE;fmtString;data;constructor(e,t){super(e),this.fmtString=e,this.data=this.processString(e,t)}processString(e,t){const n=e.split("..."),r=n[0];let a="="===n[1].charAt(0);const s=n[1].slice(a?1:0);for(const e of w){const t=R(r,s,a,e);if(null!==t)return t}throw new i.A.ValidationError(`Invalid range literal: '${e}' ; ranges must be homogenous and of the format x...y or x...=y for the types: [Date, Integer]`)}}const I=[...w],y=(e,t,n)=>s.L.STRING_RE.test(e)?new A(e,t,n):null;class L extends _{type=h.SET;fmtString;data;constructor(e,t,n=Object.values(u)){super(e),this.fmtString=e,this.data=this.processString(e,t,n)}processString(e,t,n){let r=i.A.tokenizeWithNestedEnclosures(e,",",1,!0);r=r.filter(e=>""!==e);const a=new Set;for(const s of r){let r=null;for(const e of I)if(r=e(s),r){a.add(r.data);break}if(!r){if(r=y(s,t,n),!r)throw new i.A.ValidationError(`Invalid set element: '${e}' ; could not be parsed as a valid instance of any of the following types: [Date, Integer, String]`);a.add(r.data)}}return this.fmtString=`{${Array.from(a).join(", ")}}`,a}}const O={StringLiteral:A,IntLiteral:S,BoolLiteral:T,DateLiteral:g,RangeLiteral:N,SetLiteral:L,Field:E,BaseEltTypes:h,FIELD_EXTRACT_FN_MAP:d.j,parseBaseElement:function(e,t){if(s.L.STRING_LITERAL_RE.test(e))return new A(e,t);if(s.L.INT_LITERAL_RE.test(e))return new S(e);if(s.L.BOOL_LITERAL_RE.test(e))return new T(e);if(s.L.DATE_LITERAL_RE.test(e))return new g(e);if(s.L.RANGE_LITERAL_RE.test(e))return new N(e,t);if(s.L.SET_LITERAL_RE.test(e))return new L(e,t);if(s.L.SEASON_LITERAL_RE.test(e))return new A(e,t,[u.Season]);if(s.L.FIELD_WORD_LITERAL_RE.test(e))return new E(e);throw new i.A.ValidationError(`Invalid base element: '${e}' ; could not be parsed as a Field or Literal.`)},COLLECTION_FIELDS_SET:f};const b={">":(e,t)=>e>t,"<":(e,t)=>e<t,"=":(e,t)=>e===t,">=":(e,t)=>e>=t,"<=":(e,t)=>e<=t,"!=":(e,t)=>e!==t},C="in",P="compare";class v{}class D extends v{type=C;opStr;negate=!1;constructor(e=!1){super(),this.negate=e,this.opStr=this.negate?"!in":"in"}call(e,t){const n=Array.isArray(t)?t.includes(e):t.has(e);return this.negate?!n:n}}class x extends v{type=P;opStr;compareFn;constructor(e){if(super(),this.opStr=e,this.compareFn=b[e],!this.compareFn)throw new Error(`Unknown operator: ${e}`)}call(e,t){return this.compareFn(e,t)}}function F(e){switch(e){case"in":return new D;case"!in":return new D(!0);default:return new x(e)}}const B={AND:"and",OR:"or",XOR:"xor",NOT:"not",LAST_N:"last-n",EQUIPMENT:"equipment",ARTIFACT:"artifact",CR:"cr",BASE_FILTER:"base-filter"},k="CLAUSE_FN",M="HERO_LIST_FN",H="GLOBAL_FN",U="BASE_FILTER";class j{}class $ extends j{}class G extends ${fnType=k;fns=[];constructor(...e){super(),this.fns=e}asString(e=""){let t="";const n=e+l.RG;return this.fns.forEach(e=>t+=`${e.asString(n)},\n`),`${e}${this.fnName}(\n${t.trimEnd()}\n${e})`}}class K extends G{fnName=B.AND;fnType=k;call(e){return this.fns.every(t=>t.call(e))}}class q extends G{fnName=B.OR;fnType=k;call(e){return this.fns.some(t=>t.call(e))}}class Y extends G{fnName=B.XOR;fnType=k;call(e){let t=!1;for(let n of this.fns)t=!t&&n.call(e)||t&&!n.call(e);return t}}class W extends G{fnName=B.NOT;fnType=k;constructor(...e){if(super(...e),1!==this.fns.length)throw new i.A.SyntaxException(`Invalid NOT function call ; accepts exactly 1 argument ; got: [${this.fns}]`)}call(e){return!this.fns[0].call(e)}}class V extends ${fnType=M;getHeroes(e){return this.isPlayer1?e[a.Lx.P1_PICKS]:e[a.Lx.P2_PICKS]}asString(e=""){return`${e}${this.isPlayer1?"p1.":"p2."}${this.fnName}(${this.argFmtString})`}}class X extends V{fnName=B.CR;fnType=M;heroName;crThreshold=0;operator;targetField;isPlayer1=!1;argFmtString;constructor(e,t){super();const n=e.includes(",")?",":" ",r=i.A.tokenizeWithNestedEnclosures(e,n,1,!0);if(3!==r.length)throw new i.A.SyntaxException(`Invalid CR function call ; accepts exactly 3 arguments ; got: [${r}] from str: ${e}`);const s=parseInt(r[2]);if(isNaN(s))throw new i.A.TypeException(`Invalid CR function call ; third argument must be a valid integer literal ; got: '${r[2]}' from str: ${e}`);const o=F(r[1]);if(!(o instanceof x))throw new i.A.TypeException(`Invalid CR function call ; second argument must be a valid comparison operator ; got: '${r[1]}' from str: ${e}`);this.heroName=new O.StringLiteral(r[0],t,[u.Hero]).data,this.crThreshold=s,this.operator=o,this.isPlayer1=e.includes("p1."),this.targetField=e=>e[a.Lx.CR_BAR],this.argFmtString=`${this.heroName} ${this.operator.opStr} ${this.crThreshold}`}call(e){const t=this.getHeroes(e),n=this.targetField(e).find(e=>e[0]===this.heroName);return!!n&&(!!t.includes(this.heroName)&&this.operator.call(n[1],this.crThreshold))}}function J(e,t){for(const n in e)if(e[n]>(t[n]||0))return!1;return!0}class Q extends V{fnName=B.EQUIPMENT;fnType=M;heroName;targetEquipCounts;isPlayer1=!1;argFmtString;targetField;constructor(e,t){super();const n=i.A.tokenizeWithNestedEnclosures(e,",",1,!0);if(2!==n.length)throw new i.A.SyntaxException(`Invalid equipment function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${e}`);const s=n[1].includes("{")?n[1]:`{${n[1]}}`;let o=i.A.tokenizeWithNestedEnclosures(s,",",1,!0);o=o.map(e=>new O.StringLiteral(e,t,[u.Equipment]).data),this.targetEquipCounts=(0,r.J)(o),this.heroName=new O.StringLiteral(n[0],t,[u.Hero]).data,this.isPlayer1=e.includes("p1."),this.argFmtString=`${this.heroName}, {${o.join(",")}}`,this.targetField=e=>this.isPlayer1?e[a.Lx.P1_EQUIPMENT]:e[a.Lx.P2_EQUIPMENT]}call(e){const t=this.getHeroes(e),n=this.targetField(e);for(let e=0;e<t.length;e++)if(t[e]===this.heroName){const t=(0,r.J)(n[e]);return J(this.targetEquipCounts,t)}return!1}}class z extends V{fnName=B.ARTIFACT;fnType=M;heroName;targetArtifacts;isPlayer1=!1;argFmtString;targetField;constructor(e,t){super();const n=i.A.tokenizeWithNestedEnclosures(e,",",1,!0);if(2!==n.length)throw new i.A.SyntaxException(`Invalid artifact function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${e}`);const r=n[1].includes("{")?n[1]:`{${n[1]}}`;let s=i.A.tokenizeWithNestedEnclosures(r,",",1,!0);s=s.map(e=>new O.StringLiteral(e,t,[u.Artifact]).data),this.targetArtifacts=s,this.heroName=new O.StringLiteral(n[0],t,[u.Hero]).data,this.isPlayer1=e.includes("p1."),this.argFmtString=`${this.heroName}, {${s.join(", ")}}`,this.targetField=e=>this.isPlayer1?e[a.Lx.P1_ARTIFACTS]:e[a.Lx.P2_ARTIFACTS]}call(e){const t=this.getHeroes(e),n=this.targetField(e);for(let e=0;e<t.length;e++)if(t[e]===this.heroName)return this.targetArtifacts.some(t=>n[e].includes(t));return!1}}class Z extends j{fnType=H;asString(e=""){return`${e}${this.fnName}(${this.argFmtString})`}}class ee extends Z{fnName=B.LAST_N;fnType=H;argFmtString;n;constructor(e){super();const t=i.A.tokenizeWithNestedEnclosures(e,",",1,!0);if(1!==t.length)throw new i.A.SyntaxException(`Invalid last-n function call ; accepts exactly 1 argument ; got: [${t}] from str: ${e}`);this.n=new O.IntLiteral(t[0]).data,this.argFmtString=`${this.n}`}call(e){return e.slice(-this.n)}}function te(e,t,n){const r=`${e.asString()} ${t.opStr} ${n.asString()}`;if(e instanceof O.Field&&n instanceof O.Field)throw new i.A.ValidationError(`Invalid base filter; fields cannot be compared with other fields ; got string: [${r}]`);if(e.type!==O.BaseEltTypes.FIELD&&n.type!==O.BaseEltTypes.FIELD)throw new i.A.ValidationError(`Invalid base filter; every base filter must have at least one field ; got string: [${r}]`);if(t instanceof D&&(a=n,!(O.COLLECTION_FIELDS_SET.has(a.rawString)||n instanceof O.RangeLiteral||n instanceof O.SetLiteral)))throw new i.A.ValidationError(`Invalid base filter; 'in' operators can only be used with Ranges, Sets, or Fields that correspond to sets like 'p1.picks' ; got string: [${r}]`);var a;return!0}class ne extends ${fnType=U;fnName=B.BASE_FILTER;fmtString;fn;constructor(e,t){super();const n=i.A.tokenizeWithNestedEnclosures(e," ",0,!0);if(3!==n.length)throw new i.A.SyntaxException(`Invalid base filter; filters must have 3 tokens and be of the form: ['X', operator, 'Y']; got tokens: [${n}] from str: ${e}`);let[r,a,s]=n;const o=F(a),l=O.parseBaseElement(r,t),c=O.parseBaseElement(s,t);if(l.asString(),c.asString(),te(l,o,c),l instanceof O.Field&&!(c instanceof O.Field))this.fn=e=>o.call(l.extractData(e),c.getData());else{if(l instanceof O.Field||!(c instanceof O.Field))throw new i.A.ValidationError("Invalid base filter; filters must contain a Field and a Literal; got: "+e);this.fn=e=>o.call(l.getData(),c.extractData(e))}this.fmtString=`${l.asString()} ${a} ${c.asString()}`}call(e){return this.fn(e)}asString(e=""){return`${e}${this.fmtString}`}}const re={[B.BASE_FILTER]:ne,[B.AND]:K,[B.OR]:q,[B.NOT]:W,[B.XOR]:Y,[B.LAST_N]:ee,[B.EQUIPMENT]:Q,[B.ARTIFACT]:z,[B.CR]:X},ae={AND:K,OR:q,NOT:W,XOR:Y,LAST_N:ee,EQUIPMENT:Q,ARTIFACT:z,CR:X,BASE_FILTER:ne}},54:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(207);class a extends Error{constructor(e){super(e),this.name="Filter Syntax Exception"}}class s extends Error{constructor(e){super(e),this.name="Filter Type Exception"}}class i extends Error{constructor(e){super(e),this.name="Filter Validation Error"}}const o={"(":")","{":"}",'"':'"',"'":"'"},l={"'":'"','"':"'"},c=Object.fromEntries(Object.entries(o).filter(([e,t])=>e!==t).map(([e,t])=>[t,e]));function u(e){const t={};for(const n of e)t[n]=(t[n]||0)+1;return t}function d(e){return new Date(`${e}T00:00:00Z`)}const f={SyntaxException:a,TypeException:s,ValidationError:i,getCharCounts:u,tokenizeWithNestedEnclosures:function(e,t=" ",n=0,r=!0){const s=[];let i="",d=[];for(let f=0;f<e.length;f++){const h=e[f];if(t.includes(h)&&d.length===n)i&&(s.push(r?i.trim():i),i="");else if(c[h]){const t=c[h];if(d.length>n&&(i+=h),d[d.length-1]!==t){const t=u(e);throw(t["'"]||0)%2!=0||(t['"']||0)%2!=0?new a(`Error tokenizing: Unbalanced closing character at position ${f}; got string: '${e}' ; if a str type has quote characters in it, wrap it in the opposite quote character.`):new a(`Error tokenizing: Unbalanced closing character at position ${f}; got string: '${e}'`)}d.pop()}else d.length>=n&&(i+=h),!o[h]||l[h]&&d[d.length-1]===l[h]||(d[d.length-1]===o[h]&&h===o[h]?d.pop():d.push(h))}if(d.length>0)throw new Error(`Unbalanced enclosures in input string; unresolved characters from enclosure stack: [ ${d.join(", ")} ]`);return i&&s.push(r?i.trim():i),s},parseDate:function(e){if(!r.L.DATE_LITERAL_RE.test(e))throw new a(`Invalid date; must be in the format: YYYY-MM-DD ( regex: ${r.L.DATE_LITERAL_RE.source} ); got: '${e}'`);const t=d(e);if(isNaN(t.getTime()))throw new a(`Invalid date; could not be parsed as a valid date; got: '${e}'`);const n=t.toISOString().split("T")[0],[s,i,o]=n.split("-").map(Number);if(t.getUTCFullYear()!==s||t.getUTCMonth()+1!==i||t.getUTCDate()!==o)throw new a(`Invalid date; parsed date: ${t.toISOString()} does not match passed in string: ${e}`);return t.toISOString(),t.constructor.name,t},tryConvert:function(e,t,n,r=null){null===r&&(r=`Could not convert ${n} to ${t}`);try{return e(n)}catch(e){throw new s(`${r}: ${e.message}`)}},trimSurroundingQuotes:function(e){return e.replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")},castStringToUTCDate:d}},82:(e,t,n)=>{n.d(t,{j:()=>l});var r=n(836),a=n(412),s=n(771);function i(e,t,n){const r={user:e,filterStr:n,battles:{headers:[],rows:[]}};var s;return r.battles=(s=Object.values(t),{headers:a.se,rows:s.map(e=>a.se.map(t=>JSON.stringify(e[t])))}),r}function o(e){if(!e||"object"!=typeof e)throw new Error("Invalid upload: data is null, undefined, or not an object");if(!("user"in e))throw new Error("Invalid upload: missing 'user' field");if((0,s.l)(e.user),!("battles"in e))throw new Error("Invalid upload: missing 'battles' field");return function(e){if(!e||"object"!=typeof e)return!1;if(!("headers"in e)||!Array.isArray(e.headers))throw new Error("Invalid upload: missing headers field");if(e.headers.length!==a.se.length)throw new Error(`Invalid upload: expected ${a.se.length} headers, got ${e.headers.length}`);for(let t=0;t<a.se.length;t++)if(a.se[t]!==e.headers[t])throw new Error(`Invalid upload: headers do not match at index ${t}; expected ${a.se[t]}, got ${e.headers[t]}`);if(!("rows"in e)||!Array.isArray(e.rows))throw new Error("Invalid upload: missing rows field or rows is not an array");if(0===e.rows.length)throw new Error("Invalid upload: uploaded data has no battles");for(let t=0;t<e.rows.length;t++){const n=e.rows[t];if(n.length!==a.se.length)throw new Error(`Invalid upload: expected ${a.se.length} columns per row, got ${n.length} at index ${t}`)}}(e.battles),!0}const l={triggerDownload:async function(){const e=await r.n.UserManager.getUser();if(!e)throw new Error("User not found; cannot export data without an active user");const t=await r.n.ClientCache.getStats(),n=await r.n.ClientCache.getFilterStr()||void 0,a=t.areFiltersApplied?" Filtered":"";let s=t.areFiltersApplied?Object.values(t.filteredBattlesObj):t.battles;s=s||[];const o=await i(e,s,n),l=(new Date).toISOString().split("T")[0]||"";!function(e,t){const n=JSON.stringify(t),r=new Blob([n],{type:"application/json"}),a=URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=e.endsWith(".json")?e:`${e}.json`,s.click(),URL.revokeObjectURL(a)}(`${e.name} (${e.id})${a} ${l}`,o)},parseJSON:async function(e){!function(e,t=".json",n=60){if(!e.name.endsWith(".json"))throw new Error("File must be .json");const r=1024*n*1024;if(e.size>r)throw new Error(`File must be smaller than ${n}mb, got ${e.size/1048576}mb File.`)}(e);const t=await e.text(),n=JSON.parse(t);return o(n),n},restructureParsedUploadBattles:function(e){const t=[];for(const n of e.rows){const e={};a.se.forEach((t,r)=>{e[t]=n[r]}),t.push(e)}return function(e){const t=new Set(e.map(e=>e[a.Lx.P1_ID])),n=new Set(e.map(e=>e[a.Lx.P1_SERVER]));if(1!==t.size)throw new Error(`Invalid upload: Multiple P1 IDs found in upload: {${Array.from(t).join(", ")}}`);if(1!==n.size)throw new Error(`Invalid upload: Multiple P1 Servers found in upload: {${Array.from(n).join(", ")}}`);const r=n.values().next().value?.replace(/"|'/g,"");if(!r||!Object.values(a.DB).includes(r))throw new Error(`Invalid upload: Invalid P1 Server found in upload: '${r}'`)}(t),t}}},84:(e,t,n)=>{n.d(t,{S:()=>f});var r=n(834),a=n(528),s=n(207),i=n(469),o=n(42),l=n(971),c=n(54),u=n(545);function d(e){return function(e,t,n){for(let r of e)if(!t.has(r))throw new c.A.SyntaxException(`Invalid character within <${n}> ; ' ${r} ' is not allowed; got string: '${e}'`)}(e=e.replace(/[\n\t\r]/g," ").replace(/\s+/g," "),l.yL,"Main Filter String"),e=e.toLowerCase()}class f{_filters;rawString;preParsedString;references;constructor(){this._filters=[],this.rawString="",this.preParsedString="",this.references={HeroDicts:null,ARTIFACT_LOWERCASE_STRINGS_MAP:{},SEASON_DETAILS:[]}}async addReferences(e=null){if(null===(e=e||await a.A.getHeroDicts()))throw new Error("Hero Manager could not be retrieved to parse filters.");const t=await i.A.getSeasonDetails();if(null===t)throw new Error("Season Details could not be retrieved to parse filters.");const n=await r.A.getArtifactLowercaseNameMap();this.references={HeroDicts:e,ARTIFACT_LOWERCASE_STRINGS_MAP:n,SEASON_DETAILS:t}}getFilters(){return function(e){const t=[],n=[];for(const r of e)r instanceof o.y4?t.push(r):n.push(r);return[...t,...n]}(this._filters)}asString(){const e=l.RG;return`[\n${this._filters.map(t=>t.asString(e)).join(";\n")};\n]`}static async getFiltersFromCache(e=null){const t=await u.A.get(u.A.Keys.FILTER_STR);if(null===t)return[];return(await this.fromFilterStr(t,e)).getFilters()}static async fromFilterStr(e,t=null){const n=new f;return n.rawString=e,await n.addReferences(t),n.preParsedString=d(e),n._filters=n.parse(n.preParsedString),n}parseList(e){return e.reduce((e,t)=>(e.push(...this.parse(t)),e),[])}parse(e){if(""===(e=e.trim()))return[];if(e.includes(";")){const t=e.split(";");return this.parseList(t)}const t=e.split("(")[0].replace(/p[1-2]\./i,""),n=c.A.tokenizeWithNestedEnclosures(e,",",1,!0);switch(t){case o.eR.AND:case o.eR.OR:case o.eR.NOT:case o.eR.XOR:const r=function(e,t){for(const n of e)if(n instanceof o.y4)throw new c.A.SyntaxException(`Global filters not allowed in clause functions; got: ${n.asString()} from string: "${t}"`);return e.filter(e=>e instanceof o.Qo)}(this.parseList(n),e);return[new o.CO[t](...r)];case o.eR.LAST_N:return[new o.c2.LAST_N(e)];case o.eR.EQUIPMENT:case o.eR.ARTIFACT:case o.eR.CR:return[new o.CO[t](e,this.references)];default:if(s.L.FUNCTION_CALL_RE.test(e))throw new c.A.SyntaxException(`Filter String is not a valid function call but a parenthese block was detected; got: ${e}`);return[new o.c2.BASE_FILTER(e,this.references)]}}}},92:(e,t,n)=>{function r(e){return e.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())}function a(e){return e.reduce((e,t)=>(e[t]=(e[t]||0)+1,e),{})}n.d(t,{J:()=>a,S:()=>r})},136:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(545);const a={ACTIONS:{CLEAR_USER:"CLEAR_USER",SHOW_NO_USER_MSG:"SHOW_NO_USER_MSG",SHOW_DATA_ALREADY_CLEARED_MSG:"SHOW_DATA_ALREADY_CLEARED_MSG",QUERY_USER:"QUERY_USER",REFRESH_REFERENCES:"REFRESH_REFERENCES"},getState:async function(){return await r.A.get(r.A.Keys.INTER_PAGE_MANAGER)??{actions:[],messages:[]}},setState:async function(e){await r.A.cache(r.A.Keys.INTER_PAGE_MANAGER,e)},pushActions:async function(e){let t=await this.getState();t.actions.push(...e),await this.setState(t)},pushAction:async function(e){let t=await this.getState();t.actions.push(e),await this.setState(t)},makeAction:function(e,t){return{action:e,message:t}},flushState:async function(){const e=await this.getState();return await r.A.delete(r.A.Keys.INTER_PAGE_MANAGER),e}}},149:(e,t,n)=>{n.d(t,{W:()=>a});var r=n(836);const a={changeLang:async function(e){await r.n.ClientCache.setLang(e),await r.n.HeroManager.fetchAndCacheHeroManager(e),window.location.reload()},getLang:async function(){return await r.n.ClientCache.getLang()}}},172:(e,t,n)=>{n.d(t,{GF:()=>h,ev:()=>d});var r=n(494);n(623);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw s}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}var u={RED:"text-danger",GREEN:"text-safe",E_BLUE:"text-e-blue"},d=l(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text=t,this.docElement=n,this.classList=r});function f(e){if(!e instanceof d)throw new Error("Only instances of TextPacket can be passed to this function")}var h={queue:[],autoClearElements:[],TextPacket:d,STYLES:u,clearStyles:function(e){for(var t=0,n=Object.values(u);t<n.length;t++){var r=n[t];e.classList.remove(r)}},write:function(e){f(e),e.docElement.textContent=e.text,this.clearStyles(e.docElement),e.classList.forEach(function(t){e.docElement.classList.add(t)})},writeStr:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.write(new d(e,t,n))},writeStrFromID:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=r.K.unwrapHtmlElt(t);this.writeStr(e,a,n)},push:function(e){f(e),this.queue.push(e)},pushFromObj:function(e){var t=e.text,n=e.docElement,r=e.classList;this.push(new d(t,n,r))},bindAutoClear:function(e){var t,n=s(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.autoClearElements.push(r)}}catch(e){n.e(e)}finally{n.f()}},processQueue:function(){var e=this;this.queue.forEach(function(t){e.write(t)}),this.queue=[]},clearMessages:function(){var e,t=s(this.autoClearElements);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.textContent="",this.clearStyles(n)}}catch(e){t.e(e)}finally{t.f()}}}},207:(e,t,n)=>{n.d(t,{L:()=>F});var r=n(833);function a(e,t="i"){return new RegExp(`^(?:${e.source})(?=[,)\\s;]|$)`,t)}function s(e,t="i"){return new RegExp(`^(?:${e.source})$`,t)}function i(e,t="i"){if(e.length<1)throw new Error("orRegex must have at least one pattern");let n=`(?:${e[0].source})`;for(let t=1;t<e.length;t++)n+=`|(?:${e[t].source})`;return new RegExp(n,t)}const o=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),l=Object.keys(r.j),c=new RegExp(`^(?:${l.map(o).join("|")})`,"i"),u=new RegExp(`(?:${["and","or","xor","not"].map(o).join("|")})(?=\\()`,"i"),d=new RegExp(`(?:${["last-n"].map(o).join("|")})(?=\\()`,"i"),f=new RegExp(`(?:${["p1.equipment","p2.equipment","p1.artifact","p2.artifact","p1.cr","p2.cr"].map(o).join("|")})(?=\\()`,"i"),h=i([u,d,f]),p=/.*/i,E=/\d{4}-\d{2}-\d{2}/,_=/\{\s*\}/,A=/-?\d+/,S=/season-[1-9]+[0-9]*f?|current-season|last-season/i,T=/pvp_rta_ss[1-9]+[0-9]*f?/i,g=new RegExp(`^${E.source}$`,"i"),m=new RegExp(`(?:${S.source})`,"i"),w=p.source,R=A.source,N=E.source,I=c.source,y=m.source,L=/"[^"]*"|'[^']*'/i,O=s(L),b=new RegExp(`(?:${L.source}|${w}|${N})`,"i"),C=new RegExp(`(?:${I}|${y})`,"i"),P=b.source,v=new RegExp(`\\{\\s*(?:${P}\\s*)(?:,\\s*${P}\\s*)*,?\\s*\\}|${_.source}`,"i"),D=new RegExp(`${R}\\.\\.\\.=?${R}|${N}\\.\\.\\.=?${N}`),x=new RegExp(`^${D.source}$`);let F={STRING_RE:p,DATE_RE:E,INT_RE:A,EMPTY_SET_RE:_,SET_ELEMENT_RE:b,SET_RE:v,SET_LITERAL_RE:s(v),STRING_LITERAL_RE:O,DATE_LITERAL_RE:g,INT_LITERAL_RE:/^-?\d+$/,BOOL_LITERAL_RE:/^(true|false)$/i,RANGE_RE:D,RANGE_LITERAL_RE:x,SEASON_RE:S,SEASON_LITERAL_RE:s(S),SEASON_CODE_RE:T,SEASON_CODE_LITERAL_RE:s(T),DATA_WORD_RE:m,DATA_WORD_LITERAL_RE:s(m),FIELD_WORD_RE:c,FIELD_WORD_LITERAL_RE:s(c),DATAFIELD_RE:C,GLOBAL_FILTER_RE:/last-n\(\d+\)/i,ANCHORED_STR_LITERAL_RE:s(O),CLAUSE_FUNCTIONS_RE:u,DIRECT_FUNCTIONS_RE:f,GLOBAL_FUNCTIONS_RE:d,FUNCTIONS_RE:h,FUNCTION_CALL_RE:/\(.*\)/i,padRegex:a,anchorExp:s,tokenMatch:function(e){return function(e){return e.match(h)?"keyword":e.match(/\s+(?:!=|<|>|=|>=|<=|in|!in)(?=\s+)/i)?"operator":e.match(new RegExp(`[a-z0-9."'}=)-]${C.source}(?=[,)\\s;]|$)`,"i"))?null:e.match(a(c))?"field":e.match(a(m))?"declared-data":e.match(a(L))?"string":e.match(a(v))?"set":e.match(a(D))?"range":e.match(/[^(,\s;.=0-9\-]+\d+/i)?null:e.match(a(A))||e.match(a(E))||e.match(/(?:^|\s)(?:true|false)(?=[,)\s;]|$)/i)?"declared-data":e.match(/[\(\)\{\}\;\,]/)?"bracket":(e.next(),null)}(e)},orRegex:i,escapeRegex:o}},274:(e,t,n)=>{n.a(e,async(e,t)=>{try{var r=n(207),a=n(940),s=n(874),i=n(354),o=n(541),l=n(623),c=n(494),u=n(149),d=n(980);const f=[];let h=null;const p=l.A.INFO_PAGE.IDS;function E(e,t,n){return`\n    <div class="col-sm-12 d-none", id="${n}-card">\n      <div class="card">\n        <div class="card-header">\n          <h5>${e}</h5>\n          <p class="text-sm">${t}</p>\n        </div>\n        <div class="card-body pc-component text-sm" id="${n}-wrapper">\n          <textarea name="code" class="codemirror-hidden" id="${n}"></textarea>\n        </div>\n      </div>\n    </div>\n  `}function _(e){const t=i.b0.WELCOME_BLOCK;return`\n\t\t<div class="col-md-9 mb-3 d-none", id="${l.A.INFO_PAGE.IDS.OVERVIEW_CARD}">\n\t\t\t<div class="card">\n\t\t\t\t<div class="card-header text-center">\n\t\t\t\t\t<h3>${(0,d.q)(e,t.TITLE)}</h3>\n\t\t\t\t</div>\n\t\t\t\t<div class="card-body text-start py-3 px-5">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>${(0,d.q)(e,t.DESCRIPTION_PART1)}</li>\n\t\t\t\t\t\t<li>${(0,d.q)(e,t.DESCRIPTION_PART2)}</li>\n\t\t\t\t\t\t<li>${(0,d.q)(e,t.DESCRIPTION_PART3)}</li>\n\t\t\t\t\t\t<li>${(0,d.q)(e,t.DESCRIPTION_PART4)}</li>\n\t\t\t\t\t\t<li>${(0,d.q)(e,t.DESCRIPTION_PART5)}</li>\n\t\t\t\t\t\t<li>${(0,d.q)(e,t.DESCRIPTION_PART6)}</li>\n\t\t\t\t\t\t<li>${(0,d.q)(e,t.DESCRIPTION_PART7)}</li>\n\t\t\t\t\t\t<li>${(0,d.q)(e,t.DESCRIPTION_PART8)}</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n  `}function A(e){let t="";const n=d.j[e],r=i.b0.FilterExamplesAndTest;var a,s;return t+=E(n(r.EX1_TITLE),n(r.EX1_DESCRIPTION),l.A.INFO_PAGE.IDS.EX_FILTER_1),t+=E(n(r.EX2_TITLE),n(r.EX2_DESCRIPTION),l.A.INFO_PAGE.IDS.EX_FILTER_2),t+=E(n(r.EX3_TITLE),n(r.EX3_DESCRIPTION),l.A.INFO_PAGE.IDS.EX_FILTER_3),t+=E(n(r.EX4_TITLE),n(r.EX4_DESCRIPTION),l.A.INFO_PAGE.IDS.EX_FILTER_4),t+=E(n(r.EX5_TITLE),n(r.EX5_DESCRIPTION),l.A.INFO_PAGE.IDS.EX_FILTER_5),t+=(a=n(r.TEST_TITLE),s=n(r.TEST_DESCRIPTION),`\n    <div class="col-sm-12 d-none" id="${p.TEST_SYNTAX_CARD}">\n      <div class="card">\n        <div class="card-header text-center kpi-header tight-fit">\n          <h3>${a}</h3>\n          <h6 class="small-text">${s}</h6>\n        </div>\n        <div class="card-body text-center kpi-body tight-fit">\n          <div class="row justify-content-center px-4">\n            <span class="d-block mb-1 rel-width-80 scrollable-60px" id="${p.TEST_FILTER_MESSAGE}">&nbsp;</span>\n              <textarea id="codeArea" name="code" class="codemirror-hidden"></textarea>\n              <div class="d-flex justify-content-center gap-3 mt-4">\n                <button type="button" id="${p.CHECK_SYNTAX_BTN}" name="check-syntax" value="check" class="btn shadow px-sm-1">Check\n                  Syntax</button>\n              </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `),t}function S(e,t){return{tag:"div",classes:["col-sm-12","d-none"],children:[{tag:"div",classes:["card"],children:e}],attributes:t?.attributes}}function T(e,t){return{tag:"p",textContent:e,classes:t}}function g(e,t=1,n){return{tag:"h"+t,textContent:e,classes:n}}function m(e,t=1,n){const r={tag:"div",classes:["card-header"],children:[{tag:"h"+t,textContent:e}]};return n&&r.children?.push(T(n)),r}function w({composeList:e,classes:t,option:n}){return{tag:"div",classes:["card-body","pc-component"].concat(t??[]),option:n,children:e}}function R({outertag:e,outerclasses:t,innertag:n,innerclasses:r,textList:a}){return{tag:e??"ul",classes:t??[],children:[{tag:n??"li",classes:r??[],textContent:a}]}}function N(e){return{tag:"table",style:"width: 100%;",classes:["table","filter-syntax-table"],children:[{tag:"tbody",children:e}]}}function I({leftText:e,rightText:t,leftClasses:n,rightClasses:r}){return{tag:"tr",children:[{tag:"td",style:"white-space: nowrap;",classes:n??[],textContent:e},{tag:"td",classes:["cm-def"],innerHtml:"&rarr;"},{tag:"td",classes:r??[],textContent:t}]}}function y({entries:e,leftClasses:t,rightClasses:n}){return e.map(([e,r])=>I({leftText:e,rightText:r,leftClasses:t,rightClasses:n}))}function L(e){const t=d.j[e],n=i.b0.FilterOverview;const r=S([m(t(n.generalOverviewTitle),3,t(n.generalOverviewDescription)),w({option:o.Kb.NEST}),g(t(n.filterUsageTitle),4),T(t(n.filterUsageDescription)),{tag:"hr"},g(t(n.objectTypesTitle),4),T(t(n.objectTypesDescription)),R({outertag:"ol",outerclasses:["text-sm"],textList:t(n.objectTypesList)}),{tag:"hr"},g(t(n.highLevelRulesTitle),4),R({outertag:"ol",outerclasses:["text-sm"],textList:t(n.highLevelRulesList)})],{attributes:{id:p.FILTER_OVERVIEW}}),a=i.b0.Fields;const s=S([m(t(a.title),5),w({classes:["text-sm"],option:o.Kb.NEST}),N(y({entries:[["date",t(a.date)],["season",t(a.season)],["is-win",t(a.isWin)],["is-first-pick",t(a.isFirstPick)],["is-first-turn",t(a.isFirstTurn)],["first-turn-hero",t(a.firstTurnHero)],["victory-points",t(a.victoryPoints)],["prebans",t(a.prebans)],["postbans",t(a.postbans)],["turns",t(a.turns)],["seconds",t(a.seconds)],["point-gain",t(a.pointGain)]],leftClasses:["cm-datafield"],rightClasses:["cm-default"]})),T(t(a.attributesTitle)),T(t(a.attributesDescription),["text-sm"]),N(y({entries:[["pick[n]",t(a.pickN)],["picks",t(a.picks)],["league",t(a.league)],["prebans",t(a.prebansAttribute)],["postban",t(a.postban)],["server",t(a.server)],["id",t(a.id)],["mvp",t(a.mvp)]],leftClasses:["cm-datafield"],rightClasses:["cm-default"]}))],{attributes:{id:p.FIELD_SYNTAX}}),l=i.b0.DeclaredData,c=S([m(t(l.title),5),w({classes:["text-sm"],option:o.Kb.NEST}),N(y({entries:[["Integer",t(l.Integer)],["Date",t(l.Date)],["String",t(l.String)],["Boolean",t(l.Boolean)],["Set",t(l.Set)],["Range",t(l.Range)],["Season",t(l.Season)]],leftClasses:["cm-declared-data"],rightClasses:["cm-default"]}))],{attributes:{id:p.DATA_SYNTAX}}),u=i.b0.Operators,f=S([m(t(u.title),5),w({classes:["text-sm"],option:o.Kb.NEST}),N(y({entries:[["=",t(u.equal)],["!=",t(u.notEqual)],[">",t(u.gt)],[">=",t(u.gte)],["<",t(u.lt)],["<=",t(u.lte)],["in",t(u.in)],["!in",t(u.notIn)]],leftClasses:["cm-operator"],rightClasses:["cm-default"]}))],{attributes:{id:p.OPERATOR_SYNTAX}}),h=i.b0.Functions,E=S([m(t(h.title),5),w({classes:["text-sm"],option:o.Kb.NEST}),T(t(h.clauseFunctionsTitle)),T(t(h.clauseFunctionsDescription),["text-sm"]),N(y({entries:[["AND",t(h.AND)],["OR",t(h.OR)],["XOR",t(h.XOR)],["NOT",t(h.NOT)]],leftClasses:["cm-keyword"],rightClasses:["cm-default"]})),T(t(h.directFunctionsTitle)),T(t(h.directFunctionsDescription),["text-sm"]),N(y({entries:[["[p1/p2].equipment(hero, str/set)",t(h.EQUIPMENT)],["[p1/p2].artifact(hero, str/set)",t(h.ARTIFACT)],["[p1/p2].CR(hero, operator, integer)",t(h.CR)]],leftClasses:["cm-keyword"],rightClasses:["cm-default"]})),T(t(h.globalFiltersTitle)),T(t(h.globalFiltersDescription),["text-sm"]),N(y({entries:[["last-N",t(h.lastN)]],leftClasses:["cm-keyword"],rightClasses:["cm-default"]}))],{attributes:{id:p.FUNCTION_SYNTAX}}),_=i.b0.Syntax;return[r,s,c,f,E,S([m(t(_.title),5),w({classes:["text-sm"],option:o.Kb.NEST}),N(y({entries:[[";",t(_.semiColon)],[",",t(_.comma)],["(",t(_.parentheses)],["{",t(_.braces)]],leftClasses:["cm-bracket"],rightClasses:["cm-default"]}))],{attributes:{id:p.STRUCTURAL_SYNTAX}})]}function O(e,t){const n=c.K.unwrapHtmlElt(e);n.value=t.replace(/^\n/,"");const r=CodeMirror.fromTextArea(n,{mode:"filterSyntax",lineNumbers:!0,theme:"default",readOnly:!0});f.push(r),n.classList.remove("codemirror-hidden")}function b(){CodeMirror.defineMode("filterSyntax",function(){return{token:function(e,t){return r.L.tokenMatch(e)}}});O("exFilter1",'\nseason = current-season;\nis-first-pick = true;\np1.pick1 in {lone wolf peira, new moon luna};\nOR("harsetti" in p1.prebans, "harsetti" in p2.prebans);');O("exFilter2",'\nlast-n(500);\ndate in 2025-04-01...2025-07-01;\nis-first-pick = false;\nOR(\n\tAND(\n\t\tp2.league in {warlord, emperor, legend},\n    \tp2.pick3 = "zio"\n    ),\n    victory-points >= 3000\n)');O("exFilter3",'\n"Rinak" in prebans;\n"Boss Arunka" in prebans;\n"Harsetti" in p1.picks;\nNOT("Harsetti" = p2.postban);\nvictory-points in 2500...=3000;');O("exFilter4","\nseason = season-16f;\nis-win = true;");O("exFilter5",'\np1.equipment("belian", {immunity, counter});\np1.artifact("belian", {3f, elbris ritual sword});\np2.cr("New Moon Luna" > 100);\np2.server in {global, asia, Japan};');const e=c.K.unwrapHtmlElt("codeArea"),t=CodeMirror.fromTextArea(e,{mode:"filterSyntax",lineNumbers:!0,theme:"default"});f.push(t);l.A.INFO_PAGE.getFromId(l.A.INFO_PAGE.IDS.CHECK_SYNTAX_BTN).addEventListener("click",async function(e){e.preventDefault(),c.K.unwrapHtmlElt("codeArea").value=t.getValue();const n=t.getValue();await a.A.validateFilterSyntax(n)}),t.on("change",()=>{t.save()}),e.classList.remove("codemirror-hidden")}async function C(){const e=l.A.INFO_PAGE.getFromId(l.A.INFO_PAGE.IDS.FILTER_SYNTAX_CONTAINER),t=await u.W.getLang(),n=L(t);new o.GQ(e).compose(n);const r=l.A.INFO_PAGE.getFromId(l.A.INFO_PAGE.IDS.FILTER_EXAMPLES_AND_TEST_CONTAINER),a=A(t);r.innerHTML=a;const s=l.A.INFO_PAGE.getFromId(l.A.INFO_PAGE.IDS.OVERVIEW_CONTAINER),i=_(t);s.innerHTML=i}function P(){const e=l.A.INFO_PAGE.getFromId(l.A.INFO_PAGE.IDS.INFORMATION_CONTENT_LINKS_CONTAINER);e.addEventListener("click",function(t){const n=t.target;if("link-button"===n.name){const t=n.id.replace("link","card"),r=document.getElementById(t);h=r,r?.classList.remove("d-none");for(const e of f)e.refresh();l.A.INFO_PAGE.getFromId(l.A.INFO_PAGE.IDS.RETURN_CONTAINER).classList.remove("d-none"),e.classList.add("d-none")}})}function v(){const e=l.A.INFO_PAGE.getFromId(l.A.INFO_PAGE.IDS.RETURN_BTN),t=l.A.INFO_PAGE.getFromId(l.A.INFO_PAGE.IDS.INFORMATION_CONTENT_LINKS_CONTAINER);e.addEventListener("click",function(e){t.classList.remove("d-none"),h?.classList.add("d-none"),l.A.INFO_PAGE.getFromId(l.A.INFO_PAGE.IDS.RETURN_CONTAINER).classList.add("d-none")})}async function D(){await C(),await s.Su.initialize(),P(),v(),a.A.setVisibility(l.A.BODY_FOOTER_CONTAINER,!0),b()}await D(),t()}catch(x){t(x)}},1)},275:(e,t,n)=>{function r(){var e,t,n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,s,i){var o=r&&r.prototype instanceof c?r:c,u=Object.create(o.prototype);return a(u,"_invoke",function(n,r,a){var s,i,o,c=0,u=a||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return s=t,i=0,o=e,f.n=n,l}};function h(n,r){for(i=n,o=r,t=0;!d&&c&&!a&&t<u.length;t++){var a,s=u[t],h=f.p,p=s[2];n>3?(a=p===r)&&(o=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=h&&((a=n<2&&h<s[1])?(i=0,f.v=r,f.n=s[1]):h<p&&(a=n<3||s[0]>r||r>p)&&(s[4]=n,s[5]=r,f.n=p,i=0))}if(a||n>1)return l;throw d=!0,r}return function(a,u,p){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,p),i=u,o=p;(t=i<2?e:o)||!d;){s||(i?i<3?(i>1&&(f.n=-1),h(i,o)):f.n=o:f.v=o);try{if(c=2,s){if(i||(a="next"),t=s[a]){if(!(t=t.call(s,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,i<2&&(i=0)}else 1===i&&(t=s.return)&&t.call(s),i<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),i=1);s=e}else if((t=(d=f.n<0)?o:n.call(r,f))!==l)break}catch(t){s=e,i=1,o=t}finally{c=1}}return{value:t,done:d}}}(n,s,i),!0),u}var l={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][s]?t(t([][s]())):(a(t={},s,function(){return this}),t),h=d.prototype=c.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,i,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=d,a(h,"constructor",d),a(d,"constructor",u),u.displayName="GeneratorFunction",a(d,i,"GeneratorFunction"),a(h),a(h,i,"Generator"),a(h,s,function(){return this}),a(h,"toString",function(){return"[object Generator]"}),(r=function(){return{w:o,m:p}})()}function a(e,t,n,r){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}a=function(e,t,n,r){if(t)s?s(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){a(e,t,function(e){return this._invoke(t,n,e)})};i("next",0),i("throw",1),i("return",2)}},a(e,t,n,r)}function s(e,t,n,r,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){s(i,r,a,o,l,"next",e)}function l(e){s(i,r,a,o,l,"throw",e)}o(void 0)})}}n.d(t,{A:()=>h});var o,l,c,u,d,f;const h={test:function(e){e.rank_plot},fetchFromPython:(f=i(r().m(function e(t){var n,a;return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fetch(t);case 1:if((n=e.v).ok){e.n=3;break}return e.n=2,fetch(t);case 2:n=e.v;case 3:return e.n=4,n.json();case 4:return a=e.v,e.a(2,a||null)}},e)})),function(e){return f.apply(this,arguments)}),fetchHeroData:(d=i(r().m(function e(){return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.fetchFromPython("/api/get_hero_data");case 1:return e.a(2,e.v)}},e,this)})),function(){return d.apply(this,arguments)}),rsFetchBattleData:(u=i(r().m(function e(t){return r().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}throw new Error("Must pass user to fetch battles data");case 1:return e.n=2,fetch("/api/rs_get_battle_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:t})});case 2:return e.a(2,e.v)}},e)})),function(e){return u.apply(this,arguments)}),fetchSeasonDetails:(c=i(r().m(function e(){var t,n,a;return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fetch("/api/get_season_details");case 1:return t=e.v,e.n=2,t.json();case 2:if(!(n=e.v).success){e.n=3;break}return a=JSON.parse(n.seasonDetails),e.a(2,{seasonDetails:a,error:!1});case 3:return e.a(2,{seasonDetails:null,error:n.error});case 4:return e.a(2)}},e)})),function(){return c.apply(this,arguments)}),fetchArtifactJson:(l=i(r().m(function e(){var t,n,a;return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fetch("/api/get_artifact_json");case 1:return t=e.v,e.n=2,t.json();case 2:if(!(n=e.v).success){e.n=3;break}return a=JSON.parse(n.artifactJson),e.a(2,a);case 3:return e.a(2,null);case 4:return e.a(2)}},e)})),function(){return l.apply(this,arguments)}),fetchUser:(o=i(r().m(function e(t){var n,a,s;return r().w(function(e){for(;;)switch(e.n){case 0:if(t.name&&t.world_code||t.id){e.n=1;break}throw new Error("Must pass a user object with either user.name and user.world_code or user.id to fetch user");case 1:return e.n=2,fetch("/api/get_user_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userData:t})});case 2:return n=e.v,e.n=3,n.json();case 3:if(a=e.v,n.ok){e.n=4;break}throw new Error("Flask server error: ".concat(a.error));case 4:if(a.foundUser){e.n=6;break}if(t.world_code){e.n=5;break}return e.a(2,{user:null,ok:!0});case 5:return e.a(2,{user:null,ok:!0});case 6:return s=a.user,"Found user: ".concat(JSON.stringify(s)),e.a(2,{user:s,ok:!0})}},e)})),function(e){return o.apply(this,arguments)})}},354:(e,t,n)=>{n.d(t,{b0:()=>h});var r=n(412);n(623).A.INFO_PAGE.IDS;const a=r.Yj.CODES.EN,s={generalOverviewTitle:{[a]:"General Overview"},generalOverviewDescription:{[a]:"This page details the rules for writing filters within the Hero Stats page. Examples will be shown below along with space to practice writing and validating filters."},filterUsageTitle:{[a]:"Filter Usage"},filterUsageDescription:{[a]:"Filters are primarily used to adjust which battles the user wants to \n    include when calculating stats like win rate and pick rate. They can also be used to \n    automatically adjust the chart to the filtered subset if desired. Almost all columns \n    listed in the full table of battles at the bottom of the stats page can filtered on using \n    the custom syntax. See other sections of the information page to understand the exact syntax and rules for writing filters."},objectTypesTitle:{[a]:"Syntax Types"},objectTypesDescription:{[a]:"There are 5 main types of syntax used in filters:"},objectTypesList:{[a]:["Fields: keywords corresponding to data from each of the battles, such as if the battle is a win, the victory points the player ended the battle at, the first hero the player picked, etc.","Declared Data: data values the user defines to filter the data on. They include integers, dates, strings, sets, booleans, and ranges. There are also some keywords like 'current-season' that allow the user to conveniently utilize declared data based on predefined logic.","Operators: the operations that allow the comparison of Fields and Declared Data. They are the core of filters (includes operations like >, <, =, set membership, etc.).","Functions: higher level operations that may allow the combination of filters in a logical manner or correspond to complex predefined filters.","Pure Syntax Elements: characters like brackets, quotes, commas, and semicolons that define how the filters are broken up and parsed."]},highLevelRulesTitle:{[a]:"High Level Rules"},highLevelRulesList:{[a]:["Filter syntax is entirely case insensitive. It will be converted to lowercase in the backend.","All filters must be separated by a semicolon ( ; ) if multiple are applied.","The terminating semicolon ( ; ) for the last filter (including if only one filter) is optional.","Every filter must either be a function call or a base filter of the form: X operator Y","Functions and sets have their constituent arguments separated by commas ( , ) not semicolons ( ; )","Clause functions like And(...), OR(...), etc. can take nested clause functions as arguments but must ultimately terminate as base filters.","Certain functions, like last-N(), are global filters that must take into account all battles when filtering (last-N captures only the N most recent battles). Since these filters are affected by other filters, to regulate the logic, all global filters will be hoisted to the top and executed in the order they were written.","Apart from global filter hoisting, all filters will execute in the order they are written.","Some filters or sets of filters are valid but will never return true. For instance, comparing different data types or using two filters which together specify a hero must be picked by both the player and the opponent. These filters will pass validation, and the resulting stats will be empty.","Some operations require specific data types; if this is the case, an error will be thrown specifying the necessary data type."]}},i={title:{[a]:"Fields"},attributesTitle:{[a]:"Attributes"},attributesDescription:{[a]:"Attributes are types of fields that are accessed by using the syntax\n          p1.'attribute here' or p2.'attribute here' ; for example, 'p1.pick1' is used to access the\n          first picked hero by player 1 in the battle."},date:{[a]:"the date the battle occurred"},season:{[a]:"the season the battle occurred (resolves to the internal season code, not the name or number)"},isWin:{[a]:"boolean indicator flagging if the player won"},isFirstPick:{[a]:"boolean indicator flagging if the player got first pick"},isFirstTurn:{[a]:"boolean indicator flagging if the player got the first turn"},firstTurnHero:{[a]:"string of the hero that got the first turn (regardless of player)"},victoryPoints:{[a]:"integer indicating the victory points the player ended the battle at"},prebans:{[a]:"set of all the pre-banned heroes"},postbans:{[a]:"set of the two postbanned heroes"},turns:{[a]:"the number of turns the battle lasted (0 for incomplete battles)"},seconds:{[a]:"the number of seconds the battle lasted"},pointGain:{[a]:"a signed integer indicating how many victory points the player gained"},pickN:{[a]:"accesses pick n for the corresponding player. Replace [n] with numbers 1 - 5 to access the corresponding pick."},picks:{[a]:"accesses a set of all 5 picks for the specified player"},league:{[a]:"a string value that gives the league the specified player ended the battle in (i.e. emperor, warlord, etc.)"},prebansAttribute:{[a]:"accesses the set of the 2 heroes pre-banned by the specified player"},postban:{[a]:"accesses the hero postbanned by the specified player"},server:{[a]:"the server of the specified player"},id:{[a]:"the numerical id of the specified player"},mvp:{[a]:"accesses the mvp hero for the specified player"}},o={title:{[a]:"Declared Data"},Integer:{[a]:"Any valid non-negative integer (declare like '2787' without the quotes)"},Date:{[a]:"Date value using YYYY-MM-DD format exclusively (declare like '2025-01-07' without the quotes). Date must be valid."},String:{[a]:"Text based data declared within either double or single quotes (example: \"lone wolf peira\"). The quotes are necessary when declared outside of a set. When the string contains a quote, you must use the opposite quote type to wrap the string. Season keywords like \"current-season\" will be converted to string types automatically. They will take the form of their season code (ie 'pvp_rta_ss[season number here]' like 'pvp_rta_ss17' or 'pvp_rta_ss17f'). Therefore, season codes are valid string literals."},Boolean:{[a]:"Corresponds to true or false values; declare using 'true' or 'false' without the quotes"},Set:{[a]:'Used to group multiple individual pieces of data together; \n    declare using the format { x, y, z, ... }. A trailing comma after the last element is optional. \n    Sets can only contain string, integer, and date literals. They can be of heterogeneous types. \n    Strings within sets do not need to be quoted unless they contain a quote. Since season keywords like "current-season" \n    will be converted to string types automatically, they can be used in sets.'},Range:{[a]:"Used to define a continuous range of either integers or dates.\n     Can be used in cases where a set can be used. \n     Declare using the syntax: 'X...Y' or 'X...=Y', where the '=' indicates if Y \n     should be included in the set. X and Y must either both be integers or \n     both be dates (example: 2025-05-01...2025-06-01 yields a set of all dates in May 2025)"},Season:{[a]:'Used to easily filter battles to particular seasons or preseasons.\n     Can be declared by writing "season-n" without quotes, where n is the number of the desired season.\n      Season numbers and dates can be seen in the season details table at the top of the stats page.\n       The keywords "current-season" and "last-season" can alternatively be used to access the respective season based on the current active season.\n        A season number appended with "f" will access the preseason immediately following the season if one exists.'}},l={title:{[a]:"Operators"},equal:{[a]:"Checks if left side is equal to right side."},notEqual:{[a]:"Checks if left side is not equal to right side."},gt:{[a]:"Checks if left side is greater than right side."},gte:{[a]:"Checks if left side is greater than or equal to right side."},lt:{[a]:"Checks if left side is less than right side."},lte:{[a]:"Checks if left side is less than or equal to right side."},in:{[a]:"Checks if the left side of the operator is contained within the right side. The right side of the operator must be a Range, Set, or Field that corresponds to a set (i.e. p1.picks, p2.prebans, etc.)."},notIn:{[a]:"Checks if the left side of the operator is not contained within the right side. The right side of the operator must be a Range, Set, or Field that corresponds to a set (i.e. p1.picks, p2.prebans, etc.)."}},c={title:{[a]:"Functions"},clauseFunctionsTitle:{[a]:"Clause Functions"},clauseFunctionsDescription:{[a]:"Clause functions generally take 1 or more filters as arguments and create logic gates to combine the\n    result. Clause functions can take other clause functions as arguments, but the syntax tree must eventually\n    terminate as base filters. Global Filter Functions cannot be used within Clause Functions."},AND:{[a]:"Creates an AND gate for the filter arguments, returning true if all arguments return true. An empty AND function will always return true. Call using the syntax 'AND( arg1, arg2, ...)'"},OR:{[a]:"Creates an OR gate for the filter arguments, returning true if any argument returns true. An empty OR function will always return false. Call using the syntax 'OR( arg1, arg2, ...)'"},XOR:{[a]:"Creates an XOR gate for the filter arguments, returning a boolean value based on a cascading XOR. XOR requires at least 2 arguments to pass validation. Call using the syntax 'XOR( arg1, arg2, ...)'"},NOT:{[a]:"The NOT function takes exactly one argument which must be a filter (not an individual Field or Data Declaration) and inverts the boolean result. Call using the syntax 'NOT(arg)'."},directFunctionsTitle:{[a]:"Direct Functions"},directFunctionsDescription:{[a]:"Direct functions are compound filters that perform a specific operation which would be otherwise\n    impossible to express using the standard filter syntax. They include functions for filtering\n    based on equipment, artifacts, and CR."},EQUIPMENT:{[a]:"Creates a filter that checks if the specified hero has the specified equipment. Call using the syntax '[p1/p2].equipment(hero, equip str or set)' where [p1/p2] is replaced with either 'p1' or 'p2' to specify the player to check. Hero must be a string literal of any valid hero name, and the second argument must either be a string literal of a valid equipment set name or a set of equipment sets. When a set is passed, the filter will return true if the hero has all of the sets equipped (it will always be false if more than 2 unique sets are passed). You can pass a set like {torrent, torrent, torrent} to filter for 2 piece sets equipped multiple times. As long as the passed equipment is equipped by the specified hero, the function will return true even if the hero has an additional set equipped. Also note that a post-banned hero will not have any equipment. Example function call: p1.equipment(\"Arbiter Vildred\", {Torrent, Torrent, Immunity})"},ARTIFACT:{[a]:'Creates a filter that checks if the specified hero has the specified artifact equipped. It is called symmetrically to the equipment function. The only difference is that if a set of artifacts is passed, unlike the equipment filter, the artifact filter will return true if the hero has any of the artifacts equipped, whereas the equipment filter requires all of the equipment sets to be equipped. Also note that a post-banned hero will not have any artifact. Example function call: p1.artifact("Arbiter Vildred", "Alexa\'s Basket")'},CR:{[a]:"Creates a filter that compares the starting CR of the specified hero to the integer passed using the specified operator. Only comparison operators can be used (includes > , >=, <, <=, =, !=). Call using simplified syntax without commas like 'p1.cr(\"Zio\" = 100)' or comma separated syntax like 'p2.cr(\"Amid\", > , 95)'. Use either 'p1.' or 'p2.' to specify the player to check. This filter will return false if the hero specified was post banned. Note that this function implicitly includes the filter \"hero in [p1 or p2].picks\", therefore, negating this filter with a NOT clause will not simply return games where the hero had less than the specific CR; it will also include games where the specified player did not pick the hero. Therefore, to negate the function, use the complimentary operator instead."},globalFiltersTitle:{[a]:"Global Filter Functions"},globalFiltersDescription:{[a]:"Global filter functions are context aware, meaning that they cannot be applied to one battle in a\n                vacuum.\n                They require knowledge of the other battles to determine resulting truth value for the battle being\n                processed.\n                As such, they are affected by other filters in the chain. Therefore, to standardize behavior, all global\n                filter functions are hoisted to the top of the filter chain and executed in order."},lastN:{[a]:"Filters for the most recent N battles. Requires an Integer as an argument. Call using the syntax 'last-N(Integer)'"}},u={title:{[a]:"Syntax Elements"},semiColon:{[a]:"Semicolons must be used to separate filters when multiple are used. Do not use semicolons to separate commas in functions; use commas instead."},comma:{[a]:"Commas are used to separate arguments to functions or sets."},parentheses:{[a]:"Parentheses are used to bound the arguments to function calls."},braces:{[a]:"Braces are used to bound the arguments to a set declaration."}},d={EX1_TITLE:{[a]:"Filter Example 1"},EX1_DESCRIPTION:{[a]:"This filter takes only battles in the current season and filters for first pick\n              games where the player selected either ML Peira or New Moon Luna as their first pick and\n              harsetti was pre-banned."},EX2_TITLE:{[a]:"Filter Example 2"},EX2_DESCRIPTION:{[a]:"This filter first selects the most recent 500 battles, then filters\n              those for second pick games that occurred between April 2025 and June 2025\n              in which either the opponent is in Warlord, Emperor, or Legend and picked Zio on 3, or games\n              in which the player ended with at or above 3000 victory points. <br><br>\n\n              *Note that it does not matter when the last-n filter is placed;\n              it will always execute before local filters, since it is a global filter.\n              Therefore, the result will likely have much less than 500 battles. <br><br>\n\n              **Also note that the indentation is purely for readability. Multiple spaces or returns will be ignored\n              during parsing."},EX3_TITLE:{[a]:"Filter Example 3"},EX3_DESCRIPTION:{[a]:"This filter selects only games in which ML Arunka and Rinak are pre-banned,\n              Harsetti was picked by the player and was not postbanned, and the player ended\n              with victory points between 2500 and 3000 inclusively."},EX4_TITLE:{[a]:"Filter Example 4"},EX4_DESCRIPTION:{[a]:"This filter selects only games which occurred\n              in the pre-season following season 16 that the player won"},EX5_TITLE:{[a]:"Filter Example 5"},EX5_DESCRIPTION:{[a]:"This filter selects only games where the player selected belian, and\n              Belian was equipped with both Counter and Immunity sets, and Belian was either\n              equipped with 3f or Elbris Ritual Sword. Furthermore, it filters only for battles\n              in which the opponent selected New Moon Luna, and New Moon Luna took the first turn, and\n              the opponent was either from the Global, Japan, or Asia servers."},TEST_TITLE:{[a]:"Filter Test"},TEST_DESCRIPTION:{[a]:"Write filter syntax below to test. Use the 'Check Syntax' button to verify the filter\n              is properly formed."}},f={TITLE:{[a]:"Welcome to E7 RTA Archive"},DESCRIPTION_PART1:{[a]:"This tool primarily enables E7 players to maintain their RTA history beyond 100 battles."},DESCRIPTION_PART2:{[a]:"Users can query their most recent 100 battles just like the E7 website, then export the data using the button in the top right and upload in the future to maintain a continuous history."},DESCRIPTION_PART3:{[a]:"All uploads are handled exclusively by the client. No data from the upload is sent to the server (except for the User information [id, username, server, etc.] if auto-query is selected)."},DESCRIPTION_PART4:{[a]:"Some statistics are also available to help users better understand their performance."},DESCRIPTION_PART5:{[a]:"A customizable filter syntax is available, allowing users to control what data is used in the analysis."},DESCRIPTION_PART6:{[a]:"To utilize filters and query statistics, identifiers must be input correctly. A search page is available to find the correct names for things like artifacts and heroes."},DESCRIPTION_PART7:{[a]:"Navigate to content pages using the above nav bar or the side panel."},DESCRIPTION_PART8:{[a]:"English is currently the only supported language."}},h={Welcome:f,FilterExamplesAndTest:d,FilterOverview:s,Functions:c,DeclaredData:o,Fields:i,Operators:l,Syntax:u,WELCOME_BLOCK:f}},412:(e,t,n)=>{n.d(t,{$k:()=>o,D5:()=>h,DB:()=>i,F4:()=>p,F7:()=>s,Lx:()=>d,W4:()=>E,WB:()=>a,Yj:()=>r,hc:()=>c,pc:()=>u,pg:()=>l,se:()=>f});const r={CODES:{DE:"de",KO:"ko",PT:"pt",TH:"th",ZH_TW:"zh-TW",JA:"ja",EN:"en",FR:"fr",ZH_CN:"zh-CN",ES:"es"},NAMES:{DE:"German",KO:"Korean",PT:"Portuguese",TH:"Thai",ZH_TW:"Chinese (Traditional, Taiwan)",JA:"Japanese",EN:"English",FR:"French",ZH_CN:"Chinese (Simplified, China)",ES:"Spanish"}},a=new Set(["world_kor","world_global","world_jpn","world_asia","world_eu"]),s={GLOBAL:"world_global",KOR:"world_kor",JPN:"world_jpn",ASIA:"world_asia",EU:"world_eu"},i={[s.GLOBAL]:"Global",[s.KOR]:"Korea",[s.JPN]:"Japan",[s.ASIA]:"Asia",[s.EU]:"Europe"},o=(i.world_global,s.GLOBAL,i.world_kor,s.KOR,i.world_jpn,s.JPN,i.world_asia,s.ASIA,i.world_eu,s.EU,Object.fromEntries(Object.values(i).map(e=>[e.toLowerCase(),e]))),l={set_speed:"Speed",set_acc:"Hit",set_cri:"Critical",set_res:"Resist",set_def:"Defense",set_att:"Attack",set_max_hp:"Health",set_cri_dmg:"Destruction",set_coop:"Unity",set_immune:"Immunity",set_rage:"Rage",set_vampire:"Lifesteal",set_shield:"Protection",set_revenge:"Revenge",set_penetrate:"Penetration",set_torrent:"Torrent",set_counter:"Counter",set_scar:"Injury",set_revenant:"Reversal",set_riposte:"Riposte"},c=864e5,u={bronze:"Bronze",silver:"Silver",gold:"Gold",master:"Master",challenger:"Challenger",champion:"Champion",warlord:"Warlord",emperor:"Emperor",legend:"Legend"},d={SEASON:"Season",SEASON_CODE:"Season Code",DATE_TIME:"Date/Time",SECONDS:"Seconds",TURNS:"Turns",SEQ_NUM:"Seq Num",P1_ID:"P1 ID",P1_SERVER:"P1 Server",P2_ID:"P2 ID",P2_SERVER:"P2 Server",P1_LEAGUE:"P1 League",P2_LEAGUE:"P2 League",P1_POINTS:"P1 Points",POINT_GAIN:"Point Gain",WIN:"Win",FIRST_PICK:"First Pick",FIRST_TURN:"First Turn",FIRST_TURN_HERO:"First Turn Hero",CR_BAR:"CR Bar",P1_PREBANS:"P1 Prebans",P2_PREBANS:"P2 Prebans",P1_PICKS:"P1 Picks",P2_PICKS:"P2 Picks",P1_POSTBAN:"P1 Postban",P2_POSTBAN:"P2 Postban",P1_EQUIPMENT:"P1 Equipment",P2_EQUIPMENT:"P2 Equipment",P1_ARTIFACTS:"P1 Artifacts",P2_ARTIFACTS:"P2 Artifacts",P1_MVP:"P1 MVP",P2_MVP:"P2 MVP"},f=(Object.values(d).filter(e=>!e.toLowerCase().includes("prime")),Object.values(d).filter(e=>!e.toLowerCase().includes("prime"))),h=(d.P1_EQUIPMENT,d.P2_EQUIPMENT,d.P1_ARTIFACTS,d.P2_ARTIFACTS,d.CR_BAR,d.P1_PREBANS,d.P2_PREBANS,d.P1_PICKS,d.P2_PICKS,d.FIRST_PICK,d.FIRST_TURN,d.WIN,d.SECONDS,d.TURNS,d.P1_POINTS,d.POINT_GAIN,d.P1_LEAGUE,d.P2_LEAGUE,{HERO_NAME:"Hero Name",BATTLES:"Battles",PICK_RATE:"Pick Rate",WINS:"Wins",WIN_RATE:"Win rate",POSTBANS:"Postbans",POSTBAN_RATE:"Postban Rate",SUCCESS_RATE:"Success Rate",PLUS_MINUS:"+/-",POINT_GAIN:"Point Gain",AVG_CR:"Avg CR",FIRST_TURNS:"First Turns",FIRST_TURN_RATE:"First Turn Rate"}),p="https://epic7.onstove.com",E=p+"/gg"},469:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(545),a=n(275),s=n(412),i=n(207);let o={fetchAndCacheSeasonDetails:async function(){const e=await a.A.fetchSeasonDetails();if(e.error)throw new Error(`Could not fetch season details: ${e.error}`);const t=e.seasonDetails;t.forEach(e=>{e.range=[e.Start,e.End].map(e=>new Date(`${e.split(" ")[0]}T00:00:00`)),e["Season Number"]=String(e["Season Number"])}),t.sort((e,t)=>parseInt(e["Season Number"])-parseInt(t["Season Number"]));const n=[t[0]];let i=t[0];if(t.slice(1).forEach(e=>{const[t,r]=[new Date(+i.range[1]+s.hc),new Date(+e.range[0]-s.hc)],a=i["Season Number"]+"f",o={"Season Number":a,Code:"pvp_rta_ss"+a,Season:`Pre ${e.Season}`,Start:t.toISOString().slice(0,10),End:r.toISOString().slice(0,10),Status:"Complete",range:[t,r]};n.push(o),n.push(e),i=e}),i.range[1]<new Date){const e=new Date(+i.range[1]+s.hc),t=i["Season Number"]+"f",r={"Season Number":t,Code:"pvp_rta_ss"+t,Season:"Active Pre-Season",Start:e.toISOString().slice(0,10),End:"N/A",Status:"Active",range:[e,new Date]};n.push(r)}return n.reverse(),await r.A.cache(r.A.Keys.SEASON_DETAILS,n),n},getSeasonDetails:async function(){const e=await r.A.get(r.A.Keys.SEASON_DETAILS);return e||await o.fetchAndCacheSeasonDetails()},clearSeasonDetails:async function(){await r.A.delete(r.A.Keys.SEASON_DETAILS)},getSeasonNumFromCode:function(e){return e.split("_").at(-1)},reaquireIfNeeded:async function(e){const t=await o.getSeasonDetails(),n=new Set(t.map(e=>e.Code));e.forEach(e=>{const t=e[s.Lx.SEASON_CODE];i.L.SEASON_CODE_LITERAL_RE.test(t)||console.error("Battle contains invalid season code:",t,e),n.has(e[s.Lx.SEASON_CODE])||o.fetchAndCacheSeasonDetails()})}};const l=o},494:(e,t,n)=>{n.d(t,{K:()=>r});const r={unwrapHtmlElt:function(e){const t=document.getElementById(e);if(null===t)throw new Error(`Could not find element with ID ${e}`);return t},setText:function(e,t){this.unwrapHtmlElt(e).textContent=t}}},497:(e,t,n)=>{n.d(t,{pq:()=>o});var r=n(545),a=(n(623),n(940),n(507));n(771),n(412);const s=new Set(Object.values(a.D));function i(e){return!!s.has(e)||(console.error(`Invalid page state: ${e}`),!1)}let o={getState:async function(){return await r.A.get(r.A.Keys.HOME_PAGE_STATE)??a.D.SELECT_DATA},setState:async function(e){i(e)&&await r.A.cache(r.A.Keys.HOME_PAGE_STATE,e)},resetState:async function(){await r.A.delete(r.A.Keys.HOME_PAGE_STATE)}}},507:(e,t,n)=>{n.d(t,{D:()=>r});const r={SELECT_DATA:"select-data",SHOW_STATS:"show-stats",LOAD_DATA:"load-data",HERO_INFO:"hero-info"}},528:(e,t,n)=>{n.d(t,{A:()=>c});var r=n(545),a=n(412),s=n(275),i=n(40);const o="~Fodder",l="~Empty";const c={getHeroDicts:async function(e=a.Yj.CODES.EN){const t=await r.A.get(r.A.Keys.HERO_MANAGER);return t||this.fetchAndCacheHeroManager(e)},createHeroManager:function(e){let t={heroes:[],Empty:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A"},Fodder:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A"},name_lookup:{},code_lookup:{}};return t.heroes=e,t=function(e){e.heroes.length;const t={attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:l},n={attribute_cd:"N/A",code:"N/A",grade:"2/3",job_cd:"N/A",name:o};return e.heroes.push(t),e.heroes.push(n),e.Fodder=n,e.Empty=t,e}(t),t=function(e){return e.name_lookup=e.heroes.reduce((e,t)=>(e[t.name.toLowerCase().replace(/\s+/g,"")]=t,e),{}),e.code_lookup=e.heroes.reduce((e,t)=>(e[t.code]=t,e),{}),e}(t),t},fetchHeroManager:async function(e=a.Yj.CODES.EN){const t=(await i.A.fetchHeroJSON()??await s.A.fetchHeroData())[e];return this.createHeroManager(t)},fetchAndCacheHeroManager:async function(e=a.Yj.CODES.EN){const t=await this.fetchHeroManager(e);return await r.A.cache(r.A.Keys.HERO_MANAGER,t),t},deleteHeroManager:async function(){await r.A.delete(r.A.Keys.HERO_MANAGER)},getHeroByName:function(e,t){if(!t)throw new Error("HeroManager instance must be passed to lookup functions");if(!e)return t.Empty;const n=e.toLowerCase().replace(/\s+/g,"");return t.name_lookup[n]??null},getHeroByCode:function(e,t){if(!t)throw new Error("HeroManager instance must be passed to lookup functions");return e?t.code_lookup[e]??null:t.Empty},EMPTY_NAME:l,FODDER_NAME:o}},541:(e,t,n)=>{n.d(t,{GQ:()=>l,Kb:()=>i});var r=n(494);let a=0;function s(){return a+=1,`id-${a}`}const i={NEST:"nest",END_NEST:"end-nest",ADJ:"adj"},o="~end-nest~";i.END_NEST;class l{htmlElt;children;childArr;constructor(e){this.htmlElt=e,this.children={},this.childArr=[]}static fromID(e){return new l(r.K.unwrapHtmlElt(e))}static fromElt(e){return new l(e)}get id(){return this.htmlElt.id}set id(e){this.htmlElt.id=e}addClass(...e){this.htmlElt.classList.add(...e)}addStyle(e){this.htmlElt.setAttribute("style",e)}removeClass(...e){this.htmlElt.classList.remove(...e)}addAttributes(e){for(const[t,n]of Object.entries(e))this.htmlElt.setAttribute(t,n)}appendChild(e){if(e instanceof l)return this.htmlElt.appendChild(e.htmlElt),e.id||(e.id=s()),this.children[e.id]=e,this.childArr.push(e),e;if(e instanceof HTMLElement){let t=new l(e);return this.appendChild(t)}throw new Error("Only instances of HTMLConstructor or HTMLElement can be passed to this function")}setInnerHtml(e){this.htmlElt.innerHTML=e}appendInnerHTML(e){this.htmlElt.insertAdjacentHTML("beforeend",e)}constructChild(e,t={}){t.id||(t.id=s());let n=document.createElement(e),r=new l(n);return r.addAttributes(t),this.appendChild(r),r}addTextContent(e){this.htmlElt.textContent=e}compose(e){for(let t=0;t<e.length;t++){const n=e[t];if(n.option===i.NEST){const r=[];for(let n=t+1;n<e.length;n++){const t=e[n];if(t.option===i.END_NEST)break;r.push(t)}n.children?n.children=[...n.children,...r]:n.children=r,n.option=i.ADJ,this.compose([n]),t+=r.length;continue}if(n.tag===o)continue;if(n.textContent instanceof Array){const e=[];for(const t of n.textContent){const r=Object.assign({},n);r.textContent=t,e.push(r)}this.compose(e);continue}let r=this.constructChild(n.tag,n.attributes);n.classes&&r.addClass(...n.classes),n.children&&r.compose(n.children),n.textContent&&r.addTextContent(n.textContent),n.style&&r.addStyle(n.style),n.innerHtml&&r.setInnerHtml(n.innerHtml)}}}},545:(e,t,n)=>{n.d(t,{A:()=>G});const r=(e,t)=>t.some(t=>e instanceof t);let a,s;const i=new WeakMap,o=new WeakMap,l=new WeakMap;let c={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return i.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return h(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function u(e){c=e(c)}function d(e){return(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(p(this),t),h(this.request)}:function(...t){return h(e.apply(p(this),t))}}function f(e){return"function"==typeof e?d(e):(e instanceof IDBTransaction&&function(e){if(i.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",s),e.removeEventListener("abort",s)},a=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",s),e.addEventListener("abort",s)});i.set(e,t)}(e),r(e,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,c):e)}function h(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",s)},a=()=>{t(h(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",s)});return l.set(t,e),t}(e);if(o.has(e))return o.get(e);const t=f(e);return t!==e&&(o.set(e,t),l.set(t,e)),t}const p=e=>l.get(e);const E=["get","getKey","getAll","getAllKeys","count"],_=["put","add","delete","clear"],A=new Map;function S(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(A.get(t))return A.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=_.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!E.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,a?"readwrite":"readonly");let i=s.store;return r&&(i=i.index(t.shift())),(await Promise.all([i[n](...t),a&&s.done]))[0]};return A.set(t,s),s}u(e=>({...e,get:(t,n,r)=>S(t,n)||e.get(t,n,r),has:(t,n)=>!!S(t,n)||e.has(t,n)}));const T=["continue","continuePrimaryKey","advance"],g={},m=new WeakMap,w=new WeakMap,R={get(e,t){if(!T.includes(t))return e[t];let n=g[t];return n||(n=g[t]=function(...e){m.set(this,w.get(this)[t](...e))}),n}};async function*N(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const n=new Proxy(t,R);for(w.set(n,t),l.set(n,p(t));t;)yield n,t=await(m.get(n)||t.continue()),m.delete(n)}function I(e,t){return t===Symbol.asyncIterator&&r(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&r(e,[IDBIndex,IDBObjectStore])}u(e=>({...e,get:(t,n,r)=>I(t,n)?N:e.get(t,n,r),has:(t,n)=>I(t,n)||e.has(t,n)}));var y=n(412);async function L(e,t){const n=e.transaction(t,"readwrite");n.objectStore(t).clear(),await n.done}const O={USER:"current-user",BATTLES:"battles",RAW_UPLOAD:"raw-upload",STATS:"stats",FILTER_STR:"filter-str"},b={GLOBAL_USERS:"global-users",EU_USERS:"eu-users",ASIA_USERS:"asia-users",JPN_USERS:"jpn-users",KOR_USERS:"kor-users"},C={...b,ARTIFACTS:"artifacts",ARTIFACTS_LOWERCASE_NAMES_MAP:"artifacts-lowercase-names-map",ARTIFACT_OBJECT_LIST:"artifact-object-list",HERO_MANAGER:"hero-manager",SEASON_DETAILS:"season-details"},P={...O,...C,LANG:"lang",AUTO_ZOOM_FLAG:"auto-zoom",AUTO_QUERY_FLAG:"auto-query",ID_SEARCH_FLAG:"id-search",HOME_PAGE_STATE:"home-page-state",INTER_PAGE_MANAGER:"inter-page-manager"},v=864e5,D=2*v,x=3*(7*v),F=v,B=Object.values(C),k=Object.values(O).filter(e=>e!==O.FILTER_STR);function M(e){const[t,n]=e;return`[${new Date(t)}, ${n}]`}function H(e){return B.includes(e)?F:k.includes(e)?x:D}const U="DataStore",j="MetaStore";let $={consts:{DB_NAME:"E7ArenaStatsClientDB",DB_VERSION:1,STORE_NAME:U,META_STORE_NAME:j},Keys:{...P},MetaKeys:{TIMESTAMP:"timestamp"},loaded_UM:new Set,openDB:async function(){return await function(e,t,{blocked:n,upgrade:r,blocking:a,terminated:s}={}){const i=indexedDB.open(e,t),o=h(i);return r&&i.addEventListener("upgradeneeded",e=>{r(h(i.result),e.oldVersion,e.newVersion,h(i.transaction),e)}),n&&i.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}($.consts.DB_NAME,$.consts.DB_VERSION,{upgrade(e){e.objectStoreNames.contains(U)&&e.deleteObjectStore(U),e.objectStoreNames.contains(U)||e.createObjectStore(U),e.objectStoreNames.contains(j)||e.createObjectStore(j)}})},get:async function(e){const t=await this.openDB(),n=await t.get(U,e);if(!n)return null;return await this.checkCacheTimeout(e)?n:null},cache:async function(e,t){const n=await this.openDB();await n.put(U,t,e),await this.setTimeoutDataNow(e)},delete:async function(e){const t=await this.openDB();await t.delete(U,e),await this.deleteTimeoutData(e)},deleteDB:async function(){await indexedDB.deleteDatabase(this.consts.DB_NAME)},getTimeoutData:async function(e){const t=await this.openDB(),n=`${e+this.MetaKeys.TIMESTAMP}`;return await t.get(j,n)||null},setTimeoutData:async function(e,t){const n=await this.openDB(),r=`${e+this.MetaKeys.TIMESTAMP}`;await n.put(j,t,r)},setTimeoutDataNow:async function(e){const t=function(e){return[Date.now(),H(e)]}(e);await this.setTimeoutData(e,t)},deleteTimeoutData:async function(e){const t=await this.openDB(),n=`${e+this.MetaKeys.TIMESTAMP}`;await t.delete(j,n)},clearData:async function(){const e=await this.openDB();await L(e,U),await L(e,j)},clearUserData:async function(){const e=Object.values(O);await Promise.all(e.map(e=>this.delete(e)))},clearUserLists:async function(){const e=Object.values(b);await Promise.all(e.map(e=>this.delete(e)))},clearSeasonData:async function(){await this.delete(P.SEASON_DETAILS)},clearReferenceData:async function(){const e=Object.values(C);await Promise.all(e.map(e=>this.delete(e)))},checkCacheTimeout:async function(e){const t=await this.getTimeoutData(e),n=Date.now();if(!t)return!1;if(r=t,!Array.isArray(r)||2!==r.length||"number"!=typeof r[0]||"number"!=typeof r[1])return await this.delete(e),!1;var r;const[a,s]=t;return n-a>s?(M(t),new Date(n),await this.delete(e),!1):(M(t),new Date(n),H(e),t[0],!0)},getFilterStr:async function(){return await this.get(P.FILTER_STR)},setFilterStr:async function(e){await this.cache(P.FILTER_STR,e)},getLang:async function(){return await this.get(P.LANG)??y.Yj.CODES.EN},setLang:async function(e){await this.cache(P.LANG,e)},getStats:async function(){return await this.get(P.STATS)},setStats:async function(e){await this.cache(P.STATS,e)}};const G=$},623:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(494);const a={SELECT_DATA_MSG:"select-data-msg",FILTER_MSG:"filterMSG",SELECT_DATA_BODY:"select-data-body",SHOW_STATS_BODY:"show-stats-body",LOAD_DATA_BODY:"load-data-body",HERO_INFO_BODY:"hero-info-body",HERO_INFO_CONTENT:"hero-info-content",HERO_DEFAULT_CONTENT:"default-content",LATEST_BATTLES_BTN:"latest-battles-btn",UPLOAD_FORM:"uploadForm",CSV_FILE:"csvFile",USER_QUERY_FORM_NAME:"user-query-form-name",USER_QUERY_FORM_SERVER:"user-query-form-server",AUTO_ZOOM_FLAG:"auto-zoom-flag",USER_NAME:"user-name",USER_ID:"user-id",USER_SERVER:"user-server",BATTLE_FILTER_TOGGLER:"filter-battle-table",ID_SEARCH_FLAG:"id-search-flag",SEASON_DETAILS_TBL:"season-details-tbl",PERFORMANCE_STATS_TBL:"performance-stats-tbl",FIRST_PICK_STATS_TBL:"first-pick-stats-tbl",PREBAN_STATS_TBL:"preban-stats-tbl",PLAYER_TBL:"player-tbl",OPPONENT_TBL:"opponent-tbl",BATTLES_TBL:"battles-tbl",RANK_PLOT:"rank-plot",SEARCH_INPUT:"searchInput",HERO_SEARCH_OPTIONS:"hero-option-list",HERO_PLAYER_TBL:"hero-player-tbl",HERO_OPPONENT_TBL:"hero-opponent-tbl"};class s{IDS=a;_SELECT_DATA_MSG=null;_FILTER_MSG=null;_SELECT_DATA_BODY=null;_SHOW_STATS_BODY=null;_LOAD_DATA_BODY=null;_HERO_INFO_BODY=null;_LATEST_BATTLES_BTN=null;_UPLOAD_FORM=null;_CSV_FILE=null;_USER_QUERY_FORM_NAME=null;_USER_QUERY_FORM_SERVER=null;_AUTO_ZOOM_FLAG=null;_FOOTER=null;_USER_NAME=null;_USER_ID=null;_USER_SERVER=null;_BATTLE_FILTER_TOGGLER=null;_ID_SEARCH_FLAG=null;_SEASON_DETAILS_TBL=null;_PERFORMANCE_STATS_TBL=null;_FIRST_PICK_STATS_TBL=null;_PREBAN_STATS_TBL=null;_PLAYER_TBL=null;_OPPONENT_TBL=null;_BATTLE_TBL=null;_RANK_PLOT=null;_HERO_PLAYER_TBL=null;_HERO_OPPONENT_TBL=null;_SEARCH_INPUT=null;_SEARCH_OPTIONS=null;getElt(e){return r.K.unwrapHtmlElt(e)}get SELECT_DATA_MSG(){return this._SELECT_DATA_MSG||=r.K.unwrapHtmlElt("select-data-msg")}get FILTER_MSG(){return this._FILTER_MSG||=r.K.unwrapHtmlElt("filterMSG")}get SELECT_DATA_BODY(){return this._SELECT_DATA_BODY||=r.K.unwrapHtmlElt("select-data-body")}get SHOW_STATS_BODY(){return this._SHOW_STATS_BODY||=r.K.unwrapHtmlElt("show-stats-body")}get LOAD_DATA_BODY(){return this._LOAD_DATA_BODY||=r.K.unwrapHtmlElt("load-data-body")}get HERO_INFO_BODY(){return this._HERO_INFO_BODY||=r.K.unwrapHtmlElt("hero-info-body")}get LATEST_BATTLES_BTN(){return this._LATEST_BATTLES_BTN||=r.K.unwrapHtmlElt("latest-battles-btn")}get UPLOAD_FORM(){return this._UPLOAD_FORM||=r.K.unwrapHtmlElt("uploadForm")}get CSV_FILE(){return this._CSV_FILE||=r.K.unwrapHtmlElt("csvFile")}get USER_QUERY_FORM_NAME(){return this._USER_QUERY_FORM_NAME||=r.K.unwrapHtmlElt("user-query-form-name")}get USER_QUERY_FORM_SERVER(){return this._USER_QUERY_FORM_SERVER||=r.K.unwrapHtmlElt("user-query-form-server")}get AUTO_ZOOM_FLAG(){return this._AUTO_ZOOM_FLAG||=r.K.unwrapHtmlElt("auto-zoom-flag")}get USER_NAME(){return this._USER_NAME||=r.K.unwrapHtmlElt("user-name")}get USER_ID(){return this._USER_ID||=r.K.unwrapHtmlElt("user-id")}get USER_SERVER(){return this._USER_SERVER||=r.K.unwrapHtmlElt("user-server")}get BATTLE_FILTER_TOGGLE(){return this._BATTLE_FILTER_TOGGLER||=r.K.unwrapHtmlElt("filter-battle-table")}get ID_SEARCH_FLAG(){return this._ID_SEARCH_FLAG||=r.K.unwrapHtmlElt("id-search-flag")}get SEASON_DETAILS_TBL(){return this._SEASON_DETAILS_TBL||=r.K.unwrapHtmlElt("season-details-tbl")}get PERFORMANCE_STATS_TBL(){return this._PERFORMANCE_STATS_TBL||=r.K.unwrapHtmlElt("performance-stats-tbl")}get FIRST_PICK_STATS_TBL(){return this._FIRST_PICK_STATS_TBL||=r.K.unwrapHtmlElt("first-pick-stats-tbl")}get PREBAN_STATS_TBL(){return this._PREBAN_STATS_TBL||=r.K.unwrapHtmlElt("preban-stats-tbl")}get PLAYER_TBL(){return this._PLAYER_TBL||=r.K.unwrapHtmlElt("player-tbl")}get OPPONENT_TBL(){return this._OPPONENT_TBL||=r.K.unwrapHtmlElt("opponent-tbl")}get BATTLES_TBL(){return this._BATTLE_TBL||=r.K.unwrapHtmlElt("battles-tbl")}get RANK_PLOT(){return this._RANK_PLOT||=r.K.unwrapHtmlElt("rank-plot")}get MESSAGE_ELEMENTS_LIST(){return[this.SELECT_DATA_MSG,this.FILTER_MSG]}get SEARCH_INPUT(){return this._SEARCH_INPUT||=r.K.unwrapHtmlElt("searchInput")}get HERO_SEARCH_OPTIONS(){return this._SEARCH_OPTIONS||=r.K.unwrapHtmlElt("hero-option-list")}get HERO_PLAYER_TBL(){return this._HERO_PLAYER_TBL||=r.K.unwrapHtmlElt("hero-player-tbl")}get HERO_OPPONENT_TBL(){return this._HERO_OPPONENT_TBL||=r.K.unwrapHtmlElt("hero-opponent-tbl")}}class i{_SIDEBAR_HIDE_BTN=null;get SIDEBAR_HIDE_BTN(){return this._SIDEBAR_HIDE_BTN||=r.K.unwrapHtmlElt("sidebar-hide")}_CLEAR_DATA_BTN=null;get CLEAR_DATA_BTN(){return this._CLEAR_DATA_BTN||=r.K.unwrapHtmlElt("clear-data-btn")}_EXPORT_CSV_BTN=null;get EXPORT_DATA_BTN(){return this._EXPORT_CSV_BTN||=r.K.unwrapHtmlElt("export-data-btn")}_OFFICIAL_SITE_BTN=null;get OFFICIAL_SITE_BTN(){return this._OFFICIAL_SITE_BTN||=r.K.unwrapHtmlElt("official-site-btn")}_USER_NAME=null;get USER_NAME(){return this._USER_NAME||=r.K.unwrapHtmlElt("user-name")}_USER_ID=null;get USER_ID(){return this._USER_ID||=r.K.unwrapHtmlElt("user-id")}_USER_SERVER=null;get USER_SERVER(){return this._USER_SERVER||=r.K.unwrapHtmlElt("user-server")}_SIDEBAR_CONTROL=null;get SIDEBAR_CONTROL(){return this._SIDEBAR_CONTROL||=r.K.unwrapHtmlElt("sidebar-control")}_REFRESH_REFERENCES_BTN=null;get REFRESH_REFERENCES_BTN(){return this._REFRESH_REFERENCES_BTN||=r.K.unwrapHtmlElt("refresh-references-btn")}}class o{_SEARCH_DOMAINS=null;get SEARCH_DOMAINS(){return this._SEARCH_DOMAINS||=r.K.unwrapHtmlElt("search-domains")}_SEARCH_SUBMIT_BTN=null;get SEARCH_SUBMIT_BTN(){return this._SEARCH_SUBMIT_BTN||=r.K.unwrapHtmlElt("search-submit-btn")}_SEARCH_FORM=null;get SEARCH_FORM(){return this._SEARCH_FORM||=r.K.unwrapHtmlElt("searchForm")}_SEARCH_TABLE_CONTAINER=null;get SEARCH_TABLE_CONTAINER(){return this._SEARCH_TABLE_CONTAINER||=r.K.unwrapHtmlElt("search-table-container")}}class l{_FILTER_SYNTAX_RULES_CONTAINER=null;get FILTER_SYNTAX_RULES_CONTAINER(){return this._FILTER_SYNTAX_RULES_CONTAINER||=r.K.unwrapHtmlElt("filter-syntax-rules-container")}_ALL_CONTENT_CONTAINER=null;get ALL_CONTENT_CONTAINER(){return this._ALL_CONTENT_CONTAINER||=r.K.unwrapHtmlElt("all-content-container")}}class c{IDS={OVERVIEW_CONTAINER:"overview-container",OVERVIEW_CARD:"overview-card",RETURN_BTN:"info-return-btn",RETURN_CONTAINER:"info-return-container",FILTER_SYNTAX_CONTAINER:"filter-syntax-rules-container",FILTER_EXAMPLES_AND_TEST_CONTAINER:"filter-syntax-examples-and-test-container",INFORMATION_CONTENT_LINKS_CONTAINER:"information-content-links-container",ALL_CONTENT_CONTAINER:"all-content-container",FILTER_OVERVIEW:"filter-rules-card",FIELD_SYNTAX:"fields-card",FUNCTION_SYNTAX:"functions-card",OPERATOR_SYNTAX:"operators-card",DATA_SYNTAX:"declared-data-card",STRUCTURAL_SYNTAX:"structural-syntax-card",EX_FILTER_1:"exFilter1",EX_FILTER_2:"exFilter2",EX_FILTER_3:"exFilter3",EX_FILTER_4:"exFilter4",EX_FILTER_5:"exFilter5",TEST_FILTER_FORM:"test-filter-form",TEST_FILTER_MESSAGE:"filterMSG",TEST_SYNTAX_CARD:"test-syntax-card",CHECK_SYNTAX_BTN:"check-syntax-btn"};_CACHE={};constructor(){this._CACHE={}}getFromId(e){return this._CACHE[e]||=r.K.unwrapHtmlElt(e)}}const u=new class{HOME_PAGE;NAV_BAR;SEARCH_PAGE;FILTER_SYNTAX_PAGE;INFO_PAGE;_BODY_FOOTER_CONTAINER=null;_FOOTER_WRAPPER=null;constructor(){this.HOME_PAGE=new s,this.NAV_BAR=new i,this.SEARCH_PAGE=new o,this.FILTER_SYNTAX_PAGE=new l,this.INFO_PAGE=new c}get BODY_FOOTER_CONTAINER(){return this._BODY_FOOTER_CONTAINER??=r.K.unwrapHtmlElt("body-footer-container")}get FOOTER_WRAPPER(){return this._FOOTER_WRAPPER||=r.K.unwrapHtmlElt("footer-wrapper")}}},719:(e,t,n)=>{n.d(t,{A:()=>h});var r=n(545),a=n(913),s=n(528),i=n(834),o=n(412),l=n(92);function c(e,t,n){const r=e=>s.A.getHeroByCode(e,t)?.name??t.Fodder.name,a=(t,r)=>r.map((r,a)=>r?(e=>i.A.convertCodeToName(e,n)||"None")(r):((t,n)=>"p1"===t?e.p2_postban===e.p1_picks[n]:e.p1_postban===e.p2_picks[n])(t,a)?"n/a":"None");const c=e=>e.map(e=>e.map(e=>o.pg[e]||e)),u=e.cr_bar.find(e=>100===e[1]),d=!!u&&e.p1_picks.includes(u[0]);var f;return{[o.Lx.SEASON]:e.season_name||"None",[o.Lx.SEASON_CODE]:e.season_code||"None",[o.Lx.DATE_TIME]:e.date_time,[o.Lx.SECONDS]:e.seconds,[o.Lx.TURNS]:e.turns,[o.Lx.SEQ_NUM]:e.seq_num,[o.Lx.P1_ID]:e.p1_id.toString(),[o.Lx.P1_SERVER]:o.DB[e.p1_server]||e.p1_server||"None",[o.Lx.P2_ID]:e.p2_id.toString(),[o.Lx.P2_SERVER]:o.DB[e.p2_server]||e.p2_server||"None",[o.Lx.P1_LEAGUE]:(0,l.S)(e.p1_league)||"None",[o.Lx.P2_LEAGUE]:(0,l.S)(e.p2_league)||"None",[o.Lx.P1_POINTS]:e.p1_win_score,[o.Lx.POINT_GAIN]:e.p1_point_delta||null,[o.Lx.WIN]:1===e.win,[o.Lx.FIRST_PICK]:1===e.first_pick,[o.Lx.FIRST_TURN]:!!d,[o.Lx.FIRST_TURN_HERO]:u?r(u[0]):"n/a",[o.Lx.CR_BAR]:(f=e.cr_bar,f.map(e=>e&&2==e.length?[r(e[0]),e[1]]:["n/a",0])),[o.Lx.P1_PREBANS]:e.p1_prebans.map(r),[o.Lx.P2_PREBANS]:e.p2_prebans.map(r),[o.Lx.P1_PICKS]:e.p1_picks.map(r),[o.Lx.P2_PICKS]:e.p2_picks.map(r),[o.Lx.P1_POSTBAN]:r(e.p1_postban),[o.Lx.P2_POSTBAN]:r(e.p2_postban),[o.Lx.P1_EQUIPMENT]:c(e.p1_equipment),[o.Lx.P2_EQUIPMENT]:c(e.p2_equipment),[o.Lx.P1_ARTIFACTS]:a("p1",e.p1_artifacts),[o.Lx.P2_ARTIFACTS]:a("p2",e.p2_artifacts),[o.Lx.P1_MVP]:r(e.p1_mvp),[o.Lx.P2_MVP]:r(e.p2_mvp)}}function u(e){let t=function(e){for(const[t,n]of Object.entries(o.pg))e[o.Lx.P1_EQUIPMENT]=e[o.Lx.P1_EQUIPMENT].replaceAll(t,n),e[o.Lx.P2_EQUIPMENT]=e[o.Lx.P2_EQUIPMENT].replaceAll(t,n);return e}(e);return Object.fromEntries(Object.entries(t).map(([e,t])=>[e,JSON.parse(t)]))}var d=n(42);function f(e,t){const n=t.filter(e=>e instanceof d.Qo),r=t.filter(e=>e instanceof d.y4);for(let t of r)t.asString(),e=t.call(e);for(let t of n)t.asString(),e=e.filter(e=>t.call(e));return e}const h={loaded_servers:new Set,getBattles:async function(){const e=await r.A.get(r.A.Keys.BATTLES)??null;return r.A.setTimeoutDataNow(r.A.Keys.BATTLES),e},applyFilters:f,extendBattles:async function(e){const t={...await r.A.get(r.A.Keys.BATTLES)??{},...this.sortBattlesObj(e)};return await r.A.cache(r.A.Keys.BATTLES,t),t},cacheQuery:async function(e,t,n){if(!e)return[];e.length;const r=function(e,t,n){n=n??i.A.getArtifactCodeToNameMap();let r=[];for(const a of e){let e=c(a,t,n);r.push([e["Seq Num"],e])}return Object.fromEntries(r)}(e,t,n);return await this.extendBattles(r)},cacheUpload:async function(e,t){if(!e)return console.error("No uploaded battles provided to cacheUpload"),{};const n=function(e){const t=e.map(e=>u(e));return Object.fromEntries(t.map(e=>[e[o.Lx.SEQ_NUM],e]))}(e);return await this.extendBattles(n)},getStats:async function(e,t,n){const r=t.length,s=Object.values(e),i=f(s,t),l=r>0,c=await a.A.getPrebanStats(i,n),u=await a.A.getFirstPickStats(i,n),d=await a.A.getGeneralStats(i),h=await a.A.getHeroStats(i,n),p=await a.A.getPerformanceStats(i);return{battles:s,filteredBattlesObj:Object.fromEntries(i.map(e=>[e[o.Lx.SEQ_NUM],e])),prebanStats:c,generalStats:d,firstPickStats:u,playerHeroStats:h.playerHeroStats,enemyHeroStats:h.enemyHeroStats,performanceStats:p,numFilters:r,areFiltersApplied:l}},sortBattlesList:function(e,t=!0){const n=o.Lx.DATE_TIME;return t?e.sort((e,t)=>+new Date(e[n])-+new Date(t[n])):e.sort((e,t)=>+new Date(t[n])-+new Date(e[n]))},sortBattlesObj:function(e,t=!0){const n=o.Lx.DATE_TIME;if(t){let t=Object.values(e).sort((e,t)=>+new Date(e[n])-+new Date(t[n]));return Object.fromEntries(t.map(e=>[e[o.Lx.SEQ_NUM],e]))}{let t=Object.values(e).sort((e,t)=>+new Date(t[n])-+new Date(e[n]));return Object.fromEntries(t.map(e=>[e[o.Lx.SEQ_NUM],e]))}}}},771:(e,t,n)=>{n.d(t,{A:()=>h,l:()=>l});var r=n(412),a=n(545),s=n(40),i=n(275);const o={[r.F7.GLOBAL]:a.A.Keys.GLOBAL_USERS,[r.F7.EU]:a.A.Keys.EU_USERS,[r.F7.ASIA]:a.A.Keys.ASIA_USERS,[r.F7.JPN]:a.A.Keys.JPN_USERS,[r.F7.KOR]:a.A.Keys.KOR_USERS};function l(e){if(!e)throw new Error("Invalid user; user is null or undefined");if(!("id"in e)||"number"!=typeof e.id)throw new Error("Invalid user; user id does not exist or is not a number");if(!("name"in e)||"string"!=typeof e.name)throw new Error("Invalid user; user name does not exist or is not a string");if(!("world_code"in e)||"string"!=typeof e.world_code)throw new Error("Invalid user; user.world_code does not exist or is not a string");if(!(e.world_code in r.DB))throw new Error("Invalid user; user.world_code is not a valid world code");return!0}function c(e,t){return{id:Number(e.nick_no),name:e.nick_nm,code:e.code||null,rank:Number(e.rank),world_code:t}}async function u(e){const t=await a.A.get(o[e]);if(null!==t)return t;const n=await async function(e){const t=await s.A.fetchUserJSON(e);if(!t||"object"==typeof t&&!("users"in t))return null;const n=t;return Object.fromEntries(n.users.map(t=>[t.nick_no,c(t,e)]))}(e);return await a.A.cache(o[e],n),n}const d=e=>r.DB[e];async function f(e,t){const n=await u(t),r=n?Object.values(n):[];if(0===r.length)return d(t),{user:null,ok:!1};let a,s;if(e.id)a=e.id,s=e=>e.id;else{if(!e.name)throw new Error("Must pass a user object with either user.name or user.id to find user");a=e.name.toLowerCase(),s=e=>e.name.toLowerCase()}return function(e,t,n){const r=t.find(t=>n(t)===e);return r?(JSON.stringify(r),{user:r,ok:!0}):{user:null,ok:!0}}(a,r,s)}const h={getUserMap:u,findUser:async function(e){if(JSON.stringify(e),!e.name&&!e.id||!e.world_code)throw new Error("Must pass a user object with either user.name or user.id, and user.world_code to find user");let t=e.id?`Numeric ID: ${e.id}`:`Name: '${e.name}'`,n=null;if(n=await f(e,e.world_code),n.ok||(n=await i.A.fetchUser(e)),n.ok){const r=n.user;if(null===r)throw new Error(`Could not find user with ${t} in Server: ${d(e.world_code)}`);return r}throw new Error(`Function did not properly terminate: ${JSON.stringify(n)}`)},setUser:async function(e){await a.A.cache(a.A.Keys.USER,e)},getUser:async function(){const e=await a.A.get(a.A.Keys.USER);return await a.A.setTimeoutDataNow(a.A.Keys.USER),e},clearUserData:async function(){await a.A.clearUserData()},clearUserDataLists:async function(){await a.A.clearUserLists()}}},833:(e,t,n)=>{n.d(t,{j:()=>s});var r=n(412),a=n(54);const s={date:e=>e[r.Lx.DATE_TIME]?a.A.castStringToUTCDate(e[r.Lx.DATE_TIME].split(" ")[0]).getTime():"N/A",season:e=>e[r.Lx.SEASON_CODE],"is-first-pick":e=>!!e[r.Lx.FIRST_PICK],"is-win":e=>!!e[r.Lx.WIN],"victory-points":e=>e[r.Lx.P1_POINTS],"p1.picks":e=>e[r.Lx.P1_PICKS],"p2.picks":e=>e[r.Lx.P2_PICKS],"p1.prebans":e=>e[r.Lx.P1_PREBANS],"p2.prebans":e=>e[r.Lx.P2_PREBANS],"p1.postban":e=>e[r.Lx.P1_POSTBAN],"p2.postban":e=>e[r.Lx.P2_POSTBAN],postbans:e=>[e[r.Lx.P1_POSTBAN],e[r.Lx.P2_POSTBAN]],prebans:e=>[...e[r.Lx.P1_PREBANS],...e[r.Lx.P2_PREBANS]],"p1.pick1":e=>e[r.Lx.P1_PICKS][0],"p1.pick2":e=>e[r.Lx.P1_PICKS][1],"p1.pick3":e=>e[r.Lx.P1_PICKS][2],"p1.pick4":e=>e[r.Lx.P1_PICKS][3],"p1.pick5":e=>e[r.Lx.P1_PICKS][4],"p2.pick1":e=>e[r.Lx.P2_PICKS][0],"p2.pick2":e=>e[r.Lx.P2_PICKS][1],"p2.pick3":e=>e[r.Lx.P2_PICKS][2],"p2.pick4":e=>e[r.Lx.P2_PICKS][3],"p2.pick5":e=>e[r.Lx.P2_PICKS][4],"p1.league":e=>e[r.Lx.P1_LEAGUE],"p2.league":e=>e[r.Lx.P2_LEAGUE],"p1.server":e=>e[r.Lx.P1_SERVER],"p2.server":e=>e[r.Lx.P2_SERVER],"p1.id":e=>Number(e[r.Lx.P1_ID]),"p2.id":e=>Number(e[r.Lx.P2_ID]),"p1.mvp":e=>e[r.Lx.P1_MVP],"p2.mvp":e=>e[r.Lx.P2_MVP],"is-first-turn":e=>!!e[r.Lx.FIRST_TURN],"first-turn-hero":e=>e[r.Lx.FIRST_TURN_HERO],turns:e=>e[r.Lx.TURNS],seconds:e=>e[r.Lx.SECONDS],"point-gain":e=>e[r.Lx.POINT_GAIN]}},834:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(545),a=n(40),s=n(275);const i={async getArtifactCodeToNameMap(){let e=await r.A.get(r.A.Keys.ARTIFACTS);return e||(e=await this.fetchAndCacheArtifacts()),e},getArtifactLowercaseNameMap:async function(){let e=await r.A.get(r.A.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP);if(null!==e)return e;const t=await this.getArtifactCodeToNameMap();return e=Object.fromEntries(Object.values(t).filter(e=>null!==e).map(e=>[e.toLowerCase(),e])),await r.A.cache(r.A.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP,e),e},getArtifactObjectList:async function(){let e=await r.A.get(r.A.Keys.ARTIFACT_OBJECT_LIST);if(null!==e)return e;const t=await this.getArtifactCodeToNameMap();return e=Object.entries(t).map(([e,t])=>({id:e,name:t})),await r.A.cache(r.A.Keys.ARTIFACT_OBJECT_LIST,e),e},fetchAndCacheArtifacts:async function(){const e=await async function(){let e=await a.A.fetchArtifactJSON("en");return null===e&&(e=await s.A.fetchArtifactJson()),null===e?(console.error("Could not get artifact Json map from E7 server or flask server"),null):Object.fromEntries(e.filter(e=>null!==e.name).map(e=>[e.code,e.name]))}();return null===e?{}:(await r.A.cache(r.A.Keys.ARTIFACTS,e),e)},clearArtifactData:async function(){await r.A.delete(r.A.Keys.ARTIFACTS)},convertCodeToName:function(e,t){return t[e]||e}}},836:(e,t,n)=>{n.d(t,{n:()=>u});var r=n(528),a=n(719),s=n(469),i=n(545),o=n(771),l=n(834),c=n(149);let u={HeroManager:r.A,BattleManager:a.A,SeasonManager:s.A,UserManager:o.A,ClientCache:i.A,ArtifactManager:l.A,LangManager:c.W}},874:(e,t,n)=>{n.d(t,{Su:()=>S});var r=n(497),a=n(412),s=n(771),i=n(623),o=n(136),l=n(836),c=n(149),u=n(82),d=n(507);function f(){window.location.href=URL_UTILS.HOME_PAGE_URL}function h(){document.querySelectorAll(".nav-link").forEach(e=>{e.addEventListener("click",async function(t){if(!("dataset"in e)||!e.dataset||"object"!=typeof e.dataset||!("nav"in e.dataset))return;const n=e.dataset.nav;if(Object.values(d.D).includes(n))if(n===d.D.SELECT_DATA)await r.pq.setState(d.D.SELECT_DATA),f();else if(n===d.D.HERO_INFO)await r.pq.setState(d.D.HERO_INFO),f();else if(n===d.D.SHOW_STATS){await s.A.getUser()?(await r.pq.setState(d.D.SHOW_STATS),f()):(await r.pq.setState(d.D.SELECT_DATA),await o.A.pushAction({message:"Active user not found; you must either query a valid user or upload battles to view hero stats.",action:o.A.ACTIONS.SHOW_NO_USER_MSG}),f())}})})}function p(){i.A.NAV_BAR.CLEAR_DATA_BTN.addEventListener("click",async function(){await s.A.getUser()?(await r.pq.setState(d.D.SELECT_DATA),await o.A.pushAction({action:o.A.ACTIONS.CLEAR_USER})):(await r.pq.setState(d.D.SELECT_DATA),await o.A.pushAction({action:o.A.ACTIONS.SHOW_DATA_ALREADY_CLEARED_MSG})),f()})}function E(){[i.A.NAV_BAR.CLEAR_DATA_BTN,i.A.NAV_BAR.EXPORT_DATA_BTN,i.A.NAV_BAR.OFFICIAL_SITE_BTN].forEach(e=>{e.addEventListener("touchstart",()=>{e.classList.add("touch-hover"),setTimeout(()=>e.classList.remove("touch-hover"),150)})})}function _(e,t="en"){e?(i.A.NAV_BAR.USER_NAME.innerText=e.name,i.A.NAV_BAR.USER_ID.innerText=`${e.id}`,i.A.NAV_BAR.USER_SERVER.innerText=a.DB[e.world_code],i.A.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(function(e,t){const n=`${a.F4}/${t}/gg/battlerecord/${e.world_code}/${e.id}`;return n}(e,t),"_blank","noopener,noreferrer")}):(i.A.NAV_BAR.USER_NAME.innerText="(None)",i.A.NAV_BAR.USER_ID.innerText="(None)",i.A.NAV_BAR.USER_SERVER.innerText="(None)",i.A.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(a.W4,"_blank","noopener,noreferrer")})}function A(){i.A.NAV_BAR.EXPORT_DATA_BTN.addEventListener("click",async function(){if(!await l.n.UserManager.getUser())return await o.A.pushAction({message:"User not found; cannot export data without an active user",action:o.A.ACTIONS.SHOW_NO_USER_MSG}),await r.pq.setState(d.D.SELECT_DATA),void f();await u.j.triggerDownload()})}let S={addNavListeners:h,addClearDataBtnListener:p,writeUserInfo:_,initialize:async function(){_(await s.A.getUser()),h(),p(),A(),E()},navToHome:f,addExportDataBtnListener:A,addBraceButtonListeners:E,eraseUserFromPage:async function(){await s.A.clearUserData(),_(null)},setUserOnPage:async function(e){await s.A.setUser(e),_(e,await c.W.getLang())}}},913:(e,t,n)=>{n.d(t,{A:()=>S});var r=n(528),a=n(412);const s=e=>e.filter(e=>e[a.Lx.FIRST_PICK]),i="N/A";function o(e){return(100*e).toFixed(2)+"%"}function l(e,t,n=!1){return 0===t?n?"0.00%":i:o(e/t)}function c(e,t){return 0===t?i:(e/t).toFixed(2)}function u(e,t){const n=e[a.Lx.CR_BAR].find(e=>e[0]===t);return n?n[1]:null}function d(e,t){const n=e.filter(e=>{const n=e[a.Lx.P1_PICKS].includes(t)||e[a.Lx.P2_PICKS].includes(t),r=e[a.Lx.P1_POSTBAN]!==t&&e[a.Lx.P2_POSTBAN]!==t;return n&&r});let r=n.length,s=0,i=0;for(const e of n){const n=u(e,t);null!==n&&(s+=n,i+=+(100===n))}return{avgCR:l(s/100,r,!0),firstTurns:i,firstTurnRate:l(i,r,!0)}}function f(e,t){const n=(r=e,r.filter(e=>e[a.Lx.WIN])).length;var r;const s=e.length,i=e.filter(e=>e[a.Lx.FIRST_TURN]).length,o=l(i,e.length),u=e.reduce((e,t)=>e+(t[a.Lx.POINT_GAIN]||0),0);return{wins:n,subsetLength:s,frequency:l(e.length,t),winRate:l(n,e.length),plusMinus:2*n-s,pointGain:e.reduce((e,t)=>e+(t[a.Lx.POINT_GAIN]||0),0),avgPPG:c(u,s),firstTurns:i,firstTurnRate:o}}function h(e,t,n){const r=f(e,t),s=e.reduce((e,t)=>e+ +(t[a.Lx.P1_POSTBAN]===n||t[a.Lx.P2_POSTBAN]===n),0),i=e.reduce((e,t)=>e+ +(t[a.Lx.WIN]||t[a.Lx.P1_POSTBAN]===n||t[a.Lx.P2_POSTBAN]===n),0),o=d(e,n);return{[a.D5.HERO_NAME]:n,[a.D5.BATTLES]:r.subsetLength,[a.D5.PICK_RATE]:r.frequency,[a.D5.WINS]:r.wins,[a.D5.WIN_RATE]:r.winRate,[a.D5.POSTBANS]:s,[a.D5.POSTBAN_RATE]:l(s,r.subsetLength),[a.D5.SUCCESS_RATE]:l(i,r.subsetLength),[a.D5.PLUS_MINUS]:r.plusMinus,[a.D5.POINT_GAIN]:r.pointGain,[a.D5.AVG_CR]:o.avgCR,[a.D5.FIRST_TURNS]:o.firstTurns,[a.D5.FIRST_TURN_RATE]:o.firstTurnRate}}function p(e,t=!0){const n=new Set;for(const r of Object.values(e)){(t?r[a.Lx.P1_PICKS]:r[a.Lx.P2_PICKS]).forEach(e=>{n.add(e)})}return n}function E(e){return e.sort(),e.join("~")}function _(e,t){return e.map(e=>r.A.getHeroByName(e,t)?.code??t.Empty.code).filter(e=>e!==t.Empty.code)}function A(e){let t;const n=Math.floor(e/60),r=(e%60).toFixed(1);return t=0===n?`${r} secs`:`${n} : ${r}s`,t}const S={getHeroStats:function(e,t){if(0===e.length)return{playerHeroStats:[],enemyHeroStats:[]};const n=e.length,s=p(e,!0),i=p(e,!1),o=[],l=[];for(const i of s){const s=r.A.getHeroByName(i,t);if(!s)continue;const l=e.filter(e=>e[a.Lx.P1_PICKS].includes(i));l.length>0&&o.push(h(l,n,s.name))}for(const s of i){const i=r.A.getHeroByName(s,t);if(!i)continue;const o=e.filter(e=>e[a.Lx.P2_PICKS].includes(s));o.length>0&&l.push(h(o,n,i.name))}const c=a.D5.HERO_NAME;return{playerHeroStats:o.sort((e,t)=>e[c].localeCompare(t[c])),enemyHeroStats:l.sort((e,t)=>e[c].localeCompare(t[c]))}},getFirstPickStats:function(e,t){if(0===(e=s(Object.values(e))).length)return[];const n=e.length,i={};for(const t of e){if(0===t[a.Lx.P1_PICKS].length)continue;const e=t[a.Lx.P1_PICKS][0];e in i||(i[e]={wins:0,appearances:0}),i[e].wins+=+t[a.Lx.WIN],i[e].appearances+=1}const l=Object.entries(i).map(([e,a])=>({hero:r.A.getHeroByName(e,t)?.name??r.A.EMPTY_NAME,wins:a.wins,appearances:a.appearances,win_rate:o(a.wins/a.appearances),appearance_rate:o(a.appearances/n),"+/-":2*a.wins-a.appearances}));return l.sort((e,t)=>t.appearances-e.appearances),l},getPrebanStats:function(e,t){if(0===e.length)return[];const n=new Set;for(const r of e){const e=_(r[a.Lx.P1_PREBANS],t);if(0!==e.length){for(const r of e)r!==t.Empty.code&&n.add(r);e.length>1&&n.add(E(e))}}const s=e.length,i=[];for(const o of n){const n=f(e.filter(e=>E(_(e[a.Lx.P1_PREBANS],t)).includes(o)),s),l=o.split("~").map(e=>r.A.getHeroByCode(e,t)?.name??t.Empty.name).sort().join(", ");n.wins,n.subsetLength,i.push({preban:l,wins:n.wins,appearances:n.subsetLength,appearance_rate:n.frequency,win_rate:n.winRate,"+/-":n.plusMinus})}return i.sort((e,t)=>t.appearances-e.appearances),i},getPerformanceStats:function(e){const t={servers:[],leagues:[]},n=e.length,r=Object.values(a.DB),s=Object.values(a.pc),i=[...r.map(e=>[`Server: ${e}`,t=>t["P2 Server"]===e]),...s.map(e=>[`League: ${e}`,t=>t["P2 League"]===e])];for(const[r,s]of i){const i=e.filter(s),l=i.length;if(0===l)continue;const c=f(i,n),u=i.filter(e=>e[a.Lx.FIRST_PICK]),d=u.reduce((e,t)=>e+ +t[a.Lx.WIN],0),h=i.filter(e=>!e[a.Lx.FIRST_PICK]),p=h.reduce((e,t)=>e+ +t[a.Lx.WIN],0);(r.toLowerCase().includes("server")?t.servers:t.leagues).push({label:r,count:l,wins:c.wins,win_rate:c.winRate,frequency:c.frequency,"+/-":c.plusMinus,fp_games:u.length,sp_games:h.length,fp_wr:u.length>0?o(d/u.length):"N/A",sp_wr:h.length>0?o(p/h.length):"N/A"})}return[...t.servers,...t.leagues.slice(-4)]},getGeneralStats:function(e){e.sort((e,t)=>new Date(e["Date/Time"]).getTime()-new Date(t["Date/Time"]).getTime());const t=e.length,n=c(e.reduce((e,t)=>e+(t["Point Gain"]||0),0),t),r=c(e.reduce((e,t)=>e+t.Turns,0),t),u=e.length>0?Math.max(...e.map(e=>e.Turns)):0,d=e.reduce((e,t)=>e+t.Seconds,0),h=t>0?d/t:0,p=e.length>0?Math.max(...e.map(e=>e.Seconds)):0;let E=A(h),_=A(p);const S=e.reduce((e,t)=>e+ +t["First Turn"],0),T=s(e),g=(e=>e.filter(e=>!e[a.Lx.FIRST_PICK]))(e),m=f(T,t),w=f(g,t),R=l(m.wins+w.wins,t);let[N,I,y,L]=[0,0,0,0];for(let t of e)t.Win?(y+=1,N=Math.max(N,y),L=0):(y=0,L+=1,I=Math.max(I,L));return{first_pick_count:m.subsetLength,second_pick_count:w.subsetLength,first_pick_rate:m.frequency,second_pick_rate:w.frequency,first_pick_winrate:m.winRate,second_pick_winrate:w.winRate,total_winrate:R,total_battles:t,total_wins:m.wins+w.wins,max_win_streak:N,max_loss_streak:I,avg_ppg:n,avg_turns:r,avg_time:E,max_turns:u,max_time:_,first_turn_games:S,first_turn_rate:t?o(S/t):i}},computeGenericStats:f,queryStats:h,toPercent:o,divideToPercentString:l,divideToString:c,computeCRStats:d,secondsToTimeStr:A}},940:(e,t,n)=>{n.d(t,{A:()=>d});var r,a,s=n(528),i=n(84),o=n(172);function l(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function s(n,r,a,s){var l=r&&r.prototype instanceof o?r:o,u=Object.create(l.prototype);return c(u,"_invoke",function(n,r,a){var s,o,l,c=0,u=a||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return s=t,o=0,l=e,f.n=n,i}};function h(n,r){for(o=n,l=r,t=0;!d&&c&&!a&&t<u.length;t++){var a,s=u[t],h=f.p,p=s[2];n>3?(a=p===r)&&(l=s[(o=s[4])?5:(o=3,3)],s[4]=s[5]=e):s[0]<=h&&((a=n<2&&h<s[1])?(o=0,f.v=r,f.n=s[1]):h<p&&(a=n<3||s[0]>r||r>p)&&(s[4]=n,s[5]=r,f.n=p,o=0))}if(a||n>1)return i;throw d=!0,r}return function(a,u,p){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,p),o=u,l=p;(t=o<2?e:l)||!d;){s||(o?o<3?(o>1&&(f.n=-1),h(o,l)):f.n=l:f.v=l);try{if(c=2,s){if(o||(a="next"),t=s[a]){if(!(t=t.call(s,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,o<2&&(o=0)}else 1===o&&(t=s.return)&&t.call(s),o<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),o=1);s=e}else if((t=(d=f.n<0)?l:n.call(r,f))!==i)break}catch(t){s=e,o=1,l=t}finally{c=1}}return{value:t,done:d}}}(n,a,s),!0),u}var i={};function o(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(c(t={},r,function(){return this}),t),h=d.prototype=o.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,c(e,a,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=d,c(h,"constructor",d),c(d,"constructor",u),u.displayName="GeneratorFunction",c(d,a,"GeneratorFunction"),c(h),c(h,a,"Generator"),c(h,r,function(){return this}),c(h,"toString",function(){return"[object Generator]"}),(l=function(){return{w:s,m:p}})()}function c(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}c=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var s=function(t,n){c(e,t,function(e){return this._invoke(t,n,e)})};s("next",0),s("throw",1),s("return",2)}},c(e,t,n,r)}function u(e,t,n,r,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,a)}const d={validateFilterSyntax:(r=l().m(function e(t){var n,r,a;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,s.A.getHeroDicts();case 1:return n=e.v,r=document.getElementById("filterMSG"),e.p=2,e.n=3,i.S.fromFilterStr(t,n);case 3:return e.v.asString(),o.GF.write(new o.ev("Validation Passed",r,[o.GF.STYLES.GREEN])),e.a(2,!0);case 4:return e.p=4,a=e.v,console.error(a),o.GF.write(new o.ev("Validation Failed: ".concat(a.message),r,[o.GF.STYLES.RED])),e.a(2,!1)}},e,null,[[2,4]])}),a=function(){var e=this,t=arguments;return new Promise(function(n,a){var s=r.apply(e,t);function i(e){u(s,n,a,i,o,"next",e)}function o(e){u(s,n,a,i,o,"throw",e)}i(void 0)})},function(e){return a.apply(this,arguments)}),setScrollPercent:function(e){"Scrolling to ".concat(e,"%");var t=e/100*(document.documentElement.scrollHeight-window.innerHeight),n=document.documentElement,r=n.style.scrollBehavior;n.style.scrollBehavior="auto",window.scrollTo({top:t}),n.style.scrollBehavior=r},getScrollPercent:function(){var e=window.scrollY||document.documentElement.scrollTop,t=document.documentElement.scrollHeight-window.innerHeight;return 0===t?0:e/t*100},setVisibility:function(e,t){t?e.classList.remove("d-none"):e.classList.add("d-none")}}},971:(e,t,n)=>{n.d(t,{Nk:()=>i,RG:()=>s,yL:()=>a});var r=n(412);const a=new Set("'\"(),_-.=; ><!1234567890{}~abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),s="   ",i=Object.fromEntries(Object.values(r.pg).map(e=>[e.toLowerCase(),e]))},980:(e,t,n)=>{n.d(t,{j:()=>s,q:()=>a});var r=n(412);function a(e,t){return t[e]??t[r.Yj.CODES.EN]}const s={[r.Yj.CODES.EN]:function(e){return a(r.Yj.CODES.EN,e)},[r.Yj.CODES.DE]:function(e){return a(r.Yj.CODES.DE,e)},[r.Yj.CODES.KO]:function(e){return a(r.Yj.CODES.KO,e)},[r.Yj.CODES.PT]:function(e){return a(r.Yj.CODES.PT,e)},[r.Yj.CODES.TH]:function(e){return a(r.Yj.CODES.TH,e)},[r.Yj.CODES.ZH_TW]:function(e){return a(r.Yj.CODES.ZH_TW,e)},[r.Yj.CODES.JA]:function(e){return a(r.Yj.CODES.JA,e)},[r.Yj.CODES.FR]:function(e){return a(r.Yj.CODES.FR,e)},[r.Yj.CODES.ZH_CN]:function(e){return a(r.Yj.CODES.ZH_CN,e)},[r.Yj.CODES.ES]:function(e){return a(r.Yj.CODES.ES,e)}}}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return s[e](n,n.exports,o),n.exports}e="function"==typeof Symbol,t=e?Symbol("webpack queues"):"__webpack_queues__",n=e?Symbol("webpack exports"):"__webpack_exports__",r=e?Symbol("webpack error"):"__webpack_error__",a=e=>{e&&e.d<1&&(e.d=1,e.forEach(e=>e.r--),e.forEach(e=>e.r--?e.r++:e()))},o.a=(e,s,i)=>{var o;i&&((o=[]).d=-1);var l,c,u,d=new Set,f=e.exports,h=new Promise((e,t)=>{u=t,c=e});h[n]=f,h[t]=e=>(o&&e(o),d.forEach(e),h.catch(e=>{})),e.exports=h,s(e=>{var s;l=(e=>e.map(e=>{if(null!==e&&"object"==typeof e){if(e[t])return e;if(e.then){var s=[];s.d=0,e.then(e=>{i[n]=e,a(s)},e=>{i[r]=e,a(s)});var i={};return i[t]=e=>e(s),i}}var o={};return o[t]=e=>{},o[n]=e,o}))(e);var i=()=>l.map(e=>{if(e[r])throw e[r];return e[n]}),c=new Promise(e=>{(s=()=>e(i)).r=0;var n=e=>e!==o&&!d.has(e)&&(d.add(e),e&&!e.d&&(s.r++,e.push(s)));l.map(e=>e[t](n))});return s.r?c:i()},e=>(e?u(h[r]=e):c(f),a(o))),o&&o.d<0&&(o.d=0)},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);o(274)})();