/*! For license information please see search.a61229016aad33430b7e.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,n,r,s,a={40:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(412);async function s(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error: status: ${e.status}`);const n=await e.json();return Object.keys(n),n}catch(t){return console.error("Error fetching global user data:",t),null}}const a={fetchHeroJSON:async function(t=null){let e=await s("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_hero.json");return e?(t&&e[t]?e=e[t]:t&&!e[t]&&(console.error("Could not find hero data for language:",t),e=null),e):null},fetchUserJSON:async function(t){if(t=t.replace("world_",""),![...r.WB].some(e=>e.replace("world_","")===t))return console.error(`Could not find world code: ${t}`),null;const e=`https://static.smilegatemegaport.com/gameRecord/epic7/epic7_user_world_${t}.json`,n=await s(e);return n&&"object"==typeof n&&"users"in n&&Array.isArray(n.users)&&n.users.length,n},fetchArtifactJSON:async function(t=null){let e=await s("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_artifact.json"),n=null;if(e&&t&&"object"==typeof e&&t in e){let n=e;if(Array.isArray(n[t]))return n[t]}return n},fetchInfo:async function(t,e,n="en"){const r=new URLSearchParams({nick_no:t,world_code:e,lang:n});try{const t=await fetch("https://epic7.onstove.com/gg/gameApi/getUserInfo",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()});if(!t.ok)return console.error("Error fetching battle list:",t.status,t.statusText),null;return await t.json()}catch(t){return console.error("Request failed:",t),null}}}},42:(t,e,n)=>{n.d(e,{c2:()=>st,CO:()=>rt,eR:()=>B,y4:()=>Z,Qo:()=>j});var r=n(92),s=n(412),a=n(207),o=n(54),i=n(528),c=n(971);class u{}const l={Hero:new class extends u{parse(t,e){return i.A.getHeroByName(t,e.HeroDicts)?.name??null}parserType="Hero"},League:new class extends u{parse(t){return s.pc,s.pc[t]}parserType="League"},Server:new class extends u{parse(t){return s.$k[t]}parserType="Server"},Equipment:new class extends u{parse(t){return c.Nk[t.toLowerCase()]}parserType="Equipment"},Artifact:new class extends u{parse(t,e){return e.ARTIFACT_LOWERCASE_STRINGS_MAP[t.toLowerCase()]}parserType="Artifact"},Season:new class extends u{parse(t,e){let n;if("current-season"===t)return e.SEASON_DETAILS[0].Code;if("last-season"===t)return e.SEASON_DETAILS[1].Code;if(a.L.SEASON_LITERAL_RE.test(t))n=t.split("-").at(-1);else{if(!a.L.SEASON_CODE_LITERAL_RE.test(t))return null;n=t.split("_ss").at(-1)}e.SEASON_DETAILS.map(t=>t.Code.split("_").at(-1));return e.SEASON_DETAILS.find(t=>t.Code.split("_ss").at(-1)===n)?.Code}parserType="Season Code"}};var h=n(833);const E=new Set(["p1.picks","p2.picks","p1.prebans","p2.prebans","prebans","postbans"]),f={FIELD:"FIELD",RANGE:"RANGE",SET:"SET",INT:"INT",DATE:"DATE",BOOL:"BOOL",STRING:"STRING"};class _{}class d extends _{type=f.FIELD;rawString;extractFn;constructor(t){if(super(),this.rawString=t,!h.j[t])throw new Error("Invalid field");this.extractFn=h.j[t]}getData(){throw new Error("Not implemented for Field")}extractData(t){return this.extractFn(t)}asString(){return`${this.rawString}`}}class A extends _{rawString;constructor(t){super(),this.rawString=t}getData(){return this.data}extractData(t){throw new Error("Not implemented for Literals")}asString(){return`${this.fmtString}`}}class p extends A{type=f.STRING;fmtString;data;constructor(t,e,n=Object.values(l)){super(t),t=o.A.trimSurroundingQuotes(t),this.data=this.processString(t,e,n),this.fmtString=this.data}processString(t,e,n){const r=function(t,e,n){for(const r of n){const n=r.parse(t,e);if(r.parserType,n)return n}return null}(t,e,n);if(!r){const e=n.map(t=>t.parserType).join(", ");throw new o.A.ValidationError(`Invalid string literal: '${t}' ; could not be parsed as a valid instance of any of the following: [${e}]`)}return r}}class S extends A{type=f.INT;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){const e=parseInt(t);if(isNaN(e))throw new o.A.ValidationError(`Invalid integer literal: '${t}'`);return e}}class g extends A{type=f.BOOL;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){if("true"===t)return!0;if("false"===t)return!1;throw new o.A.ValidationError(`Invalid boolean literal: '${t}'`)}}class T extends A{type=f.DATE;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){return o.A.parseDate(t).getTime()}}class R{start;end;endInclusive;constructor(t,e,n){this.start=t,this.end=e,this.endInclusive=n}has(t){return"number"==typeof t&&"number"==typeof this.start&&"number"==typeof this.end&&(!(t<this.start)&&(!(t>this.end)&&(t!==this.end||this.endInclusive)))}includes(t){return this.has(t)}}const m=[t=>a.L.DATE_LITERAL_RE.test(t)?new T(t):null,t=>a.L.INT_LITERAL_RE.test(t)?new S(t):null];function w(t,e,n,r){let s=r(t),a=r(e);return null===s||null===a?null:new R(s.data,a.data,n)}class L extends A{type=f.RANGE;fmtString;data;constructor(t,e){super(t),this.fmtString=t,this.data=this.processString(t,e)}processString(t,e){const n=t.split("..."),r=n[0];let s="="===n[1].charAt(0);const a=n[1].slice(s?1:0);for(const t of m){const e=w(r,a,s,t);if(null!==e)return e}throw new o.A.ValidationError(`Invalid range literal: '${t}' ; ranges must be homogenous and of the format x...y or x...=y for the types: [Date, Integer]`)}}const N=[...m],y=(t,e,n)=>a.L.STRING_RE.test(t)?new p(t,e,n):null;class O extends A{type=f.SET;fmtString;data;constructor(t,e,n=Object.values(l)){super(t),this.fmtString=t,this.data=this.processString(t,e,n)}processString(t,e,n){let r=o.A.tokenizeWithNestedEnclosures(t,",",1,!0);r=r.filter(t=>""!==t);const s=new Set;for(const a of r){let r=null;for(const t of N)if(r=t(a),r){s.add(r.data);break}if(!r){if(r=y(a,e,n),!r)throw new o.A.ValidationError(`Invalid set element: '${t}' ; could not be parsed as a valid instance of any of the following types: [Date, Integer, String]`);s.add(r.data)}}return this.fmtString=`{${Array.from(s).join(", ")}}`,s}}const I={StringLiteral:p,IntLiteral:S,BoolLiteral:g,DateLiteral:T,RangeLiteral:L,SetLiteral:O,Field:d,BaseEltTypes:f,FIELD_EXTRACT_FN_MAP:h.j,parseBaseElement:function(t,e){if(a.L.STRING_LITERAL_RE.test(t))return new p(t,e);if(a.L.INT_LITERAL_RE.test(t))return new S(t);if(a.L.BOOL_LITERAL_RE.test(t))return new g(t);if(a.L.DATE_LITERAL_RE.test(t))return new T(t);if(a.L.RANGE_LITERAL_RE.test(t))return new L(t,e);if(a.L.SET_LITERAL_RE.test(t))return new O(t,e);if(a.L.SEASON_LITERAL_RE.test(t))return new p(t,e,[l.Season]);if(a.L.FIELD_WORD_LITERAL_RE.test(t))return new d(t);throw new o.A.ValidationError(`Invalid base element: '${t}' ; could not be parsed as a Field or Literal.`)},COLLECTION_FIELDS_SET:E};const C={">":(t,e)=>t>e,"<":(t,e)=>t<e,"=":(t,e)=>t===e,">=":(t,e)=>t>=e,"<=":(t,e)=>t<=e,"!=":(t,e)=>t!==e},D="in",v="compare";class P{}class F extends P{type=D;opStr;negate=!1;constructor(t=!1){super(),this.negate=t,this.opStr=this.negate?"!in":"in"}call(t,e){const n=Array.isArray(e)?e.includes(t):e.has(t);return this.negate?!n:n}}class b extends P{type=v;opStr;compareFn;constructor(t){if(super(),this.opStr=t,this.compareFn=C[t],!this.compareFn)throw new Error(`Unknown operator: ${t}`)}call(t,e){return this.compareFn(t,e)}}function x(t){switch(t){case"in":return new F;case"!in":return new F(!0);default:return new b(t)}}const B={AND:"and",OR:"or",XOR:"xor",NOT:"not",LAST_N:"last-n",EQUIPMENT:"equipment",ARTIFACT:"artifact",CR:"cr",BASE_FILTER:"base-filter"},M="CLAUSE_FN",U="HERO_LIST_FN",H="GLOBAL_FN",$="BASE_FILTER";class k{}class j extends k{}class G extends j{fnType=M;fns=[];constructor(...t){super(),this.fns=t}asString(t=""){let e="";const n=t+c.RG;return this.fns.forEach(t=>e+=`${t.asString(n)},\n`),`${t}${this.fnName}(\n${e.trimEnd()}\n${t})`}}class K extends G{fnName=B.AND;fnType=M;call(t){return this.fns.every(e=>e.call(t))}}class V extends G{fnName=B.OR;fnType=M;call(t){return this.fns.some(e=>e.call(t))}}class W extends G{fnName=B.XOR;fnType=M;call(t){let e=!1;for(let n of this.fns)e=!e&&n.call(t)||e&&!n.call(t);return e}}class Y extends G{fnName=B.NOT;fnType=M;constructor(...t){if(super(...t),1!==this.fns.length)throw new o.A.SyntaxException(`Invalid NOT function call ; accepts exactly 1 argument ; got: [${this.fns}]`)}call(t){return!this.fns[0].call(t)}}class q extends j{fnType=U;getHeroes(t){return this.isPlayer1?t[s.Lx.P1_PICKS]:t[s.Lx.P2_PICKS]}asString(t=""){return`${t}${this.isPlayer1?"p1.":"p2."}${this.fnName}(${this.argFmtString})`}}class J extends q{fnName=B.CR;fnType=U;heroName;crThreshold=0;operator;targetField;isPlayer1=!1;argFmtString;constructor(t,e){super();const n=t.includes(",")?",":" ",r=o.A.tokenizeWithNestedEnclosures(t,n,1,!0);if(3!==r.length)throw new o.A.SyntaxException(`Invalid CR function call ; accepts exactly 3 arguments ; got: [${r}] from str: ${t}`);const a=parseInt(r[2]);if(isNaN(a))throw new o.A.TypeException(`Invalid CR function call ; third argument must be a valid integer literal ; got: '${r[2]}' from str: ${t}`);const i=x(r[1]);if(!(i instanceof b))throw new o.A.TypeException(`Invalid CR function call ; second argument must be a valid comparison operator ; got: '${r[1]}' from str: ${t}`);this.heroName=new I.StringLiteral(r[0],e,[l.Hero]).data,this.crThreshold=a,this.operator=i,this.isPlayer1=t.includes("p1."),this.targetField=t=>t[s.Lx.CR_BAR],this.argFmtString=`${this.heroName} ${this.operator.opStr} ${this.crThreshold}`}call(t){const e=this.getHeroes(t),n=this.targetField(t).find(t=>t[0]===this.heroName);return!!n&&(!!e.includes(this.heroName)&&this.operator.call(n[1],this.crThreshold))}}function Q(t,e){for(const n in t)if(t[n]>(e[n]||0))return!1;return!0}class z extends q{fnName=B.EQUIPMENT;fnType=U;heroName;targetEquipCounts;isPlayer1=!1;argFmtString;targetField;constructor(t,e){super();const n=o.A.tokenizeWithNestedEnclosures(t,",",1,!0);if(2!==n.length)throw new o.A.SyntaxException(`Invalid equipment function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${t}`);const a=n[1].includes("{")?n[1]:`{${n[1]}}`;let i=o.A.tokenizeWithNestedEnclosures(a,",",1,!0);i=i.map(t=>new I.StringLiteral(t,e,[l.Equipment]).data),this.targetEquipCounts=(0,r.J)(i),this.heroName=new I.StringLiteral(n[0],e,[l.Hero]).data,this.isPlayer1=t.includes("p1."),this.argFmtString=`${this.heroName}, {${i.join(",")}}`,this.targetField=t=>this.isPlayer1?t[s.Lx.P1_EQUIPMENT]:t[s.Lx.P2_EQUIPMENT]}call(t){const e=this.getHeroes(t),n=this.targetField(t);for(let t=0;t<e.length;t++)if(e[t]===this.heroName){const e=(0,r.J)(n[t]);return Q(this.targetEquipCounts,e)}return!1}}class X extends q{fnName=B.ARTIFACT;fnType=U;heroName;targetArtifacts;isPlayer1=!1;argFmtString;targetField;constructor(t,e){super();const n=o.A.tokenizeWithNestedEnclosures(t,",",1,!0);if(2!==n.length)throw new o.A.SyntaxException(`Invalid artifact function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${t}`);const r=n[1].includes("{")?n[1]:`{${n[1]}}`;let a=o.A.tokenizeWithNestedEnclosures(r,",",1,!0);a=a.map(t=>new I.StringLiteral(t,e,[l.Artifact]).data),this.targetArtifacts=a,this.heroName=new I.StringLiteral(n[0],e,[l.Hero]).data,this.isPlayer1=t.includes("p1."),this.argFmtString=`${this.heroName}, {${a.join(", ")}}`,this.targetField=t=>this.isPlayer1?t[s.Lx.P1_ARTIFACTS]:t[s.Lx.P2_ARTIFACTS]}call(t){const e=this.getHeroes(t),n=this.targetField(t);for(let t=0;t<e.length;t++)if(e[t]===this.heroName)return this.targetArtifacts.some(e=>n[t].includes(e));return!1}}class Z extends k{fnType=H;asString(t=""){return`${t}${this.fnName}(${this.argFmtString})`}}class tt extends Z{fnName=B.LAST_N;fnType=H;argFmtString;n;constructor(t){super();const e=o.A.tokenizeWithNestedEnclosures(t,",",1,!0);if(1!==e.length)throw new o.A.SyntaxException(`Invalid last-n function call ; accepts exactly 1 argument ; got: [${e}] from str: ${t}`);this.n=new I.IntLiteral(e[0]).data,this.argFmtString=`${this.n}`}call(t){return t.slice(-this.n)}}function et(t,e,n){const r=`${t.asString()} ${e.opStr} ${n.asString()}`;if(t instanceof I.Field&&n instanceof I.Field)throw new o.A.ValidationError(`Invalid base filter; fields cannot be compared with other fields ; got string: [${r}]`);if(t.type!==I.BaseEltTypes.FIELD&&n.type!==I.BaseEltTypes.FIELD)throw new o.A.ValidationError(`Invalid base filter; every base filter must have at least one field ; got string: [${r}]`);if(e instanceof F&&(s=n,!(I.COLLECTION_FIELDS_SET.has(s.rawString)||n instanceof I.RangeLiteral||n instanceof I.SetLiteral)))throw new o.A.ValidationError(`Invalid base filter; 'in' operators can only be used with Ranges, Sets, or Fields that correspond to sets like 'p1.picks' ; got string: [${r}]`);var s;return!0}class nt extends j{fnType=$;fnName=B.BASE_FILTER;fmtString;fn;constructor(t,e){super();const n=o.A.tokenizeWithNestedEnclosures(t," ",0,!0);if(3!==n.length)throw new o.A.SyntaxException(`Invalid base filter; filters must have 3 tokens and be of the form: ['X', operator, 'Y']; got tokens: [${n}] from str: ${t}`);let[r,s,a]=n;const i=x(s),c=I.parseBaseElement(r,e),u=I.parseBaseElement(a,e);if(c.asString(),u.asString(),et(c,i,u),c instanceof I.Field&&!(u instanceof I.Field))this.fn=t=>i.call(c.extractData(t),u.getData());else{if(c instanceof I.Field||!(u instanceof I.Field))throw new o.A.ValidationError("Invalid base filter; filters must contain a Field and a Literal; got: "+t);this.fn=t=>i.call(c.getData(),u.extractData(t))}this.fmtString=`${c.asString()} ${s} ${u.asString()}`}call(t){return this.fn(t)}asString(t=""){return`${t}${this.fmtString}`}}const rt={[B.BASE_FILTER]:nt,[B.AND]:K,[B.OR]:V,[B.NOT]:Y,[B.XOR]:W,[B.LAST_N]:tt,[B.EQUIPMENT]:z,[B.ARTIFACT]:X,[B.CR]:J},st={AND:K,OR:V,NOT:Y,XOR:W,LAST_N:tt,EQUIPMENT:z,ARTIFACT:X,CR:J,BASE_FILTER:nt}},54:(t,e,n)=>{n.d(e,{A:()=>E});var r=n(207);class s extends Error{constructor(t){super(t),this.name="Filter Syntax Exception"}}class a extends Error{constructor(t){super(t),this.name="Filter Type Exception"}}class o extends Error{constructor(t){super(t),this.name="Filter Validation Error"}}const i={"(":")","{":"}",'"':'"',"'":"'"},c={"'":'"','"':"'"},u=Object.fromEntries(Object.entries(i).filter(([t,e])=>t!==e).map(([t,e])=>[e,t]));function l(t){const e={};for(const n of t)e[n]=(e[n]||0)+1;return e}function h(t){return new Date(`${t}T00:00:00Z`)}const E={SyntaxException:s,TypeException:a,ValidationError:o,getCharCounts:l,tokenizeWithNestedEnclosures:function(t,e=" ",n=0,r=!0){const a=[];let o="",h=[];for(let E=0;E<t.length;E++){const f=t[E];if(e.includes(f)&&h.length===n)o&&(a.push(r?o.trim():o),o="");else if(u[f]){const e=u[f];if(h.length>n&&(o+=f),h[h.length-1]!==e){const e=l(t);throw(e["'"]||0)%2!=0||(e['"']||0)%2!=0?new s(`Error tokenizing: Unbalanced closing character at position ${E}; got string: '${t}' ; if a str type has quote characters in it, wrap it in the opposite quote character.`):new s(`Error tokenizing: Unbalanced closing character at position ${E}; got string: '${t}'`)}h.pop()}else h.length>=n&&(o+=f),!i[f]||c[f]&&h[h.length-1]===c[f]||(h[h.length-1]===i[f]&&f===i[f]?h.pop():h.push(f))}if(h.length>0)throw new Error(`Unbalanced enclosures in input string; unresolved characters from enclosure stack: [ ${h.join(", ")} ]`);return o&&a.push(r?o.trim():o),a},parseDate:function(t){if(!r.L.DATE_LITERAL_RE.test(t))throw new s(`Invalid date; must be in the format: YYYY-MM-DD ( regex: ${r.L.DATE_LITERAL_RE.source} ); got: '${t}'`);const e=h(t);if(isNaN(e.getTime()))throw new s(`Invalid date; could not be parsed as a valid date; got: '${t}'`);const n=e.toISOString().split("T")[0],[a,o,i]=n.split("-").map(Number);if(e.getUTCFullYear()!==a||e.getUTCMonth()+1!==o||e.getUTCDate()!==i)throw new s(`Invalid date; parsed date: ${e.toISOString()} does not match passed in string: ${t}`);return e.toISOString(),e.constructor.name,e},tryConvert:function(t,e,n,r=null){null===r&&(r=`Could not convert ${n} to ${e}`);try{return t(n)}catch(t){throw new a(`${r}: ${t.message}`)}},trimSurroundingQuotes:function(t){return t.replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")},castStringToUTCDate:h}},82:(t,e,n)=>{n.d(e,{j:()=>c});var r=n(836),s=n(412),a=n(771);function o(t,e,n){const r={user:t,filterStr:n,battles:{headers:[],rows:[]}};var a;return r.battles=(a=Object.values(e),{headers:s.se,rows:a.map(t=>s.se.map(e=>JSON.stringify(t[e])))}),r}function i(t){if(!t||"object"!=typeof t)throw new Error("Invalid upload: data is null, undefined, or not an object");if(!("user"in t))throw new Error("Invalid upload: missing 'user' field");if((0,a.l)(t.user),!("battles"in t))throw new Error("Invalid upload: missing 'battles' field");return function(t){if(!t||"object"!=typeof t)return!1;if(!("headers"in t)||!Array.isArray(t.headers))throw new Error("Invalid upload: missing headers field");if(t.headers.length!==s.se.length)throw new Error(`Invalid upload: expected ${s.se.length} headers, got ${t.headers.length}`);for(let e=0;e<s.se.length;e++)if(s.se[e]!==t.headers[e])throw new Error(`Invalid upload: headers do not match at index ${e}; expected ${s.se[e]}, got ${t.headers[e]}`);if(!("rows"in t)||!Array.isArray(t.rows))throw new Error("Invalid upload: missing rows field or rows is not an array");if(0===t.rows.length)throw new Error("Invalid upload: uploaded data has no battles");for(let e=0;e<t.rows.length;e++){const n=t.rows[e];if(n.length!==s.se.length)throw new Error(`Invalid upload: expected ${s.se.length} columns per row, got ${n.length} at index ${e}`)}}(t.battles),!0}const c={triggerDownload:async function(){const t=await r.n.UserManager.getUser();if(!t)throw new Error("User not found; cannot export data without an active user");const e=await r.n.ClientCache.getStats(),n=await r.n.ClientCache.getFilterStr()||void 0,s=e.areFiltersApplied?" Filtered":"";let a=e.areFiltersApplied?Object.values(e.filteredBattlesObj):e.battles;a=a||[];const i=await o(t,a,n),c=(new Date).toISOString().split("T")[0]||"";!function(t,e){const n=JSON.stringify(e),r=new Blob([n],{type:"application/json"}),s=URL.createObjectURL(r),a=document.createElement("a");a.href=s,a.download=t.endsWith(".json")?t:`${t}.json`,a.click(),URL.revokeObjectURL(s)}(`${t.name} (${t.id})${s} ${c}`,i)},parseJSON:async function(t){!function(t,e=".json",n=60){if(!t.name.endsWith(".json"))throw new Error("File must be .json");const r=1024*n*1024;if(t.size>r)throw new Error(`File must be smaller than ${n}mb, got ${t.size/1048576}mb File.`)}(t);const e=await t.text(),n=JSON.parse(e);return i(n),n},restructureParsedUploadBattles:function(t){const e=[];for(const n of t.rows){const t={};s.se.forEach((e,r)=>{t[e]=n[r]}),e.push(t)}return function(t){const e=new Set(t.map(t=>t[s.Lx.P1_ID])),n=new Set(t.map(t=>t[s.Lx.P1_SERVER]));if(1!==e.size)throw new Error(`Invalid upload: Multiple P1 IDs found in upload: {${Array.from(e).join(", ")}}`);if(1!==n.size)throw new Error(`Invalid upload: Multiple P1 Servers found in upload: {${Array.from(n).join(", ")}}`);const r=n.values().next().value?.replace(/"|'/g,"");if(!r||!Object.values(s.DB).includes(r))throw new Error(`Invalid upload: Invalid P1 Server found in upload: '${r}'`)}(e),e}}},84:(t,e,n)=>{n.d(e,{S:()=>E});var r=n(834),s=n(528),a=n(207),o=n(469),i=n(42),c=n(971),u=n(54),l=n(545);function h(t){return function(t,e,n){for(let r of t)if(!e.has(r))throw new u.A.SyntaxException(`Invalid character within <${n}> ; ' ${r} ' is not allowed; got string: '${t}'`)}(t=t.replace(/[\n\t\r]/g," ").replace(/\s+/g," "),c.yL,"Main Filter String"),t=t.toLowerCase()}class E{_filters;rawString;preParsedString;references;constructor(){this._filters=[],this.rawString="",this.preParsedString="",this.references={HeroDicts:null,ARTIFACT_LOWERCASE_STRINGS_MAP:{},SEASON_DETAILS:[]}}async addReferences(t=null){if(null===(t=t||await s.A.getHeroDicts()))throw new Error("Hero Manager could not be retrieved to parse filters.");const e=await o.A.getSeasonDetails();if(null===e)throw new Error("Season Details could not be retrieved to parse filters.");const n=await r.A.getArtifactLowercaseNameMap();this.references={HeroDicts:t,ARTIFACT_LOWERCASE_STRINGS_MAP:n,SEASON_DETAILS:e}}getFilters(){return function(t){const e=[],n=[];for(const r of t)r instanceof i.y4?e.push(r):n.push(r);return[...e,...n]}(this._filters)}asString(){const t=c.RG;return`[\n${this._filters.map(e=>e.asString(t)).join(";\n")};\n]`}static async getFiltersFromCache(t=null){const e=await l.A.get(l.A.Keys.FILTER_STR);if(null===e)return[];return(await this.fromFilterStr(e,t)).getFilters()}static async fromFilterStr(t,e=null){const n=new E;return n.rawString=t,await n.addReferences(e),n.preParsedString=h(t),n._filters=n.parse(n.preParsedString),n}parseList(t){return t.reduce((t,e)=>(t.push(...this.parse(e)),t),[])}parse(t){if(""===(t=t.trim()))return[];if(t.includes(";")){const e=t.split(";");return this.parseList(e)}const e=t.split("(")[0].replace(/p[1-2]\./i,""),n=u.A.tokenizeWithNestedEnclosures(t,",",1,!0);switch(e){case i.eR.AND:case i.eR.OR:case i.eR.NOT:case i.eR.XOR:const r=function(t,e){for(const n of t)if(n instanceof i.y4)throw new u.A.SyntaxException(`Global filters not allowed in clause functions; got: ${n.asString()} from string: "${e}"`);return t.filter(t=>t instanceof i.Qo)}(this.parseList(n),t);return[new i.CO[e](...r)];case i.eR.LAST_N:return[new i.c2.LAST_N(t)];case i.eR.EQUIPMENT:case i.eR.ARTIFACT:case i.eR.CR:return[new i.CO[e](t,this.references)];default:if(a.L.FUNCTION_CALL_RE.test(t))throw new u.A.SyntaxException(`Filter String is not a valid function call but a parenthese block was detected; got: ${t}`);return[new i.c2.BASE_FILTER(t,this.references)]}}}},92:(t,e,n)=>{function r(t){return t.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())}function s(t){return t.reduce((t,e)=>(t[e]=(t[e]||0)+1,t),{})}n.d(e,{J:()=>s,S:()=>r})},136:(t,e,n)=>{n.d(e,{A:()=>s});var r=n(545);const s={ACTIONS:{CLEAR_USER:"CLEAR_USER",SHOW_NO_USER_MSG:"SHOW_NO_USER_MSG",SHOW_DATA_ALREADY_CLEARED_MSG:"SHOW_DATA_ALREADY_CLEARED_MSG",QUERY_USER:"QUERY_USER",REFRESH_REFERENCES:"REFRESH_REFERENCES"},getState:async function(){return await r.A.get(r.A.Keys.INTER_PAGE_MANAGER)??{actions:[],messages:[]}},setState:async function(t){await r.A.cache(r.A.Keys.INTER_PAGE_MANAGER,t)},pushActions:async function(t){let e=await this.getState();e.actions.push(...t),await this.setState(e)},pushAction:async function(t){let e=await this.getState();e.actions.push(t),await this.setState(e)},makeAction:function(t,e){return{action:t,message:e}},flushState:async function(){const t=await this.getState();return await r.A.delete(r.A.Keys.INTER_PAGE_MANAGER),t}}},149:(t,e,n)=>{n.d(e,{W:()=>s});var r=n(836);const s={changeLang:async function(t){await r.n.ClientCache.setLang(t),await r.n.HeroManager.fetchAndCacheHeroManager(t),window.location.reload()},getLang:async function(){return await r.n.ClientCache.getLang()}}},172:(t,e,n)=>{n.d(e,{GF:()=>f,ev:()=>h});var r=n(494);n(623);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function c(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var l={RED:"text-danger",GREEN:"text-safe",E_BLUE:"text-e-blue"},h=c(function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=e,this.docElement=n,this.classList=r});function E(t){if(!t instanceof h)throw new Error("Only instances of TextPacket can be passed to this function")}var f={queue:[],autoClearElements:[],TextPacket:h,STYLES:l,clearStyles:function(t){for(var e=0,n=Object.values(l);e<n.length;e++){var r=n[e];t.classList.remove(r)}},write:function(t){E(t),t.docElement.textContent=t.text,this.clearStyles(t.docElement),t.classList.forEach(function(e){t.docElement.classList.add(e)})},writeStr:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.write(new h(t,e,n))},writeStrFromID:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=r.K.unwrapHtmlElt(e);this.writeStr(t,s,n)},push:function(t){E(t),this.queue.push(t)},pushFromObj:function(t){var e=t.text,n=t.docElement,r=t.classList;this.push(new h(e,n,r))},bindAutoClear:function(t){var e,n=a(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.autoClearElements.push(r)}}catch(t){n.e(t)}finally{n.f()}},processQueue:function(){var t=this;this.queue.forEach(function(e){t.write(e)}),this.queue=[]},clearMessages:function(){var t,e=a(this.autoClearElements);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.textContent="",this.clearStyles(n)}}catch(t){e.e(t)}finally{e.f()}}}},207:(t,e,n)=>{n.d(e,{L:()=>x});var r=n(833);function s(t,e="i"){return new RegExp(`^(?:${t.source})(?=[,)\\s;]|$)`,e)}function a(t,e="i"){return new RegExp(`^(?:${t.source})$`,e)}function o(t,e="i"){if(t.length<1)throw new Error("orRegex must have at least one pattern");let n=`(?:${t[0].source})`;for(let e=1;e<t.length;e++)n+=`|(?:${t[e].source})`;return new RegExp(n,e)}const i=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=Object.keys(r.j),u=new RegExp(`^(?:${c.map(i).join("|")})`,"i"),l=new RegExp(`(?:${["and","or","xor","not"].map(i).join("|")})(?=\\()`,"i"),h=new RegExp(`(?:${["last-n"].map(i).join("|")})(?=\\()`,"i"),E=new RegExp(`(?:${["p1.equipment","p2.equipment","p1.artifact","p2.artifact","p1.cr","p2.cr"].map(i).join("|")})(?=\\()`,"i"),f=o([l,h,E]),_=/.*/i,d=/\d{4}-\d{2}-\d{2}/,A=/\{\s*\}/,p=/-?\d+/,S=/season-[1-9]+[0-9]*f?|current-season|last-season/i,g=/pvp_rta_ss[1-9]+[0-9]*f?/i,T=new RegExp(`^${d.source}$`,"i"),R=new RegExp(`(?:${S.source})`,"i"),m=_.source,w=p.source,L=d.source,N=u.source,y=R.source,O=/"[^"]*"|'[^']*'/i,I=a(O),C=new RegExp(`(?:${O.source}|${m}|${L})`,"i"),D=new RegExp(`(?:${N}|${y})`,"i"),v=C.source,P=new RegExp(`\\{\\s*(?:${v}\\s*)(?:,\\s*${v}\\s*)*,?\\s*\\}|${A.source}`,"i"),F=new RegExp(`${w}\\.\\.\\.=?${w}|${L}\\.\\.\\.=?${L}`),b=new RegExp(`^${F.source}$`);let x={STRING_RE:_,DATE_RE:d,INT_RE:p,EMPTY_SET_RE:A,SET_ELEMENT_RE:C,SET_RE:P,SET_LITERAL_RE:a(P),STRING_LITERAL_RE:I,DATE_LITERAL_RE:T,INT_LITERAL_RE:/^-?\d+$/,BOOL_LITERAL_RE:/^(true|false)$/i,RANGE_RE:F,RANGE_LITERAL_RE:b,SEASON_RE:S,SEASON_LITERAL_RE:a(S),SEASON_CODE_RE:g,SEASON_CODE_LITERAL_RE:a(g),DATA_WORD_RE:R,DATA_WORD_LITERAL_RE:a(R),FIELD_WORD_RE:u,FIELD_WORD_LITERAL_RE:a(u),DATAFIELD_RE:D,GLOBAL_FILTER_RE:/last-n\(\d+\)/i,ANCHORED_STR_LITERAL_RE:a(I),CLAUSE_FUNCTIONS_RE:l,DIRECT_FUNCTIONS_RE:E,GLOBAL_FUNCTIONS_RE:h,FUNCTIONS_RE:f,FUNCTION_CALL_RE:/\(.*\)/i,padRegex:s,anchorExp:a,tokenMatch:function(t){return function(t){return t.match(f)?"keyword":t.match(/\s+(?:!=|<|>|=|>=|<=|in|!in)(?=\s+)/i)?"operator":t.match(new RegExp(`[a-z0-9."'}=)-]${D.source}(?=[,)\\s;]|$)`,"i"))?null:t.match(s(u))?"field":t.match(s(R))?"declared-data":t.match(s(O))?"string":t.match(s(P))?"set":t.match(s(F))?"range":t.match(/[^(,\s;.=0-9\-]+\d+/i)?null:t.match(s(p))||t.match(s(d))||t.match(/(?:^|\s)(?:true|false)(?=[,)\s;]|$)/i)?"declared-data":t.match(/[\(\)\{\}\;\,]/)?"bracket":(t.next(),null)}(t)},orRegex:o,escapeRegex:i}},275:(t,e,n)=>{function r(){var t,e,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,a,o){var i=r&&r.prototype instanceof u?r:u,l=Object.create(i.prototype);return s(l,"_invoke",function(n,r,s){var a,o,i,u=0,l=s||[],h=!1,E={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return a=e,o=0,i=t,E.n=n,c}};function f(n,r){for(o=n,i=r,e=0;!h&&u&&!s&&e<l.length;e++){var s,a=l[e],f=E.p,_=a[2];n>3?(s=_===r)&&(i=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=t):a[0]<=f&&((s=n<2&&f<a[1])?(o=0,E.v=r,E.n=a[1]):f<_&&(s=n<3||a[0]>r||r>_)&&(a[4]=n,a[5]=r,E.n=_,o=0))}if(s||n>1)return c;throw h=!0,r}return function(s,l,_){if(u>1)throw TypeError("Generator is already running");for(h&&1===l&&f(l,_),o=l,i=_;(e=o<2?t:i)||!h;){a||(o?o<3?(o>1&&(E.n=-1),f(o,i)):E.n=i:E.v=i);try{if(u=2,a){if(o||(s="next"),e=a[s]){if(!(e=e.call(a,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,o<2&&(o=0)}else 1===o&&(e=a.return)&&e.call(a),o<2&&(i=TypeError("The iterator does not provide a '"+s+"' method"),o=1);a=t}else if((e=(h=E.n<0)?i:n.call(r,E))!==c)break}catch(e){a=t,o=1,i=e}finally{u=1}}return{value:e,done:h}}}(n,a,o),!0),l}var c={};function u(){}function l(){}function h(){}e=Object.getPrototypeOf;var E=[][a]?e(e([][a]())):(s(e={},a,function(){return this}),e),f=h.prototype=u.prototype=Object.create(E);function _(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,s(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return l.prototype=h,s(f,"constructor",h),s(h,"constructor",l),l.displayName="GeneratorFunction",s(h,o,"GeneratorFunction"),s(f),s(f,o,"Generator"),s(f,a,function(){return this}),s(f,"toString",function(){return"[object Generator]"}),(r=function(){return{w:i,m:_}})()}function s(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}s=function(t,e,n,r){if(e)a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var o=function(e,n){s(t,e,function(t){return this._invoke(e,n,t)})};o("next",0),o("throw",1),o("return",2)}},s(t,e,n,r)}function a(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,s)}function o(t){return function(){var e=this,n=arguments;return new Promise(function(r,s){var o=t.apply(e,n);function i(t){a(o,r,s,i,c,"next",t)}function c(t){a(o,r,s,i,c,"throw",t)}i(void 0)})}}n.d(e,{A:()=>f});var i,c,u,l,h,E;const f={test:function(t){t.rank_plot},fetchFromPython:(E=o(r().m(function t(e){var n,s;return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch(e);case 1:if((n=t.v).ok){t.n=3;break}return t.n=2,fetch(e);case 2:n=t.v;case 3:return t.n=4,n.json();case 4:return s=t.v,t.a(2,s||null)}},t)})),function(t){return E.apply(this,arguments)}),fetchHeroData:(h=o(r().m(function t(){return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.fetchFromPython("/api/get_hero_data");case 1:return t.a(2,t.v)}},t,this)})),function(){return h.apply(this,arguments)}),rsFetchBattleData:(l=o(r().m(function t(e){return r().w(function(t){for(;;)switch(t.n){case 0:if(e){t.n=1;break}throw new Error("Must pass user to fetch battles data");case 1:return t.n=2,fetch("/api/rs_get_battle_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e})});case 2:return t.a(2,t.v)}},t)})),function(t){return l.apply(this,arguments)}),fetchSeasonDetails:(u=o(r().m(function t(){var e,n,s;return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("/api/get_season_details");case 1:return e=t.v,t.n=2,e.json();case 2:if(!(n=t.v).success){t.n=3;break}return s=JSON.parse(n.seasonDetails),t.a(2,{seasonDetails:s,error:!1});case 3:return t.a(2,{seasonDetails:null,error:n.error});case 4:return t.a(2)}},t)})),function(){return u.apply(this,arguments)}),fetchArtifactJson:(c=o(r().m(function t(){var e,n,s;return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("/api/get_artifact_json");case 1:return e=t.v,t.n=2,e.json();case 2:if(!(n=t.v).success){t.n=3;break}return s=JSON.parse(n.artifactJson),t.a(2,s);case 3:return t.a(2,null);case 4:return t.a(2)}},t)})),function(){return c.apply(this,arguments)}),fetchUser:(i=o(r().m(function t(e){var n,s,a;return r().w(function(t){for(;;)switch(t.n){case 0:if(e.name&&e.world_code||e.id){t.n=1;break}throw new Error("Must pass a user object with either user.name and user.world_code or user.id to fetch user");case 1:return t.n=2,fetch("/api/get_user_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userData:e})});case 2:return n=t.v,t.n=3,n.json();case 3:if(s=t.v,n.ok){t.n=4;break}throw new Error("Flask server error: ".concat(s.error));case 4:if(s.foundUser){t.n=6;break}if(e.world_code){t.n=5;break}return t.a(2,{user:null,ok:!0});case 5:return t.a(2,{user:null,ok:!0});case 6:return a=s.user,"Found user: ".concat(JSON.stringify(a)),t.a(2,{user:a,ok:!0})}},t)})),function(t){return i.apply(this,arguments)})}},412:(t,e,n)=>{n.d(e,{$k:()=>i,D5:()=>f,DB:()=>o,F4:()=>_,F7:()=>a,Lx:()=>h,W4:()=>d,WB:()=>s,Yj:()=>r,hc:()=>u,pc:()=>l,pg:()=>c,se:()=>E});const r={CODES:{DE:"de",KO:"ko",PT:"pt",TH:"th",ZH_TW:"zh-TW",JA:"ja",EN:"en",FR:"fr",ZH_CN:"zh-CN",ES:"es"},NAMES:{DE:"German",KO:"Korean",PT:"Portuguese",TH:"Thai",ZH_TW:"Chinese (Traditional, Taiwan)",JA:"Japanese",EN:"English",FR:"French",ZH_CN:"Chinese (Simplified, China)",ES:"Spanish"}},s=new Set(["world_kor","world_global","world_jpn","world_asia","world_eu"]),a={GLOBAL:"world_global",KOR:"world_kor",JPN:"world_jpn",ASIA:"world_asia",EU:"world_eu"},o={[a.GLOBAL]:"Global",[a.KOR]:"Korea",[a.JPN]:"Japan",[a.ASIA]:"Asia",[a.EU]:"Europe"},i=(o.world_global,a.GLOBAL,o.world_kor,a.KOR,o.world_jpn,a.JPN,o.world_asia,a.ASIA,o.world_eu,a.EU,Object.fromEntries(Object.values(o).map(t=>[t.toLowerCase(),t]))),c={set_speed:"Speed",set_acc:"Hit",set_cri:"Critical",set_res:"Resist",set_def:"Defense",set_att:"Attack",set_max_hp:"Health",set_cri_dmg:"Destruction",set_coop:"Unity",set_immune:"Immunity",set_rage:"Rage",set_vampire:"Lifesteal",set_shield:"Protection",set_revenge:"Revenge",set_penetrate:"Penetration",set_torrent:"Torrent",set_counter:"Counter",set_scar:"Injury",set_revenant:"Reversal",set_riposte:"Riposte"},u=864e5,l={bronze:"Bronze",silver:"Silver",gold:"Gold",master:"Master",challenger:"Challenger",champion:"Champion",warlord:"Warlord",emperor:"Emperor",legend:"Legend"},h={SEASON:"Season",SEASON_CODE:"Season Code",DATE_TIME:"Date/Time",SECONDS:"Seconds",TURNS:"Turns",SEQ_NUM:"Seq Num",P1_ID:"P1 ID",P1_SERVER:"P1 Server",P2_ID:"P2 ID",P2_SERVER:"P2 Server",P1_LEAGUE:"P1 League",P2_LEAGUE:"P2 League",P1_POINTS:"P1 Points",POINT_GAIN:"Point Gain",WIN:"Win",FIRST_PICK:"First Pick",FIRST_TURN:"First Turn",FIRST_TURN_HERO:"First Turn Hero",CR_BAR:"CR Bar",P1_PREBANS:"P1 Prebans",P2_PREBANS:"P2 Prebans",P1_PICKS:"P1 Picks",P2_PICKS:"P2 Picks",P1_POSTBAN:"P1 Postban",P2_POSTBAN:"P2 Postban",P1_EQUIPMENT:"P1 Equipment",P2_EQUIPMENT:"P2 Equipment",P1_ARTIFACTS:"P1 Artifacts",P2_ARTIFACTS:"P2 Artifacts",P1_MVP:"P1 MVP",P2_MVP:"P2 MVP"},E=(Object.values(h).filter(t=>!t.toLowerCase().includes("prime")),Object.values(h).filter(t=>!t.toLowerCase().includes("prime"))),f=(h.P1_EQUIPMENT,h.P2_EQUIPMENT,h.P1_ARTIFACTS,h.P2_ARTIFACTS,h.CR_BAR,h.P1_PREBANS,h.P2_PREBANS,h.P1_PICKS,h.P2_PICKS,h.FIRST_PICK,h.FIRST_TURN,h.WIN,h.SECONDS,h.TURNS,h.P1_POINTS,h.POINT_GAIN,h.P1_LEAGUE,h.P2_LEAGUE,{HERO_NAME:"Hero Name",BATTLES:"Battles",PICK_RATE:"Pick Rate",WINS:"Wins",WIN_RATE:"Win rate",POSTBANS:"Postbans",POSTBAN_RATE:"Postban Rate",SUCCESS_RATE:"Success Rate",PLUS_MINUS:"+/-",POINT_GAIN:"Point Gain",AVG_CR:"Avg CR",FIRST_TURNS:"First Turns",FIRST_TURN_RATE:"First Turn Rate"}),_="https://epic7.onstove.com",d=_+"/gg"},469:(t,e,n)=>{n.d(e,{A:()=>c});var r=n(545),s=n(275),a=n(412),o=n(207);let i={fetchAndCacheSeasonDetails:async function(){const t=await s.A.fetchSeasonDetails();if(t.error)throw new Error(`Could not fetch season details: ${t.error}`);const e=t.seasonDetails;e.forEach(t=>{t.range=[t.Start,t.End].map(t=>new Date(`${t.split(" ")[0]}T00:00:00`)),t["Season Number"]=String(t["Season Number"])}),e.sort((t,e)=>parseInt(t["Season Number"])-parseInt(e["Season Number"]));const n=[e[0]];let o=e[0];if(e.slice(1).forEach(t=>{const[e,r]=[new Date(+o.range[1]+a.hc),new Date(+t.range[0]-a.hc)],s=o["Season Number"]+"f",i={"Season Number":s,Code:"pvp_rta_ss"+s,Season:`Pre ${t.Season}`,Start:e.toISOString().slice(0,10),End:r.toISOString().slice(0,10),Status:"Complete",range:[e,r]};n.push(i),n.push(t),o=t}),o.range[1]<new Date){const t=new Date(+o.range[1]+a.hc),e=o["Season Number"]+"f",r={"Season Number":e,Code:"pvp_rta_ss"+e,Season:"Active Pre-Season",Start:t.toISOString().slice(0,10),End:"N/A",Status:"Active",range:[t,new Date]};n.push(r)}return n.reverse(),await r.A.cache(r.A.Keys.SEASON_DETAILS,n),n},getSeasonDetails:async function(){const t=await r.A.get(r.A.Keys.SEASON_DETAILS);return t||await i.fetchAndCacheSeasonDetails()},clearSeasonDetails:async function(){await r.A.delete(r.A.Keys.SEASON_DETAILS)},getSeasonNumFromCode:function(t){return t.split("_").at(-1)},reaquireIfNeeded:async function(t){const e=await i.getSeasonDetails(),n=new Set(e.map(t=>t.Code));t.forEach(t=>{const e=t[a.Lx.SEASON_CODE];o.L.SEASON_CODE_LITERAL_RE.test(e)||console.error("Battle contains invalid season code:",e,t),n.has(t[a.Lx.SEASON_CODE])||i.fetchAndCacheSeasonDetails()})}};const c=i},494:(t,e,n)=>{n.d(e,{K:()=>r});const r={unwrapHtmlElt:function(t){const e=document.getElementById(t);if(null===e)throw new Error(`Could not find element with ID ${t}`);return e},setText:function(t,e){this.unwrapHtmlElt(t).textContent=e}}},497:(t,e,n)=>{n.d(e,{pq:()=>i});var r=n(545),s=(n(623),n(940),n(507));n(771),n(412);const a=new Set(Object.values(s.D));function o(t){return!!a.has(t)||(console.error(`Invalid page state: ${t}`),!1)}let i={getState:async function(){return await r.A.get(r.A.Keys.HOME_PAGE_STATE)??s.D.SELECT_DATA},setState:async function(t){o(t)&&await r.A.cache(r.A.Keys.HOME_PAGE_STATE,t)},resetState:async function(){await r.A.delete(r.A.Keys.HOME_PAGE_STATE)}}},507:(t,e,n)=>{n.d(e,{D:()=>r});const r={SELECT_DATA:"select-data",SHOW_STATS:"show-stats",LOAD_DATA:"load-data",HERO_INFO:"hero-info"}},528:(t,e,n)=>{n.d(e,{A:()=>u});var r=n(545),s=n(412),a=n(275),o=n(40);const i="~Fodder",c="~Empty";const u={getHeroDicts:async function(t=s.Yj.CODES.EN){const e=await r.A.get(r.A.Keys.HERO_MANAGER);return e||this.fetchAndCacheHeroManager(t)},createHeroManager:function(t){let e={heroes:[],Empty:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A"},Fodder:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A"},name_lookup:{},code_lookup:{}};return e.heroes=t,e=function(t){t.heroes.length;const e={attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:c},n={attribute_cd:"N/A",code:"N/A",grade:"2/3",job_cd:"N/A",name:i};return t.heroes.push(e),t.heroes.push(n),t.Fodder=n,t.Empty=e,t}(e),e=function(t){return t.name_lookup=t.heroes.reduce((t,e)=>(t[e.name.toLowerCase().replace(/\s+/g,"")]=e,t),{}),t.code_lookup=t.heroes.reduce((t,e)=>(t[e.code]=e,t),{}),t}(e),e},fetchHeroManager:async function(t=s.Yj.CODES.EN){const e=(await o.A.fetchHeroJSON()??await a.A.fetchHeroData())[t];return this.createHeroManager(e)},fetchAndCacheHeroManager:async function(t=s.Yj.CODES.EN){const e=await this.fetchHeroManager(t);return await r.A.cache(r.A.Keys.HERO_MANAGER,e),e},deleteHeroManager:async function(){await r.A.delete(r.A.Keys.HERO_MANAGER)},getHeroByName:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");if(!t)return e.Empty;const n=t.toLowerCase().replace(/\s+/g,"");return e.name_lookup[n]??null},getHeroByCode:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");return t?e.code_lookup[t]??null:e.Empty},EMPTY_NAME:c,FODDER_NAME:i}},545:(t,e,n)=>{n.d(e,{A:()=>G});const r=(t,e)=>e.some(e=>t instanceof e);let s,a;const o=new WeakMap,i=new WeakMap,c=new WeakMap;let u={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return o.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function l(t){u=t(u)}function h(t){return(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(_(this),e),f(this.request)}:function(...e){return f(t.apply(_(this),e))}}function E(t){return"function"==typeof t?h(t):(t instanceof IDBTransaction&&function(t){if(o.has(t))return;const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{e(),r()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});o.set(t,e)}(t),r(t,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,u):t)}function f(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{e(f(t.result)),r()},a=()=>{n(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",a)});return c.set(e,t),e}(t);if(i.has(t))return i.get(t);const e=E(t);return e!==t&&(i.set(t,e),c.set(e,t)),e}const _=t=>c.get(t);const d=["get","getKey","getAll","getAllKeys","count"],A=["put","add","delete","clear"],p=new Map;function S(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(p.get(e))return p.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=A.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!d.includes(n))return;const a=async function(t,...e){const a=this.transaction(t,s?"readwrite":"readonly");let o=a.store;return r&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&a.done]))[0]};return p.set(e,a),a}l(t=>({...t,get:(e,n,r)=>S(e,n)||t.get(e,n,r),has:(e,n)=>!!S(e,n)||t.has(e,n)}));const g=["continue","continuePrimaryKey","advance"],T={},R=new WeakMap,m=new WeakMap,w={get(t,e){if(!g.includes(e))return t[e];let n=T[e];return n||(n=T[e]=function(...t){R.set(this,m.get(this)[e](...t))}),n}};async function*L(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const n=new Proxy(e,w);for(m.set(n,e),c.set(n,_(e));e;)yield n,e=await(R.get(n)||e.continue()),R.delete(n)}function N(t,e){return e===Symbol.asyncIterator&&r(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===e&&r(t,[IDBIndex,IDBObjectStore])}l(t=>({...t,get:(e,n,r)=>N(e,n)?L:t.get(e,n,r),has:(e,n)=>N(e,n)||t.has(e,n)}));var y=n(412);async function O(t,e){const n=t.transaction(e,"readwrite");n.objectStore(e).clear(),await n.done}const I={USER:"current-user",BATTLES:"battles",RAW_UPLOAD:"raw-upload",STATS:"stats",FILTER_STR:"filter-str"},C={GLOBAL_USERS:"global-users",EU_USERS:"eu-users",ASIA_USERS:"asia-users",JPN_USERS:"jpn-users",KOR_USERS:"kor-users"},D={...C,ARTIFACTS:"artifacts",ARTIFACTS_LOWERCASE_NAMES_MAP:"artifacts-lowercase-names-map",ARTIFACT_OBJECT_LIST:"artifact-object-list",HERO_MANAGER:"hero-manager",SEASON_DETAILS:"season-details"},v={...I,...D,LANG:"lang",AUTO_ZOOM_FLAG:"auto-zoom",AUTO_QUERY_FLAG:"auto-query",ID_SEARCH_FLAG:"id-search",HOME_PAGE_STATE:"home-page-state",INTER_PAGE_MANAGER:"inter-page-manager"},P=864e5,F=2*P,b=3*(7*P),x=P,B=Object.values(D),M=Object.values(I).filter(t=>t!==I.FILTER_STR);function U(t){const[e,n]=t;return`[${new Date(e)}, ${n}]`}function H(t){return B.includes(t)?x:M.includes(t)?b:F}const $="DataStore",k="MetaStore";let j={consts:{DB_NAME:"E7ArenaStatsClientDB",DB_VERSION:1,STORE_NAME:$,META_STORE_NAME:k},Keys:{...v},MetaKeys:{TIMESTAMP:"timestamp"},loaded_UM:new Set,openDB:async function(){return await function(t,e,{blocked:n,upgrade:r,blocking:s,terminated:a}={}){const o=indexedDB.open(t,e),i=f(o);return r&&o.addEventListener("upgradeneeded",t=>{r(f(o.result),t.oldVersion,t.newVersion,f(o.transaction),t)}),n&&o.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),i.then(t=>{a&&t.addEventListener("close",()=>a()),s&&t.addEventListener("versionchange",t=>s(t.oldVersion,t.newVersion,t))}).catch(()=>{}),i}(j.consts.DB_NAME,j.consts.DB_VERSION,{upgrade(t){t.objectStoreNames.contains($)&&t.deleteObjectStore($),t.objectStoreNames.contains($)||t.createObjectStore($),t.objectStoreNames.contains(k)||t.createObjectStore(k)}})},get:async function(t){const e=await this.openDB(),n=await e.get($,t);if(!n)return null;return await this.checkCacheTimeout(t)?n:null},cache:async function(t,e){const n=await this.openDB();await n.put($,e,t),await this.setTimeoutDataNow(t)},delete:async function(t){const e=await this.openDB();await e.delete($,t),await this.deleteTimeoutData(t)},deleteDB:async function(){await indexedDB.deleteDatabase(this.consts.DB_NAME)},getTimeoutData:async function(t){const e=await this.openDB(),n=`${t+this.MetaKeys.TIMESTAMP}`;return await e.get(k,n)||null},setTimeoutData:async function(t,e){const n=await this.openDB(),r=`${t+this.MetaKeys.TIMESTAMP}`;await n.put(k,e,r)},setTimeoutDataNow:async function(t){const e=function(t){return[Date.now(),H(t)]}(t);await this.setTimeoutData(t,e)},deleteTimeoutData:async function(t){const e=await this.openDB(),n=`${t+this.MetaKeys.TIMESTAMP}`;await e.delete(k,n)},clearData:async function(){const t=await this.openDB();await O(t,$),await O(t,k)},clearUserData:async function(){const t=Object.values(I);await Promise.all(t.map(t=>this.delete(t)))},clearUserLists:async function(){const t=Object.values(C);await Promise.all(t.map(t=>this.delete(t)))},clearSeasonData:async function(){await this.delete(v.SEASON_DETAILS)},clearReferenceData:async function(){const t=Object.values(D);await Promise.all(t.map(t=>this.delete(t)))},checkCacheTimeout:async function(t){const e=await this.getTimeoutData(t),n=Date.now();if(!e)return!1;if(r=e,!Array.isArray(r)||2!==r.length||"number"!=typeof r[0]||"number"!=typeof r[1])return await this.delete(t),!1;var r;const[s,a]=e;return n-s>a?(U(e),new Date(n),await this.delete(t),!1):(U(e),new Date(n),H(t),e[0],!0)},getFilterStr:async function(){return await this.get(v.FILTER_STR)},setFilterStr:async function(t){await this.cache(v.FILTER_STR,t)},getLang:async function(){return await this.get(v.LANG)??y.Yj.CODES.EN},setLang:async function(t){await this.cache(v.LANG,t)},getStats:async function(){return await this.get(v.STATS)},setStats:async function(t){await this.cache(v.STATS,t)}};const G=j},623:(t,e,n)=>{n.d(e,{A:()=>l});var r=n(494);const s={SELECT_DATA_MSG:"select-data-msg",FILTER_MSG:"filterMSG",SELECT_DATA_BODY:"select-data-body",SHOW_STATS_BODY:"show-stats-body",LOAD_DATA_BODY:"load-data-body",HERO_INFO_BODY:"hero-info-body",HERO_INFO_CONTENT:"hero-info-content",HERO_DEFAULT_CONTENT:"default-content",LATEST_BATTLES_BTN:"latest-battles-btn",UPLOAD_FORM:"uploadForm",CSV_FILE:"csvFile",USER_QUERY_FORM_NAME:"user-query-form-name",USER_QUERY_FORM_SERVER:"user-query-form-server",AUTO_ZOOM_FLAG:"auto-zoom-flag",USER_NAME:"user-name",USER_ID:"user-id",USER_SERVER:"user-server",BATTLE_FILTER_TOGGLER:"filter-battle-table",ID_SEARCH_FLAG:"id-search-flag",SEASON_DETAILS_TBL:"season-details-tbl",PERFORMANCE_STATS_TBL:"performance-stats-tbl",FIRST_PICK_STATS_TBL:"first-pick-stats-tbl",PREBAN_STATS_TBL:"preban-stats-tbl",PLAYER_TBL:"player-tbl",OPPONENT_TBL:"opponent-tbl",BATTLES_TBL:"battles-tbl",RANK_PLOT:"rank-plot",SEARCH_INPUT:"searchInput",HERO_SEARCH_OPTIONS:"hero-option-list",HERO_PLAYER_TBL:"hero-player-tbl",HERO_OPPONENT_TBL:"hero-opponent-tbl"};class a{IDS=s;_SELECT_DATA_MSG=null;_FILTER_MSG=null;_SELECT_DATA_BODY=null;_SHOW_STATS_BODY=null;_LOAD_DATA_BODY=null;_HERO_INFO_BODY=null;_LATEST_BATTLES_BTN=null;_UPLOAD_FORM=null;_CSV_FILE=null;_USER_QUERY_FORM_NAME=null;_USER_QUERY_FORM_SERVER=null;_AUTO_ZOOM_FLAG=null;_FOOTER=null;_USER_NAME=null;_USER_ID=null;_USER_SERVER=null;_BATTLE_FILTER_TOGGLER=null;_ID_SEARCH_FLAG=null;_SEASON_DETAILS_TBL=null;_PERFORMANCE_STATS_TBL=null;_FIRST_PICK_STATS_TBL=null;_PREBAN_STATS_TBL=null;_PLAYER_TBL=null;_OPPONENT_TBL=null;_BATTLE_TBL=null;_RANK_PLOT=null;_HERO_PLAYER_TBL=null;_HERO_OPPONENT_TBL=null;_SEARCH_INPUT=null;_SEARCH_OPTIONS=null;getElt(t){return r.K.unwrapHtmlElt(t)}get SELECT_DATA_MSG(){return this._SELECT_DATA_MSG||=r.K.unwrapHtmlElt("select-data-msg")}get FILTER_MSG(){return this._FILTER_MSG||=r.K.unwrapHtmlElt("filterMSG")}get SELECT_DATA_BODY(){return this._SELECT_DATA_BODY||=r.K.unwrapHtmlElt("select-data-body")}get SHOW_STATS_BODY(){return this._SHOW_STATS_BODY||=r.K.unwrapHtmlElt("show-stats-body")}get LOAD_DATA_BODY(){return this._LOAD_DATA_BODY||=r.K.unwrapHtmlElt("load-data-body")}get HERO_INFO_BODY(){return this._HERO_INFO_BODY||=r.K.unwrapHtmlElt("hero-info-body")}get LATEST_BATTLES_BTN(){return this._LATEST_BATTLES_BTN||=r.K.unwrapHtmlElt("latest-battles-btn")}get UPLOAD_FORM(){return this._UPLOAD_FORM||=r.K.unwrapHtmlElt("uploadForm")}get CSV_FILE(){return this._CSV_FILE||=r.K.unwrapHtmlElt("csvFile")}get USER_QUERY_FORM_NAME(){return this._USER_QUERY_FORM_NAME||=r.K.unwrapHtmlElt("user-query-form-name")}get USER_QUERY_FORM_SERVER(){return this._USER_QUERY_FORM_SERVER||=r.K.unwrapHtmlElt("user-query-form-server")}get AUTO_ZOOM_FLAG(){return this._AUTO_ZOOM_FLAG||=r.K.unwrapHtmlElt("auto-zoom-flag")}get USER_NAME(){return this._USER_NAME||=r.K.unwrapHtmlElt("user-name")}get USER_ID(){return this._USER_ID||=r.K.unwrapHtmlElt("user-id")}get USER_SERVER(){return this._USER_SERVER||=r.K.unwrapHtmlElt("user-server")}get BATTLE_FILTER_TOGGLE(){return this._BATTLE_FILTER_TOGGLER||=r.K.unwrapHtmlElt("filter-battle-table")}get ID_SEARCH_FLAG(){return this._ID_SEARCH_FLAG||=r.K.unwrapHtmlElt("id-search-flag")}get SEASON_DETAILS_TBL(){return this._SEASON_DETAILS_TBL||=r.K.unwrapHtmlElt("season-details-tbl")}get PERFORMANCE_STATS_TBL(){return this._PERFORMANCE_STATS_TBL||=r.K.unwrapHtmlElt("performance-stats-tbl")}get FIRST_PICK_STATS_TBL(){return this._FIRST_PICK_STATS_TBL||=r.K.unwrapHtmlElt("first-pick-stats-tbl")}get PREBAN_STATS_TBL(){return this._PREBAN_STATS_TBL||=r.K.unwrapHtmlElt("preban-stats-tbl")}get PLAYER_TBL(){return this._PLAYER_TBL||=r.K.unwrapHtmlElt("player-tbl")}get OPPONENT_TBL(){return this._OPPONENT_TBL||=r.K.unwrapHtmlElt("opponent-tbl")}get BATTLES_TBL(){return this._BATTLE_TBL||=r.K.unwrapHtmlElt("battles-tbl")}get RANK_PLOT(){return this._RANK_PLOT||=r.K.unwrapHtmlElt("rank-plot")}get MESSAGE_ELEMENTS_LIST(){return[this.SELECT_DATA_MSG,this.FILTER_MSG]}get SEARCH_INPUT(){return this._SEARCH_INPUT||=r.K.unwrapHtmlElt("searchInput")}get HERO_SEARCH_OPTIONS(){return this._SEARCH_OPTIONS||=r.K.unwrapHtmlElt("hero-option-list")}get HERO_PLAYER_TBL(){return this._HERO_PLAYER_TBL||=r.K.unwrapHtmlElt("hero-player-tbl")}get HERO_OPPONENT_TBL(){return this._HERO_OPPONENT_TBL||=r.K.unwrapHtmlElt("hero-opponent-tbl")}}class o{_SIDEBAR_HIDE_BTN=null;get SIDEBAR_HIDE_BTN(){return this._SIDEBAR_HIDE_BTN||=r.K.unwrapHtmlElt("sidebar-hide")}_CLEAR_DATA_BTN=null;get CLEAR_DATA_BTN(){return this._CLEAR_DATA_BTN||=r.K.unwrapHtmlElt("clear-data-btn")}_EXPORT_CSV_BTN=null;get EXPORT_DATA_BTN(){return this._EXPORT_CSV_BTN||=r.K.unwrapHtmlElt("export-data-btn")}_OFFICIAL_SITE_BTN=null;get OFFICIAL_SITE_BTN(){return this._OFFICIAL_SITE_BTN||=r.K.unwrapHtmlElt("official-site-btn")}_USER_NAME=null;get USER_NAME(){return this._USER_NAME||=r.K.unwrapHtmlElt("user-name")}_USER_ID=null;get USER_ID(){return this._USER_ID||=r.K.unwrapHtmlElt("user-id")}_USER_SERVER=null;get USER_SERVER(){return this._USER_SERVER||=r.K.unwrapHtmlElt("user-server")}_SIDEBAR_CONTROL=null;get SIDEBAR_CONTROL(){return this._SIDEBAR_CONTROL||=r.K.unwrapHtmlElt("sidebar-control")}_REFRESH_REFERENCES_BTN=null;get REFRESH_REFERENCES_BTN(){return this._REFRESH_REFERENCES_BTN||=r.K.unwrapHtmlElt("refresh-references-btn")}}class i{_SEARCH_DOMAINS=null;get SEARCH_DOMAINS(){return this._SEARCH_DOMAINS||=r.K.unwrapHtmlElt("search-domains")}_SEARCH_SUBMIT_BTN=null;get SEARCH_SUBMIT_BTN(){return this._SEARCH_SUBMIT_BTN||=r.K.unwrapHtmlElt("search-submit-btn")}_SEARCH_FORM=null;get SEARCH_FORM(){return this._SEARCH_FORM||=r.K.unwrapHtmlElt("searchForm")}_SEARCH_TABLE_CONTAINER=null;get SEARCH_TABLE_CONTAINER(){return this._SEARCH_TABLE_CONTAINER||=r.K.unwrapHtmlElt("search-table-container")}}class c{_FILTER_SYNTAX_RULES_CONTAINER=null;get FILTER_SYNTAX_RULES_CONTAINER(){return this._FILTER_SYNTAX_RULES_CONTAINER||=r.K.unwrapHtmlElt("filter-syntax-rules-container")}_ALL_CONTENT_CONTAINER=null;get ALL_CONTENT_CONTAINER(){return this._ALL_CONTENT_CONTAINER||=r.K.unwrapHtmlElt("all-content-container")}}class u{IDS={OVERVIEW_CONTAINER:"overview-container",OVERVIEW_CARD:"overview-card",RETURN_BTN:"info-return-btn",RETURN_CONTAINER:"info-return-container",FILTER_SYNTAX_CONTAINER:"filter-syntax-rules-container",FILTER_EXAMPLES_AND_TEST_CONTAINER:"filter-syntax-examples-and-test-container",INFORMATION_CONTENT_LINKS_CONTAINER:"information-content-links-container",ALL_CONTENT_CONTAINER:"all-content-container",FILTER_OVERVIEW:"filter-rules-card",FIELD_SYNTAX:"fields-card",FUNCTION_SYNTAX:"functions-card",OPERATOR_SYNTAX:"operators-card",DATA_SYNTAX:"declared-data-card",STRUCTURAL_SYNTAX:"structural-syntax-card",EX_FILTER_1:"exFilter1",EX_FILTER_2:"exFilter2",EX_FILTER_3:"exFilter3",EX_FILTER_4:"exFilter4",EX_FILTER_5:"exFilter5",TEST_FILTER_FORM:"test-filter-form",TEST_FILTER_MESSAGE:"filterMSG",TEST_SYNTAX_CARD:"test-syntax-card",CHECK_SYNTAX_BTN:"check-syntax-btn"};_CACHE={};constructor(){this._CACHE={}}getFromId(t){return this._CACHE[t]||=r.K.unwrapHtmlElt(t)}}const l=new class{HOME_PAGE;NAV_BAR;SEARCH_PAGE;FILTER_SYNTAX_PAGE;INFO_PAGE;_BODY_FOOTER_CONTAINER=null;_FOOTER_WRAPPER=null;constructor(){this.HOME_PAGE=new a,this.NAV_BAR=new o,this.SEARCH_PAGE=new i,this.FILTER_SYNTAX_PAGE=new c,this.INFO_PAGE=new u}get BODY_FOOTER_CONTAINER(){return this._BODY_FOOTER_CONTAINER??=r.K.unwrapHtmlElt("body-footer-container")}get FOOTER_WRAPPER(){return this._FOOTER_WRAPPER||=r.K.unwrapHtmlElt("footer-wrapper")}}},654:(t,e,n)=>{n.d(e,{W:()=>at});var r=n(528),s=n(834),a=n(771),o=n(412);function i(t){return Array.isArray?Array.isArray(t):"[object Array]"===_(t)}function c(t){return"string"==typeof t}function u(t){return"number"==typeof t}function l(t){return!0===t||!1===t||function(t){return h(t)&&null!==t}(t)&&"[object Boolean]"==_(t)}function h(t){return"object"==typeof t}function E(t){return null!=t}function f(t){return!t.trim().length}function _(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const d=Object.prototype.hasOwnProperty;class A{constructor(t){this._keys=[],this._keyMap={};let e=0;t.forEach(t=>{let n=p(t);this._keys.push(n),this._keyMap[n.id]=n,e+=n.weight}),this._keys.forEach(t=>{t.weight/=e})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function p(t){let e=null,n=null,r=null,s=1,a=null;if(c(t)||i(t))r=t,e=S(t),n=g(t);else{if(!d.call(t,"name"))throw new Error((t=>`Missing ${t} property in key`)("name"));const o=t.name;if(r=o,d.call(t,"weight")&&(s=t.weight,s<=0))throw new Error((t=>`Property 'weight' in key '${t}' must be a positive integer`)(o));e=S(o),n=g(o),a=t.getFn}return{path:e,id:n,weight:s,src:r,getFn:a}}function S(t){return i(t)?t:t.split(".")}function g(t){return i(t)?t.join("."):t}var T={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,...{useExtendedSearch:!1,getFn:function(t,e){let n=[],r=!1;const s=(t,e,a)=>{if(E(t))if(e[a]){const o=t[e[a]];if(!E(o))return;if(a===e.length-1&&(c(o)||u(o)||l(o)))n.push(function(t){return null==t?"":function(t){if("string"==typeof t)return t;let e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(t)}(o));else if(i(o)){r=!0;for(let t=0,n=o.length;t<n;t+=1)s(o[t],e,a+1)}else e.length&&s(o,e,a+1)}else n.push(t)};return s(t,c(e)?e.split("."):e,0),r?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const R=/[^ ]+/g;class m{constructor({getFn:t=T.getFn,fieldNormWeight:e=T.fieldNormWeight}={}){this.norm=function(t=1,e=3){const n=new Map,r=Math.pow(10,e);return{get(e){const s=e.match(R).length;if(n.has(s))return n.get(s);const a=1/Math.pow(s,.5*t),o=parseFloat(Math.round(a*r)/r);return n.set(s,o),o},clear(){n.clear()}}}(e,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((t,e)=>{this._keysMap[t.id]=e})}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,c(this.docs[0])?this.docs.forEach((t,e)=>{this._addString(t,e)}):this.docs.forEach((t,e)=>{this._addObject(t,e)}),this.norm.clear())}add(t){const e=this.size();c(t)?this._addString(t,e):this._addObject(t,e)}removeAt(t){this.records.splice(t,1);for(let e=t,n=this.size();e<n;e+=1)this.records[e].i-=1}getValueForItemAtKeyId(t,e){return t[this._keysMap[e]]}size(){return this.records.length}_addString(t,e){if(!E(t)||f(t))return;let n={v:t,i:e,n:this.norm.get(t)};this.records.push(n)}_addObject(t,e){let n={i:e,$:{}};this.keys.forEach((e,r)=>{let s=e.getFn?e.getFn(t):this.getFn(t,e.path);if(E(s))if(i(s)){let t=[];const e=[{nestedArrIndex:-1,value:s}];for(;e.length;){const{nestedArrIndex:n,value:r}=e.pop();if(E(r))if(c(r)&&!f(r)){let e={v:r,i:n,n:this.norm.get(r)};t.push(e)}else i(r)&&r.forEach((t,n)=>{e.push({nestedArrIndex:n,value:t})})}n.$[r]=t}else if(c(s)&&!f(s)){let t={v:s,n:this.norm.get(s)};n.$[r]=t}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function w(t,e,{getFn:n=T.getFn,fieldNormWeight:r=T.fieldNormWeight}={}){const s=new m({getFn:n,fieldNormWeight:r});return s.setKeys(t.map(p)),s.setSources(e),s.create(),s}function L(t,{errors:e=0,currentLocation:n=0,expectedLocation:r=0,distance:s=T.distance,ignoreLocation:a=T.ignoreLocation}={}){const o=e/t.length;if(a)return o;const i=Math.abs(r-n);return s?o+i/s:i?1:o}const N=32;function y(t,e,n,{location:r=T.location,distance:s=T.distance,threshold:a=T.threshold,findAllMatches:o=T.findAllMatches,minMatchCharLength:i=T.minMatchCharLength,includeMatches:c=T.includeMatches,ignoreLocation:u=T.ignoreLocation}={}){if(e.length>N)throw new Error(`Pattern length exceeds max of ${N}.`);const l=e.length,h=t.length,E=Math.max(0,Math.min(r,h));let f=a,_=E;const d=i>1||c,A=d?Array(h):[];let p;for(;(p=t.indexOf(e,_))>-1;){let t=L(e,{currentLocation:p,expectedLocation:E,distance:s,ignoreLocation:u});if(f=Math.min(t,f),_=p+l,d){let t=0;for(;t<l;)A[p+t]=1,t+=1}}_=-1;let S=[],g=1,R=l+h;const m=1<<l-1;for(let r=0;r<l;r+=1){let a=0,i=R;for(;a<i;){L(e,{errors:r,currentLocation:E+i,expectedLocation:E,distance:s,ignoreLocation:u})<=f?a=i:R=i,i=Math.floor((R-a)/2+a)}R=i;let c=Math.max(1,E-i+1),p=o?h:Math.min(E+i,h)+l,T=Array(p+2);T[p+1]=(1<<r)-1;for(let a=p;a>=c;a-=1){let o=a-1,i=n[t.charAt(o)];if(d&&(A[o]=+!!i),T[a]=(T[a+1]<<1|1)&i,r&&(T[a]|=(S[a+1]|S[a])<<1|1|S[a+1]),T[a]&m&&(g=L(e,{errors:r,currentLocation:o,expectedLocation:E,distance:s,ignoreLocation:u}),g<=f)){if(f=g,_=o,_<=E)break;c=Math.max(1,2*E-_)}}if(L(e,{errors:r+1,currentLocation:E,expectedLocation:E,distance:s,ignoreLocation:u})>f)break;S=T}const w={isMatch:_>=0,score:Math.max(.001,g)};if(d){const t=function(t=[],e=T.minMatchCharLength){let n=[],r=-1,s=-1,a=0;for(let o=t.length;a<o;a+=1){let o=t[a];o&&-1===r?r=a:o||-1===r||(s=a-1,s-r+1>=e&&n.push([r,s]),r=-1)}return t[a-1]&&a-r>=e&&n.push([r,a-1]),n}(A,i);t.length?c&&(w.indices=t):w.isMatch=!1}return w}function O(t){let e={};for(let n=0,r=t.length;n<r;n+=1){const s=t.charAt(n);e[s]=(e[s]||0)|1<<r-n-1}return e}const I=String.prototype.normalize?t=>t.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):t=>t;class C{constructor(t,{location:e=T.location,threshold:n=T.threshold,distance:r=T.distance,includeMatches:s=T.includeMatches,findAllMatches:a=T.findAllMatches,minMatchCharLength:o=T.minMatchCharLength,isCaseSensitive:i=T.isCaseSensitive,ignoreDiacritics:c=T.ignoreDiacritics,ignoreLocation:u=T.ignoreLocation}={}){if(this.options={location:e,threshold:n,distance:r,includeMatches:s,findAllMatches:a,minMatchCharLength:o,isCaseSensitive:i,ignoreDiacritics:c,ignoreLocation:u},t=i?t:t.toLowerCase(),t=c?I(t):t,this.pattern=t,this.chunks=[],!this.pattern.length)return;const l=(t,e)=>{this.chunks.push({pattern:t,alphabet:O(t),startIndex:e})},h=this.pattern.length;if(h>N){let t=0;const e=h%N,n=h-e;for(;t<n;)l(this.pattern.substr(t,N),t),t+=N;if(e){const t=h-N;l(this.pattern.substr(t),t)}}else l(this.pattern,0)}searchIn(t){const{isCaseSensitive:e,ignoreDiacritics:n,includeMatches:r}=this.options;if(t=e?t:t.toLowerCase(),t=n?I(t):t,this.pattern===t){let e={isMatch:!0,score:0};return r&&(e.indices=[[0,t.length-1]]),e}const{location:s,distance:a,threshold:o,findAllMatches:i,minMatchCharLength:c,ignoreLocation:u}=this.options;let l=[],h=0,E=!1;this.chunks.forEach(({pattern:e,alphabet:n,startIndex:f})=>{const{isMatch:_,score:d,indices:A}=y(t,e,n,{location:s+f,distance:a,threshold:o,findAllMatches:i,minMatchCharLength:c,includeMatches:r,ignoreLocation:u});_&&(E=!0),h+=d,_&&A&&(l=[...l,...A])});let f={isMatch:E,score:E?h/this.chunks.length:1};return E&&r&&(f.indices=l),f}}class D{constructor(t){this.pattern=t}static isMultiMatch(t){return v(t,this.multiRegex)}static isSingleMatch(t){return v(t,this.singleRegex)}search(){}}function v(t,e){const n=t.match(e);return n?n[1]:null}class P extends D{constructor(t,{location:e=T.location,threshold:n=T.threshold,distance:r=T.distance,includeMatches:s=T.includeMatches,findAllMatches:a=T.findAllMatches,minMatchCharLength:o=T.minMatchCharLength,isCaseSensitive:i=T.isCaseSensitive,ignoreDiacritics:c=T.ignoreDiacritics,ignoreLocation:u=T.ignoreLocation}={}){super(t),this._bitapSearch=new C(t,{location:e,threshold:n,distance:r,includeMatches:s,findAllMatches:a,minMatchCharLength:o,isCaseSensitive:i,ignoreDiacritics:c,ignoreLocation:u})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class F extends D{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let e,n=0;const r=[],s=this.pattern.length;for(;(e=t.indexOf(this.pattern,n))>-1;)n=e+s,r.push([e,n-1]);const a=!!r.length;return{isMatch:a,score:a?0:1,indices:r}}}const b=[class extends D{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},F,class extends D{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},class extends D{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},class extends D{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},class extends D{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}},class extends D{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const e=-1===t.indexOf(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},P],x=b.length,B=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/;const M=new Set([P.type,F.type]);class U{constructor(t,{isCaseSensitive:e=T.isCaseSensitive,ignoreDiacritics:n=T.ignoreDiacritics,includeMatches:r=T.includeMatches,minMatchCharLength:s=T.minMatchCharLength,ignoreLocation:a=T.ignoreLocation,findAllMatches:o=T.findAllMatches,location:i=T.location,threshold:c=T.threshold,distance:u=T.distance}={}){this.query=null,this.options={isCaseSensitive:e,ignoreDiacritics:n,includeMatches:r,minMatchCharLength:s,findAllMatches:o,ignoreLocation:a,location:i,threshold:c,distance:u},t=e?t:t.toLowerCase(),t=n?I(t):t,this.pattern=t,this.query=function(t,e={}){return t.split("|").map(t=>{let n=t.trim().split(B).filter(t=>t&&!!t.trim()),r=[];for(let t=0,s=n.length;t<s;t+=1){const s=n[t];let a=!1,o=-1;for(;!a&&++o<x;){const t=b[o];let n=t.isMultiMatch(s);n&&(r.push(new t(n,e)),a=!0)}if(!a)for(o=-1;++o<x;){const t=b[o];let n=t.isSingleMatch(s);if(n){r.push(new t(n,e));break}}}return r})}(this.pattern,this.options)}static condition(t,e){return e.useExtendedSearch}searchIn(t){const e=this.query;if(!e)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:r,ignoreDiacritics:s}=this.options;t=r?t:t.toLowerCase(),t=s?I(t):t;let a=0,o=[],i=0;for(let r=0,s=e.length;r<s;r+=1){const s=e[r];o.length=0,a=0;for(let e=0,r=s.length;e<r;e+=1){const r=s[e],{isMatch:c,indices:u,score:l}=r.search(t);if(!c){i=0,a=0,o.length=0;break}if(a+=1,i+=l,n){const t=r.constructor.type;M.has(t)?o=[...o,...u]:o.push(u)}}if(a){let t={isMatch:!0,score:i/a};return n&&(t.indices=o),t}}return{isMatch:!1,score:1}}}const H=[];function $(t,e){for(let n=0,r=H.length;n<r;n+=1){let r=H[n];if(r.condition(t,e))return new r(t,e)}return new C(t,e)}const k="$and",j="$or",G="$path",K="$val",V=t=>!(!t[k]&&!t[j]),W=t=>({[k]:Object.keys(t).map(e=>({[e]:t[e]}))});function Y(t,e,{auto:n=!0}={}){const r=t=>{let s=Object.keys(t);const a=(t=>!!t[G])(t);if(!a&&s.length>1&&!V(t))return r(W(t));if((t=>!i(t)&&h(t)&&!V(t))(t)){const r=a?t[G]:s[0],o=a?t[K]:t[r];if(!c(o))throw new Error((t=>`Invalid value for key ${t}`)(r));const i={keyId:g(r),pattern:o};return n&&(i.searcher=$(o,e)),i}let o={children:[],operator:s[0]};return s.forEach(e=>{const n=t[e];i(n)&&n.forEach(t=>{o.children.push(r(t))})}),o};return V(t)||(t=W(t)),r(t)}function q(t,e){const n=t.matches;e.matches=[],E(n)&&n.forEach(t=>{if(!E(t.indices)||!t.indices.length)return;const{indices:n,value:r}=t;let s={indices:n,value:r};t.key&&(s.key=t.key.src),t.idx>-1&&(s.refIndex=t.idx),e.matches.push(s)})}function J(t,e){e.score=t.score}class Q{constructor(t,e={},n){this.options={...T,...e},this.options.useExtendedSearch,this._keyStore=new A(this.options.keys),this.setCollection(t,n)}setCollection(t,e){if(this._docs=t,e&&!(e instanceof m))throw new Error("Incorrect 'index' type");this._myIndex=e||w(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){E(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const e=[];for(let n=0,r=this._docs.length;n<r;n+=1){const s=this._docs[n];t(s,n)&&(this.removeAt(n),n-=1,r-=1,e.push(s))}return e}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:e=-1}={}){const{includeMatches:n,includeScore:r,shouldSort:s,sortFn:a,ignoreFieldNorm:o}=this.options;let i=c(t)?c(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return function(t,{ignoreFieldNorm:e=T.ignoreFieldNorm}){t.forEach(t=>{let n=1;t.matches.forEach(({key:t,norm:r,score:s})=>{const a=t?t.weight:null;n*=Math.pow(0===s&&a?Number.EPSILON:s,(a||1)*(e?1:r))}),t.score=n})}(i,{ignoreFieldNorm:o}),s&&i.sort(a),u(e)&&e>-1&&(i=i.slice(0,e)),function(t,e,{includeMatches:n=T.includeMatches,includeScore:r=T.includeScore}={}){const s=[];return n&&s.push(q),r&&s.push(J),t.map(t=>{const{idx:n}=t,r={item:e[n],refIndex:n};return s.length&&s.forEach(e=>{e(t,r)}),r})}(i,this._docs,{includeMatches:n,includeScore:r})}_searchStringList(t){const e=$(t,this.options),{records:n}=this._myIndex,r=[];return n.forEach(({v:t,i:n,n:s})=>{if(!E(t))return;const{isMatch:a,score:o,indices:i}=e.searchIn(t);a&&r.push({item:t,idx:n,matches:[{score:o,value:t,norm:s,indices:i}]})}),r}_searchLogical(t){const e=Y(t,this.options),n=(t,e,r)=>{if(!t.children){const{keyId:n,searcher:s}=t,a=this._findMatches({key:this._keyStore.get(n),value:this._myIndex.getValueForItemAtKeyId(e,n),searcher:s});return a&&a.length?[{idx:r,item:e,matches:a}]:[]}const s=[];for(let a=0,o=t.children.length;a<o;a+=1){const o=t.children[a],i=n(o,e,r);if(i.length)s.push(...i);else if(t.operator===k)return[]}return s},r=this._myIndex.records,s={},a=[];return r.forEach(({$:t,i:r})=>{if(E(t)){let o=n(e,t,r);o.length&&(s[r]||(s[r]={idx:r,item:t,matches:[]},a.push(s[r])),o.forEach(({matches:t})=>{s[r].matches.push(...t)}))}}),a}_searchObjectList(t){const e=$(t,this.options),{keys:n,records:r}=this._myIndex,s=[];return r.forEach(({$:t,i:r})=>{if(!E(t))return;let a=[];n.forEach((n,r)=>{a.push(...this._findMatches({key:n,value:t[r],searcher:e}))}),a.length&&s.push({idx:r,item:t,matches:a})}),s}_findMatches({key:t,value:e,searcher:n}){if(!E(e))return[];let r=[];if(i(e))e.forEach(({v:e,i:s,n:a})=>{if(!E(e))return;const{isMatch:o,score:i,indices:c}=n.searchIn(e);o&&r.push({score:i,key:t,value:e,idx:s,norm:a,indices:c})});else{const{v:s,n:a}=e,{isMatch:o,score:i,indices:c}=n.searchIn(s);o&&r.push({score:i,key:t,value:s,norm:a,indices:c})}return r}}Q.version="7.1.0",Q.createIndex=w,Q.parseIndex=function(t,{getFn:e=T.getFn,fieldNormWeight:n=T.fieldNormWeight}={}){const{keys:r,records:s}=t,a=new m({getFn:e,fieldNormWeight:n});return a.setKeys(r),a.setIndexRecords(s),a},Q.config=T,Q.parseQuery=Y,function(...t){H.push(...t)}(U);const z={GLOBAL_SERVER:"Global Server",KOR_SERVER:"Korea Server",JPN_SERVER:"Japan Server",ASIA_SERVER:"Asia Server",EU_SERVER:"Europe Server"},X={[z.GLOBAL_SERVER]:o.F7.GLOBAL,[z.KOR_SERVER]:o.F7.KOR,[z.JPN_SERVER]:o.F7.JPN,[z.ASIA_SERVER]:o.F7.ASIA,[z.EU_SERVER]:o.F7.EU},Z={[z.GLOBAL_SERVER]:"Global Server",[z.KOR_SERVER]:"Korea Server",[z.JPN_SERVER]:"Japan Server",[z.ASIA_SERVER]:"Asia Server",[z.EU_SERVER]:"Europe Server",HEROES:"Heroes",ARTIFACTS:"Artifacts"},tt={keys:["name"],threshold:.4},et={keys:["name"],threshold:.4},nt={keys:["name"],threshold:.4};function rt(t,e,n=null,r={}){let s={includeScore:!0,threshold:.3};s={...s,...r};let a=null;a=new Q(e,s);const o=a.search(t);return null!==n?o.slice(0,n):o}function st(t,e){return rt(t,e,null,et)}class at{static DOMAINS=Z;DOMAIN_CACHE={[z.GLOBAL_SERVER]:null,[z.KOR_SERVER]:null,[z.JPN_SERVER]:null,[z.ASIA_SERVER]:null,[z.EU_SERVER]:null,[Z.HEROES]:null,[Z.ARTIFACTS]:null};async get_domain(t){if(!this.DOMAIN_CACHE[t])if(Object.values(z).includes(t)){const e=t,n=await a.A.getUserMap(X[e]);this.DOMAIN_CACHE[e]=n?Object.values(n):[]}else if(t===Z.HEROES){const e=await r.A.getHeroDicts();this.DOMAIN_CACHE[t]=e.heroes}else if(t===Z.ARTIFACTS){const e=await s.A.getArtifactObjectList();this.DOMAIN_CACHE[t]=e}return await this.DOMAIN_CACHE[t]}async search(t,e){let n;switch(t){case z.GLOBAL_SERVER:case z.KOR_SERVER:case z.JPN_SERVER:case z.ASIA_SERVER:case z.EU_SERVER:return n=await this.get_domain(t),st(e,n);case Z.HEROES:return function(t,e){return rt(t,e,null,tt)}(e,await this.get_domain(t));case Z.ARTIFACTS:const r=await this.get_domain(t);return rt(e,r,null,nt);default:throw new Error(`Unknown domain: ${t}`)}}}},719:(t,e,n)=>{n.d(e,{A:()=>f});var r=n(545),s=n(913),a=n(528),o=n(834),i=n(412),c=n(92);function u(t,e,n){const r=t=>a.A.getHeroByCode(t,e)?.name??e.Fodder.name,s=(e,r)=>r.map((r,s)=>r?(t=>o.A.convertCodeToName(t,n)||"None")(r):((e,n)=>"p1"===e?t.p2_postban===t.p1_picks[n]:t.p1_postban===t.p2_picks[n])(e,s)?"n/a":"None");const u=t=>t.map(t=>t.map(t=>i.pg[t]||t)),l=t.cr_bar.find(t=>100===t[1]),h=!!l&&t.p1_picks.includes(l[0]);var E;return{[i.Lx.SEASON]:t.season_name||"None",[i.Lx.SEASON_CODE]:t.season_code||"None",[i.Lx.DATE_TIME]:t.date_time,[i.Lx.SECONDS]:t.seconds,[i.Lx.TURNS]:t.turns,[i.Lx.SEQ_NUM]:t.seq_num,[i.Lx.P1_ID]:t.p1_id.toString(),[i.Lx.P1_SERVER]:i.DB[t.p1_server]||t.p1_server||"None",[i.Lx.P2_ID]:t.p2_id.toString(),[i.Lx.P2_SERVER]:i.DB[t.p2_server]||t.p2_server||"None",[i.Lx.P1_LEAGUE]:(0,c.S)(t.p1_league)||"None",[i.Lx.P2_LEAGUE]:(0,c.S)(t.p2_league)||"None",[i.Lx.P1_POINTS]:t.p1_win_score,[i.Lx.POINT_GAIN]:t.p1_point_delta||null,[i.Lx.WIN]:1===t.win,[i.Lx.FIRST_PICK]:1===t.first_pick,[i.Lx.FIRST_TURN]:!!h,[i.Lx.FIRST_TURN_HERO]:l?r(l[0]):"n/a",[i.Lx.CR_BAR]:(E=t.cr_bar,E.map(t=>t&&2==t.length?[r(t[0]),t[1]]:["n/a",0])),[i.Lx.P1_PREBANS]:t.p1_prebans.map(r),[i.Lx.P2_PREBANS]:t.p2_prebans.map(r),[i.Lx.P1_PICKS]:t.p1_picks.map(r),[i.Lx.P2_PICKS]:t.p2_picks.map(r),[i.Lx.P1_POSTBAN]:r(t.p1_postban),[i.Lx.P2_POSTBAN]:r(t.p2_postban),[i.Lx.P1_EQUIPMENT]:u(t.p1_equipment),[i.Lx.P2_EQUIPMENT]:u(t.p2_equipment),[i.Lx.P1_ARTIFACTS]:s("p1",t.p1_artifacts),[i.Lx.P2_ARTIFACTS]:s("p2",t.p2_artifacts),[i.Lx.P1_MVP]:r(t.p1_mvp),[i.Lx.P2_MVP]:r(t.p2_mvp)}}function l(t){let e=function(t){for(const[e,n]of Object.entries(i.pg))t[i.Lx.P1_EQUIPMENT]=t[i.Lx.P1_EQUIPMENT].replaceAll(e,n),t[i.Lx.P2_EQUIPMENT]=t[i.Lx.P2_EQUIPMENT].replaceAll(e,n);return t}(t);return Object.fromEntries(Object.entries(e).map(([t,e])=>[t,JSON.parse(e)]))}var h=n(42);function E(t,e){const n=e.filter(t=>t instanceof h.Qo),r=e.filter(t=>t instanceof h.y4);for(let e of r)e.asString(),t=e.call(t);for(let e of n)e.asString(),t=t.filter(t=>e.call(t));return t}const f={loaded_servers:new Set,getBattles:async function(){const t=await r.A.get(r.A.Keys.BATTLES)??null;return r.A.setTimeoutDataNow(r.A.Keys.BATTLES),t},applyFilters:E,extendBattles:async function(t){const e={...await r.A.get(r.A.Keys.BATTLES)??{},...this.sortBattlesObj(t)};return await r.A.cache(r.A.Keys.BATTLES,e),e},cacheQuery:async function(t,e,n){if(!t)return[];t.length;const r=function(t,e,n){n=n??o.A.getArtifactCodeToNameMap();let r=[];for(const s of t){let t=u(s,e,n);r.push([t["Seq Num"],t])}return Object.fromEntries(r)}(t,e,n);return await this.extendBattles(r)},cacheUpload:async function(t,e){if(!t)return console.error("No uploaded battles provided to cacheUpload"),{};const n=function(t){const e=t.map(t=>l(t));return Object.fromEntries(e.map(t=>[t[i.Lx.SEQ_NUM],t]))}(t);return await this.extendBattles(n)},getStats:async function(t,e,n){const r=e.length,a=Object.values(t),o=E(a,e),c=r>0,u=await s.A.getPrebanStats(o,n),l=await s.A.getFirstPickStats(o,n),h=await s.A.getGeneralStats(o),f=await s.A.getHeroStats(o,n),_=await s.A.getPerformanceStats(o);return{battles:a,filteredBattlesObj:Object.fromEntries(o.map(t=>[t[i.Lx.SEQ_NUM],t])),prebanStats:u,generalStats:h,firstPickStats:l,playerHeroStats:f.playerHeroStats,enemyHeroStats:f.enemyHeroStats,performanceStats:_,numFilters:r,areFiltersApplied:c}},sortBattlesList:function(t,e=!0){const n=i.Lx.DATE_TIME;return e?t.sort((t,e)=>+new Date(t[n])-+new Date(e[n])):t.sort((t,e)=>+new Date(e[n])-+new Date(t[n]))},sortBattlesObj:function(t,e=!0){const n=i.Lx.DATE_TIME;if(e){let e=Object.values(t).sort((t,e)=>+new Date(t[n])-+new Date(e[n]));return Object.fromEntries(e.map(t=>[t[i.Lx.SEQ_NUM],t]))}{let e=Object.values(t).sort((t,e)=>+new Date(e[n])-+new Date(t[n]));return Object.fromEntries(e.map(t=>[t[i.Lx.SEQ_NUM],t]))}}}},758:(t,e,n)=>{n.a(t,async(t,e)=>{try{var r=n(654),s=n(870),a=n(940),o=n(874),i=n(623),c=n(771),u=n(136);function f(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function a(n,r,s,a){var c=r&&r.prototype instanceof i?r:i,u=Object.create(c.prototype);return _(u,"_invoke",function(n,r,s){var a,i,c,u=0,l=s||[],h=!1,E={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return a=e,i=0,c=t,E.n=n,o}};function f(n,r){for(i=n,c=r,e=0;!h&&u&&!s&&e<l.length;e++){var s,a=l[e],f=E.p,_=a[2];n>3?(s=_===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=f&&((s=n<2&&f<a[1])?(i=0,E.v=r,E.n=a[1]):f<_&&(s=n<3||a[0]>r||r>_)&&(a[4]=n,a[5]=r,E.n=_,i=0))}if(s||n>1)return o;throw h=!0,r}return function(s,l,_){if(u>1)throw TypeError("Generator is already running");for(h&&1===l&&f(l,_),i=l,c=_;(e=i<2?t:c)||!h;){a||(i?i<3?(i>1&&(E.n=-1),f(i,c)):E.n=c:E.v=c);try{if(u=2,a){if(i||(s="next"),e=a[s]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+s+"' method"),i=1);a=t}else if((e=(h=E.n<0)?c:n.call(r,E))!==o)break}catch(e){a=t,i=1,c=e}finally{u=1}}return{value:e,done:h}}}(n,s,a),!0),u}var o={};function i(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(_(e={},r,function(){return this}),e),h=u.prototype=i.prototype=Object.create(l);function E(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,_(t,s,"GeneratorFunction")),t.prototype=Object.create(h),t}return c.prototype=u,_(h,"constructor",u),_(u,"constructor",c),c.displayName="GeneratorFunction",_(u,s,"GeneratorFunction"),_(h),_(h,s,"Generator"),_(h,r,function(){return this}),_(h,"toString",function(){return"[object Generator]"}),(f=function(){return{w:a,m:E}})()}function _(t,e,n,r){var s=Object.defineProperty;try{s({},"",{})}catch(t){s=0}_=function(t,e,n,r){if(e)s?s(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){_(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},_(t,e,n,r)}function d(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,s)}function A(t){return function(){var e=this,n=arguments;return new Promise(function(r,s){var a=t.apply(e,n);function o(t){d(a,r,s,o,i,"next",t)}function i(t){d(a,r,s,o,i,"throw",t)}o(void 0)})}}var l="search-table",h=new r.W,E=["Name","ID","Search Score","Raw Search Result"];function p(t){return S.apply(this,arguments)}function S(){return(S=A(f().m(function t(e){var n,r;return f().w(function(t){for(;;)switch(t.n){case 0:if((n=JSON.parse(e["Raw Search Result"])).world_code){t.n=1;break}return t.a(2);case 1:return t.n=2,c.A.findUser({id:n.id,world_code:n.world_code});case 2:if(null!==(r=t.v)){t.n=3;break}throw new Error("User not found:",n);case 3:return t.n=4,c.A.clearUserData();case 4:return t.n=5,c.A.setUser(r);case 5:u.A.pushAction({action:u.A.ACTIONS.QUERY_USER}),o.Su.navToHome();case 6:return t.a(2)}},t)}))).apply(this,arguments)}function g(){var t=$("#".concat(l)).DataTable({layout:{},language:{},searching:!1,order:[[2,"asc"]],columnDefs:[{targets:"_all",className:"nowrap"}],buttons:{},pageLength:50,scrollY:"200px",deferRender:!0,scroller:!0,scrollCollapse:!1,columns:Object.values(E).map(function(t){return{data:t}})});$("#".concat(l," tbody")).on("click","tr",A(f().m(function e(){var n;return f().w(function(e){for(;;)switch(e.n){case 0:return n=t.row(this).data(),e.n=1,p(n);case 1:return e.a(2)}},e,this)})))}function T(t){return{Name:t.item.name,ID:t.item.id||t.item.code,"Search Score":t.score.toFixed(4),"Raw Search Result":JSON.stringify(t.item)}}function R(){var t=i.A.SEARCH_PAGE.SEARCH_FORM;t.addEventListener("submit",function(){var e=A(f().m(function e(n){var r,a,o,i,c;return f().w(function(e){for(;;)switch(e.n){case 0:return n.preventDefault(),r=new FormData(t),a=r.get("searchTerm"),o=r.get("searchDomain"),e.n=1,h.search(o,a);case 1:i=e.v,c=(c=i.map(T)).slice(0,5e3),s.A.replaceData(l,c);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}())}function m(){return w.apply(this,arguments)}function w(){return(w=A(f().m(function t(){return f().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.Su.initialize();case 1:g(),R(),a.A.setVisibility(i.A.BODY_FOOTER_CONTAINER,!0);case 2:return t.a(2)}},t)}))).apply(this,arguments)}await m(),e()}catch(L){e(L)}},1)},771:(t,e,n)=>{n.d(e,{A:()=>f,l:()=>c});var r=n(412),s=n(545),a=n(40),o=n(275);const i={[r.F7.GLOBAL]:s.A.Keys.GLOBAL_USERS,[r.F7.EU]:s.A.Keys.EU_USERS,[r.F7.ASIA]:s.A.Keys.ASIA_USERS,[r.F7.JPN]:s.A.Keys.JPN_USERS,[r.F7.KOR]:s.A.Keys.KOR_USERS};function c(t){if(!t)throw new Error("Invalid user; user is null or undefined");if(!("id"in t)||"number"!=typeof t.id)throw new Error("Invalid user; user id does not exist or is not a number");if(!("name"in t)||"string"!=typeof t.name)throw new Error("Invalid user; user name does not exist or is not a string");if(!("world_code"in t)||"string"!=typeof t.world_code)throw new Error("Invalid user; user.world_code does not exist or is not a string");if(!(t.world_code in r.DB))throw new Error("Invalid user; user.world_code is not a valid world code");return!0}function u(t,e){return{id:Number(t.nick_no),name:t.nick_nm,code:t.code||null,rank:Number(t.rank),world_code:e}}async function l(t){const e=await s.A.get(i[t]);if(null!==e)return e;const n=await async function(t){const e=await a.A.fetchUserJSON(t);if(!e||"object"==typeof e&&!("users"in e))return null;const n=e;return Object.fromEntries(n.users.map(e=>[e.nick_no,u(e,t)]))}(t);return await s.A.cache(i[t],n),n}const h=t=>r.DB[t];async function E(t,e){const n=await l(e),r=n?Object.values(n):[];if(0===r.length)return h(e),{user:null,ok:!1};let s,a;if(t.id)s=t.id,a=t=>t.id;else{if(!t.name)throw new Error("Must pass a user object with either user.name or user.id to find user");s=t.name.toLowerCase(),a=t=>t.name.toLowerCase()}return function(t,e,n){const r=e.find(e=>n(e)===t);return r?(JSON.stringify(r),{user:r,ok:!0}):{user:null,ok:!0}}(s,r,a)}const f={getUserMap:l,findUser:async function(t){if(JSON.stringify(t),!t.name&&!t.id||!t.world_code)throw new Error("Must pass a user object with either user.name or user.id, and user.world_code to find user");let e=t.id?`Numeric ID: ${t.id}`:`Name: '${t.name}'`,n=null;if(n=await E(t,t.world_code),n.ok||(n=await o.A.fetchUser(t)),n.ok){const r=n.user;if(null===r)throw new Error(`Could not find user with ${e} in Server: ${h(t.world_code)}`);return r}throw new Error(`Function did not properly terminate: ${JSON.stringify(n)}`)},setUser:async function(t){await s.A.cache(s.A.Keys.USER,t)},getUser:async function(){const t=await s.A.get(s.A.Keys.USER);return await s.A.setTimeoutDataNow(s.A.Keys.USER),t},clearUserData:async function(){await s.A.clearUserData()},clearUserDataLists:async function(){await s.A.clearUserLists()}}},833:(t,e,n)=>{n.d(e,{j:()=>a});var r=n(412),s=n(54);const a={date:t=>t[r.Lx.DATE_TIME]?s.A.castStringToUTCDate(t[r.Lx.DATE_TIME].split(" ")[0]).getTime():"N/A",season:t=>t[r.Lx.SEASON_CODE],"is-first-pick":t=>!!t[r.Lx.FIRST_PICK],"is-win":t=>!!t[r.Lx.WIN],"victory-points":t=>t[r.Lx.P1_POINTS],"p1.picks":t=>t[r.Lx.P1_PICKS],"p2.picks":t=>t[r.Lx.P2_PICKS],"p1.prebans":t=>t[r.Lx.P1_PREBANS],"p2.prebans":t=>t[r.Lx.P2_PREBANS],"p1.postban":t=>t[r.Lx.P1_POSTBAN],"p2.postban":t=>t[r.Lx.P2_POSTBAN],postbans:t=>[t[r.Lx.P1_POSTBAN],t[r.Lx.P2_POSTBAN]],prebans:t=>[...t[r.Lx.P1_PREBANS],...t[r.Lx.P2_PREBANS]],"p1.pick1":t=>t[r.Lx.P1_PICKS][0],"p1.pick2":t=>t[r.Lx.P1_PICKS][1],"p1.pick3":t=>t[r.Lx.P1_PICKS][2],"p1.pick4":t=>t[r.Lx.P1_PICKS][3],"p1.pick5":t=>t[r.Lx.P1_PICKS][4],"p2.pick1":t=>t[r.Lx.P2_PICKS][0],"p2.pick2":t=>t[r.Lx.P2_PICKS][1],"p2.pick3":t=>t[r.Lx.P2_PICKS][2],"p2.pick4":t=>t[r.Lx.P2_PICKS][3],"p2.pick5":t=>t[r.Lx.P2_PICKS][4],"p1.league":t=>t[r.Lx.P1_LEAGUE],"p2.league":t=>t[r.Lx.P2_LEAGUE],"p1.server":t=>t[r.Lx.P1_SERVER],"p2.server":t=>t[r.Lx.P2_SERVER],"p1.id":t=>Number(t[r.Lx.P1_ID]),"p2.id":t=>Number(t[r.Lx.P2_ID]),"p1.mvp":t=>t[r.Lx.P1_MVP],"p2.mvp":t=>t[r.Lx.P2_MVP],"is-first-turn":t=>!!t[r.Lx.FIRST_TURN],"first-turn-hero":t=>t[r.Lx.FIRST_TURN_HERO],turns:t=>t[r.Lx.TURNS],seconds:t=>t[r.Lx.SECONDS],"point-gain":t=>t[r.Lx.POINT_GAIN]}},834:(t,e,n)=>{n.d(e,{A:()=>o});var r=n(545),s=n(40),a=n(275);const o={async getArtifactCodeToNameMap(){let t=await r.A.get(r.A.Keys.ARTIFACTS);return t||(t=await this.fetchAndCacheArtifacts()),t},getArtifactLowercaseNameMap:async function(){let t=await r.A.get(r.A.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP);if(null!==t)return t;const e=await this.getArtifactCodeToNameMap();return t=Object.fromEntries(Object.values(e).filter(t=>null!==t).map(t=>[t.toLowerCase(),t])),await r.A.cache(r.A.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP,t),t},getArtifactObjectList:async function(){let t=await r.A.get(r.A.Keys.ARTIFACT_OBJECT_LIST);if(null!==t)return t;const e=await this.getArtifactCodeToNameMap();return t=Object.entries(e).map(([t,e])=>({id:t,name:e})),await r.A.cache(r.A.Keys.ARTIFACT_OBJECT_LIST,t),t},fetchAndCacheArtifacts:async function(){const t=await async function(){let t=await s.A.fetchArtifactJSON("en");return null===t&&(t=await a.A.fetchArtifactJson()),null===t?(console.error("Could not get artifact Json map from E7 server or flask server"),null):Object.fromEntries(t.filter(t=>null!==t.name).map(t=>[t.code,t.name]))}();return null===t?{}:(await r.A.cache(r.A.Keys.ARTIFACTS,t),t)},clearArtifactData:async function(){await r.A.delete(r.A.Keys.ARTIFACTS)},convertCodeToName:function(t,e){return e[t]||t}}},836:(t,e,n)=>{n.d(e,{n:()=>l});var r=n(528),s=n(719),a=n(469),o=n(545),i=n(771),c=n(834),u=n(149);let l={HeroManager:r.A,BattleManager:s.A,SeasonManager:a.A,UserManager:i.A,ClientCache:o.A,ArtifactManager:c.A,LangManager:u.W}},870:(t,e,n)=>{n.d(e,{A:()=>r});const r={destroyDataTable:function(t){const e=$(`#${t}`);$.fn.dataTable.isDataTable(e)&&e.DataTable().clear().destroy()},replaceData:function(t,e){$(`#${t}`).DataTable().clear().rows.add(e).draw()}}},874:(t,e,n)=>{n.d(e,{Su:()=>S});var r=n(497),s=n(412),a=n(771),o=n(623),i=n(136),c=n(836),u=n(149),l=n(82),h=n(507);function E(){window.location.href=URL_UTILS.HOME_PAGE_URL}function f(){document.querySelectorAll(".nav-link").forEach(t=>{t.addEventListener("click",async function(e){if(!("dataset"in t)||!t.dataset||"object"!=typeof t.dataset||!("nav"in t.dataset))return;const n=t.dataset.nav;if(Object.values(h.D).includes(n))if(n===h.D.SELECT_DATA)await r.pq.setState(h.D.SELECT_DATA),E();else if(n===h.D.HERO_INFO)await r.pq.setState(h.D.HERO_INFO),E();else if(n===h.D.SHOW_STATS){await a.A.getUser()?(await r.pq.setState(h.D.SHOW_STATS),E()):(await r.pq.setState(h.D.SELECT_DATA),await i.A.pushAction({message:"Active user not found; you must either query a valid user or upload battles to view hero stats.",action:i.A.ACTIONS.SHOW_NO_USER_MSG}),E())}})})}function _(){o.A.NAV_BAR.CLEAR_DATA_BTN.addEventListener("click",async function(){await a.A.getUser()?(await r.pq.setState(h.D.SELECT_DATA),await i.A.pushAction({action:i.A.ACTIONS.CLEAR_USER})):(await r.pq.setState(h.D.SELECT_DATA),await i.A.pushAction({action:i.A.ACTIONS.SHOW_DATA_ALREADY_CLEARED_MSG})),E()})}function d(){[o.A.NAV_BAR.CLEAR_DATA_BTN,o.A.NAV_BAR.EXPORT_DATA_BTN,o.A.NAV_BAR.OFFICIAL_SITE_BTN].forEach(t=>{t.addEventListener("touchstart",()=>{t.classList.add("touch-hover"),setTimeout(()=>t.classList.remove("touch-hover"),150)})})}function A(t,e="en"){t?(o.A.NAV_BAR.USER_NAME.innerText=t.name,o.A.NAV_BAR.USER_ID.innerText=`${t.id}`,o.A.NAV_BAR.USER_SERVER.innerText=s.DB[t.world_code],o.A.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(function(t,e){const n=`${s.F4}/${e}/gg/battlerecord/${t.world_code}/${t.id}`;return n}(t,e),"_blank","noopener,noreferrer")}):(o.A.NAV_BAR.USER_NAME.innerText="(None)",o.A.NAV_BAR.USER_ID.innerText="(None)",o.A.NAV_BAR.USER_SERVER.innerText="(None)",o.A.NAV_BAR.OFFICIAL_SITE_BTN.onclick=()=>{window.open(s.W4,"_blank","noopener,noreferrer")})}function p(){o.A.NAV_BAR.EXPORT_DATA_BTN.addEventListener("click",async function(){if(!await c.n.UserManager.getUser())return await i.A.pushAction({message:"User not found; cannot export data without an active user",action:i.A.ACTIONS.SHOW_NO_USER_MSG}),await r.pq.setState(h.D.SELECT_DATA),void E();await l.j.triggerDownload()})}let S={addNavListeners:f,addClearDataBtnListener:_,writeUserInfo:A,initialize:async function(){A(await a.A.getUser()),f(),_(),p(),d()},navToHome:E,addExportDataBtnListener:p,addBraceButtonListeners:d,eraseUserFromPage:async function(){await a.A.clearUserData(),A(null)},setUserOnPage:async function(t){await a.A.setUser(t),A(t,await u.W.getLang())}}},913:(t,e,n)=>{n.d(e,{A:()=>S});var r=n(528),s=n(412);const a=t=>t.filter(t=>t[s.Lx.FIRST_PICK]),o="N/A";function i(t){return(100*t).toFixed(2)+"%"}function c(t,e,n=!1){return 0===e?n?"0.00%":o:i(t/e)}function u(t,e){return 0===e?o:(t/e).toFixed(2)}function l(t,e){const n=t[s.Lx.CR_BAR].find(t=>t[0]===e);return n?n[1]:null}function h(t,e){const n=t.filter(t=>{const n=t[s.Lx.P1_PICKS].includes(e)||t[s.Lx.P2_PICKS].includes(e),r=t[s.Lx.P1_POSTBAN]!==e&&t[s.Lx.P2_POSTBAN]!==e;return n&&r});let r=n.length,a=0,o=0;for(const t of n){const n=l(t,e);null!==n&&(a+=n,o+=+(100===n))}return{avgCR:c(a/100,r,!0),firstTurns:o,firstTurnRate:c(o,r,!0)}}function E(t,e){const n=(r=t,r.filter(t=>t[s.Lx.WIN])).length;var r;const a=t.length,o=t.filter(t=>t[s.Lx.FIRST_TURN]).length,i=c(o,t.length),l=t.reduce((t,e)=>t+(e[s.Lx.POINT_GAIN]||0),0);return{wins:n,subsetLength:a,frequency:c(t.length,e),winRate:c(n,t.length),plusMinus:2*n-a,pointGain:t.reduce((t,e)=>t+(e[s.Lx.POINT_GAIN]||0),0),avgPPG:u(l,a),firstTurns:o,firstTurnRate:i}}function f(t,e,n){const r=E(t,e),a=t.reduce((t,e)=>t+ +(e[s.Lx.P1_POSTBAN]===n||e[s.Lx.P2_POSTBAN]===n),0),o=t.reduce((t,e)=>t+ +(e[s.Lx.WIN]||e[s.Lx.P1_POSTBAN]===n||e[s.Lx.P2_POSTBAN]===n),0),i=h(t,n);return{[s.D5.HERO_NAME]:n,[s.D5.BATTLES]:r.subsetLength,[s.D5.PICK_RATE]:r.frequency,[s.D5.WINS]:r.wins,[s.D5.WIN_RATE]:r.winRate,[s.D5.POSTBANS]:a,[s.D5.POSTBAN_RATE]:c(a,r.subsetLength),[s.D5.SUCCESS_RATE]:c(o,r.subsetLength),[s.D5.PLUS_MINUS]:r.plusMinus,[s.D5.POINT_GAIN]:r.pointGain,[s.D5.AVG_CR]:i.avgCR,[s.D5.FIRST_TURNS]:i.firstTurns,[s.D5.FIRST_TURN_RATE]:i.firstTurnRate}}function _(t,e=!0){const n=new Set;for(const r of Object.values(t)){(e?r[s.Lx.P1_PICKS]:r[s.Lx.P2_PICKS]).forEach(t=>{n.add(t)})}return n}function d(t){return t.sort(),t.join("~")}function A(t,e){return t.map(t=>r.A.getHeroByName(t,e)?.code??e.Empty.code).filter(t=>t!==e.Empty.code)}function p(t){let e;const n=Math.floor(t/60),r=(t%60).toFixed(1);return e=0===n?`${r} secs`:`${n} : ${r}s`,e}const S={getHeroStats:function(t,e){if(0===t.length)return{playerHeroStats:[],enemyHeroStats:[]};const n=t.length,a=_(t,!0),o=_(t,!1),i=[],c=[];for(const o of a){const a=r.A.getHeroByName(o,e);if(!a)continue;const c=t.filter(t=>t[s.Lx.P1_PICKS].includes(o));c.length>0&&i.push(f(c,n,a.name))}for(const a of o){const o=r.A.getHeroByName(a,e);if(!o)continue;const i=t.filter(t=>t[s.Lx.P2_PICKS].includes(a));i.length>0&&c.push(f(i,n,o.name))}const u=s.D5.HERO_NAME;return{playerHeroStats:i.sort((t,e)=>t[u].localeCompare(e[u])),enemyHeroStats:c.sort((t,e)=>t[u].localeCompare(e[u]))}},getFirstPickStats:function(t,e){if(0===(t=a(Object.values(t))).length)return[];const n=t.length,o={};for(const e of t){if(0===e[s.Lx.P1_PICKS].length)continue;const t=e[s.Lx.P1_PICKS][0];t in o||(o[t]={wins:0,appearances:0}),o[t].wins+=+e[s.Lx.WIN],o[t].appearances+=1}const c=Object.entries(o).map(([t,s])=>({hero:r.A.getHeroByName(t,e)?.name??r.A.EMPTY_NAME,wins:s.wins,appearances:s.appearances,win_rate:i(s.wins/s.appearances),appearance_rate:i(s.appearances/n),"+/-":2*s.wins-s.appearances}));return c.sort((t,e)=>e.appearances-t.appearances),c},getPrebanStats:function(t,e){if(0===t.length)return[];const n=new Set;for(const r of t){const t=A(r[s.Lx.P1_PREBANS],e);if(0!==t.length){for(const r of t)r!==e.Empty.code&&n.add(r);t.length>1&&n.add(d(t))}}const a=t.length,o=[];for(const i of n){const n=E(t.filter(t=>d(A(t[s.Lx.P1_PREBANS],e)).includes(i)),a),c=i.split("~").map(t=>r.A.getHeroByCode(t,e)?.name??e.Empty.name).sort().join(", ");n.wins,n.subsetLength,o.push({preban:c,wins:n.wins,appearances:n.subsetLength,appearance_rate:n.frequency,win_rate:n.winRate,"+/-":n.plusMinus})}return o.sort((t,e)=>e.appearances-t.appearances),o},getPerformanceStats:function(t){const e={servers:[],leagues:[]},n=t.length,r=Object.values(s.DB),a=Object.values(s.pc),o=[...r.map(t=>[`Server: ${t}`,e=>e["P2 Server"]===t]),...a.map(t=>[`League: ${t}`,e=>e["P2 League"]===t])];for(const[r,a]of o){const o=t.filter(a),c=o.length;if(0===c)continue;const u=E(o,n),l=o.filter(t=>t[s.Lx.FIRST_PICK]),h=l.reduce((t,e)=>t+ +e[s.Lx.WIN],0),f=o.filter(t=>!t[s.Lx.FIRST_PICK]),_=f.reduce((t,e)=>t+ +e[s.Lx.WIN],0);(r.toLowerCase().includes("server")?e.servers:e.leagues).push({label:r,count:c,wins:u.wins,win_rate:u.winRate,frequency:u.frequency,"+/-":u.plusMinus,fp_games:l.length,sp_games:f.length,fp_wr:l.length>0?i(h/l.length):"N/A",sp_wr:f.length>0?i(_/f.length):"N/A"})}return[...e.servers,...e.leagues.slice(-4)]},getGeneralStats:function(t){t.sort((t,e)=>new Date(t["Date/Time"]).getTime()-new Date(e["Date/Time"]).getTime());const e=t.length,n=u(t.reduce((t,e)=>t+(e["Point Gain"]||0),0),e),r=u(t.reduce((t,e)=>t+e.Turns,0),e),l=t.length>0?Math.max(...t.map(t=>t.Turns)):0,h=t.reduce((t,e)=>t+e.Seconds,0),f=e>0?h/e:0,_=t.length>0?Math.max(...t.map(t=>t.Seconds)):0;let d=p(f),A=p(_);const S=t.reduce((t,e)=>t+ +e["First Turn"],0),g=a(t),T=(t=>t.filter(t=>!t[s.Lx.FIRST_PICK]))(t),R=E(g,e),m=E(T,e),w=c(R.wins+m.wins,e);let[L,N,y,O]=[0,0,0,0];for(let e of t)e.Win?(y+=1,L=Math.max(L,y),O=0):(y=0,O+=1,N=Math.max(N,O));return{first_pick_count:R.subsetLength,second_pick_count:m.subsetLength,first_pick_rate:R.frequency,second_pick_rate:m.frequency,first_pick_winrate:R.winRate,second_pick_winrate:m.winRate,total_winrate:w,total_battles:e,total_wins:R.wins+m.wins,max_win_streak:L,max_loss_streak:N,avg_ppg:n,avg_turns:r,avg_time:d,max_turns:l,max_time:A,first_turn_games:S,first_turn_rate:e?i(S/e):o}},computeGenericStats:E,queryStats:f,toPercent:i,divideToPercentString:c,divideToString:u,computeCRStats:h,secondsToTimeStr:p}},940:(t,e,n)=>{n.d(e,{A:()=>h});var r,s,a=n(528),o=n(84),i=n(172);function c(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function a(n,r,s,a){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return u(l,"_invoke",function(n,r,s){var a,i,c,u=0,l=s||[],h=!1,E={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return a=e,i=0,c=t,E.n=n,o}};function f(n,r){for(i=n,c=r,e=0;!h&&u&&!s&&e<l.length;e++){var s,a=l[e],f=E.p,_=a[2];n>3?(s=_===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=f&&((s=n<2&&f<a[1])?(i=0,E.v=r,E.n=a[1]):f<_&&(s=n<3||a[0]>r||r>_)&&(a[4]=n,a[5]=r,E.n=_,i=0))}if(s||n>1)return o;throw h=!0,r}return function(s,l,_){if(u>1)throw TypeError("Generator is already running");for(h&&1===l&&f(l,_),i=l,c=_;(e=i<2?t:c)||!h;){a||(i?i<3?(i>1&&(E.n=-1),f(i,c)):E.n=c:E.v=c);try{if(u=2,a){if(i||(s="next"),e=a[s]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+s+"' method"),i=1);a=t}else if((e=(h=E.n<0)?c:n.call(r,E))!==o)break}catch(e){a=t,i=1,c=e}finally{u=1}}return{value:e,done:h}}}(n,s,a),!0),l}var o={};function i(){}function l(){}function h(){}e=Object.getPrototypeOf;var E=[][r]?e(e([][r]())):(u(e={},r,function(){return this}),e),f=h.prototype=i.prototype=Object.create(E);function _(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,u(t,s,"GeneratorFunction")),t.prototype=Object.create(f),t}return l.prototype=h,u(f,"constructor",h),u(h,"constructor",l),l.displayName="GeneratorFunction",u(h,s,"GeneratorFunction"),u(f),u(f,s,"Generator"),u(f,r,function(){return this}),u(f,"toString",function(){return"[object Generator]"}),(c=function(){return{w:a,m:_}})()}function u(t,e,n,r){var s=Object.defineProperty;try{s({},"",{})}catch(t){s=0}u=function(t,e,n,r){if(e)s?s(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){u(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},u(t,e,n,r)}function l(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,s)}const h={validateFilterSyntax:(r=c().m(function t(e){var n,r,s;return c().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,a.A.getHeroDicts();case 1:return n=t.v,r=document.getElementById("filterMSG"),t.p=2,t.n=3,o.S.fromFilterStr(e,n);case 3:return t.v.asString(),i.GF.write(new i.ev("Validation Passed",r,[i.GF.STYLES.GREEN])),t.a(2,!0);case 4:return t.p=4,s=t.v,console.error(s),i.GF.write(new i.ev("Validation Failed: ".concat(s.message),r,[i.GF.STYLES.RED])),t.a(2,!1)}},t,null,[[2,4]])}),s=function(){var t=this,e=arguments;return new Promise(function(n,s){var a=r.apply(t,e);function o(t){l(a,n,s,o,i,"next",t)}function i(t){l(a,n,s,o,i,"throw",t)}o(void 0)})},function(t){return s.apply(this,arguments)}),setScrollPercent:function(t){"Scrolling to ".concat(t,"%");var e=t/100*(document.documentElement.scrollHeight-window.innerHeight),n=document.documentElement,r=n.style.scrollBehavior;n.style.scrollBehavior="auto",window.scrollTo({top:e}),n.style.scrollBehavior=r},getScrollPercent:function(){var t=window.scrollY||document.documentElement.scrollTop,e=document.documentElement.scrollHeight-window.innerHeight;return 0===e?0:t/e*100},setVisibility:function(t,e){e?t.classList.remove("d-none"):t.classList.add("d-none")}}},971:(t,e,n)=>{n.d(e,{Nk:()=>o,RG:()=>a,yL:()=>s});var r=n(412);const s=new Set("'\"(),_-.=; ><!1234567890{}~abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),a="   ",o=Object.fromEntries(Object.values(r.pg).map(t=>[t.toLowerCase(),t]))}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return a[t](n,n.exports,i),n.exports}t="function"==typeof Symbol,e=t?Symbol("webpack queues"):"__webpack_queues__",n=t?Symbol("webpack exports"):"__webpack_exports__",r=t?Symbol("webpack error"):"__webpack_error__",s=t=>{t&&t.d<1&&(t.d=1,t.forEach(t=>t.r--),t.forEach(t=>t.r--?t.r++:t()))},i.a=(t,a,o)=>{var i;o&&((i=[]).d=-1);var c,u,l,h=new Set,E=t.exports,f=new Promise((t,e)=>{l=e,u=t});f[n]=E,f[e]=t=>(i&&t(i),h.forEach(t),f.catch(t=>{})),t.exports=f,a(t=>{var a;c=(t=>t.map(t=>{if(null!==t&&"object"==typeof t){if(t[e])return t;if(t.then){var a=[];a.d=0,t.then(t=>{o[n]=t,s(a)},t=>{o[r]=t,s(a)});var o={};return o[e]=t=>t(a),o}}var i={};return i[e]=t=>{},i[n]=t,i}))(t);var o=()=>c.map(t=>{if(t[r])throw t[r];return t[n]}),u=new Promise(t=>{(a=()=>t(o)).r=0;var n=t=>t!==i&&!h.has(t)&&(h.add(t),t&&!t.d&&(a.r++,t.push(a)));c.map(t=>t[e](n))});return a.r?u:o()},t=>(t?l(f[r]=t):u(E),s(i))),i&&i.d<0&&(i.d=0)},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);i(758)})();