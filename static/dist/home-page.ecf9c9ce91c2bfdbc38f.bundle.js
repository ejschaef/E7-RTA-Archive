/*! For license information please see home-page.ecf9c9ce91c2bfdbc38f.bundle.js.LICENSE.txt */
(()=>{var t={809:function(t,e){var n,r,o;r=[],n=function t(){var e,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},r=!n.document&&!!n.postMessage,o=n.IS_PAPA_WORKER||!1,a={},i=0,s={};function c(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var e=m(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new d(e),(this._handle.streamer=this)._config=e}.call(this,t),this.parseChunk=function(t,e){var r=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<r){let e=this._config.newline;e||(a=this._config.quoteChar||'"',e=this._handle.guessLineEndings(t,a)),t=[...t.split(e).slice(r)].join(e)}this.isFirstChunk&&v(this._config.beforeFirstChunk)&&void 0!==(a=this._config.beforeFirstChunk(t))&&(t=a),this.isFirstChunk=!1,this._halted=!1,r=this._partialLine+t;var a=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=a.meta.cursor,this._finished||(this._partialLine=r.substring(t-this._baseIndex),this._baseIndex=t),a&&a.data&&(this._rowCount+=a.data.length),r=this._finished||this._config.preview&&this._rowCount>=this._config.preview,o)n.postMessage({results:a,workerId:s.WORKER_ID,finished:r});else if(v(this._config.chunk)&&!e){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=a=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!r||!v(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||a&&a.meta.paused||this._nextChunk(),a}this._halted=!0},this._sendError=function(t){v(this._config.error)?this._config.error(t):o&&this._config.error&&n.postMessage({workerId:s.WORKER_ID,error:t,finished:!1})}}function u(t){var e;(t=t||{}).chunkSize||(t.chunkSize=s.RemoteChunkSize),c.call(this,t),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),r||(e.onload=g(this._chunkLoaded,this),e.onerror=g(this._chunkError,this)),e.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var t,n=this._config.downloadRequestHeaders;for(t in n)e.setRequestHeader(t,n[t])}var o;this._config.chunkSize&&(o=this._start+this._config.chunkSize-1,e.setRequestHeader("Range","bytes="+this._start+"-"+o));try{e.send(this._config.downloadRequestBody)}catch(t){this._chunkError(t.message)}r&&0===e.status&&this._chunkError()}},this._chunkLoaded=function(){4===e.readyState&&(e.status<200||400<=e.status?this._chunkError():(this._start+=this._config.chunkSize||e.responseText.length,this._finished=!this._config.chunkSize||this._start>=(t=>null!==(t=t.getResponseHeader("Content-Range"))?parseInt(t.substring(t.lastIndexOf("/")+1)):-1)(e),this.parseChunk(e.responseText)))},this._chunkError=function(t){t=e.statusText||t,this._sendError(new Error(t))}}function l(t){(t=t||{}).chunkSize||(t.chunkSize=s.LocalChunkSize),c.call(this,t);var e,n,r="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,n=t.slice||t.webkitSlice||t.mozSlice,r?((e=new FileReader).onload=g(this._chunkLoaded,this),e.onerror=g(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input,o=(this._config.chunkSize&&(o=Math.min(this._start+this._config.chunkSize,this._input.size),t=n.call(t,this._start,o)),e.readAsText(t,this._config.encoding));r||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(e.error)}}function f(t){var e;c.call(this,t=t||{}),this.stream=function(t){return e=t,this._nextChunk()},this._nextChunk=function(){var t,n;if(!this._finished)return t=this._config.chunkSize,e=t?(n=e.substring(0,t),e.substring(t)):(n=e,""),this._finished=!e,this.parseChunk(n)}}function p(t){c.call(this,t=t||{});var e=[],n=!0,r=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===e.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):n=!0},this._streamData=g(function(t){try{e.push("string"==typeof t?t:t.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(t){this._streamError(t)}},this),this._streamError=g(function(t){this._streamCleanUp(),this._sendError(t)},this),this._streamEnd=g(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=g(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function d(t){var e,n,r,o,a=Math.pow(2,53),i=-a,c=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,u=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,l=this,f=0,p=0,d=!1,E=!1,S=[],y={data:[],errors:[],meta:{}};function g(e){return"greedy"===t.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function T(){if(y&&r&&(A("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),r=!1),t.skipEmptyLines&&(y.data=y.data.filter(function(t){return!g(t)})),w()){if(y)if(Array.isArray(y.data[0])){for(var e=0;w()&&e<y.data.length;e++)y.data[e].forEach(n);y.data.splice(0,1)}else y.data.forEach(n);function n(e,n){v(t.transformHeader)&&(e=t.transformHeader(e,n)),S.push(e)}}function o(e,n){for(var r=t.header?{}:[],o=0;o<e.length;o++){var s=o,l=e[o];l=((e,n)=>(e=>(t.dynamicTypingFunction&&void 0===t.dynamicTyping[e]&&(t.dynamicTyping[e]=t.dynamicTypingFunction(e)),!0===(t.dynamicTyping[e]||t.dynamicTyping)))(e)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&((t=>{if(c.test(t)&&(t=parseFloat(t),i<t&&t<a))return 1})(n)?parseFloat(n):u.test(n)?new Date(n):""===n?null:n):n)(s=t.header?o>=S.length?"__parsed_extra":S[o]:s,l=t.transform?t.transform(l,s):l),"__parsed_extra"===s?(r[s]=r[s]||[],r[s].push(l)):r[s]=l}return t.header&&(o>S.length?A("FieldMismatch","TooManyFields","Too many fields: expected "+S.length+" fields but parsed "+o,p+n):o<S.length&&A("FieldMismatch","TooFewFields","Too few fields: expected "+S.length+" fields but parsed "+o,p+n)),r}var l;y&&(t.header||t.dynamicTyping||t.transform)&&(l=1,!y.data.length||Array.isArray(y.data[0])?(y.data=y.data.map(o),l=y.data.length):y.data=o(y.data,0),t.header&&y.meta&&(y.meta.fields=S),p+=l)}function w(){return t.header&&0===S.length}function A(t,e,n,r){t={type:t,code:e,message:n},void 0!==r&&(t.row=r),y.errors.push(t)}v(t.step)&&(o=t.step,t.step=function(e){y=e,w()?T():(T(),0!==y.data.length&&(f+=e.data.length,t.preview&&f>t.preview?n.abort():(y.data=y.data[0],o(y,l))))}),this.parse=function(o,a,i){var c=t.quoteChar||'"';return t.newline||(t.newline=this.guessLineEndings(o,c)),r=!1,t.delimiter?v(t.delimiter)&&(t.delimiter=t.delimiter(o),y.meta.delimiter=t.delimiter):((c=((e,n,r,o,a)=>{var i,c,u,l;a=a||[",","\t","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var f=0;f<a.length;f++){for(var p,d=a[f],h=0,E=0,S=0,y=(u=void 0,new _({comments:o,delimiter:d,newline:n,preview:10}).parse(e)),m=0;m<y.data.length;m++)r&&g(y.data[m])?S++:(E+=p=y.data[m].length,void 0===u?u=p:0<p&&(h+=Math.abs(p-u),u=p));0<y.data.length&&(E/=y.data.length-S),(void 0===c||h<=c)&&(void 0===l||l<E)&&1.99<E&&(c=h,i=d,l=E)}return{successful:!!(t.delimiter=i),bestDelimiter:i}})(o,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess)).successful?t.delimiter=c.bestDelimiter:(r=!0,t.delimiter=s.DefaultDelimiter),y.meta.delimiter=t.delimiter),c=m(t),t.preview&&t.header&&c.preview++,e=o,n=new _(c),y=n.parse(e,a,i),T(),d?{meta:{paused:!0}}:y||{meta:{paused:!1}}},this.paused=function(){return d},this.pause=function(){d=!0,n.abort(),e=v(t.chunk)?"":e.substring(n.getCharIndex())},this.resume=function(){l.streamer._halted?(d=!1,l.streamer.parseChunk(e,!0)):setTimeout(l.resume,3)},this.aborted=function(){return E},this.abort=function(){E=!0,n.abort(),y.meta.aborted=!0,v(t.complete)&&t.complete(y),e=""},this.guessLineEndings=function(t,e){t=t.substring(0,1048576),e=new RegExp(h(e)+"([^]*?)"+h(e),"gm");var n=(t=t.replace(e,"")).split("\r");if(t=1<(e=t.split("\n")).length&&e[0].length<n[0].length,1===n.length||t)return"\n";for(var r=0,o=0;o<n.length;o++)"\n"===n[o][0]&&r++;return r>=n.length/2?"\r\n":"\r"}}function h(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function _(t){var e=(t=t||{}).delimiter,n=t.newline,r=t.comments,o=t.step,a=t.preview,i=t.fastMode,c=null,u=!1,l=null==t.quoteChar?'"':t.quoteChar,f=l;if(void 0!==t.escapeChar&&(f=t.escapeChar),("string"!=typeof e||-1<s.BAD_DELIMITERS.indexOf(e))&&(e=","),r===e)throw new Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<s.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var p=0,d=!1;this.parse=function(s,_,E){if("string"!=typeof s)throw new Error("Input must be a string");var S=s.length,y=e.length,m=n.length,g=r.length,T=v(o),w=[],A=[],b=[],O=p=0;if(!s)return U();if(i||!1!==i&&-1===s.indexOf(l)){for(var R=s.split(n),P=0;P<R.length;P++){if(b=R[P],p+=b.length,P!==R.length-1)p+=n.length;else if(E)return U();if(!r||b.substring(0,g)!==r){if(T){if(w=[],k(b.split(e)),j(),d)return U()}else k(b.split(e));if(a&&a<=P)return w=w.slice(0,a),U(!0)}}return U()}for(var L=s.indexOf(e,p),C=s.indexOf(n,p),I=new RegExp(h(f)+h(l),"g"),N=s.indexOf(l,p);;)if(s[p]===l)for(N=p,p++;;){if(-1===(N=s.indexOf(l,N+1)))return E||A.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:w.length,index:p}),F();if(N===S-1)return F(s.substring(p,N).replace(I,l));if(l===f&&s[N+1]===f)N++;else if(l===f||0===N||s[N-1]!==f){-1!==L&&L<N+1&&(L=s.indexOf(e,N+1));var D=M(-1===(C=-1!==C&&C<N+1?s.indexOf(n,N+1):C)?L:Math.min(L,C));if(s.substr(N+1+D,y)===e){b.push(s.substring(p,N).replace(I,l)),s[p=N+1+D+y]!==l&&(N=s.indexOf(l,p)),L=s.indexOf(e,p),C=s.indexOf(n,p);break}if(D=M(C),s.substring(N+1+D,N+1+D+m)===n){if(b.push(s.substring(p,N).replace(I,l)),x(N+1+D+m),L=s.indexOf(e,p),N=s.indexOf(l,p),T&&(j(),d))return U();if(a&&w.length>=a)return U(!0);break}A.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:w.length,index:p}),N++}}else if(r&&0===b.length&&s.substring(p,p+g)===r){if(-1===C)return U();p=C+m,C=s.indexOf(n,p),L=s.indexOf(e,p)}else if(-1!==L&&(L<C||-1===C))b.push(s.substring(p,L)),p=L+y,L=s.indexOf(e,p);else{if(-1===C)break;if(b.push(s.substring(p,C)),x(C+m),T&&(j(),d))return U();if(a&&w.length>=a)return U(!0)}return F();function k(t){w.push(t),O=p}function M(t){var e=0;return-1!==t&&(t=s.substring(N+1,t))&&""===t.trim()?t.length:e}function F(t){return E||(void 0===t&&(t=s.substring(p)),b.push(t),p=S,k(b),T&&j()),U()}function x(t){p=t,k(b),b=[],C=s.indexOf(n,p)}function U(r){if(t.header&&!_&&w.length&&!u){var o=w[0],a=Object.create(null),i=new Set(o);let e=!1;for(let n=0;n<o.length;n++){let r=o[n];if(a[r=v(t.transformHeader)?t.transformHeader(r,n):r]){let t,s=a[r];for(;t=r+"_"+s,s++,i.has(t););i.add(t),o[n]=t,a[r]++,e=!0,(c=null===c?{}:c)[t]=r}else a[r]=1,o[n]=r;i.add(r)}u=!0}return{data:w,errors:A,meta:{delimiter:e,linebreak:n,aborted:d,truncated:!!r,cursor:O+(_||0),renamedHeaders:c}}}function j(){o(U()),w=[],A=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return p}}function E(t){var e=t.data,n=a[e.workerId],r=!1;if(e.error)n.userError(e.error,e.file);else if(e.results&&e.results.data){var o={abort:function(){r=!0,S(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(v(n.userStep)){for(var i=0;i<e.results.data.length&&(n.userStep({data:e.results.data[i],errors:e.results.errors,meta:e.results.meta},o),!r);i++);delete e.results}else v(n.userChunk)&&(n.userChunk(e.results,o,e.file),delete e.results)}e.finished&&!r&&S(e.workerId,e.results)}function S(t,e){var n=a[t];v(n.userComplete)&&n.userComplete(e),n.terminate(),delete a[t]}function y(){throw new Error("Not implemented.")}function m(t){if("object"!=typeof t||null===t)return t;var e,n=Array.isArray(t)?[]:{};for(e in t)n[e]=m(t[e]);return n}function g(t,e){return function(){t.apply(e,arguments)}}function v(t){return"function"==typeof t}return s.parse=function(e,r){var o=(r=r||{}).dynamicTyping||!1;if(v(o)&&(r.dynamicTypingFunction=o,o={}),r.dynamicTyping=o,r.transform=!!v(r.transform)&&r.transform,!r.worker||!s.WORKERS_SUPPORTED)return o=null,s.NODE_STREAM_INPUT,"string"==typeof e?(e=(t=>65279!==t.charCodeAt(0)?t:t.slice(1))(e),o=new(r.download?u:f)(r)):!0===e.readable&&v(e.read)&&v(e.on)?o=new p(r):(n.File&&e instanceof File||e instanceof Object)&&(o=new l(r)),o.stream(e);(o=(()=>{var e;return!!s.WORKERS_SUPPORTED&&(e=(()=>{var e=n.URL||n.webkitURL||null,r=t.toString();return s.BLOB_URL||(s.BLOB_URL=e.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))})(),(e=new n.Worker(e)).onmessage=E,e.id=i++,a[e.id]=e)})()).userStep=r.step,o.userChunk=r.chunk,o.userComplete=r.complete,o.userError=r.error,r.step=v(r.step),r.chunk=v(r.chunk),r.complete=v(r.complete),r.error=v(r.error),delete r.worker,o.postMessage({input:e,config:r,workerId:o.id})},s.unparse=function(t,e){var n=!1,r=!0,o=",",a="\r\n",i='"',c=i+i,u=!1,l=null,f=!1,p=((()=>{if("object"==typeof e){if("string"!=typeof e.delimiter||s.BAD_DELIMITERS.filter(function(t){return-1!==e.delimiter.indexOf(t)}).length||(o=e.delimiter),"boolean"!=typeof e.quotes&&"function"!=typeof e.quotes&&!Array.isArray(e.quotes)||(n=e.quotes),"boolean"!=typeof e.skipEmptyLines&&"string"!=typeof e.skipEmptyLines||(u=e.skipEmptyLines),"string"==typeof e.newline&&(a=e.newline),"string"==typeof e.quoteChar&&(i=e.quoteChar),"boolean"==typeof e.header&&(r=e.header),Array.isArray(e.columns)){if(0===e.columns.length)throw new Error("Option columns is empty");l=e.columns}void 0!==e.escapeChar&&(c=e.escapeChar+i),e.escapeFormulae instanceof RegExp?f=e.escapeFormulae:"boolean"==typeof e.escapeFormulae&&e.escapeFormulae&&(f=/^[=+\-@\t\r].*$/)}})(),new RegExp(h(i),"g"));if("string"==typeof t&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return d(null,t,u);if("object"==typeof t[0])return d(l||Object.keys(t[0]),t,u)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||l),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:"object"==typeof t.data[0]?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||"object"==typeof t.data[0]||(t.data=[t.data])),d(t.fields||[],t.data||[],u);throw new Error("Unable to serialize unrecognized input");function d(t,e,n){var i="",s=("string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e)),Array.isArray(t)&&0<t.length),c=!Array.isArray(e[0]);if(s&&r){for(var u=0;u<t.length;u++)0<u&&(i+=o),i+=_(t[u],u);0<e.length&&(i+=a)}for(var l=0;l<e.length;l++){var f=(s?t:e[l]).length,p=!1,d=s?0===Object.keys(e[l]).length:0===e[l].length;if(n&&!s&&(p="greedy"===n?""===e[l].join("").trim():1===e[l].length&&0===e[l][0].length),"greedy"===n&&s){for(var h=[],E=0;E<f;E++){var S=c?t[E]:E;h.push(e[l][S])}p=""===h.join("").trim()}if(!p){for(var y=0;y<f;y++){0<y&&!d&&(i+=o);var m=s&&c?t[y]:y;i+=_(e[l][m],y)}l<e.length-1&&(!n||0<f&&!d)&&(i+=a)}}return i}function _(t,e){var r,a;return null==t?"":t.constructor===Date?JSON.stringify(t).slice(1,25):(a=!1,f&&"string"==typeof t&&f.test(t)&&(t="'"+t,a=!0),r=t.toString().replace(p,c),(a=a||!0===n||"function"==typeof n&&n(t,e)||Array.isArray(n)&&n[e]||((t,e)=>{for(var n=0;n<e.length;n++)if(-1<t.indexOf(e[n]))return!0;return!1})(r,s.BAD_DELIMITERS)||-1<r.indexOf(o)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?i+r+i:r)}},s.RECORD_SEP=String.fromCharCode(30),s.UNIT_SEP=String.fromCharCode(31),s.BYTE_ORDER_MARK="\ufeff",s.BAD_DELIMITERS=["\r","\n",'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!r&&!!n.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=_,s.ParserHandle=d,s.NetworkStreamer=u,s.FileStreamer=l,s.StringStreamer=f,s.ReadableStreamStreamer=p,n.jQuery&&((e=n.jQuery).fn.parse=function(t){var r=t.config||{},o=[];return this.each(function(t){if("INPUT"!==e(this).prop("tagName").toUpperCase()||"file"!==e(this).attr("type").toLowerCase()||!n.FileReader||!this.files||0===this.files.length)return!0;for(var a=0;a<this.files.length;a++)o.push({file:this.files[a],inputElem:this,instanceConfig:e.extend({},r)})}),a(),this;function a(){if(0===o.length)v(t.complete)&&t.complete();else{var n,r,a,c,u=o[0];if(v(t.before)){var l=t.before(u.file,u.inputElem);if("object"==typeof l){if("abort"===l.action)return n="AbortError",r=u.file,a=u.inputElem,c=l.reason,void(v(t.error)&&t.error({name:n},r,a,c));if("skip"===l.action)return void i();"object"==typeof l.config&&(u.instanceConfig=e.extend(u.instanceConfig,l.config))}else if("skip"===l)return void i()}var f=u.instanceConfig.complete;u.instanceConfig.complete=function(t){v(f)&&f(t,u.file,u.inputElem),i()},s.parse(u.file,u.instanceConfig)}}function i(){o.splice(0,1),a()}}),o&&(n.onmessage=function(t){t=t.data,void 0===s.WORKER_ID&&t&&(s.WORKER_ID=t.workerId),"string"==typeof t.input?n.postMessage({workerId:s.WORKER_ID,results:s.parse(t.input,t.config),finished:!0}):(n.File&&t.input instanceof File||t.input instanceof Object)&&(t=s.parse(t.input,t.config))&&n.postMessage({workerId:s.WORKER_ID,results:t,finished:!0})}),(u.prototype=Object.create(c.prototype)).constructor=u,(l.prototype=Object.create(c.prototype)).constructor=l,(f.prototype=Object.create(f.prototype)).constructor=f,(p.prototype=Object.create(c.prototype)).constructor=p,s},void 0===(o="function"==typeof n?n.apply(e,r):n)||(t.exports=o)}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r].call(a.exports,a,a.exports,n),a.exports}(()=>{"use strict";const t=(t,e)=>e.some(e=>t instanceof e);let e,r;const o=new WeakMap,a=new WeakMap,i=new WeakMap;let s={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return o.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function c(t){s=t(s)}function u(t){return(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(p(this),e),f(this.request)}:function(...e){return f(t.apply(p(this),e))}}function l(n){return"function"==typeof n?u(n):(n instanceof IDBTransaction&&function(t){if(o.has(t))return;const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{e(),r()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});o.set(t,e)}(n),t(n,e||(e=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(n,s):n)}function f(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{e(f(t.result)),r()},a=()=>{n(t.error),r()};t.addEventListener("success",o),t.addEventListener("error",a)});return i.set(e,t),e}(t);if(a.has(t))return a.get(t);const e=l(t);return e!==t&&(a.set(t,e),i.set(e,t)),e}const p=t=>i.get(t);const d=["get","getKey","getAll","getAllKeys","count"],h=["put","add","delete","clear"],_=new Map;function E(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(_.get(e))return _.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=h.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!d.includes(n))return;const a=async function(t,...e){const a=this.transaction(t,o?"readwrite":"readonly");let i=a.store;return r&&(i=i.index(e.shift())),(await Promise.all([i[n](...e),o&&a.done]))[0]};return _.set(e,a),a}c(t=>({...t,get:(e,n,r)=>E(e,n)||t.get(e,n,r),has:(e,n)=>!!E(e,n)||t.has(e,n)}));const S=["continue","continuePrimaryKey","advance"],y={},m=new WeakMap,g=new WeakMap,v={get(t,e){if(!S.includes(e))return t[e];let n=y[e];return n||(n=y[e]=function(...t){m.set(this,g.get(this)[e](...t))}),n}};async function*T(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const n=new Proxy(e,v);for(g.set(n,e),i.set(n,p(e));e;)yield n,e=await(m.get(n)||e.continue()),m.delete(n)}function w(e,n){return n===Symbol.asyncIterator&&t(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===n&&t(e,[IDBIndex,IDBObjectStore])}function A(t){return t.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())}function b(t){return t.reduce((t,e)=>(t[e]=(t[e]||0)+1,t),{})}c(t=>({...t,get:(e,n,r)=>w(e,n)?T:t.get(e,n,r),has:(e,n)=>w(e,n)||t.has(e,n)}));const O={DE:"de",KO:"ko",PT:"pt",TH:"th",ZH_TW:"zh-TW",JA:"ja",EN:"en",FR:"fr",ZH_CN:"zh-CN",ES:"es"},R=new Set(["world_kor","world_global","world_jpn","world_asia","world_eu"]),P="world_global",L="world_kor",C="world_jpn",I="world_asia",N="world_eu",D={[P]:"Global",[L]:"Korea",[C]:"Japan",[I]:"Asia",[N]:"Europe"},k={[D.world_global]:P,[D.world_kor]:L,[D.world_jpn]:C,[D.world_asia]:I,[D.world_eu]:N},M=Object.fromEntries(Object.values(D).map(t=>[t.toLowerCase(),t])),F={set_speed:"Speed",set_acc:"Hit",set_cri:"Critical",set_res:"Resist",set_def:"Defense",set_att:"Attack",set_max_hp:"Health",set_cri_dmg:"Destruction",set_coop:"Unity",set_immune:"Immunity",set_rage:"Rage",set_vampire:"Lifesteal",set_shield:"Protection",set_revenge:"Revenge",set_penetrate:"Penetration",set_torrent:"Torrent",set_counter:"Counter",set_scar:"Injury"},x=864e5,U={bronze:0,silver:1,gold:2,master:3,challenger:4,champion:5,warlord:6,emperor:7,legend:8},j=Object.fromEntries(Object.keys(U).sort((t,e)=>U[t]-U[e]).map(t=>[t,A(t)])),B={SEASON:"Season",SEASON_CODE:"Season Code",DATE_TIME:"Date/Time",SECONDS:"Seconds",TURNS:"Turns",SEQ_NUM:"Seq Num",P1_ID:"P1 ID",P1_SERVER:"P1 Server",P2_ID:"P2 ID",P2_SERVER:"P2 Server",P1_LEAGUE:"P1 League",P2_LEAGUE:"P2 League",P1_POINTS:"P1 Points",POINT_GAIN:"Point Gain",WIN:"Win",FIRST_PICK:"First Pick",FIRST_TURN:"First Turn",FIRST_TURN_HERO:"First Turn Hero",CR_BAR:"CR Bar",P1_PREBANS:"P1 Prebans",P2_PREBANS:"P2 Prebans",P1_PICKS:"P1 Picks",P2_PICKS:"P2 Picks",P1_POSTBAN:"P1 Postban",P2_POSTBAN:"P2 Postban",P1_EQUIPMENT:"P1 Equipment",P2_EQUIPMENT:"P2 Equipment",P1_ARTIFACTS:"P1 Artifacts",P2_ARTIFACTS:"P2 Artifacts",P1_MVP:"P1 MVP",P2_MVP:"P2 MVP",P1_PICKS_PRIMES:"P1 Picks Primes",P1_PICKS_PRIME_PRODUCT:"P1 Picks Prime Product",P2_PICKS_PRIMES:"P2 Picks Primes",P2_PICKS_PRIME_PRODUCT:"P2 Picks Prime Product",P1_PREBANS_PRIMES:"P1 Prebans Primes",P1_PREBANS_PRIME_PRODUCT:"P1 Prebans Prime Product",P2_PREBANS_PRIMES:"P2 Prebans Primes",P2_PREBANS_PRIME_PRODUCT:"P2 Prebans Prime Product"},G=Object.values(B).filter(t=>!t.toLowerCase().includes("prime")),H=[B.P1_EQUIPMENT,B.P2_EQUIPMENT,B.P1_ARTIFACTS,B.P2_ARTIFACTS,B.CR_BAR,B.P1_PREBANS,B.P2_PREBANS,B.P1_PICKS,B.P2_PICKS],K=[B.FIRST_PICK,B.FIRST_TURN,B.WIN],W=[B.SECONDS,B.TURNS,B.P1_POINTS,B.POINT_GAIN],V=[B.P1_LEAGUE,B.P2_LEAGUE],Y="Hero Name",q="Battles",z="Pick Rate",Q="Wins",J="Win rate",X="Postbans",Z="Postban Rate",tt="Success Rate",et="+/-",nt="Point Gain",rt="Avg CR",ot="First Turns",at="First Turn Rate",it="https://epic7.onstove.com",st=it+"/gg";const ct=function(t){const e=new Uint8Array(t+1),n=[];for(let r=2;r<=t;r++)if(!e[r]){n.push(r);for(let n=r*r;n<=t;n+=r)e[n]=1}return n}(3e4);async function ut(t,e){const n=t.transaction(e,"readwrite");n.objectStore(e).clear(),await n.done}const lt={USER:"current-user",BATTLES:"battles",RAW_UPLOAD:"raw-upload",UPLOADED_BATTLES:"uploaded-battles",FILTERED_BATTLES:"filtered-battles",STATS:"stats",FILTER_STR:"filter-str"},ft={GLOBAL_USERS:"global-users",EU_USERS:"eu-users",ASIA_USERS:"asia-users",JPN_USERS:"jpn-users",KOR_USERS:"kor-users"},pt={...lt,...ft,LANG:"lang",HERO_MANAGER:"hero-manager",SEASON_DETAILS:"season-details",AUTO_ZOOM_FLAG:"auto-zoom",AUTO_QUERY_FLAG:"auto-query",ID_SEARCH_FLAG:"id-search",ARTIFACTS:"artifacts",ARTIFACTS_LOWERCASE_NAMES_MAP:"artifacts-lowercase-names-map",ARTIFACT_OBJECT_LIST:"artifact-object-list",HOME_PAGE_STATE:"home-page-state",INTER_PAGE_MANAGER:"inter-page-manager"};let dt={consts:{DB_NAME:"E7ArenaStatsClientDB",DB_VERSION:1,STORE_NAME:"DataStore",META_STORE_NAME:"MetaStore",CACHE_TIMEOUT:1728e5},Keys:{...pt},MetaKeys:{TIMESTAMP:"timestamp"},loaded_UM:new Set,openDB:async()=>function(t,e,{blocked:n,upgrade:r,blocking:o,terminated:a}={}){const i=indexedDB.open(t,e),s=f(i);return r&&i.addEventListener("upgradeneeded",t=>{r(f(i.result),t.oldVersion,t.newVersion,f(i.transaction),t)}),n&&i.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),s.then(t=>{a&&t.addEventListener("close",()=>a()),o&&t.addEventListener("versionchange",t=>o(t.oldVersion,t.newVersion,t))}).catch(()=>{}),s}(dt.consts.DB_NAME,dt.consts.DB_VERSION,{upgrade(t){t.objectStoreNames.contains(dt.consts.STORE_NAME)&&t.deleteObjectStore(dt.consts.STORE_NAME),t.objectStoreNames.contains(dt.consts.STORE_NAME)||t.createObjectStore(dt.consts.STORE_NAME),t.objectStoreNames.contains(dt.consts.META_STORE_NAME)||t.createObjectStore(dt.consts.META_STORE_NAME)}}),get:async function(t){const e=await this.openDB(),n=await e.get(this.consts.STORE_NAME,t);if(null===n)return null;return await this.checkCacheTimeout(t)?n:null},cache:async function(t,e){const n=await this.openDB();await n.put(this.consts.STORE_NAME,e,t),await this.setTimestamp(t,Date.now())},delete:async function(t){const e=await this.openDB();await e.delete(this.consts.STORE_NAME,t),await this.deleteTimestamp(t)},deleteDB:async function(){await indexedDB.deleteDatabase(this.consts.DB_NAME)},getTimestamp:async function(t){const e=await this.openDB(),n=`${t+this.MetaKeys.TIMESTAMP}`;return await e.get(this.consts.META_STORE_NAME,n)??0},setTimestamp:async function(t,e){const n=await this.openDB(),r=`${t+this.MetaKeys.TIMESTAMP}`;await n.put(this.consts.META_STORE_NAME,e,r),await n.get(this.consts.META_STORE_NAME,r)},deleteTimestamp:async function(t){const e=await this.openDB(),n=`${t+this.MetaKeys.TIMESTAMP}`;await e.delete(this.consts.META_STORE_NAME,n)},clearData:async function(){const t=await this.openDB();await ut(t,this.consts.STORE_NAME),await ut(t,this.consts.META_STORE_NAME)},clearUserData:async function(){const t=Object.values(lt);await Promise.all(t.map(t=>this.delete(t)))},clearUserLists:async function(){const t=Object.values(ft);await Promise.all(t.map(t=>this.delete(t)))},clearSeasonData:async function(){await this.delete(pt.SEASON_DETAILS)},checkCacheTimeout:async function(t){const e=await this.getTimestamp(t),n=Date.now();return!(!e||n-e>dt.consts.CACHE_TIMEOUT)||(await this.delete(t),!1)},getFilterStr:async function(){return await this.get(dt.Keys.FILTER_STR)},setFilterStr:async function(t){await this.cache(dt.Keys.FILTER_STR,t)},getLang:async function(){return await this.get(dt.Keys.LANG)??O.EN},setLang:async function(t){await this.cache(dt.Keys.LANG,t)},getStats:async function(){return await this.get(dt.Keys.STATS)},setStats:async function(t){await this.cache(pt.STATS,t)}};const ht=dt,_t={unwrapHtmlElt:function(t){const e=document.getElementById(t);if(null===e)throw new Error(`Could not find element with ID ${t}`);return e},setText:function(t,e){this.unwrapHtmlElt(t).textContent=e}};function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function St(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gt(r.key),r)}}function mt(t,e,n){return e&&yt(t.prototype,e),n&&yt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gt(t){var e=function(t,e){if("object"!=Et(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Et(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Et(e)?e:e+""}var vt=function(){return mt(function t(){St(this,t)},[{key:"SELECT_DATA_MSG",get:function(){return this._SELECT_DATA_MSG||(this._SELECT_DATA_MSG=_t.unwrapHtmlElt("select-data-msg"))}},{key:"FILTER_MSG",get:function(){return this._FILTER_MSG||(this._FILTER_MSG=_t.unwrapHtmlElt("filterMSG"))}},{key:"SELECT_DATA_BODY",get:function(){return this._SELECT_DATA_BODY||(this._SELECT_DATA_BODY=_t.unwrapHtmlElt("select-data-body"))}},{key:"SHOW_STATS_BODY",get:function(){return this._SHOW_STATS_BODY||(this._SHOW_STATS_BODY=_t.unwrapHtmlElt("show-stats-body"))}},{key:"LOAD_DATA_BODY",get:function(){return this._LOAD_DATA_BODY||(this._LOAD_DATA_BODY=_t.unwrapHtmlElt("load-data-body"))}},{key:"CLEAR_DATA_BTN",get:function(){return this._CLEAR_DATA_BTN||(this._CLEAR_DATA_BTN=_t.unwrapHtmlElt("clear-data-btn"))}},{key:"UPLOAD_FORM",get:function(){return this._UPLOAD_FORM||(this._UPLOAD_FORM=_t.unwrapHtmlElt("uploadForm"))}},{key:"CSV_FILE",get:function(){return this._CSV_FILE||(this._CSV_FILE=_t.unwrapHtmlElt("csvFile"))}},{key:"USER_QUERY_FORM_NAME",get:function(){return this._USER_QUERY_FORM_NAME||(this._USER_QUERY_FORM_NAME=_t.unwrapHtmlElt("user-query-form-name"))}},{key:"USER_QUERY_FORM_SERVER",get:function(){return this._USER_QUERY_FORM_SERVER||(this._USER_QUERY_FORM_SERVER=_t.unwrapHtmlElt("user-query-form-server"))}},{key:"AUTO_ZOOM_FLAG",get:function(){return this._AUTO_ZOOM_FLAG||(this._AUTO_ZOOM_FLAG=_t.unwrapHtmlElt("auto-zoom-flag"))}},{key:"FOOTER_BODY",get:function(){return this._FOOTER||(this._FOOTER=_t.unwrapHtmlElt("footer-body"))}},{key:"USER_NAME",get:function(){return this._USER_NAME||(this._USER_NAME=_t.unwrapHtmlElt("user-name"))}},{key:"USER_ID",get:function(){return this._USER_ID||(this._USER_ID=_t.unwrapHtmlElt("user-id"))}},{key:"USER_SERVER",get:function(){return this._USER_SERVER||(this._USER_SERVER=_t.unwrapHtmlElt("user-server"))}},{key:"BATTLE_FILTER_TOGGLE",get:function(){return this._BATTLE_FILTER_TOGGLER||(this._BATTLE_FILTER_TOGGLER=_t.unwrapHtmlElt("filter-battle-table"))}},{key:"ID_SEARCH_FLAG",get:function(){return this._ID_SEARCH_FLAG||(this._ID_SEARCH_FLAG=_t.unwrapHtmlElt("id-search-flag"))}},{key:"ESCAPE_BTN",get:function(){return this._ESCAPE_BTN||(this._ESCAPE_BTN=_t.unwrapHtmlElt("escape-btn"))}},{key:"SEASON_DETAILS_TBL",get:function(){return this._SEASON_DETAILS_TBL||(this._SEASON_DETAILS_TBL=_t.unwrapHtmlElt("season-details-tbl"))}},{key:"PERFORMANCE_STATS_TBL",get:function(){return this._PERFORMANCE_STATS_TBL||(this._PERFORMANCE_STATS_TBL=_t.unwrapHtmlElt("performance-stats-tbl"))}},{key:"FIRST_PICK_STATS_TBL",get:function(){return this._FIRST_PICK_STATS_TBL||(this._FIRST_PICK_STATS_TBL=_t.unwrapHtmlElt("first-pick-stats-tbl"))}},{key:"PREBAN_STATS_TBL",get:function(){return this._PREBAN_STATS_TBL||(this._PREBAN_STATS_TBL=_t.unwrapHtmlElt("preban-stats-tbl"))}},{key:"PLAYER_TBL",get:function(){return this._PLAYER_TBL||(this._PLAYER_TBL=_t.unwrapHtmlElt("player-tbl"))}},{key:"OPPONENT_TBL",get:function(){return this._OPPONENT_TBL||(this._OPPONENT_TBL=_t.unwrapHtmlElt("opponent-tbl"))}},{key:"BATTLES_TBL",get:function(){return this._BATTLE_TBL||(this._BATTLE_TBL=_t.unwrapHtmlElt("battles-tbl"))}},{key:"RANK_PLOT",get:function(){return this._RANK_PLOT||(this._RANK_PLOT=_t.unwrapHtmlElt("rank-plot"))}},{key:"MESSAGE_ELEMENTS_LIST",get:function(){return[this.SELECT_DATA_MSG,this.FILTER_MSG]}}])}(),Tt=function(){return mt(function t(){St(this,t)},[{key:"SIDEBAR_HIDE_BTN",get:function(){return this._SIDEBAR_HIDE_BTN||(this._SIDEBAR_HIDE_BTN=_t.unwrapHtmlElt("sidebar-hide"))}},{key:"CLEAR_DATA_BTN",get:function(){return this._CLEAR_DATA_BTN||(this._CLEAR_DATA_BTN=_t.unwrapHtmlElt("clear-data-btn"))}},{key:"EXPORT_CSV_BTN",get:function(){return this._EXPORT_CSV_BTN||(this._EXPORT_CSV_BTN=_t.unwrapHtmlElt("export-csv-btn"))}},{key:"OFFICIAL_SITE_BTN",get:function(){return this._OFFICIAL_SITE_BTN||(this._OFFICIAL_SITE_BTN=_t.unwrapHtmlElt("official-site-btn"))}},{key:"USER_NAME",get:function(){return this._USER_NAME||(this._USER_NAME=_t.unwrapHtmlElt("user-name"))}},{key:"USER_ID",get:function(){return this._USER_ID||(this._USER_ID=_t.unwrapHtmlElt("user-id"))}},{key:"USER_SERVER",get:function(){return this._USER_SERVER||(this._USER_SERVER=_t.unwrapHtmlElt("user-server"))}},{key:"SIDEBAR_CONTROL",get:function(){return this._SIDEBAR_CONTROL||(this._SIDEBAR_CONTROL=_t.unwrapHtmlElt("sidebar-control"))}}])}(),wt=function(){return mt(function t(){St(this,t)},[{key:"SEARCH_DOMAINS",get:function(){return this._SEARCH_DOMAINS||(this._SEARCH_DOMAINS=_t.unwrapHtmlElt("search-domains"))}},{key:"SEARCH_SUBMIT_BTN",get:function(){return this._SEARCH_SUBMIT_BTN||(this._SEARCH_SUBMIT_BTN=_t.unwrapHtmlElt("search-submit-btn"))}},{key:"SEARCH_FORM",get:function(){return this._SEARCH_FORM||(this._SEARCH_FORM=_t.unwrapHtmlElt("searchForm"))}},{key:"SEARCH_TABLE_CONTAINER",get:function(){return this._SEARCH_TABLE_CONTAINER||(this._SEARCH_TABLE_CONTAINER=_t.unwrapHtmlElt("search-table-container"))}}])}(),At=function(){return mt(function t(){St(this,t)},[{key:"FILTER_SYNTAX_RULES_CONTAINER",get:function(){return this._FILTER_SYNTAX_RULES||(this._FILTER_SYNTAX_RULES=_t.unwrapHtmlElt("filter-syntax-rules-container"))}},{key:"ALL_CONTENT_CONTAINER",get:function(){return this._ALL_CONTENT_CONTAINER||(this._ALL_CONTENT_CONTAINER=_t.unwrapHtmlElt("all-content-container"))}}])}();const bt={HOME_PAGE:new vt,NAV_BAR:new Tt,SEARCH_PAGE:new wt,FILTER_SYNTAX_PAGE:new At,get BODY_FOOTER_CONTAINER(){return this._BODY_FOOTER_CONTAINER||(this._BODY_FOOTER_CONTAINER=_t.unwrapHtmlElt("body-footer-container"))}};function Ot(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Rt(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Rt(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Rt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Rt(f,"constructor",u),Rt(u,"constructor",c),c.displayName="GeneratorFunction",Rt(u,o,"GeneratorFunction"),Rt(f),Rt(f,o,"Generator"),Rt(f,r,function(){return this}),Rt(f,"toString",function(){return"[object Generator]"}),(Ot=function(){return{w:a,m:p}})()}function Rt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Rt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Rt(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},Rt(t,e,n,r)}function Pt(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Lt(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Pt(a,r,o,i,s,"next",t)}function s(t){Pt(a,r,o,i,s,"throw",t)}i(void 0)})}}var Ct,It,Nt,Dt,kt,Mt;const Ft={test:function(t){t.rank_plot},fetchFromPython:(Mt=Lt(Ot().m(function t(e){var n,r;return Ot().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch(e);case 1:if((n=t.v).ok){t.n=3;break}return t.n=2,fetch(e);case 2:n=t.v;case 3:return t.n=4,n.json();case 4:return r=t.v,t.a(2,r||null)}},t)})),function(t){return Mt.apply(this,arguments)}),fetchHeroData:(kt=Lt(Ot().m(function t(){return Ot().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.fetchFromPython("/api/get_hero_data");case 1:return t.a(2,t.v)}},t,this)})),function(){return kt.apply(this,arguments)}),rsFetchBattleData:(Dt=Lt(Ot().m(function t(e){return Ot().w(function(t){for(;;)switch(t.n){case 0:if(e){t.n=1;break}throw new Error("Must pass user to fetch battles data");case 1:return t.n=2,fetch("/api/rs_get_battle_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e})});case 2:return t.a(2,t.v)}},t)})),function(t){return Dt.apply(this,arguments)}),fetchSeasonDetails:(Nt=Lt(Ot().m(function t(){var e,n,r;return Ot().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("/api/get_season_details");case 1:return e=t.v,t.n=2,e.json();case 2:if(!(n=t.v).success){t.n=3;break}return r=JSON.parse(n.seasonDetails),t.a(2,{seasonDetails:r,error:!1});case 3:return t.a(2,{seasonDetails:null,error:n.error});case 4:return t.a(2)}},t)})),function(){return Nt.apply(this,arguments)}),fetchArtifactJson:(It=Lt(Ot().m(function t(){var e,n,r;return Ot().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,fetch("/api/get_artifact_json");case 1:return e=t.v,t.n=2,e.json();case 2:if(!(n=t.v).success){t.n=3;break}return r=JSON.parse(n.artifactJson),t.a(2,r);case 3:return t.a(2,null);case 4:return t.a(2)}},t)})),function(){return It.apply(this,arguments)}),fetchUser:(Ct=Lt(Ot().m(function t(e){var n,r,o;return Ot().w(function(t){for(;;)switch(t.n){case 0:if(e.name&&e.world_code||e.id){t.n=1;break}throw new Error("Must pass a user object with either user.name and user.world_code or user.id to fetch user");case 1:return t.n=2,fetch("/api/get_user_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userData:e})});case 2:return n=t.v,t.n=3,n.json();case 3:if(r=t.v,n.ok){t.n=4;break}throw new Error("Flask server error: ".concat(r.error));case 4:if(r.foundUser){t.n=6;break}if(e.world_code){t.n=5;break}return t.a(2,{user:null,ok:!0});case 5:return t.a(2,{user:null,ok:!0});case 6:return o=r.user,"Found user: ".concat(JSON.stringify(o)),t.a(2,{user:o,ok:!0})}},t)})),function(t){return Ct.apply(this,arguments)})};async function xt(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error: status: ${e.status}`);const n=await e.json();return Object.keys(n),n}catch(t){return console.error("Error fetching global user data:",t),null}}const Ut={fetchHeroJSON:async function(t=null){let e=await xt("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_hero.json");return e?(t&&e[t]?e=e[t]:t&&!e[t]&&(console.error("Could not find hero data for language:",t),e=null),e):null},fetchUserJSON:async function(t){if(t=t.replace("world_",""),![...R].some(e=>e.replace("world_","")===t))return console.error(`Could not find world code: ${t}`),null;const e=`https://static.smilegatemegaport.com/gameRecord/epic7/epic7_user_world_${t}.json`,n=await xt(e);return n&&"object"==typeof n&&"users"in n&&Array.isArray(n.users)&&n.users.length,n},fetchArtifactJSON:async function(t=null){let e=await xt("https://static.smilegatemegaport.com/gameRecord/epic7/epic7_artifact.json"),n=null;if(e&&t&&"object"==typeof e&&t in e){let n=e;if(Array.isArray(n[t]))return n[t]}return n},fetchInfo:async function(t,e,n="en"){const r=new URLSearchParams({nick_no:t,world_code:e,lang:n});try{const t=await fetch("https://epic7.onstove.com/gg/gameApi/getUserInfo",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()});if(!t.ok)return console.error("Error fetching battle list:",t.status,t.statusText),null;return await t.json()}catch(t){return console.error("Request failed:",t),null}}};const jt={getHeroDicts:async function(t=O.EN){const e=await ht.get(ht.Keys.HERO_MANAGER);return e||this.fetchAndCacheHeroManager(t)},createHeroManager:function(t){for(let[e,n]of t.entries()){const t=ct[e];n.prime=t}let e={heroes:[],Empty:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A",prime:1},Fodder:{attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"N/A",prime:1},name_lookup:{},code_lookup:{},prime_lookup:{},prime_pair_lookup:{}};return e.heroes=t,e=function(t){const e=t.heroes.length,n={attribute_cd:"N/A",code:"N/A",grade:"N/A",job_cd:"N/A",name:"Empty",prime:1},r={attribute_cd:"N/A",code:"N/A",grade:"2/3",job_cd:"N/A",name:"Fodder",prime:ct[e]};return t.heroes.push(n),t.heroes.push(r),t.Fodder=r,t.Empty=n,t}(e),e=function(t){t.name_lookup=t.heroes.reduce((t,e)=>(t[e.name.toLowerCase().replace(/\s+/g,"")]=e,t),{}),t.prime_lookup=t.heroes.reduce((t,e)=>(t[e.prime]=e,t),{}),t.code_lookup=t.heroes.reduce((t,e)=>(t[e.code]=e,t),{});let e=t.heroes.reduce((t,e)=>(t[e.prime]=e.name,t),{});const n=Object.keys(t.prime_lookup).length-1;for(let r=0;r<n-1;r++){const o=ct[r];for(let a=r+1;a<n;a++){const n=ct[a],r=o*n,i=t.prime_lookup[o].name,s=t.prime_lookup[n].name;e[r]=[i,s].sort().join(", ")}}return e[t.Fodder.prime*t.Fodder.prime]=[t.Fodder.name,t.Fodder.name].join(", "),t.prime_pair_lookup=e,t}(e),e},fetchHeroManager:async function(t=O.EN){const e=(await Ut.fetchHeroJSON()??await Ft.fetchHeroData())[t];return this.createHeroManager(e)},fetchAndCacheHeroManager:async function(t=O.EN){const e=await this.fetchHeroManager(t);return await ht.cache(ht.Keys.HERO_MANAGER,e),e},deleteHeroManager:async function(){await ht.delete(ht.Keys.HERO_MANAGER)},getHeroByName:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");if(!t)return e.Empty;const n=t.toLowerCase().replace(/\s+/g,"");return e.name_lookup[n]??null},getHeroByPrime:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");return e.prime_lookup[t]},getHeroByCode:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");return t?e.code_lookup[t]??null:e.Empty},getPairNamesByProduct:function(t,e){if(!e)throw new Error("HeroManager instance must be passed to lookup functions");return e.prime_pair_lookup[t]}};const Bt={async getArtifactCodeToNameMap(){let t=await ht.get(ht.Keys.ARTIFACTS);return t||(t=await this.fetchAndCacheArtifacts()),t},getArtifactLowercaseNameMap:async function(){let t=await ht.get(ht.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP);if(null!==t)return t;const e=await this.getArtifactCodeToNameMap();return t=Object.fromEntries(Object.values(e).filter(t=>null!==t).map(t=>[t.toLowerCase(),t])),await ht.cache(ht.Keys.ARTIFACTS_LOWERCASE_NAMES_MAP,t),t},getArtifactObjectList:async function(){let t=await ht.get(ht.Keys.ARTIFACT_OBJECT_LIST);if(null!==t)return t;const e=await this.getArtifactCodeToNameMap();return t=Object.entries(e).map(([t,e])=>({id:t,name:e})),await ht.cache(ht.Keys.ARTIFACT_OBJECT_LIST,t),t},fetchAndCacheArtifacts:async function(){const t=await async function(){let t=await Ut.fetchArtifactJSON("en");return null===t&&(t=await Ft.fetchArtifactJson()),null===t?(console.error("Could not get artifact Json map from E7 server or flask server"),null):Object.fromEntries(t.filter(t=>null!==t.name).map(t=>[t.code,t.name]))}();return null===t?{}:(await ht.cache(ht.Keys.ARTIFACTS,t),t)},clearArtifactData:async function(){await ht.delete(ht.Keys.ARTIFACTS)},convertCodeToName:function(t,e){return e[t]||t}},Gt={date:t=>t[B.DATE_TIME]?new Date(`${t[B.DATE_TIME].slice(0,10)}T00:00:00`):"N/A",season:t=>t[B.SEASON_CODE],"is-first-pick":t=>t[B.FIRST_PICK]?1:0,"is-win":t=>t[B.WIN]?1:0,"victory-points":t=>t[B.P1_POINTS],"p1.picks":t=>t[B.P1_PICKS],"p2.picks":t=>t[B.P2_PICKS],"p1.prebans":t=>t[B.P1_PREBANS],"p2.prebans":t=>t[B.P2_PREBANS],"p1.postban":t=>t[B.P1_POSTBAN],"p2.postban":t=>t[B.P2_POSTBAN],prebans:t=>[...t[B.P1_PREBANS],...t[B.P2_PREBANS]],"p1.pick1":t=>t[B.P1_PICKS][0],"p1.pick2":t=>t[B.P1_PICKS][1],"p1.pick3":t=>t[B.P1_PICKS][2],"p1.pick4":t=>t[B.P1_PICKS][3],"p1.pick5":t=>t[B.P1_PICKS][4],"p2.pick1":t=>t[B.P2_PICKS][0],"p2.pick2":t=>t[B.P2_PICKS][1],"p2.pick3":t=>t[B.P2_PICKS][2],"p2.pick4":t=>t[B.P2_PICKS][3],"p2.pick5":t=>t[B.P2_PICKS][4],"p1.league":t=>t[B.P1_LEAGUE],"p2.league":t=>t[B.P2_LEAGUE],"p1.server":t=>t[B.P1_SERVER],"p2.server":t=>t[B.P2_SERVER],"p1.id":t=>Number(t[B.P1_ID]),"p2.id":t=>Number(t[B.P2_ID]),"p1.mvp":t=>t[B.P1_MVP],"p2.mvp":t=>t[B.P2_MVP],"is-first-turn":t=>t[B.FIRST_TURN],"first-turn-hero":t=>t[B.FIRST_TURN_HERO],turns:t=>t[B.TURNS],seconds:t=>t[B.SECONDS],"point-gain":t=>t[B.POINT_GAIN]};function Ht(t,e="i"){return new RegExp(`^(?:${t.source})(?=[,)\\s;]|$)`,e)}function $t(t,e="i"){return new RegExp(`^(?:${t.source})$`,e)}function Kt(t,e="i"){if(t.length<1)throw new Error("orRegex must have at least one pattern");let n=`(?:${t[0].source})`;for(let e=1;e<t.length;e++)n+=`|(?:${t[e].source})`;return new RegExp(n,e)}const Wt=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Vt=Object.keys(Gt),Yt=new RegExp(`^(?:${Vt.map(Wt).join("|")})`,"i"),qt=new RegExp(`(?:${["and","or","xor","not"].map(Wt).join("|")})(?=\\()`,"i"),zt=new RegExp(`(?:${["last-n"].map(Wt).join("|")})(?=\\()`,"i"),Qt=new RegExp(`(?:${["p1.equipment","p2.equipment","p1.artifact","p2.artifact","p1.cr","p2.cr"].map(Wt).join("|")})(?=\\()`,"i"),Jt=Kt([qt,zt,Qt]),Xt=/.*/i,Zt=/\d{4}-\d{2}-\d{2}/,te=/\{\s*\}/,ee=/-?\d+/,ne=/season-[1-9]+[0-9]*f?|current-season|last-season/i,re=/pvp_rta_ss[1-9]+[0-9]*f?/i,oe=new RegExp(`^${Zt.source}$`,"i"),ae=new RegExp(`(?:${ne.source})`,"i"),ie=Xt.source,se=ee.source,ce=Zt.source,ue=Yt.source,le=ae.source,fe=new RegExp(`(["'])(${ie})\\1`,"i"),pe=$t(fe),de=fe.source,he=new RegExp(`(?:${de}|${ie}|${ce})`,"i"),_e=new RegExp(`(?:${ue}|${le})`,"i"),Ee=he.source,Se=new RegExp(`\\{\\s*(?:${Ee}\\s*)(?:,\\s*${Ee}\\s*)*,?\\s*\\}|${te.source}`,"i"),ye=new RegExp(`${se}\\.\\.\\.=?${se}|${ce}\\.\\.\\.=?${ce}`),me=new RegExp(`^${ye.source}$`);let ge={STRING_RE:Xt,DATE_RE:Zt,INT_RE:ee,EMPTY_SET_RE:te,SET_ELEMENT_RE:he,SET_RE:Se,SET_LITERAL_RE:$t(Se),STRING_LITERAL_RE:pe,DATE_LITERAL_RE:oe,INT_LITERAL_RE:/^-?\d+$/,BOOL_LITERAL_RE:/^(true|false)$/i,RANGE_RE:ye,RANGE_LITERAL_RE:me,SEASON_RE:ne,SEASON_LITERAL_RE:$t(ne),SEASON_CODE_RE:re,SEASON_CODE_LITERAL_RE:$t(re),DATA_WORD_RE:ae,DATA_WORD_LITERAL_RE:$t(ae),FIELD_WORD_RE:Yt,FIELD_WORD_LITERAL_RE:$t(Yt),DATAFIELD_RE:_e,GLOBAL_FILTER_RE:/last-n\(\d+\)/i,ANCHORED_STR_LITERAL_RE:$t(pe),CLAUSE_FUNCTIONS_RE:qt,DIRECT_FUNCTIONS_RE:Qt,GLOBAL_FUNCTIONS_RE:zt,FUNCTIONS_RE:Jt,FUNCTION_CALL_RE:/\(.*\)/i,padRegex:Ht,anchorExp:$t,tokenMatch:function(t){return t.match(Jt)?"keyword":t.match(/\s+(?:!=|<|>|=|>=|<=|in|!in)(?=\s+)/i)?"operator":t.match(new RegExp(`[a-z0-9."'}=)-]${_e.source}(?=[,)\\s;]|$)`,"i"))?null:t.match(Ht(Yt))?"field":t.match(Ht(ae))?"declared-data":t.match(Ht(fe))?"string":t.match(Ht(Se))?"set":t.match(Ht(ye))?"range":t.match(/[^(,\s;.=0-9\-]+\d+/i)?null:t.match(Ht(ee))||t.match(Ht(Zt))||t.match(/(?:^|\s)(?:true|false)(?=[,)\s;]|$)/i)?"declared-data":t.match(/[\(\)\{\}\;\,]/)?"bracket":(t.next(),null)},orRegex:Kt,escapeRegex:Wt};function ve(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Te(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Te(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Te(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Te(f,"constructor",u),Te(u,"constructor",c),c.displayName="GeneratorFunction",Te(u,o,"GeneratorFunction"),Te(f),Te(f,o,"Generator"),Te(f,r,function(){return this}),Te(f,"toString",function(){return"[object Generator]"}),(ve=function(){return{w:a,m:p}})()}function Te(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Te=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Te(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},Te(t,e,n,r)}function we(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Ae(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){we(a,r,o,i,s,"next",t)}function s(t){we(a,r,o,i,s,"throw",t)}i(void 0)})}}var be,Oe,Re,Pe={fetchAndCacheSeasonDetails:(Re=Ae(ve().m(function t(){var e,n,r,o,a,i,s;return ve().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Ft.fetchSeasonDetails();case 1:if(!(e=t.v).error){t.n=2;break}throw new Error("Could not fetch season details: ".concat(e.error));case 2:return(n=e.seasonDetails).forEach(function(t){t.range=[t.Start,t.End].map(function(t){return new Date("".concat(t.split(" ")[0],"T00:00:00"))}),t["Season Number"]=String(t["Season Number"])}),n.sort(function(t,e){return parseInt(t["Season Number"])-parseInt(e["Season Number"])}),r=[n[0]],o=n[0],n.slice(1).forEach(function(t){var e=new Date(+o.range[1]+x),n=new Date(+t.range[0]-x),a=o["Season Number"]+"f",i={"Season Number":a,Code:"pvp_rta_ss"+a,Season:"Pre ".concat(t.Season),Start:e.toISOString().slice(0,10),End:n.toISOString().slice(0,10),Status:"Complete",range:[e,n]};r.push(i),r.push(t),o=t}),o.range[1]<new Date&&(a=new Date(+r.at(-1).range[1]+x),i=o["Season Number"]+"f",s={"Season Number":i,Code:"pvp_rta_ss"+i,Season:"Active Pre-Season",Start:a.toISOString().slice(0,10),End:"N/A",Status:"Active",range:[a,new Date]},r.push(s)),r.reverse(),t.n=3,ht.cache(ht.Keys.SEASON_DETAILS,r);case 3:return t.a(2,r)}},t)})),function(){return Re.apply(this,arguments)}),getSeasonDetails:(Oe=Ae(ve().m(function t(){var e,n;return ve().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ht.get(ht.Keys.SEASON_DETAILS);case 1:if(null==(e=t.v)){t.n=2;break}n=e,t.n=4;break;case 2:return t.n=3,Pe.fetchAndCacheSeasonDetails();case 3:n=t.v;case 4:return t.a(2,n)}},t)})),function(){return Oe.apply(this,arguments)}),clearSeasonDetails:(be=Ae(ve().m(function t(){return ve().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ht.delete(ht.Keys.SEASON_DETAILS);case 1:case 2:return t.a(2)}},t)})),function(){return be.apply(this,arguments)}),getSeasonNumFromCode:function(t){return t.split("_")[-1]}};const Le=Pe;class Ce extends Error{constructor(t){super(t),this.name="Filter Syntax Exception"}}class Ie extends Error{constructor(t){super(t),this.name="Filter Type Exception"}}class Ne extends Error{constructor(t){super(t),this.name="Filter Validation Error"}}const De={"(":")","{":"}",'"':'"',"'":"'"},ke={"'":'"','"':"'"},Me=Object.fromEntries(Object.entries(De).filter(([t,e])=>t!==e).map(([t,e])=>[e,t]));function Fe(t){const e={};for(const n of t)e[n]=(e[n]||0)+1;return e}const xe={SyntaxException:Ce,TypeException:Ie,ValidationError:Ne,getCharCounts:Fe,tokenizeWithNestedEnclosures:function(t,e=" ",n=0,r=!0){const o=[];let a="",i=[];for(let s=0;s<t.length;s++){const c=t[s];if(e.includes(c)&&i.length===n)a&&(o.push(r?a.trim():a),a="");else if(Me[c]){const e=Me[c];if(i.length>n&&(a+=c),i[i.length-1]!==e){const e=Fe(t);throw(e["'"]||0)%2!=0||(e['"']||0)%2!=0?new Ce(`Error tokenizing: Unbalanced closing character at position ${s}; got string: '${t}' ; if a str type has quote characters in it, wrap it in the opposite quote character.`):new Ce(`Error tokenizing: Unbalanced closing character at position ${s}; got string: '${t}'`)}i.pop()}else i.length>=n&&(a+=c),!De[c]||ke[c]&&i[i.length-1]===ke[c]||(i[i.length-1]===De[c]&&c===De[c]?i.pop():i.push(c))}if(i.length>0)throw new Error(`Unbalanced enclosures in input string; unresolved characters from enclosure stack: [ ${i.join(", ")} ]`);return a&&o.push(r?a.trim():a),o},parseDate:function(t){if(!ge.DATE_LITERAL_RE.test(t))throw new Ce(`Invalid date; must be in the format: YYYY-MM-DD ( regex: ${ge.DATE_LITERAL_RE.source} ); got: '${t}'`);const e=t.split(" ")[0],n=new Date(`${e}T00:00:00`);if(isNaN(n.getTime()))throw new Ce(`Invalid date; could not be parsed as a valid date; got: '${t}'`);const r=n.toISOString().split("T")[0],[o,a,i]=r.split("-").map(Number);if(n.getFullYear()!==o||n.getMonth()+1!==a||n.getDate()!==i)throw new Ce(`Invalid date; parsed date: ${n.toISOString()} does not match passed in string: ${e}`);return n.toISOString(),n.constructor.name,n},tryConvert:function(t,e,n,r=null){null===r&&(r=`Could not convert ${n} to ${e}`);try{return t(n)}catch(t){throw new Ie(`${r}: ${t.message}`)}},trimSurroundingQuotes:function(t){return t.replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}},Ue=new Set("'\"(),_-.=; ><!1234567890{}abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),je=Object.fromEntries(Object.values(F).map(t=>[t.toLowerCase(),t]));class Be{}const Ge={Hero:new class extends Be{parse(t,e){return jt.getHeroByName(t,e.HeroDicts)?.name??null}parserType="Hero"},League:new class extends Be{parse(t){return j[t]}parserType="League"},Server:new class extends Be{parse(t){return M[t]}parserType="Server"},Equipment:new class extends Be{parse(t){return je[t.toLowerCase()]}parserType="Equipment"},Artifact:new class extends Be{parse(t,e){return e.ARTIFACT_LOWERCASE_STRINGS_MAP[t.toLowerCase()]}parserType="Artifact"},Season:new class extends Be{parse(t,e){let n;if("current-season"===t)return e.SEASON_DETAILS[0].Code;if("last-season"===t)return e.SEASON_DETAILS[1].Code;if(ge.SEASON_LITERAL_RE.test(t))n=t.split("-").at(-1);else{if(!ge.SEASON_CODE_LITERAL_RE.test(t))return null;n=t.split("_ss").at(-1)}e.SEASON_DETAILS.map(t=>t.Code.split("_").at(-1));return e.SEASON_DETAILS.find(t=>t.Code.split("_ss").at(-1)===n)?.Code}parserType="Season Code"}},He=new Set(["p1.picks","p2.picks","p1.prebans","p2.prebans","prebans"]),$e={FIELD:"FIELD",RANGE:"RANGE",SET:"SET",INT:"INT",DATE:"DATE",BOOL:"BOOL",STRING:"STRING"};class Ke{}class We extends Ke{type=$e.FIELD;rawString;extractFn;constructor(t){if(super(),this.rawString=t,!Gt[t])throw new Error("Invalid field");this.extractFn=Gt[t]}getData(){throw new Error("Not implemented for Field")}extractData(t){return this.extractFn(t)}asString(){return`${this.rawString}`}}class Ve extends Ke{rawString;constructor(t){super(),this.rawString=t}getData(){return this.data}extractData(t){throw new Error("Not implemented for Literals")}asString(){return`${this.fmtString}`}}class Ye extends Ve{type=$e.STRING;fmtString;data;constructor(t,e,n=Object.values(Ge)){super(t),t=xe.trimSurroundingQuotes(t),this.data=this.processString(t,e,n),this.fmtString=this.data}processString(t,e,n){const r=function(t,e,n){for(const r of n){const n=r.parse(t,e);if(r.parserType,n)return n}return null}(t,e,n);if(!r){const e=n.map(t=>t.parserType).join(", ");throw new xe.ValidationError(`Invalid string literal: '${t}' ; clould not be parsed as a valid instance of any of the following: [${e}]`)}return r}}class qe extends Ve{type=$e.INT;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){const e=parseInt(t);if(isNaN(e))throw new xe.ValidationError(`Invalid integer literal: '${t}'`);return e}}class ze extends Ve{type=$e.BOOL;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){if("true"===t)return!0;if("false"===t)return!1;throw new xe.ValidationError(`Invalid boolean literal: '${t}'`)}}class Qe extends Ve{type=$e.DATE;fmtString;data;constructor(t){super(t),this.data=this.processString(t),this.fmtString=t}processString(t){return xe.parseDate(t)}}class Je{start;end;endInclusive;constructor(t,e,n){this.start=t,this.end=e,this.endInclusive=n}has(t){return typeof t==typeof this.start&&(!(t<this.start)&&(!(t>this.end)&&(t!==this.end||this.endInclusive)))}includes(t){return this.has(t)}}const Xe=[t=>ge.DATE_LITERAL_RE.test(t)?new Qe(t):null,t=>ge.INT_LITERAL_RE.test(t)?new qe(t):null];function Ze(t,e,n,r){let o=r(t),a=r(e);return null===o||null===a?null:new Je(o.data,a.data,n)}class tn extends Ve{type=$e.RANGE;fmtString;data;constructor(t,e){super(t),this.fmtString=t,this.data=this.processString(t,e)}processString(t,e){const n=t.split("..."),r=n[0];let o="="===n[1].charAt(0);const a=n[1].slice(o?1:0);for(const t of Xe){const e=Ze(r,a,o,t);if(null!==e)return e}throw new xe.ValidationError(`Invalid range literal: '${t}' ; ranges must be homogenous and of the format x...y or x...=y for the types: [Date, Integer]`)}}const en=[...Xe],nn=(t,e,n)=>ge.STRING_RE.test(t)?new Ye(t,e,n):null;class rn extends Ve{type=$e.SET;fmtString;data;constructor(t,e,n=Object.values(Ge)){super(t),this.fmtString=t,this.data=this.processString(t,e,n)}processString(t,e,n){const r=xe.tokenizeWithNestedEnclosures(t,",",1,!0),o=new Set;for(const a of r){for(const t of en){const e=t(a);e&&o.add(e.data)}const r=nn(a,e,n);if(!r)throw new xe.ValidationError(`Invalid set element: '${t}' ; could not be parsed as a valid instance of any of the following types: [Date, Integer, String]`);o.add(r.data)}return this.fmtString=`{${Array.from(o).join(", ")}}`,o}}const on={StringLiteral:Ye,IntLiteral:qe,BoolLiteral:ze,DateLiteral:Qe,RangeLiteral:tn,SetLiteral:rn,Field:We,BaseEltTypes:$e,FIELD_EXTRACT_FN_MAP:Gt,parseBaseElement:function(t,e){if(ge.STRING_LITERAL_RE.test(t))return new Ye(t,e);if(ge.INT_LITERAL_RE.test(t))return new qe(t);if(ge.BOOL_LITERAL_RE.test(t))return new ze(t);if(ge.DATE_LITERAL_RE.test(t))return new Qe(t);if(ge.RANGE_LITERAL_RE.test(t))return new tn(t,e);if(ge.SET_LITERAL_RE.test(t))return new rn(t,e);if(ge.SEASON_LITERAL_RE.test(t))return new Ye(t,e,[Ge.Season]);if(ge.FIELD_WORD_LITERAL_RE.test(t))return new We(t);throw new xe.ValidationError(`Invalid base element: '${t}' ; could not be parsed as a Field or Literal.`)},COLLECTION_FIELDS_SET:He},an={">":(t,e)=>t>e,"<":(t,e)=>t<e,"=":(t,e)=>t===e,">=":(t,e)=>t>=e,"<=":(t,e)=>t<=e,"!=":(t,e)=>t!==e},sn="in",cn="compare";class un{}class ln extends un{type=sn;opStr;negate=!1;constructor(t=!1){super(),this.negate=t,this.opStr=this.negate?"!in":"in"}call(t,e){const n=Array.isArray(e)?e.includes(t):e.has(t);return this.negate?!n:n}}class fn extends un{type=cn;opStr;compareFn;constructor(t){if(super(),this.opStr=t,this.compareFn=an[t],!this.compareFn)throw new Error(`Unknown operator: ${t}`)}call(t,e){return this.compareFn(t,e)}}function pn(t){switch(t){case"in":return new ln;case"!in":return new ln(!0);default:return new fn(t)}}const dn="and",hn="or",_n="xor",En="not",Sn="last-n",yn="equipment",mn="artifact",gn="cr",vn="base-filter",Tn="CLAUSE_FN",wn="HERO_LIST_FN",An="GLOBAL_FN",bn="BASE_FILTER";class On{constructor(...t){}}class Rn extends On{}class Pn extends Rn{fnType=Tn;fns=[];constructor(...t){super(),this.fns=t}asString(t=""){let e="";const n=t+"   ";return this.fns.forEach(t=>e+=`${t.asString(n)},\n`),`${t}${this.fnName}(\n${e.trimEnd()}\n${t})`}}class Ln extends Pn{fnName=dn;fnType=Tn;call(t){return this.fns.every(e=>e.call(t))}}class Cn extends Pn{fnName=hn;fnType=Tn;call(t){return this.fns.some(e=>e.call(t))}}class In extends Pn{fnName=_n;fnType=Tn;call(t){let e=!1;for(let n of this.fns)e=!e&&n.call(t)||e&&!n.call(t);return e}}class Nn extends Pn{fnName=En;fnType=Tn;constructor(...t){if(super(...t),1!==this.fns.length)throw new xe.SyntaxException(`Invalid NOT function call ; accepts exactly 1 argument ; got: [${this.fns}]`)}call(t){return!this.fns[0].call(t)}}class Dn extends Rn{fnType=wn;getHeroes(t){return this.isPlayer1?t[B.P1_PICKS]:t[B.P2_PICKS]}asString(t=""){return`${t}${this.fnName}(${this.argFmtString})`}}class kn extends Dn{fnName=gn;fnType=wn;heroName;crThreshold=0;operator;targetField;isPlayer1=!1;argFmtString;constructor(t,e){super();const n=t.includes(",")?",":" ",r=xe.tokenizeWithNestedEnclosures(t,n,1,!0);if(3!==r.length)throw new xe.SyntaxException(`Invalid CR function call ; accepts exactly 3 arguments ; got: [${r}] from str: ${t}`);const o=parseInt(r[2]);if(isNaN(o))throw new xe.TypeException(`Invalid CR function call ; third argument must be a valid integer literal ; got: '${r[2]}' from str: ${t}`);const a=pn(r[1]);if(!(a instanceof fn))throw new xe.TypeException(`Invalid CR function call ; second argument must be a valid comparison operator ; got: '${r[1]}' from str: ${t}`);this.heroName=new on.StringLiteral(r[0],e,[Ge.Hero]).data,this.crThreshold=o,this.operator=a,this.isPlayer1=t.includes("p1."),this.targetField=t=>t[B.CR_BAR],this.argFmtString=`${this.heroName} ${this.operator.opStr} ${this.crThreshold}`}call(t){const e=this.getHeroes(t),n=this.targetField(t).find(t=>t[0]===this.heroName);return!!n&&(!!e.includes(this.heroName)&&this.operator.call(n,this.crThreshold))}}function Mn(t,e){for(const n in t)if(t[n]>(e[n]||0))return!1;return!0}class Fn extends Dn{fnName=yn;fnType=wn;heroName;targetEquipCounts;isPlayer1=!1;argFmtString;targetField;constructor(t,e){super();const n=xe.tokenizeWithNestedEnclosures(t,",",1,!0);if(2!==n.length)throw new xe.SyntaxException(`Invalid equipment function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${t}`);const r=n[1].includes("{")?n[1]:`{${n[1]}}`;let o=xe.tokenizeWithNestedEnclosures(r,",",1,!0);o=o.map(t=>new on.StringLiteral(t,e,[Ge.Equipment]).data),this.targetEquipCounts=b(o),this.heroName=new on.StringLiteral(n[0],e,[Ge.Hero]).data,this.isPlayer1=t.includes("p1."),this.argFmtString=`${this.heroName}, {${o.join(",")}}`,this.targetField=t=>this.isPlayer1?t[B.P1_EQUIPMENT]:t[B.P2_EQUIPMENT]}call(t){const e=this.getHeroes(t),n=this.targetField(t);for(let t=0;t<e.length;t++)if(e[t]===this.heroName){const e=b(n[t]);return Mn(this.targetEquipCounts,e)}return!1}}class xn extends Dn{fnName=mn;fnType=wn;heroName;targetArtifacts;isPlayer1=!1;argFmtString;targetField;constructor(t,e){super();const n=xe.tokenizeWithNestedEnclosures(t,",",1,!0);if(2!==n.length)throw new xe.SyntaxException(`Invalid artifact function call ; accepts exactly 2 arguments ; got: [${n}] from str: ${t}`);const r=n[1].includes("{")?n[1]:`{${n[1]}}`;let o=xe.tokenizeWithNestedEnclosures(r,",",1,!0);o=o.map(t=>new on.StringLiteral(t,e,[Ge.Artifact]).data),this.targetArtifacts=o,this.heroName=new on.StringLiteral(n[0],e,[Ge.Hero]).data,this.isPlayer1=t.includes("p1."),this.argFmtString=`${this.heroName}, {${o.join(", ")}}`,this.targetField=t=>this.isPlayer1?t[B.P1_ARTIFACTS]:t[B.P2_ARTIFACTS]}call(t){const e=this.getHeroes(t),n=this.targetField(t);for(let t=0;t<e.length;t++)if(e[t]===this.heroName)return this.targetArtifacts.some(e=>n[t].includes(e));return!1}}class Un extends On{fnType=An;asString(t=""){return`${t}${this.fnName}(${this.argFmtString})`}}class jn extends Un{fnName=Sn;fnType=An;argFmtString;n;constructor(t){super();const e=xe.tokenizeWithNestedEnclosures(t,",",1,!0);if(1!==e.length)throw new xe.SyntaxException(`Invalid last-n function call ; accepts exactly 1 argument ; got: [${e}] from str: ${t}`);this.n=new on.IntLiteral(e[0]).data,this.argFmtString=`${this.n}`}call(t){return t.slice(-this.n)}}function Bn(t,e,n){const r=`${t.asString()} ${e.opStr} ${n.asString()}`;if(t instanceof on.Field&&n instanceof on.Field)throw new xe.ValidationError(`Invalid base filter; fields cannot be compared with other fields ; got string: [${r}]`);if(t.type!==on.BaseEltTypes.FIELD&&n.type!==on.BaseEltTypes.FIELD)throw new xe.ValidationError(`Invalid base filter; every base filter must have at least one field ; got string: [${r}]`);if(e instanceof ln&&(o=n,!(on.COLLECTION_FIELDS_SET.has(o.rawString)||n instanceof on.RangeLiteral||n instanceof on.SetLiteral)))throw new xe.ValidationError(`Invalid base filter; 'in' operators can only be used with Ranges, Sets, or Fields that correspond to sets like 'p1.picks' ; got string: [${r}]`);var o;return!0}class Gn extends Rn{fnType=bn;fnName=vn;fmtString;fn;constructor(t,e){super();const n=xe.tokenizeWithNestedEnclosures(t," ",0,!0);if(3!==n.length)throw new xe.SyntaxException(`Invalid base filter; filters must have 3 tokens and be of the form: ['X', operator, 'Y']; got: [${n}] tokens from str: ${t}`);let[r,o,a]=n;const i=pn(o),s=on.parseBaseElement(r,e),c=on.parseBaseElement(a,e);if(s.asString(),c.asString(),Bn(s,i,c),s instanceof on.Field&&!(c instanceof on.Field))this.fn=t=>i.call(s.extractData(t),c.getData());else{if(s instanceof on.Field||!(c instanceof on.Field))throw new xe.ValidationError("Invalid base filter; filters must contain a Field and a Literal; got: "+t);this.fn=t=>i.call(s.getData(),c.extractData(t))}this.fmtString=`${s.asString()} ${o} ${c.asString()}`}call(t){return this.fn(t)}asString(t=""){return`${t}${this.fmtString}`}}const Hn={[vn]:Gn,[dn]:Ln,[hn]:Cn,[En]:Nn,[_n]:In,[Sn]:jn,[yn]:Fn,[mn]:xn,[gn]:kn},$n={AND:Ln,OR:Cn,NOT:Nn,XOR:In,LAST_N:jn,EQUIPMENT:Fn,ARTIFACT:xn,CR:kn,BASE_FILTER:Gn};function Kn(t){return function(t,e,n){for(let r of t)if(!e.has(r))throw new xe.SyntaxException(`Invalid character within <${n}> ; ' ${r} ' is not allowed; got string: '${t}'`)}(t=t.replace(/[\n\t\r]/g," ").replace(/\s+/g," "),Ue,"Main Filter String"),t=t.toLowerCase()}class Wn{_filters;rawString;preParsedString;references;constructor(){this._filters=[],this.rawString="",this.preParsedString="",this.references={HeroDicts:null,ARTIFACT_LOWERCASE_STRINGS_MAP:{},SEASON_DETAILS:[]}}async addReferences(t=null){if(null===(t=t||await jt.getHeroDicts()))throw new Error("Hero Manager could not be retrieved to parse filters.");const e=await Le.getSeasonDetails();if(null===e)throw new Error("Season Details could not be retrieved to parse filters.");const n=await Bt.getArtifactLowercaseNameMap();this.references={HeroDicts:t,ARTIFACT_LOWERCASE_STRINGS_MAP:n,SEASON_DETAILS:e}}getFilters(){return function(t){const e=[],n=[];for(const r of t)r instanceof Un?e.push(r):n.push(r);return[...e,...n]}(this._filters)}asString(){return`[\n${this._filters.map(t=>t.asString("   ")).join(";\n")};\n]`}static async getFiltersFromCache(t=null){const e=await ht.get(ht.Keys.FILTER_STR);if(null===e)return[];return(await this.fromFilterStr(e,t)).getFilters()}static async fromFilterStr(t,e=null){const n=new Wn;return n.rawString=t,await n.addReferences(e),n.preParsedString=Kn(t),n._filters=n.parse(n.preParsedString),n}parseList(t){return t.reduce((t,e)=>(t.push(...this.parse(e)),t),[])}parse(t){if(""===(t=t.trim()))return[];if(t.includes(";")){const e=t.split(";");return this.parseList(e)}const e=t.split("(")[0].replace(/p[1-2]\./i,""),n=xe.tokenizeWithNestedEnclosures(t,",",1,!0);switch(e){case dn:case hn:case En:case _n:const r=function(t,e){for(const n of t)if(n instanceof Un)throw new xe.SyntaxException(`Global filters not allowed in clause functions; got: ${n.asString()} from string: "${e}"`);return t.filter(t=>t instanceof Rn)}(this.parseList(n),t);return[new Hn[e](...r)];case Sn:return[new $n.LAST_N(t)];case yn:case mn:case gn:return[new Hn[e](t,this.references)];default:if(ge.FUNCTION_CALL_RE.test(t))throw new xe.SyntaxException(`Filter String is not a valid function call but a parenthese block was detected; got: ${t}`);return[new $n.BASE_FILTER(t,this.references)]}}}function Vn(t){return Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vn(t)}function Yn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return qn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function qn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Jn(r.key),r)}}function Qn(t,e,n){return e&&zn(t.prototype,e),n&&zn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jn(t){var e=function(t,e){if("object"!=Vn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Vn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Vn(e)?e:e+""}var Xn={RED:"text-danger",GREEN:"text-safe"},Zn=Qn(function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=e,this.docElement=n,this.classList=r});function tr(t){if(!t instanceof Zn)throw new Error("Only instances of TextPacket can be passed to this function")}var er={queue:[],autoClearElements:[],TextPacket:Zn,STYLES:Xn,clearStyles:function(t){for(var e=0,n=Object.values(Xn);e<n.length;e++){var r=n[e];t.classList.remove(r)}},write:function(t){tr(t),t.docElement.textContent=t.text,this.clearStyles(t.docElement),t.classList.forEach(function(e){t.docElement.classList.add(e)})},push:function(t){tr(t),this.queue.push(t)},pushFromObj:function(t){var e=t.text,n=t.docElement,r=t.classList;this.push(new Zn(e,n,r))},bindAutoClear:function(t){var e,n=Yn(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.autoClearElements.push(r)}}catch(t){n.e(t)}finally{n.f()}},processQueue:function(){var t=this;this.queue.forEach(function(e){t.write(e)}),this.queue=[]},clearMessages:function(){var t,e=Yn(this.autoClearElements);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.textContent="",this.clearStyles(n)}}catch(t){e.e(t)}finally{e.f()}}};var nr,rr,or={queueSelectDataMsgGreen:function(t){er.push(new Zn(t,bt.HOME_PAGE.SELECT_DATA_MSG,[Xn.GREEN]))},queueSelectDataMsgRed:function(t){er.push(new Zn(t,bt.HOME_PAGE.SELECT_DATA_MSG,[Xn.RED]))},queueFilterMsgGreen:function(t){er.push(new Zn(t,bt.HOME_PAGE.FILTER_MSG,[Xn.GREEN]))},queueFilterMsgRed:function(t){er.push(new Zn(t,bt.HOME_PAGE.FILTER_MSG,[Xn.RED]))}};function ar(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ir(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ir(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,ir(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,ir(f,"constructor",u),ir(u,"constructor",c),c.displayName="GeneratorFunction",ir(u,o,"GeneratorFunction"),ir(f),ir(f,o,"Generator"),ir(f,r,function(){return this}),ir(f,"toString",function(){return"[object Generator]"}),(ar=function(){return{w:a,m:p}})()}function ir(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ir=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){ir(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},ir(t,e,n,r)}function sr(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}const cr={validateFilterSyntax:(nr=ar().m(function t(e){var n,r,o;return ar().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,jt.getHeroDicts();case 1:return n=t.v,r=document.getElementById("filterMSG"),t.p=2,t.n=3,Wn.fromFilterStr(e,n);case 3:return t.v.asString(),er.write(new Zn("Validation Passed",r,[er.STYLES.GREEN])),t.a(2,!0);case 4:return t.p=4,o=t.v,console.error(o),er.write(new Zn("Validation Failed: ".concat(o.message),r,[er.STYLES.RED])),t.a(2,!1)}},t,null,[[2,4]])}),rr=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=nr.apply(t,e);function a(t){sr(o,n,r,a,i,"next",t)}function i(t){sr(o,n,r,a,i,"throw",t)}a(void 0)})},function(t){return rr.apply(this,arguments)}),setScrollPercent:function(t){"Scrolling to ".concat(t,"%");var e=t/100*(document.documentElement.scrollHeight-window.innerHeight),n=document.documentElement,r=n.style.scrollBehavior;n.style.scrollBehavior="auto",window.scrollTo({top:e}),n.style.scrollBehavior=r},getScrollPercent:function(){var t=window.scrollY||document.documentElement.scrollTop,e=document.documentElement.scrollHeight-window.innerHeight;return 0===e?0:t/e*100},setVisibility:function(t,e){e?t.classList.remove("d-none"):t.classList.add("d-none")}};var ur={SELECT_DATA:"select-data",SHOW_STATS:"show-stats",LOAD_DATA:"load-data"};const lr={[P]:ht.Keys.GLOBAL_USERS,[N]:ht.Keys.EU_USERS,[I]:ht.Keys.ASIA_USERS,[C]:ht.Keys.JPN_USERS,[L]:ht.Keys.KOR_USERS};function fr(t,e){return{id:t.nick_no,name:t.nick_nm,code:t.code,rank:t.rank,world_code:e}}async function pr(t){const e=await ht.get(lr[t]);if(null!==e)return e;const n=await async function(t){const e=await Ut.fetchUserJSON(t);if(!e||"object"==typeof e&&!("users"in e))return null;const n=e;return Object.fromEntries(n.users.map(e=>[e.nick_no,fr(e,t)]))}(t);return await ht.cache(lr[t],n),n}const dr=t=>D[t];async function hr(t,e){const n=await pr(e),r=n?Object.values(n):[];if(0===r.length)return dr(e),{user:null,ok:!1};let o,a;if(t.id)o=t.id,a=t=>t.id;else{if(!t.name)throw new Error("Must pass a user object with either user.name or user.id to find user");o=t.name.toLowerCase(),a=t=>t.name.toLowerCase()}return function(t,e,n){const r=e.find(e=>n(e)===t);return r?(JSON.stringify(r),{user:r,ok:!0}):{user:null,ok:!0}}(o,r,a)}const _r={getUserMap:pr,findUser:async function(t){if(JSON.stringify(t),!t.name&&!t.id||!t.world_code)throw new Error("Must pass a user object with either user.name or user.id, and user.world_code to find user");let e=t.id?`Numeric ID: ${t.id}`:`Name: '${t.name}'`,n=null;if(n=await hr(t,t.world_code),n.ok||(n=await Ft.fetchUser(t)),n.ok){const r=n.user;if(null===r)throw new Error(`Could not find user with ${e} in Server: ${dr(t.world_code)}`);return r}throw new Error(`Function did not properly terminate: ${JSON.stringify(n)}`)},setUser:async function(t){await ht.cache(ht.Keys.USER,t)},getUser:async function(){return await ht.get(ht.Keys.USER)},clearUserData:async function(){await ht.clearUserData()},clearUserDataLists:async function(){await ht.clearUserLists()}};function Er(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Sr(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Sr(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Sr(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Sr(f,"constructor",u),Sr(u,"constructor",c),c.displayName="GeneratorFunction",Sr(u,o,"GeneratorFunction"),Sr(f),Sr(f,o,"Generator"),Sr(f,r,function(){return this}),Sr(f,"toString",function(){return"[object Generator]"}),(Er=function(){return{w:a,m:p}})()}function Sr(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Sr=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Sr(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},Sr(t,e,n,r)}function yr(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function mr(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){yr(a,r,o,i,s,"next",t)}function s(t){yr(a,r,o,i,s,"throw",t)}i(void 0)})}}var gr=new Set(Object.values(ur));function vr(t){return!!gr.has(t)||(console.error("Invalid page state: ".concat(t)),!1)}function Tr(t){switch(t){case ur.SELECT_DATA:return bt.HOME_PAGE.SELECT_DATA_BODY;case ur.SHOW_STATS:return bt.HOME_PAGE.SHOW_STATS_BODY;case ur.LOAD_DATA:return bt.HOME_PAGE.LOAD_DATA_BODY;default:console.error("Invalid page state: ".concat(t))}}var wr,Ar,br,Or={getState:(br=mr(Er().m(function t(){var e,n,r,o;return Er().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ht.get(ht.Keys.HOME_PAGE_STATE);case 1:if(r=e=t.v,!(n=null!==r)){t.n=2;break}n=void 0!==e;case 2:if(!n){t.n=3;break}o=e,t.n=4;break;case 3:o=ur.SELECT_DATA;case 4:return t.a(2,o)}},t)})),function(){return br.apply(this,arguments)}),setState:(Ar=mr(Er().m(function t(e){return Er().w(function(t){for(;;)switch(t.n){case 0:if(vr(e)){t.n=1;break}return t.a(2);case 1:return t.n=2,ht.cache(ht.Keys.HOME_PAGE_STATE,e);case 2:return t.a(2)}},t)})),function(t){return Ar.apply(this,arguments)}),resetState:(wr=mr(Er().m(function t(){return Er().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ht.delete(ht.Keys.HOME_PAGE_STATE);case 1:return t.a(2)}},t)})),function(){return wr.apply(this,arguments)})};function Rr(t){t?(bt.HOME_PAGE.USER_NAME.innerText=t.name,bt.HOME_PAGE.USER_ID.innerText=t.id,bt.HOME_PAGE.USER_SERVER.innerText=D[t.world_code]):(bt.HOME_PAGE.USER_NAME.innerText="(None)",bt.HOME_PAGE.USER_ID.innerText="(None)",bt.HOME_PAGE.USER_SERVER.innerText="(None)")}function Pr(t){return Lr.apply(this,arguments)}function Lr(){return(Lr=mr(Er().m(function t(e){return Er().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,_r.clearUserData();case 1:if(Rr(e),!e){t.n=2;break}return t.n=2,_r.setUser(e);case 2:return t.a(2)}},t)}))).apply(this,arguments)}function Cr(){return(Cr=mr(Er().m(function t(){return Er().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Pr(null);case 1:return t.a(2)}},t)}))).apply(this,arguments)}var Ir={homePageSetView:function(t){if(vr(t)){for(var e=0,n=Object.values(ur);e<n.length;e++){var r=n[e];if(t!==r){var o=Tr(r);"Hiding ".concat(o.id),cr.setVisibility(o,!1)}}var a=Tr(t);"Showing ".concat(a.id),cr.setVisibility(a,!0)}},homePageSetUser:Pr,homePageDrawUserInfo:Rr,homePageClearUserData:function(){return Cr.apply(this,arguments)}};const Nr={ACTIONS:{CLEAR_USER:"CLEAR_USER",SHOW_NO_USER_MSG:"SHOW_NO_USER_MSG",SHOW_DATA_ALREADY_CLEARED_MSG:"SHOW_DATA_ALREADY_CLEARED_MSG",QUERY_USER:"QUERY_USER"},getState:async function(){return await ht.get(ht.Keys.INTER_PAGE_MANAGER)??{actions:[],messages:[]}},setState:async function(t){await ht.cache(ht.Keys.INTER_PAGE_MANAGER,t)},pushActions:async function(t){let e=await this.getState();e.actions.push(...t),await this.setState(e)},pushMessages:async function(t){let e=await this.getState();e.messages.push(...t),await this.setState(e)},pushState:async function(t){let e=await this.getState();e.actions.push(...t.actions),e.messages.push(...t.messages),await this.setState(e)},flushState:async function(){const t=await this.getState();return await ht.delete(ht.Keys.INTER_PAGE_MANAGER),t}};function Dr(t){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dr(t)}function kr(t){return function(t){if(Array.isArray(t))return jr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ur(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(t,e)||Ur(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fr(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=Dr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Dr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Dr(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ur(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function Ur(t,e){if(t){if("string"==typeof t)return jr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jr(t,e):void 0}}function jr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Br=function(t){return t.filter(function(t){return t[B.FIRST_PICK]})};function Gr(t){return(100*t).toFixed(2)+"%"}function Hr(t,e){return Gr(0!==e?t/e:0)}function $r(t,e){var n=t[B.CR_BAR].find(function(t){return t[0]===e});return n?n[1]:null}function Kr(t,e,n){var r,o,a=function(t){return t.filter(function(t){return t[B.WIN]})}(t).length,i=t.length,s=0!==e?i/e:0,c=0!==i?a/i:0,u=t.reduce(function(t,e){return t+(e[B.P1_POSTBAN]===n||e[B.P2_POSTBAN]===n)},0),l=t.reduce(function(t,e){return t+(e[B.WIN]||e[B.P1_POSTBAN]===n||e[B.P2_POSTBAN]===n)},0),f=t.reduce(function(t,e){return t+e[B.POINT_GAIN]},0),p=0,d=0,h=0,_=xr(t);try{for(_.s();!(o=_.n()).done;){var E=$r(o.value,n);null!==E&&0!==E&&(p+=1,d+=E,100===E&&(h+=1))}}catch(t){_.e(t)}finally{_.f()}var S=Hr(d/100,p);return Fr(Fr(Fr(Fr(Fr(Fr(Fr(Fr(Fr(Fr(r={},Y,n),q,i),z,Gr(s)),Q,a),J,Gr(c)),X,u),Z,Hr(u,i)),tt,Hr(l,i)),et,2*a-i),nt,f),Fr(Fr(Fr(r,rt,S),ot,h),at,Hr(h,p))}function Wr(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new Set,r=0,o=Object.values(t);r<o.length;r++){var a=o[r];(e?a[B.P1_PICKS_PRIMES]:a[B.P2_PICKS_PRIMES]).forEach(function(t){n.add(t)})}return n}function Vr(t){var e=Math.floor(t/60),n=(t%60).toFixed(1);return 0===e?"".concat(n," secs"):"".concat(e," : ").concat(n,"s")}const Yr={getHeroStats:function(t,e){if(0===t.length)return{playerHeroStats:[],enemyHeroStats:[]};var n,r=t.length,o=Wr(t,!0),a=Wr(t,!1),i=[],s=[],c=xr(o);try{var u=function(){var o=n.value,a=jt.getHeroByPrime(o,e),s=t.filter(function(t){return t[B.P1_PICKS_PRIME_PRODUCT]%o===0});s.length>0&&i.push(Kr(s,r,a.name))};for(c.s();!(n=c.n()).done;)u()}catch(t){c.e(t)}finally{c.f()}var l,f=xr(a);try{var p=function(){var n=l.value,o=jt.getHeroByPrime(n,e),a=t.filter(function(t){return t[B.P2_PICKS_PRIME_PRODUCT]%n===0});a.length>0&&s.push(Kr(a,r,o.name))};for(f.s();!(l=f.n()).done;)p()}catch(t){f.e(t)}finally{f.f()}var d=Y;return{playerHeroStats:i.sort(function(t,e){return t[d].localeCompare(e[d])}),enemyHeroStats:s.sort(function(t,e){return t[d].localeCompare(e[d])})}},getFirstPickStats:function(t,e){if(0===(t=Br(Object.values(t))).length)return[];var n,r=t.length,o={},a=xr(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(0!==i[B.P1_PICKS_PRIMES].length){var s=i[B.P1_PICKS_PRIMES][0];s in o||(o[s]={wins:0,appearances:0}),o[s].wins+=i[B.WIN],o[s].appearances+=1}}}catch(t){a.e(t)}finally{a.f()}var c=Object.entries(o).map(function(t){var n=Mr(t,2),o=n[0],a=n[1];return{hero:jt.getHeroByPrime(o,e).name,wins:a.wins,appearances:a.appearances,win_rate:Gr(a.wins/a.appearances),appearance_rate:Gr(a.appearances/r),"+/-":2*a.wins-a.appearances}});return c.sort(function(t,e){return e.appearances-t.appearances}),c},getPrebanStats:function(t,e){var n=jt.getHeroByName("Empty",e).prime;if(0===t.length)return[];var r,o=function(e,r){return kr(new Set(t.map(function(t){return t[e][r]}).filter(function(t){return t&&t!==n})))},a=o(B.P1_PREBANS_PRIMES,0),i=o(B.P1_PREBANS_PRIMES,1),s=new Set([].concat(kr(a),kr(i))),c=[],u=xr(s);try{for(u.s();!(r=u.n()).done;){var l=r.value;c.push(l)}}catch(t){u.e(t)}finally{u.f()}var f,p=xr(s);try{for(p.s();!(f=p.n()).done;){var d,h=f.value,_=xr(s);try{for(_.s();!(d=_.n()).done;){var E=d.value;h<E&&c.push(h*E)}}catch(t){_.e(t)}finally{_.f()}}}catch(t){p.e(t)}finally{p.f()}for(var S=t.length,y=[],m=function(){var n=v[g],r=t.filter(function(t){return t["P1 Prebans Prime Product"]%n===0}),o=r.length;if(o<1)return 1;var a=r.reduce(function(t,e){return t+e.Win},0),i=S>0?o/S:0,s=o>0?a/o:0,c=2*a-o;y.push({preban:e.prime_pair_lookup[n],wins:a,appearances:o,appearance_rate:Gr(i),win_rate:Gr(s),"+/-":c})},g=0,v=c;g<v.length;g++)m();return y.sort(function(t,e){return e.appearances-t.appearances}),y},getPerformanceStats:function(t){var e,n={servers:[],leagues:[]},r=t.length,o=Object.values(D),a=Object.values(j),i=xr([].concat(kr(o.map(function(t){return["Server: ".concat(t),function(e){return e["P2 Server"]===t}]})),kr(a.map(function(t){return["League: ".concat(t),function(e){return e["P2 League"]===t}]}))));try{for(i.s();!(e=i.n()).done;){var s=Mr(e.value,2),c=s[0],u=s[1],l=t.filter(u);if(0!==l.length){var f=l.length,p=l.reduce(function(t,e){return t+e.Win},0),d=f>0?p/f:"N/A",h=r>0?f/r:"N/A",_=l.filter(function(t){return t["First Pick"]}),E=_.reduce(function(t,e){return t+e.Win},0),S=l.filter(function(t){return!t["First Pick"]}),y=S.reduce(function(t,e){return t+e.Win},0);(c.toLowerCase().includes("server")?n.servers:n.leagues).push({label:c,count:f,wins:p,win_rate:"N/A"===d?"N/A":Gr(d),frequency:Gr(h),"+/-":2*p-f,fp_games:_.length,sp_games:S.length,fp_wr:_.length>0?Gr(E/_.length):"N/A",sp_wr:S.length>0?Gr(y/S.length):"N/A"})}}}catch(t){i.e(t)}finally{i.f()}return[].concat(kr(n.servers),kr(n.leagues.slice(-4)))},getGeneralStats:function(t,e){t.sort(function(t,e){return new Date(t["Date/Time"])-new Date(e["Date/Time"])});var n,r=t.length,o=t.reduce(function(t,e){return t+e["Point Gain"]},0),a=r>0?o/r:0,i=t.reduce(function(t,e){return t+e.Turns},0),s=r>0?i/r:0,c=t.length>0?Math.max.apply(Math,kr(t.map(function(t){return t.Turns}))):0,u=t.reduce(function(t,e){return t+e.Seconds},0),l=r>0?u/r:0,f=t.length>0?Math.max.apply(Math,kr(t.map(function(t){return t.Seconds}))):0,p=Vr(l),d=Vr(f),h=t.reduce(function(t,e){return t+e["First Turn"]},0),_=Br(t),E=function(t){return t.filter(function(t){return!t[B.FIRST_PICK]})}(t),S=_.length,y=E.length,m=_.reduce(function(t,e){return t+e.Win},0),g=E.reduce(function(t,e){return t+e.Win},0),v=r?S/r:0,T=r?y/r:0,w=S?m/S:0,A=y?g/y:0,b=r?(m+g)/r:0,O=0,R=0,P=0,L=0,C=xr(t);try{for(C.s();!(n=C.n()).done;){n.value.Win?(P+=1,O=Math.max(O,P),L=0):(P=0,L+=1,R=Math.max(R,L))}}catch(t){C.e(t)}finally{C.f()}var I="N/A";return{first_pick_count:S,second_pick_count:y,first_pick_rate:S?Gr(v):I,second_pick_rate:y?Gr(T):I,first_pick_winrate:S?Gr(w):I,second_pick_winrate:y?Gr(A):I,total_winrate:r?Gr(b):I,total_battles:r,total_wins:m+g,max_win_streak:O,max_loss_streak:R,avg_ppg:a.toFixed(2),avg_turns:s.toFixed(2),avg_time:p,max_turns:c,max_time:d,first_turn_games:h,first_turn_rate:r?Gr(h/r):I}}};function qr(t){return qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qr(t)}function zr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Qr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function Qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Jr(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=qr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=qr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==qr(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xr(t,e){var n=function(t){var n,r;return null!==(n=null===(r=jt.getHeroByName(t,e))||void 0===r?void 0:r.prime)&&void 0!==n?n:e.Fodder.prime},r=function(t,e){return t*e};t[B.P1_PICKS_PRIMES]=t[B.P1_PICKS].map(n),t[B.P2_PICKS_PRIMES]=t[B.P2_PICKS].map(n),t[B.P1_PICKS_PRIME_PRODUCT]=t[B.P1_PICKS_PRIMES].reduce(r,1),t[B.P2_PICKS_PRIME_PRODUCT]=t[B.P2_PICKS_PRIMES].reduce(r,1),t[B.P1_PREBANS_PRIMES]=t[B.P1_PREBANS].map(n),t[B.P2_PREBANS_PRIMES]=t[B.P2_PREBANS].map(n),t[B.P1_PREBANS_PRIME_PRODUCT]=t[B.P1_PREBANS_PRIMES].reduce(r,1),t[B.P2_PREBANS_PRIME_PRODUCT]=t[B.P2_PREBANS_PRIMES].reduce(r,1)}function Zr(t,e,n){var r,o=function(t){var n,r;return null!==(n=null===(r=jt.getHeroByCode(t,e))||void 0===r?void 0:r.name)&&void 0!==n?n:e.Fodder.name},a=function(e,r){return r.map(function(r,o){return r?function(t){return Bt.convertCodeToName(t,n)||"None"}(r):function(e,n){return"p1"===e?t.p2_postban===t.p1_picks[n]:t.p1_postban===t.p2_picks[n]}(e,o)?"n/a":"None"})},i=function(t){return t.map(function(t){return t.map(function(t){return F[t]||t})})},s=t.cr_bar.find(function(t){return 100===t[1]}),c=!!s&&t.p1_picks.includes(s[0]),u=(Jr(Jr(Jr(Jr(Jr(Jr(Jr(Jr(Jr(Jr(r={},B.SEASON,t.season_name||"None"),B.SEASON_CODE,t.season_code||"None"),B.DATE_TIME,t.date_time),B.SECONDS,t.seconds),B.TURNS,t.turns),B.SEQ_NUM,t.seq_num),B.P1_ID,t.p1_id.toString()),B.P1_SERVER,D[t.p1_server]||t.p1_server||"None"),B.P2_ID,t.p2_id.toString()),B.P2_SERVER,D[t.p2_server]||t.p2_server||"None"),Jr(Jr(Jr(Jr(Jr(Jr(Jr(Jr(Jr(Jr(r,B.P1_LEAGUE,A(t.p1_league)||"None"),B.P2_LEAGUE,A(t.p2_league)||"None"),B.P1_POINTS,t.p1_win_score),B.POINT_GAIN,t.p1_point_delta||null),B.WIN,1===t.win),B.FIRST_PICK,1===t.first_pick),B.FIRST_TURN,!!c),B.FIRST_TURN_HERO,s?o(s[0]):"n/a"),B.CR_BAR,t.cr_bar.map(function(t){return t&&2==t.length?[o(t[0]),t[1]]:["n/a",0]})),B.P1_PREBANS,t.p1_prebans.map(o)),Jr(Jr(Jr(Jr(Jr(Jr(Jr(Jr(Jr(Jr(r,B.P2_PREBANS,t.p2_prebans.map(o)),B.P1_PICKS,t.p1_picks.map(o)),B.P2_PICKS,t.p2_picks.map(o)),B.P1_POSTBAN,o(t.p1_postban)),B.P2_POSTBAN,o(t.p2_postban)),B.P1_EQUIPMENT,i(t.p1_equipment)),B.P2_EQUIPMENT,i(t.p2_equipment)),B.P1_ARTIFACTS,a("p1",t.p1_artifacts)),B.P2_ARTIFACTS,a("p2",t.p2_artifacts)),B.P1_MVP,o(t.p1_mvp)),Jr(r,B.P2_MVP,o(t.p2_mvp)));return Xr(u,e),u}function to(t,e,n){n=null!=n?n:Bt.getArtifactCodeToNameMap();var r,o=[],a=zr(t);try{for(a.s();!(r=a.n()).done;){var i=Zr(r.value,e,n);o.push([i["Seq Num"],i])}}catch(t){a.e(t)}finally{a.f()}return Object.fromEntries(o)}function eo(t,e){var n=t.map(function(t){var n,r=zr(H);try{for(r.s();!(n=r.n()).done;){var o=n.value;t[o]=JSON.parse(t[o])}}catch(t){r.e(t)}finally{r.f()}var a,i=zr(K);try{for(i.s();!(a=i.n()).done;){var s=a.value;t[s]="true"===t[s].toLowerCase()}}catch(t){i.e(t)}finally{i.f()}var c,u=zr(W);try{for(u.s();!(c=u.n()).done;){var l=c.value;t[l]=Number(t[l].replace("'",""))}}catch(t){u.e(t)}finally{u.f()}var f,p=zr(V);try{for(p.s();!(f=p.n()).done;){var d=f.value;t[d]=A(t[d])}}catch(t){p.e(t)}finally{p.f()}return Xr(t,e),t});return Object.fromEntries(n.map(function(t){return[t["Seq Num"],t]}))}function no(t){return no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},no(t)}function ro(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function oo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ro(Object(n),!0).forEach(function(e){ao(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ro(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ao(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=no(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=no(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==no(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function io(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(no(t)+" is not iterable")}function so(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(t,e)||uo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function co(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=uo(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function uo(t,e){if(t){if("string"==typeof t)return lo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lo(t,e):void 0}}function lo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function fo(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return po(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(po(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,po(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,po(f,"constructor",u),po(u,"constructor",c),c.displayName="GeneratorFunction",po(u,o,"GeneratorFunction"),po(f),po(f,o,"Generator"),po(f,r,function(){return this}),po(f,"toString",function(){return"[object Generator]"}),(fo=function(){return{w:a,m:p}})()}function po(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}po=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){po(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},po(t,e,n,r)}function ho(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function _o(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){ho(a,r,o,i,s,"next",t)}function s(t){ho(a,r,o,i,s,"throw",t)}i(void 0)})}}var Eo,So,yo,mo,go,vo,To,wo,Ao={loaded_servers:new Set,getBattles:(wo=_o(fo().m(function t(){var e,n,r,o;return fo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ht.get(ht.Keys.BATTLES);case 1:if(r=e=t.v,!(n=null!==r)){t.n=2;break}n=void 0!==e;case 2:if(!n){t.n=3;break}o=e,t.n=4;break;case 3:o=null;case 4:return t.a(2,o)}},t)})),function(){return wo.apply(this,arguments)}),removeBattles:(To=_o(fo().m(function t(){return fo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ht.delete(ht.Keys.BATTLES);case 1:return t.n=2,ht.delete(ht.Keys.UPLOADED_BATTLES);case 2:return t.n=3,ht.delete(ht.Keys.FILTERED_BATTLES);case 3:case 4:return t.a(2)}},t)})),function(){return To.apply(this,arguments)}),removeFilteredBattles:(vo=_o(fo().m(function t(){return fo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ht.delete(ht.Keys.FILTERED_BATTLES);case 1:case 2:return t.a(2)}},t)})),function(){return vo.apply(this,arguments)}),applyFilter:(go=_o(fo().m(function t(e){var n,r,o,a,i,s,c,u,l,f,p,d;return fo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.getBattles();case 1:n=t.v,r=e.filter(function(t){return t instanceof Rn}),o=e.filter(function(t){return t instanceof Un}),a=Object.values(n),i=co(o);try{for(i.s();!(s=i.n()).done;)c=s.value,"Applying global filter: ".concat(c.asString()),u=a.length,a=c.call(a),n=Object.fromEntries(a.map(function(t){return[t["Seq Num"],t]})),"Filtered ".concat(u-a.length," out of ").concat(u,"; new total = ").concat(a.length)}catch(t){i.e(t)}finally{i.f()}l=co(r),t.p=2,p=fo().m(function t(){var e,r;return fo().w(function(t){for(;;)switch(t.n){case 0:e=f.value,"Applying local filter: ".concat(e.asString()),r=Object.keys(n).length,n=Object.fromEntries(Object.entries(n).filter(function(t){var n=so(t,2),r=(n[0],n[1]);return e.call(r)})),"Filtered ".concat(r-Object.keys(n).length," out of ").concat(r,"; new total = ").concat(Object.keys(n).length);case 1:return t.a(2)}},t)}),l.s();case 3:if((f=l.n()).done){t.n=5;break}return t.d(io(p()),4);case 4:t.n=3;break;case 5:t.n=7;break;case 6:t.p=6,d=t.v,l.e(d);case 7:return t.p=7,l.f(),t.f(7);case 8:return"Caching filtered battles ; total = ".concat(Object.keys(n).length),t.n=9,ht.cache(ht.Keys.FILTERED_BATTLES,n);case 9:return"Filtered battles and stored in cache; modified ['FILTERED_BATTLES']; Applied total of <".concat(r.length+o.length,"> filters"),t.a(2,n)}},t,this,[[2,6,7,8]])})),function(t){return go.apply(this,arguments)}),extendBattles:(mo=_o(fo().m(function t(e){var n,r,o,a,i;return fo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ht.get(ht.Keys.BATTLES);case 1:if(a=n=t.v,!(o=null!==a)){t.n=2;break}o=void 0!==n;case 2:if(!o){t.n=3;break}i=n,t.n=4;break;case 3:i={};case 4:return r=oo(oo({},i),e),t.n=5,ht.cache(ht.Keys.BATTLES,r);case 5:return t.a(2,r)}},t)})),function(t){return mo.apply(this,arguments)}),cacheQuery:(yo=_o(fo().m(function t(e,n,r){var o,a;return fo().w(function(t){for(;;)switch(t.n){case 0:if(e){t.n=1;break}return t.a(2,[]);case 1:return"Caching queried battles: ".concat(e.length," battles; modified [BATTLES];"),o=to(e,n,r),t.n=2,this.extendBattles(o);case 2:return a=t.v,t.a(2,a)}},t,this)})),function(t,e,n){return yo.apply(this,arguments)}),cacheUpload:(So=_o(fo().m(function t(e,n){var r,o;return fo().w(function(t){for(;;)switch(t.n){case 0:if(e){t.n=1;break}return console.error("No uploaded battles provided to cacheUpload"),t.a(2,{});case 1:return r=eo(e,n),t.n=2,ht.cache(ht.Keys.UPLOADED_BATTLES,r);case 2:return t.n=3,this.extendBattles(r);case 3:return o=t.v,t.a(2,o)}},t,this)})),function(t,e){return So.apply(this,arguments)}),getStats:(Eo=_o(fo().m(function t(e,n,r){var o,a,i,s,c,u,l,f,p,d;return fo().w(function(t){for(;;)switch(t.n){case 0:return o=n.length,"Applying ".concat(o," filters"),a=Object.values(e),t.n=1,this.applyFilter(n);case 1:return i=t.v,s=Object.values(i),c=o>0,t.n=2,Yr.getPrebanStats(s,r);case 2:return u=t.v,t.n=3,Yr.getFirstPickStats(s,r);case 3:return l=t.v,t.n=4,Yr.getGeneralStats(s,r);case 4:return f=t.v,t.n=5,Yr.getHeroStats(s,r);case 5:return p=t.v,t.n=6,Yr.getPerformanceStats(s);case 6:return d=t.v,t.a(2,{battles:a,filteredBattlesObj:i,prebanStats:u,generalStats:f,firstPickStats:l,playerHeroStats:p.playerHeroStats,enemyHeroStats:p.enemyHeroStats,performanceStats:d,numFilters:o,areFiltersApplied:c})}},t,this)})),function(t,e,n){return Eo.apply(this,arguments)})};let bo={HeroManager:jt,BattleManager:Ao,SeasonManager:Le,UserManager:_r,ClientCache:ht,ArtifactManager:Bt,LangManager:{changeLang:async function(t){await bo.ClientCache.setLang(t),await bo.HeroManager.fetchAndCacheHeroManager(t),window.location.reload()},getLang:async function(){return await bo.ClientCache.getLang()}}};function Oo(t){const e=document.createElement("a");e.classList.add("d-none"),e.href=t,e.target="_blank",e.rel="noopener noreferrer",document.body.appendChild(e),e.click(),document.body.removeChild(e)}function Ro(){window.location.href=URL_UTILS.HOME_PAGE_URL}function Po(){document.querySelectorAll(".nav-link").forEach(t=>{t.addEventListener("click",async function(e){if(!("dataset"in t)||!t.dataset||"object"!=typeof t.dataset||!("nav"in t.dataset))return;const n=t.dataset.nav;if(Object.values(ur).includes(n))if(n===ur.SELECT_DATA)await Or.setState(ur.SELECT_DATA),Ro();else if(n===ur.SHOW_STATS){await _r.getUser()?(await Or.setState(ur.SHOW_STATS),Ro()):(await Or.setState(ur.SELECT_DATA),await Nr.pushState({messages:["Active user not found; you must either query a valid user or upload battles to view hero stats."],actions:[Nr.ACTIONS.SHOW_NO_USER_MSG]}),Ro())}})})}function Lo(){bt.NAV_BAR.CLEAR_DATA_BTN.addEventListener("click",async function(){await _r.getUser()?(await Or.setState(ur.SELECT_DATA),await Nr.pushActions([Nr.ACTIONS.CLEAR_USER])):(await Or.setState(ur.SELECT_DATA),await Nr.pushActions([Nr.ACTIONS.SHOW_DATA_ALREADY_CLEARED_MSG])),Ro()})}function Co(t){t?(bt.NAV_BAR.USER_NAME.innerText=t.name,bt.NAV_BAR.USER_ID.innerText=t.id,bt.NAV_BAR.USER_SERVER.innerText=D[t.world_code]):(bt.NAV_BAR.USER_NAME.innerText="(None)",bt.NAV_BAR.USER_ID.innerText="(None)",bt.NAV_BAR.USER_SERVER.innerText="(None)")}function Io(){bt.NAV_BAR.EXPORT_CSV_BTN.addEventListener("click",async function(){const t=await bo.UserManager.getUser();if(!t)return await Nr.pushState({messages:["User not found; cannot export data without an active user"],actions:[Nr.ACTIONS.SHOW_NO_USER_MSG]}),await Or.setState(ur.SELECT_DATA),void Ro();const e=(new Date).toISOString().split("T")[0]||"",n=`${t.name} (${t.id}) ${e}.csv`,r=await bo.BattleManager.getBattles();!function(t,e){const n=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.download=e,r.href=window.URL.createObjectURL(n),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}(function(t){const e=G,n=[];n.push(e.map(t=>`"${t}"`).join(","));for(const r of t){const t=e.map(t=>{let e=r[t]??"";return Array.isArray(e)&&(e=JSON.stringify(e).replace(/"/g,'""')),`"${e}"`});n.push(t.join(","))}return n.join("\n")}(Object.values(r)),n)})}function No(){bt.NAV_BAR.OFFICIAL_SITE_BTN.addEventListener("click",async function(){const t=await bo.UserManager.getUser();if(t){const e=function(t,e){return`${it}/${e}/gg/battlerecord/${t.world_code}/${t.id}`}(t,await bo.LangManager.getLang());Oo(e)}else Oo(st)})}let Do={addNavListeners:Po,addClearDataBtnListener:Lo,writeUserInfo:Co,initialize:async function(){Co(await _r.getUser()),Po(),Lo(),Io(),No()},navToHome:Ro,addExportCSVBtnListener:Io,addOfficialSiteBtnListener:No};function ko(t){return ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ko(t)}function Mo(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=ko(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ko(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ko(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Fo={SOURCE:{QUERY:"query",UPLOAD:"upload",STATS:"stats"}},xo=Mo(Mo(Mo({},ur.SELECT_DATA,0),ur.SHOW_STATS,0),ur.LOAD_DATA,0),Uo={SOURCE:"SOURCE",AUTO_ZOOM:"AUTO_ZOOM",AUTO_QUERY:"AUTO_QUERY",STATS_POST_RENDER_COMPLETED:"STATS_POST_RENDER_COMPLETED",STATS_PRE_RENDER_COMPLETED:"STATS_PRE_RENDER_COMPLETED",HOME_PAGE_STATE:"STATE",SCROLL_PERCENTS:"SCROLL_PERCENTS",CODE_MIRROR_EDITOR:"CODE_MIRROR_EDITOR",TRY_SET_USER:"TRY_SET_USER",IGNORE_RELAYOUT:"IGNORE_RELAYOUT"},jo={KEYS:Uo,VALUES:Fo,SOURCE:null,AUTO_QUERY:null,AUTO_ZOOM:!1,STATS_POST_RENDER_COMPLETED:!1,STATS_PRE_RENDER_COMPLETED:!1,HOME_PAGE_STATE:null,SCROLL_PERCENTS:xo,CODE_MIRROR_EDITOR:null,TRY_SET_USER:null,IGNORE_RELAYOUT:!1,popKey:function(t){var e=this[t];return this[t]=this._getDefault(t),e},readKey:function(t){return this[t]},_getDefault:function(t){switch(t){case Uo.AUTO_ZOOM:return!1;case Uo.SOURCE:case Uo.AUTO_QUERY:return null;case Uo.STATS_POST_RENDER_COMPLETED:case Uo.STATS_PRE_RENDER_COMPLETED:return!1;case Uo.HOME_PAGE_STATE:return null;case Uo.SCROLL_PERCENTS:return xo;case Uo.CODE_MIRROR_EDITOR:throw new Error("No default value for key: ".concat(t," ; do not use popKey or _getDefault for this key"));case Uo.TRY_SET_USER:return null;case Uo.IGNORE_RELAYOUT:return!1;default:return null}}};function Bo(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Go(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Go(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Go(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Go(f,"constructor",u),Go(u,"constructor",c),c.displayName="GeneratorFunction",Go(u,o,"GeneratorFunction"),Go(f),Go(f,o,"Generator"),Go(f,r,function(){return this}),Go(f,"toString",function(){return"[object Generator]"}),(Bo=function(){return{w:a,m:p}})()}function Go(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Go=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Go(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},Go(t,e,n,r)}function Ho(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function $o(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Ho(a,r,o,i,s,"next",t)}function s(t){Ho(a,r,o,i,s,"throw",t)}i(void 0)})}}function Ko(t){er.write(new Zn(t,bt.HOME_PAGE.SELECT_DATA_MSG,[er.STYLES.RED]))}function Wo(){return Wo=$o(Bo().m(function t(e){var n,r,o;return Bo().w(function(t){for(;;)switch(t.n){case 0:n=bt.HOME_PAGE.ID_SEARCH_FLAG,r=bo.ClientCache.Keys.ID_SEARCH_FLAG,n.addEventListener("click",$o(Bo().m(function t(){return Bo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,bo.ClientCache.cache(r,n.checked);case 1:return t.a(2)}},t)}))),(o=document.getElementById("userForm")).addEventListener("submit",function(){var t=$o(Bo().m(function t(n){var r,a,i,s,c,u;return Bo().w(function(t){for(;;)switch(t.n){case 0:if(n.preventDefault(),r=new FormData(o),a=r.get("username"),i=r.get("server"),a){t.n=1;break}Ko("Must enter username"),t.n=4;break;case 1:return t.p=1,t.n=2,bo.ClientCache.get(bo.ClientCache.Keys.ID_SEARCH_FLAG);case 2:return s=t.v,c=s?{id:a,world_code:i}:{name:a,world_code:i},jo.TRY_SET_USER=c,jo.AUTO_QUERY=!0,jo.SOURCE=jo.VALUES.SOURCE.QUERY,e(ur.LOAD_DATA),t.a(2);case 3:t.p=3,u=t.v,console.error("Caught Error:",u),Ko(u.message);case 4:return t.a(2)}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),Wo.apply(this,arguments)}function Vo(){return Vo=$o(Bo().m(function t(e){var n,r;return Bo().w(function(t){for(;;)switch(t.n){case 0:(n=document.getElementById("auto-query-flag")).addEventListener("click",$o(Bo().m(function t(){return Bo().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,bo.ClientCache.cache(bo.ClientCache.Keys.AUTO_QUERY_FLAG,n.checked);case 1:return t.a(2)}},t)}))),r=null,bt.HOME_PAGE.CSV_FILE.addEventListener("change",function(t){r=t.target.files[0]}),bt.HOME_PAGE.UPLOAD_FORM.addEventListener("submit",function(){var t=$o(Bo().m(function t(o){var a,i;return Bo().w(function(t){for(;;)switch(t.n){case 0:if(o.preventDefault(),a=n.checked,t.p=1,r){t.n=2;break}return Ko("Must upload a file"),t.a(2);case 2:return"Selected File: ".concat(r.name," ; content: ").concat(JSON.stringify(r)),t.n=3,bo.ClientCache.cache(bo.ClientCache.Keys.RAW_UPLOAD,r);case 3:return jo.AUTO_QUERY=a,jo.SOURCE=jo.VALUES.SOURCE.UPLOAD,e(ur.LOAD_DATA),t.a(2);case 4:t.p=4,i=t.v,console.error("Caught Error:",i),Ko(i.message);case 5:return t.a(2)}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t)})),Vo.apply(this,arguments)}function Yo(t){!function(t){Wo.apply(this,arguments)}(t),function(t){Vo.apply(this,arguments)}(t)}function qo(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return zo(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(zo(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,zo(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,zo(f,"constructor",u),zo(u,"constructor",c),c.displayName="GeneratorFunction",zo(u,o,"GeneratorFunction"),zo(f),zo(f,o,"Generator"),zo(f,r,function(){return this}),zo(f,"toString",function(){return"[object Generator]"}),(qo=function(){return{w:a,m:p}})()}function zo(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}zo=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){zo(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},zo(t,e,n,r)}function Qo(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Jo(){return Jo=function(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Qo(a,r,o,i,s,"next",t)}function s(t){Qo(a,r,o,i,s,"throw",t)}i(void 0)})}}(qo().m(function t(){var e,n;return qo().w(function(t){for(;;)switch(t.n){case 0:return e=document.getElementById("auto-query-flag"),t.n=1,ht.get(ht.Keys.AUTO_QUERY_FLAG);case 1:return e.checked=t.v,n=bt.HOME_PAGE.ID_SEARCH_FLAG,t.n=2,ht.get(ht.Keys.ID_SEARCH_FLAG);case 2:n.checked=t.v;case 3:return t.a(2)}},t)})),Jo.apply(this,arguments)}var Xo={runLogic:function(){return Jo.apply(this,arguments)},initialize:function(t){Yo(t)}};function Zo(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ta(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ta(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function ta(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ea(t){var e=$("#".concat(t));$.fn.dataTable.isDataTable(e)&&e.DataTable().clear().destroy()}function na(t){var e,n=Zo(t=structuredClone(t));try{for(n.s();!(e=n.n()).done;){var r,o=e.value,a=Zo(H);try{for(a.s();!(r=a.n()).done;){var i=r.value;o[i]=JSON.stringify(o[i])}}catch(t){a.e(t)}finally{a.f()}}}catch(t){n.e(t)}finally{n.f()}return t}function ra(t){var e=Number(t.replace("%",""));return e>50?"text-over50":e<50?"text-below50":""}function oa(t){var e=document.getElementById("".concat(t,"-body"));if(!e)throw new Error("Could not find tbody with id ".concat(t,"-body"));return e}var aa={populateHeroStatsTable:function(t,e){ea(t),oa(t).innerHTML="";var n=t.toLowerCase().includes("player"),r=n?"Player":"Enemy",o=[Y,q,z,Q,J,Z,tt,et,nt,rt,at],a=o.filter(function(t){return t!==tt}),i=n?o:a,s=$("#".concat(t)).DataTable({layout:{topStart:"buttons"},language:{info:"Total rows: _TOTAL_"},order:[[2,"desc"]],buttons:{name:"primary",buttons:["copy",{extend:"csv",text:"CSV",filename:r+" Hero Stats"},{extend:"excel",text:"Excel",filename:r+" Hero Stats"}]},columnDefs:[{targets:"_all",className:"nowrap"},{targets:4,createdCell:function(t,e){var n=Number(e.replace("%",""));n<50?t.style.color="red":n>50&&(t.style.color="mediumspringgreen")}}],pageLength:50,scrollY:"300px",deferRender:!0,scroller:!0,scrollCollapse:!1,columns:i.map(function(t){return{data:t}})});return s.rows.add(e).draw(),s},populateSeasonDetailsTable:function(t,e){var n=oa(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr");e.innerHTML="\n            <td>".concat(t["Season Number"],"</td>\n            <td>").concat(t.Season,"</td>\n            <td>").concat(t.Start,"</td>\n            <td>").concat(t.End,"</td>\n            <td>").concat(t.Status,"</td>\n            "),n.appendChild(e)})},populateServerStatsTable:function(t,e){var n=oa(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr"),r=t.label.includes("Server")?"cm-keyword":"cm-declared-data";e.innerHTML='\n            <td class="'.concat(r,'">').concat(t.label,"</td>\n            <td>").concat(t.count,"</td>\n            <td>").concat(t.frequency,"</td>\n            <td>").concat(t.wins,'</td>\n            <td class="').concat(ra(t.win_rate),'">').concat(t.win_rate,"</td>\n            <td>").concat(t["+/-"],'</td>\n            <td class="').concat(ra(t.fp_wr),'">').concat(t.fp_wr,'</td>\n            <td class="').concat(ra(t.sp_wr),'">').concat(t.sp_wr,"</td>\n            "),n.appendChild(e)})},populatePlayerPrebansTable:function(t,e){var n=oa(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr");e.innerHTML="\n            <td>".concat(t.preban,"</td>\n            <td>").concat(t.appearances,"</td>\n            <td>").concat(t.appearance_rate,'</td>\n            <td class="').concat(ra(t.win_rate),'">').concat(t.win_rate,"</td>\n            <td>").concat(t["+/-"],"</td>\n            "),n.appendChild(e)})},populatePlayerFirstPickTable:function(t,e){var n=oa(t);n.innerHTML="",e.forEach(function(t){var e=document.createElement("tr");e.innerHTML="\n            <td>".concat(t.hero,"</td>\n            <td>").concat(t.appearances,"</td>\n            <td>").concat(t.appearance_rate,'</td>\n            <td class="').concat(ra(t.win_rate),'">').concat(t.win_rate,"</td>\n            <td>").concat(t["+/-"],"</td>\n            "),n.appendChild(e)})},populateFullBattlesTable:function(t,e,n){var r;ea(t),e=na(e),oa(t).innerHTML="";var o=(new Date).toISOString().split("T")[0]||"";r=n?"".concat(n.name," (").concat(n.id,") ").concat(o):0===e.length?"Empty":"UID(".concat(e[0]["P1 ID"],") ").concat(o);var a=$("#".concat(t)).DataTable({layout:{topStart:"buttons"},language:{info:"Total rows: _TOTAL_"},order:[[2,"desc"]],columnDefs:[{targets:"_all",className:"nowrap"}],rowCallback:function(t,e,n){var r=t.cells[14],o=t.cells[15],a=t.cells[16];!0===e.Win?r.style.color="mediumspringgreen":!1===e.Win&&(r.style.color="red"),!0===e["First Pick"]&&(o.style.color="deepskyblue"),!0===e["First Turn"]&&(a.style.color="deepskyblue")},buttons:{name:"primary",buttons:["copy",{extend:"csv",text:"CSV",filename:r},{extend:"excel",text:"Excel",filename:r}]},pageLength:50,scrollY:"300px",deferRender:!0,scroller:!0,scrollCollapse:!1,columns:Object.values(B).filter(function(t){return!t.toLowerCase().includes("prime")}).map(function(t){return{data:t}})});return a.rows.add(e).draw(),a},replaceDatatableData:function(t,e){$("#".concat(t)).DataTable().clear().rows.add(e).draw()},replaceBattleData:function(t){t=na(t);var e=bt.HOME_PAGE.BATTLES_TBL.id;this.replaceDatatableData(e,t)}},ia=function(t){_t.setText("total-battles",t.total_battles),_t.setText("first-pick-count",t.first_pick_count),_t.setText("first-pick-rate"," (".concat(t.first_pick_rate,")")),_t.setText("second-pick-count",t.second_pick_count),_t.setText("second-pick-rate"," (".concat(t.second_pick_rate,")")),_t.setText("total-winrate",t.total_winrate),_t.setText("first-pick-winrate",t.first_pick_winrate),_t.setText("second-pick-winrate",t.second_pick_winrate),_t.setText("total-wins",t.total_wins),_t.setText("max-win-streak",t.max_win_streak),_t.setText("max-loss-streak",t.max_loss_streak),_t.setText("avg-ppg",t.avg_ppg),_t.setText("avg-turns",t.avg_turns),_t.setText("avg-time",t.avg_time),_t.setText("max-turns",t.max_turns),_t.setText("max-time",t.max_time),_t.setText("first-turn-games",t.first_turn_games),_t.setText("first-turn-rate",t.first_turn_rate)},sa={"Current Season":"season = current-season","Last Season":"season = last-season","First Pick":"is-first-pick = true","Second Pick":"is-first-pick = false","Champion+ Opponent":"p2.league in {champion, warlord, emperor, legend}","Warlord+ Opponent":"p2.league in {warlord, emperor, legend}","Emperor+ Opponent":"p2.league in {emperor, legend}","Legend Opponent":"p2.league = 'legend'",Wins:"is-win = true",Losses:"is-win = false",extendFilters:function(t,e){var n=sa[e];return";"!==(t=t.replace(/\s+$/,"")).slice(-1)&&t.length>0?t+=";\n":";"===t.slice(-1)&&(t+="\n"),"".concat(t).concat(n,";")}};const ca=sa,ua=16,la=8,fa=2,pa=1;function da(t){const e=t;return{markerSize:Math.max(fa,6-.5*Math.log10(e)),lineWidth:Math.max(pa,3-.5*Math.log10(e))}}function ha(t,e){const n={startX:null,endX:null,startY:null,endY:null};for(const[r,o]of t.entries())o["Seq Num"]in e&&(n.startX=null===n.startX||r<n.startX?r-.5:n.startX,n.startY=null===n.startY||o["P1 Points"]<n.startY+50?o["P1 Points"]-50:n.startY,n.endX=null===n.endX||r>n.endX?r+.5:n.endX,n.endY=null===n.endY||o["P1 Points"]>n.endY-50?o["P1 Points"]+50:n.endY);return n}function _a(t,e,n,r=null){e.sort((t,e)=>t["Date/Time"].localeCompare(e["Date/Time"])),n||(n={name:`UID: ${e[0]["P1 ID"]}`});const o=e.map((t,e)=>e),a=e.map(t=>t["P1 Points"]),i=[];for(let[t,n]of e.entries())r&&n["Seq Num"]in r?i.push("#ff9900"):i.push("#0df8fd");const s=e.map(t=>[t["Date/Time"].slice(0,10),t["P1 League"]]),c=da(e.length),u={x:o,y:a,mode:"lines+markers",line:{color:"#4f9293",width:c.lineWidth},marker:{symbol:"circle",size:c.markerSize,color:i},customdata:s,hovertemplate:"Points: %{y}<br>Date: %{customdata[0]}<br>League: %{customdata[1]}<extra></extra>"},l={autosize:!0,font:{family:"Roboto, Open Sans"},title:{text:`${n.name}'s RTA Point Plot`,font:{size:24,color:"#dddddd"},xanchor:"center",yanchor:"top",y:.95,x:.5},xaxis:{title:{text:"Battle Number (Chronological)",font:{size:18,color:"#dddddd"}},showgrid:!0,gridcolor:"#8d8d8d",zeroline:!1,tickfont:{size:12,color:"#dddddd"},range:null},yaxis:{title:{text:"Victory Points",font:{size:18,color:"#dddddd"}},showgrid:!0,gridcolor:"#8d8d8d",zeroline:!0,zerolinecolor:"#dddddd",zerolinewidth:2,tickfont:{size:12,color:"#dddddd"},range:null},plot_bgcolor:"#1e222d",paper_bgcolor:"#1e222d"},f={responsive:!0};let p,d=!0;return p=document.getElementById("rank-plot"),p||(d=!1,p=document.createElement("div"),p.id="rank-plot",t.appendChild(p)),p.style.width="100%",p.style.height="100%",d?Plotly.react(p,[u],l,f):Plotly.newPlot(p,[u],l,f),p}function Ea(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Sa(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Sa(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Sa(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Sa(f,"constructor",u),Sa(u,"constructor",c),c.displayName="GeneratorFunction",Sa(u,o,"GeneratorFunction"),Sa(f),Sa(f,o,"Generator"),Sa(f,r,function(){return this}),Sa(f,"toString",function(){return"[object Generator]"}),(Ea=function(){return{w:a,m:p}})()}function Sa(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Sa=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Sa(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},Sa(t,e,n,r)}function ya(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function ma(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){ya(a,r,o,i,s,"next",t)}function s(t){ya(a,r,o,i,s,"throw",t)}i(void 0)})}}function ga(){var t=bt.HOME_PAGE.RANK_PLOT;t.__zoomListenerAttached||(t.__zoomListenerAttached=!0,t.on("plotly_relayout",function(){var e=ma(Ea().m(function e(n){var r,o,a,i,s,c,u;return Ea().w(function(e){for(;;)switch(e.n){case 0:if(!jo.popKey(jo.KEYS.IGNORE_RELAYOUT)){e.n=1;break}return e.a(2);case 1:return e.n=2,ht.getStats();case 2:r=e.v,o=Object.values(r.battles).length,a=da(o),void 0!==n["xaxis.range[0]"]?(i=[n["xaxis.range[0]"],n["xaxis.range[1]"]],s=o/(i[1]-i[0]),c=Math.min(Math.max(a.markerSize*s,a.markerSize),ua),u=Math.min(Math.max(a.lineWidth*s,a.lineWidth),la),Plotly.restyle(t.id,{"marker.size":[c],"line.width":[u]})):Plotly.restyle(t.id,{"marker.size":[a.markerSize],"line.width":[a.lineWidth]});case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()))}function va(t,e){var n,r;(n=bt.HOME_PAGE.AUTO_ZOOM_FLAG).addEventListener("click",ma(Ea().m(function t(){return Ea().w(function(t){for(;;)switch(t.n){case 0:return n.checked,t.n=1,bo.ClientCache.cache(bo.ClientCache.Keys.AUTO_ZOOM_FLAG,n.checked);case 1:return t.a(2)}},t)}))),(r=bt.HOME_PAGE.BATTLE_FILTER_TOGGLE).addEventListener("click",ma(Ea().m(function t(){var e;return Ea().w(function(t){for(;;)switch(t.n){case 0:return r.checked,t.n=1,bo.ClientCache.getStats();case 1:e=t.v,r.checked?(e.filteredBattlesObj,aa.replaceBattleData(Object.values(e.filteredBattlesObj))):aa.replaceBattleData(e.battles);case 2:return t.a(2)}},t)}))),function(t){document.getElementById("premade-filters").addEventListener("click",function(e){e.preventDefault();var n=e.target.closest(".dropdown-item");if(n){var r=n.textContent.trim(),o=t.getValue(),a=ca.extendFilters(o,r);t.setValue(a)}})}(t),function(t,e){document.getElementById("filterForm").addEventListener("submit",function(){var n=ma(Ea().m(function n(r){var o,a,i,s;return Ea().w(function(n){for(;;)switch(n.n){case 0:return r.preventDefault(),document.getElementById("codeArea").value=t.getValue(),o=r.submitter,a=null==o?void 0:o.value,i=t.getValue(),n.n=1,bo.ClientCache.getFilterStr();case 1:if(s=n.v,"apply"!==a){n.n=5;break}return n.n=2,cr.validateFilterSyntax(i);case 2:if(!n.v){n.n=4;break}return n.n=3,bo.ClientCache.setFilterStr(i);case 3:case 8:return jo.AUTO_QUERY=!1,jo.SOURCE=jo.VALUES.SOURCE.STATS,e(ur.LOAD_DATA),n.a(2);case 4:n.n=9;break;case 5:if("check"!==a){n.n=7;break}return n.n=6,cr.validateFilterSyntax(i);case 6:case 9:return n.a(2);case 7:if("clear"!==a){n.n=9;break}if(t.setValue(""),!s){n.n=9;break}return n.n=8,bo.ClientCache.setFilterStr("")}},n)}));return function(t){return n.apply(this,arguments)}}())}(t,e)}function Ta(t){return Ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ta(t)}function wa(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Aa(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Aa(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Aa(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Aa(f,"constructor",u),Aa(u,"constructor",c),c.displayName="GeneratorFunction",Aa(u,o,"GeneratorFunction"),Aa(f),Aa(f,o,"Generator"),Aa(f,r,function(){return this}),Aa(f,"toString",function(){return"[object Generator]"}),(wa=function(){return{w:a,m:p}})()}function Aa(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Aa=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Aa(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},Aa(t,e,n,r)}function ba(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Oa(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){ba(a,r,o,i,s,"next",t)}function s(t){ba(a,r,o,i,s,"throw",t)}i(void 0)})}}function Ra(t){return Pa.apply(this,arguments)}function Pa(){return(Pa=Oa(wa().m(function t(e){var n,r,o,a,i,s,c,u,l,f,p,d,h;return wa().w(function(t){for(;;)switch(t.n){case 0:return n=_t.unwrapHtmlElt("rank-plot-container"),t.n=1,_r.getUser();case 1:return r=t.v,t.n=2,ht.get(ht.Keys.AUTO_ZOOM_FLAG);case 2:o=t.v,a=_a(n,e.battles,r,e.numFilters>0?e.filteredBattlesObj:null),ga(),o&&e.areFiltersApplied&&(i=ha(e.battles,e.filteredBattlesObj),s=Object.values(e.battles).length,c=Object.values(e.filteredBattlesObj).length,u=da(s),l=s/c,f=Math.min(Math.max(u.markerSize*l,u.markerSize),ua),p=Math.min(Math.max(u.lineWidth*l,u.lineWidth),la),d={"xaxis.range":[i.startX,i.endX],"yaxis.range":[i.startY,i.endY]},h={"marker.size":f,"line.width":p},jo.IGNORE_RELAYOUT=!0,Plotly.restyle(a,h),Plotly.relayout(a,d));case 3:return t.a(2)}},t)}))).apply(this,arguments)}function La(){return Ca.apply(this,arguments)}function Ca(){return(Ca=Oa(wa().m(function t(){var e,n,r,o;return wa().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,_r.getUser();case 1:if(e=t.v){t.n=2;break}return t.a(2);case 2:return t.p=3,t.n=4,bo.SeasonManager.getSeasonDetails();case 4:return Ta(n=t.v),t.n=5,bo.ClientCache.getStats();case 5:return r=t.v,console.time("populateTables"),aa.populateSeasonDetailsTable("season-details-tbl",n),aa.populateHeroStatsTable("player-tbl",r.playerHeroStats),aa.populateHeroStatsTable("opponent-tbl",r.enemyHeroStats),aa.populatePlayerFirstPickTable("first-pick-stats-tbl",r.firstPickStats),aa.populatePlayerPrebansTable("preban-stats-tbl",r.prebanStats),aa.populateServerStatsTable("performance-stats-tbl",r.performanceStats),bt.HOME_PAGE.BATTLE_FILTER_TOGGLE.checked?aa.populateFullBattlesTable("battles-tbl",Object.values(r.filteredBattlesObj),e):aa.populateFullBattlesTable("battles-tbl",r.battles,e),ia(r.generalStats),t.n=6,Ra(r);case 6:console.timeEnd("populateTables"),t.n=8;break;case 7:t.p=7,o=t.v,console.error("Error loading data:",o);case 8:return t.a(2)}},t,null,[[3,7]])}))).apply(this,arguments)}function Ia(){return Na.apply(this,arguments)}function Na(){return(Na=Oa(wa().m(function t(){var e,n,r;return wa().w(function(t){for(;;)switch(t.n){case 0:return CodeMirror.defineMode("filterSyntax",function(){return{token:function(t,e){return ge.tokenMatch(t)}}}),e=document.getElementById("codeArea"),(n=CodeMirror.fromTextArea(e,{mode:"filterSyntax",lineNumbers:!0,theme:"default"})).setSize(null,185),t.n=1,bo.ClientCache.getFilterStr();case 1:return(r=t.v)&&n.setValue(r),n.on("change",function(){n.save()}),e.classList.remove("codemirror-hidden"),jo.CODE_MIRROR_EDITOR=n,t.a(2,n)}},t)}))).apply(this,arguments)}function Da(){return(Da=Oa(wa().m(function t(){return wa().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,La();case 1:return t.a(2)}},t)}))).apply(this,arguments)}function ka(){return(ka=Oa(wa().m(function t(){var e;return wa().w(function(t){for(;;)switch(t.n){case 0:if(e=jo.CODE_MIRROR_EDITOR){t.n=1;break}return console.error("Editor not found in CONTEXT"),t.a(2);case 1:e.refresh();case 2:return t.a(2)}},t)}))).apply(this,arguments)}function Ma(){return(Ma=Oa(wa().m(function t(e){var n,r,o;return wa().w(function(t){for(;;)switch(t.n){case 0:return n=bt.HOME_PAGE.AUTO_ZOOM_FLAG,t.n=1,bo.ClientCache.get(bo.ClientCache.Keys.AUTO_ZOOM_FLAG);case 1:return r=t.v,n.checked=r,t.n=2,bo.ClientCache.getStats();case 2:return o=t.v,bt.HOME_PAGE.BATTLE_FILTER_TOGGLE.checked&&aa.replaceBattleData(Object.values(o.filteredBattlesObj)),t.n=3,_r.getUser();case 3:if(t.v){t.n=4;break}return e(ur.SELECT_DATA),t.a(2);case 4:case 5:bt.HOME_PAGE.CSV_FILE.value="",bt.HOME_PAGE.USER_QUERY_FORM_NAME.value="";case 6:return t.a(2)}},t)}))).apply(this,arguments)}function Fa(){return(Fa=Oa(wa().m(function t(e){var n;return wa().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Ia();case 1:return n=t.v,t.n=2,va(n,e);case 2:return t.a(2)}},t)}))).apply(this,arguments)}var xa={preFirstRenderLogic:function(){return Da.apply(this,arguments)},postFirstRenderLogic:function(){return ka.apply(this,arguments)},runLogic:function(t){return Ma.apply(this,arguments)},initialize:function(t){return Fa.apply(this,arguments)},populateContent:La},Ua=n(809);function ja(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ba(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ba(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Ba(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Ba(f,"constructor",u),Ba(u,"constructor",c),c.displayName="GeneratorFunction",Ba(u,o,"GeneratorFunction"),Ba(f),Ba(f,o,"Generator"),Ba(f,r,function(){return this}),Ba(f,"toString",function(){return"[object Generator]"}),(ja=function(){return{w:a,m:p}})()}function Ba(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ba=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Ba(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},Ba(t,e,n,r)}function Ga(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Ha(t){return function(t){if(Array.isArray(t))return $a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return $a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Ka=Object.values(B);var Wa,Va={parseUpload:(Wa=function(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Ga(a,r,o,i,s,"next",t)}function s(t){Ga(a,r,o,i,s,"throw",t)}i(void 0)})}}(ja().m(function t(e){var n,r,o,a;return ja().w(function(t){for(;;)switch(t.n){case 0:return this.validateCSV(e),t.n=1,e.text();case 1:if(n=t.v,(r=Ua.parse(n,{header:!0,skipEmptyLines:!0,quoteChar:'"',dynamicTyping:!1})).meta.fields.forEach(function(t,e){var n=t.trim().replace(/"/g,"");if(n!==Ka[e])throw new Error("Header ".concat(n," does not match expected column ").concat(Ka[e]," at index ").concat(e))}),!(r.errors.length>0)){t.n=2;break}throw o=r.errors[0],new Error("Failed to parse CSV: Row ".concat(o.row,", ").concat(o.message));case 2:return r.data,a=r.data,this.postParseValidation(a),t.a(2,a)}},t,this)})),function(t){return Wa.apply(this,arguments)}),validateCSV:function(t){if(!t.name.endsWith(".csv"))throw new Error("File must be .csv");if(t.size>52428800)throw new Error("File must be smaller than ".concat(50,"mb, got ").concat(t.size/1048576,"mb File."))},postParseValidation:function(t){if(t.length<2)throw new Error("File must have at least 1 battle");!function(t){for(var e=new Set,n=new Set,r=0;r<t.length;r++){var o=[t[r]["P1 ID"],t[r]["P1 Server"]],a=o[0],i=o[1],s=r+1;if(""===a.trim()||!a)throw new Error("Detected an empty ID for Player 1: failed at row: ".concat(s));if(""===i.trim()||!i)throw new Error("Detected an empty Server for Player 1: failed at row: ".concat(s));if(e.add(a),e.size>1)throw new Error("File must have exactly one ID for Player 1: found IDS: [".concat(Ha(e),"]; failed at row: ").concat(s));if(n.add(i),n.size>1)throw new Error("File must exactly one Server for Player 1: found Servers: [".concat(Ha(n),"]; failed at row: ").concat(s))}}(t)}};const Ya=Va;function qa(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return za(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(za(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,za(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,za(f,"constructor",u),za(u,"constructor",c),c.displayName="GeneratorFunction",za(u,o,"GeneratorFunction"),za(f),za(f,o,"Generator"),za(f,r,function(){return this}),za(f,"toString",function(){return"[object Generator]"}),(qa=function(){return{w:a,m:p}})()}function za(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}za=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){za(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},za(t,e,n,r)}function Qa(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Ja(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Qa(a,r,o,i,s,"next",t)}function s(t){Qa(a,r,o,i,s,"throw",t)}i(void 0)})}}function Xa(t){bt.HOME_PAGE.ESCAPE_BTN.addEventListener("click",Ja(qa().m(function t(){var e;return qa().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,_r.getUser();case 1:if(!(e=t.v)){t.n=3;break}return t.n=2,_r.setUser(e);case 2:Do.writeUserInfo(e),t.n=4;break;case 3:return t.n=4,stateDispatcher(ur.SELECT_DATA);case 4:return t.a(2)}},t)})))}function Za(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ti(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ti(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,ti(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,ti(f,"constructor",u),ti(u,"constructor",c),c.displayName="GeneratorFunction",ti(u,o,"GeneratorFunction"),ti(f),ti(f,o,"Generator"),ti(f,r,function(){return this}),ti(f,"toString",function(){return"[object Generator]"}),(Za=function(){return{w:a,m:p}})()}function ti(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ti=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){ti(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},ti(t,e,n,r)}function ei(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function ni(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){ei(a,r,o,i,s,"next",t)}function s(t){ei(a,r,o,i,s,"throw",t)}i(void 0)})}}function ri(){return oi.apply(this,arguments)}function oi(){return(oi=ni(Za().m(function t(){var e,n,r,o,a;return Za().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,bo.ClientCache.get(bo.ClientCache.Keys.RAW_UPLOAD);case 1:return e=t.v,t.n=2,Ya.parseUpload(e);case 2:return n=t.v,r=n[0]["P1 ID"],o=k[n[0]["P1 Server"]],t.n=3,bo.UserManager.findUser({id:r,world_code:o});case 3:if(a=t.v){t.n=4;break}throw new Error("File Upload Error: User not found");case 4:return t.a(2,{user:a,battleArr:n})}},t)}))).apply(this,arguments)}function ai(t,e){return ii.apply(this,arguments)}function ii(){return(ii=ni(Za().m(function t(e,n){var r,o,a,i,s;return Za().w(function(t){for(;;)switch(t.n){case 0:return JSON.stringify(e),t.n=1,bo.ArtifactManager.getArtifactCodeToNameMap();case 1:return r=t.v,t.n=2,Ft.rsFetchBattleData(e);case 2:if((o=t.v).ok){t.n=4;break}return t.n=3,o.json();case 3:throw a=t.v,new Error(a.error);case 4:return t.n=5,o.json();case 5:return i=t.v,s=i.battles,t.n=6,bo.BattleManager.cacheQuery(s,n,r);case 6:case 7:return t.a(2)}},t)}))).apply(this,arguments)}function si(t,e,n){return ci.apply(this,arguments)}function ci(){return(ci=ni(Za().m(function t(e,n,r){var o,a,i,s;return Za().w(function(t){for(;;)switch(t.n){case 0:return a=[jo.VALUES.SOURCE.QUERY,jo.VALUES.SOURCE.UPLOAD,jo.VALUES.SOURCE.STATS],i=a[1],s=a[2],n===a[0]||n===i?(o=ur.SELECT_DATA,or.queueSelectDataMsgRed("Failed to load data: ".concat(e.message))):n===s?(o=ur.SHOW_STATS,or.queueFilterMsgRed("Failed to load data: ".concat(e.message))):(console.error("Invalid source: ".concat(n," ; redirecting to select data")),o=ur.SELECT_DATA,or.queueSelectDataMsgRed("Failed to load data: ".concat(e.message))),console.error(e),t.n=1,bo.UserManager.clearUserData();case 1:return Do.writeUserInfo(null),t.n=2,r(o);case 2:return t.a(2)}},t)}))).apply(this,arguments)}function ui(t){return li.apply(this,arguments)}function li(){return(li=ni(Za().m(function t(e){var n;return Za().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,bo.UserManager.findUser(e);case 1:if(n=t.v,JSON.stringify(n),null===n){t.n=2;break}return t.a(2,n);case 2:return t.a(2,null)}},t)}))).apply(this,arguments)}function fi(t){return pi.apply(this,arguments)}function pi(){return(pi=ni(Za().m(function t(e){return Za().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,bo.UserManager.clearUserData();case 1:return t.n=2,bo.UserManager.setUser(e);case 2:Do.writeUserInfo(e);case 3:return t.a(2)}},t)}))).apply(this,arguments)}function di(){return(di=ni(Za().m(function t(e){var n,r,o,a,i,s,c,u,l,f,p,d;return Za().w(function(t){for(;;)switch(t.n){case 0:return n=null,r=null,o=null,t.p=1,t.n=2,bo.HeroManager.getHeroDicts();case 2:n=t.v,r=jo.popKey(jo.KEYS.SOURCE),o=jo.popKey(jo.KEYS.AUTO_QUERY),t.n=5;break;case 3:return t.p=3,f=t.v,console.error("Could not load reference and context variables: ",f),t.n=4,e(ur.SELECT_DATA);case 4:return t.a(2);case 5:if(t.p=5,a=null,r!==jo.VALUES.SOURCE.UPLOAD){t.n=9;break}return t.n=6,ri();case 6:return i=t.v,a=i.user,t.n=7,fi(a);case 7:return t.n=8,bo.BattleManager.cacheUpload(i.battleArr,n);case 8:t.n=12;break;case 9:if(r!==jo.VALUES.SOURCE.QUERY){t.n=12;break}if(null!==(s=jo.popKey(jo.KEYS.TRY_SET_USER))){t.n=10;break}throw new Error("TRY_SET_USER User missing from CONTEXT");case 10:return t.n=11,ui(s);case 11:return a=t.v,t.n=12,fi(a);case 12:if(null!==a){t.n=14;break}return t.n=13,bo.UserManager.getUser();case 13:a=t.v;case 14:if(!o&&r!==jo.VALUES.SOURCE.QUERY){t.n=15;break}return t.n=15,ai(a,n);case 15:return t.n=16,bo.BattleManager.getBattles();case 16:return c=t.v,t.n=17,Wn.getFiltersFromCache(n);case 17:return u=t.v,"Received Filters: ".concat(JSON.stringify(u)),t.n=18,bo.BattleManager.getStats(c,u,n);case 18:return l=t.v,t.n=19,bo.ClientCache.setStats(l);case 19:return t.n=20,xa.populateContent();case 20:return jo.STATS_PRE_RENDER_COMPLETED=!0,t.n=21,e(ur.SHOW_STATS);case 21:return t.a(2);case 22:return t.p=22,p=t.v,t.p=23,t.n=24,si(p,r,e);case 24:return t.a(2);case 25:return t.p=25,d=t.v,console.error("Something went wrong ; redirecting to select data ; error:",d),t.n=26,bo.UserManager.clearUserData();case 26:return Do.writeUserInfo(null),t.n=27,e(ur.SELECT_DATA);case 27:return t.a(2)}},t,null,[[23,25],[5,22],[1,3]])}))).apply(this,arguments)}var hi={runLogic:function(t){return di.apply(this,arguments)},initialize:function(){Xa()}};function _i(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ei(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ei(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Ei(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Ei(f,"constructor",u),Ei(u,"constructor",c),c.displayName="GeneratorFunction",Ei(u,o,"GeneratorFunction"),Ei(f),Ei(f,o,"Generator"),Ei(f,r,function(){return this}),Ei(f,"toString",function(){return"[object Generator]"}),(_i=function(){return{w:a,m:p}})()}function Ei(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ei=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Ei(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},Ei(t,e,n,r)}function Si(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function yi(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Si(a,r,o,i,s,"next",t)}function s(t){Si(a,r,o,i,s,"throw",t)}i(void 0)})}}function mi(){jo.IGNORE_RELAYOUT=!0,setTimeout(function(){Plotly.Plots.resize(document.getElementById("rank-plot"))},20)}function gi(t){return vi.apply(this,arguments)}function vi(){return(vi=yi(_i().m(function t(e){return _i().w(function(t){for(;;)switch(t.n){case 0:if(jo.STATS_PRE_RENDER_COMPLETED){t.n=2;break}return t.n=1,xa.preFirstRenderLogic(e);case 1:jo.STATS_PRE_RENDER_COMPLETED=!0;case 2:return t.n=3,xa.runLogic(e);case 3:return t.n=4,Ir.homePageSetView(ur.SHOW_STATS);case 4:if(jo.STATS_POST_RENDER_COMPLETED){t.n=6;break}return t.n=5,xa.postFirstRenderLogic();case 5:jo.STATS_POST_RENDER_COMPLETED=!0;case 6:mi();case 7:return t.a(2)}},t)}))).apply(this,arguments)}function Ti(){return wi.apply(this,arguments)}function wi(){return(wi=yi(_i().m(function t(){var e;return _i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Or.getState();case 1:e=t.v,jo.SCROLL_PERCENTS[e]=cr.getScrollPercent(),er.clearMessages(),er.processQueue();case 2:return t.a(2)}},t)}))).apply(this,arguments)}function Ai(t){return bi.apply(this,arguments)}function bi(){return(bi=yi(_i().m(function t(e){var n,r;return _i().w(function(t){for(;;)switch(t.n){case 0:if("Switching to state: ".concat(e,", with CONTEXT: "),vr(e)){t.n=1;break}return t.a(2);case 1:return Ti(),t.n=2,Or.setState(e);case 2:r=e,t.n=r===ur.SELECT_DATA?3:r===ur.SHOW_STATS?6:r===ur.LOAD_DATA?8:11;break;case 3:return t.n=4,Xo.runLogic(Ai);case 4:return t.n=5,Ir.homePageSetView(e);case 5:return t.a(3,12);case 6:return t.n=7,gi(Ai);case 7:return t.a(3,12);case 8:return t.n=9,Ir.homePageSetView(e);case 9:return t.n=10,hi.runLogic(Ai);case 10:return t.a(3,12);case 11:console.error("Invalid page state: ".concat(e));case 12:n=jo.SCROLL_PERCENTS[e],setTimeout(function(){cr.setScrollPercent(n)},0);case 13:return t.a(2)}},t)}))).apply(this,arguments)}function Oi(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Ri(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Ri(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,Ri(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,Ri(f,"constructor",u),Ri(u,"constructor",c),c.displayName="GeneratorFunction",Ri(u,o,"GeneratorFunction"),Ri(f),Ri(f,o,"Generator"),Ri(f,r,function(){return this}),Ri(f,"toString",function(){return"[object Generator]"}),(Oi=function(){return{w:a,m:p}})()}function Ri(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ri=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Ri(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},Ri(t,e,n,r)}function Pi(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Li(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Pi(a,r,o,i,s,"next",t)}function s(t){Pi(a,r,o,i,s,"throw",t)}i(void 0)})}}function Ci(){document.querySelectorAll(".nav-link").forEach(function(t){t.addEventListener("click",function(){var t=Li(Oi().m(function t(e){var n,r;return Oi().w(function(t){for(;;)switch(t.n){case 0:return n=this.dataset.nav,t.n=1,Or.getState();case 1:if(r=t.v,!Object.values(ur).includes(n)){t.n=6;break}if(r!==n){t.n=2;break}return"Already in state: ".concat(r," ; returning"),t.a(2);case 2:if(n!==ur.SELECT_DATA){t.n=3;break}Ai(ur.SELECT_DATA,jo),t.n=5;break;case 3:if(n!==ur.SHOW_STATS){t.n=5;break}return t.n=4,_r.getUser();case 4:t.v?Ai(ur.SHOW_STATS,jo):(or.queueSelectDataMsgRed("User not found; Must either query a valid user or upload battles to view hero stats"),Ai(ur.SELECT_DATA,jo));case 5:t.n=7;break;case 6:"Navigating to: ".concat(this.href);case 7:return t.a(2)}},t,this)}));return function(e){return t.apply(this,arguments)}}())}),bt.HOME_PAGE.CLEAR_DATA_BTN.addEventListener("click",function(){var t=Li(Oi().m(function t(e){var n;return Oi().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,_r.getUser();case 1:if(!(n=t.v)){t.n=4;break}return t.n=2,_r.clearUserData();case 2:return Do.writeUserInfo(null),or.queueSelectDataMsgGreen("Cleared data of user ".concat(n.name," (").concat(n.id,")")),t.n=3,Ai(ur.SELECT_DATA);case 3:jo.SCROLL_PERCENTS[ur.SHOW_STATS]=0,t.n=5;break;case 4:return or.queueSelectDataMsgGreen("Data already cleared"),t.n=5,Ai(ur.SELECT_DATA);case 5:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()),bt.NAV_BAR.SIDEBAR_HIDE_BTN.addEventListener("click",function(t){mi()}),bt.NAV_BAR.SIDEBAR_CONTROL.addEventListener("click",function(t){mi()})}let Ii=0;function Ni(){return Ii+=1,`id-${Ii}`}const Di="nest",ki="adj";class Mi{htmlElt;children;childArr;constructor(t){this.htmlElt=t,this.children={},this.childArr=[]}static fromID(t){return new Mi(_t.unwrapHtmlElt(t))}static fromElt(t){return new Mi(t)}get id(){return this.htmlElt.id}set id(t){this.htmlElt.id=t}addClass(...t){this.htmlElt.classList.add(...t)}addStyle(t){this.htmlElt.setAttribute("style",t)}removeClass(...t){this.htmlElt.classList.remove(...t)}addAttributes(t){for(const[e,n]of Object.entries(t))this.htmlElt.setAttribute(e,n)}appendChild(t){if(t instanceof Mi)return this.htmlElt.appendChild(t.htmlElt),t.id||(t.id=Ni()),this.children[t.id]=t,this.childArr.push(t),t;if(t instanceof HTMLElement){let e=new Mi(t);return this.appendChild(e)}throw new Error("Only instances of HTMLConstructor or HTMLElement can be passed to this function")}setInnerHtml(t){this.htmlElt.innerHTML=t}appendInnerHTML(t){this.htmlElt.insertAdjacentHTML("beforeend",t)}constructChild(t,e={}){e.id||(e.id=Ni());let n=document.createElement(t),r=new Mi(n);return r.addAttributes(e),this.appendChild(r),r}addTextContent(t){this.htmlElt.textContent=t}compose(t){for(let e=0;e<t.length;e++){const n=t[e];if(n.option===Di)return n.children?n.children=[...n.children,...t.slice(e+1)]:n.children=t.slice(e+1),n.option=ki,void this.compose([n]);if(n.textContent instanceof Array){const t=[];for(const e of n.textContent){const r=Object.assign({},n);r.textContent=e,t.push(r)}this.compose(t);continue}let r=this.constructChild(n.tag,n.attributes);n.classes&&r.addClass(...n.classes),n.children&&r.compose(n.children),n.textContent&&r.addTextContent(n.textContent),n.style&&r.addStyle(n.style),n.innerHtml&&r.setInnerHtml(n.innerHtml)}}}class Fi extends Mi{thead;tbody;constructor(t,e,n){super(t),this.constructChild("thead",{id:e}),this.constructChild("tbody",{id:n}),this.thead=this.children[e],this.tbody=this.children[n]}static createFromIDs(t,e,n){const r=document.createElement("table");return r.id=t,new Fi(r,e,n)}addColumns(t){const e=this.thead.constructChild("tr");t.forEach(t=>{e.constructChild("th",{scope:"col"}).addTextContent(t)})}}var xi=["Hero Name","Battles","Pick Rate","Wins","Win Rate","Postban Rate","Success Rate","+/-","Point Gain","Avg CR","First Turn Rate"],Ui=[{tbl:bt.HOME_PAGE.SEASON_DETAILS_TBL,cols:["","Season","Start","End","Status"]},{tbl:bt.HOME_PAGE.PERFORMANCE_STATS_TBL,cols:["","Battles","Freq","Wins","Win Rate","+/-","FP WR","SP WR"]},{tbl:bt.HOME_PAGE.FIRST_PICK_STATS_TBL,cols:["Hero","Battles","Pick Rate","Win Rate","+/-"]},{tbl:bt.HOME_PAGE.PREBAN_STATS_TBL,cols:["Preban","Battles","Ban Rate","Win Rate","+/-"]},{tbl:bt.HOME_PAGE.PLAYER_TBL,cols:xi},{tbl:bt.HOME_PAGE.OPPONENT_TBL,cols:xi.filter(function(t){return!t.toLowerCase().includes("success")})},{tbl:bt.HOME_PAGE.BATTLES_TBL,cols:Object.values(B).filter(function(t){return!t.toLowerCase().includes("prime")})}];function ji(){Ui.forEach(function(t){var e,n,r;e=t.tbl,n=t.cols,r=e.id,new Fi(e,r+"-head",r+"-body").addColumns(n)})}function Bi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Gi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gi(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function Gi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Hi(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return $i(u,"_invoke",function(n,r,o){var a,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,s=0,c=t,p.n=n,i}};function d(n,r){for(s=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=p.p,h=a[2];n>3?(o=h===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(s=0,p.v=r,p.n=a[1]):d<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,p.n=h,s=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(e=s<2?t:c)||!f;){a||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((e=(f=p.n<0)?c:n.call(r,p))!==i)break}catch(e){a=t,s=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,a),!0),u}var i={};function s(){}function c(){}function u(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):($i(e={},r,function(){return this}),e),f=u.prototype=s.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,$i(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=u,$i(f,"constructor",u),$i(u,"constructor",c),c.displayName="GeneratorFunction",$i(u,o,"GeneratorFunction"),$i(f),$i(f,o,"Generator"),$i(f,r,function(){return this}),$i(f,"toString",function(){return"[object Generator]"}),(Hi=function(){return{w:a,m:p}})()}function $i(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}$i=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){$i(t,e,function(t){return this._invoke(e,n,t)})};a("next",0),a("throw",1),a("return",2)}},$i(t,e,n,r)}function Ki(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Wi(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){Ki(a,r,o,i,s,"next",t)}function s(t){Ki(a,r,o,i,s,"throw",t)}i(void 0)})}}function Vi(t,e){return Yi.apply(this,arguments)}function Yi(){return(Yi=Wi(Hi().m(function t(e,n){var r,o,a,i;return Hi().w(function(t){for(;;)switch(t.n){case 0:r=!1,i=e,t.n=i===Nr.ACTIONS.CLEAR_USER?1:i===Nr.ACTIONS.SHOW_DATA_ALREADY_CLEARED_MSG?5:i===Nr.ACTIONS.SHOW_NO_USER_MSG?6:i===Nr.ACTIONS.QUERY_USER?7:8;break;case 1:return t.n=2,_r.getUser();case 2:return o=t.v,t.n=3,_r.clearUserData();case 3:return Do.writeUserInfo(null),or.queueSelectDataMsgGreen("Cleared data of user ".concat(o.name," (").concat(o.id,")")),t.n=4,Ai(ur.SELECT_DATA);case 4:return r=!0,t.a(3,9);case 5:return or.queueSelectDataMsgGreen("Data already cleared"),t.a(3,9);case 6:return a=n.pop()||"Cannot perform action; no active user found.",or.queueSelectDataMsgRed(a),t.a(3,9);case 7:return jo.AUTO_QUERY=!0,Ai(ur.LOAD_DATA),r=!0,t.a(3,9);case 8:return console.error("Invalid action: ".concat(e)),t.a(3,9);case 9:return t.a(2,r)}},t)}))).apply(this,arguments)}function qi(){return zi.apply(this,arguments)}function zi(){return(zi=Wi(Hi().m(function t(){var e,n,r,o,a,i;return Hi().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Nr.flushState();case 1:e=t.v,n=!1,r=Bi(e.actions),t.p=2,r.s();case 3:if((o=r.n()).done){t.n=6;break}return a=o.value,t.n=4,Vi(a,e.messages);case 4:n=t.v;case 5:t.n=3;break;case 6:t.n=8;break;case 7:t.p=7,i=t.v,r.e(i);case 8:return t.p=8,r.f(),t.f(8);case 9:return t.a(2,n)}},t,null,[[2,7,8,9]])}))).apply(this,arguments)}function Qi(){return Ji.apply(this,arguments)}function Ji(){return(Ji=Wi(Hi().m(function t(){var e,n,r,o;return Hi().w(function(t){for(;;)switch(t.n){case 0:Ci(),ji(),e=0,n=[Xo,xa,hi];case 1:if(!(e<n.length)){t.n=3;break}return r=n[e],t.n=2,r.initialize(Ai);case 2:e++,t.n=1;break;case 3:return t.n=4,_r.getUser();case 4:o=t.v,Do.writeUserInfo(o),Do.addExportCSVBtnListener(),Do.addOfficialSiteBtnListener(),er.bindAutoClear(bt.HOME_PAGE.MESSAGE_ELEMENTS_LIST);case 5:return t.a(2)}},t)}))).apply(this,arguments)}function Xi(){return(Xi=Wi(Hi().m(function t(){return Hi().w(function(t){for(;;)switch(t.n){case 0:document.addEventListener("DOMContentLoaded",Wi(Hi().m(function t(){var e;return Hi().w(function(t){for(;;)switch(t.n){case 0:return Qi(),t.n=1,Or.getState();case 1:if((e=t.v)!==ur.LOAD_DATA){t.n=2;break}return e=ur.SELECT_DATA,t.n=2,Or.setState(e);case 2:return jo.HOME_PAGE_STATE=e,t.n=3,qi();case 3:if(t.v){t.n=4;break}return t.n=4,Ai(e);case 4:cr.setVisibility(bt.HOME_PAGE.FOOTER_BODY,!0);case 5:return t.a(2)}},t)})));case 1:return t.a(2)}},t)}))).apply(this,arguments)}!function(){Xi.apply(this,arguments)}()})()})();